// Minified using Javascript Aggregator - see /sites/default/files/js/js_8dc6cda11e339f47555f2f469cd72319.js for original source including licensing information.

(function(global,factory){"use strict";if(typeof module==="object"&&typeof module.exports==="object"){module.exports=global.document?factory(global,true):function(w){if(!w.document){throw new Error("jQuery requires a window with a document");}
return factory(w);};}else{factory(global);}})(typeof window!=="undefined"?window:this,function(window,noGlobal){"use strict";var arr=[];var getProto=Object.getPrototypeOf;var slice=arr.slice;var flat=arr.flat?function(array){return arr.flat.call(array);}:function(array){return arr.concat.apply([],array);};var push=arr.push;var indexOf=arr.indexOf;var class2type={};var toString=class2type.toString;var hasOwn=class2type.hasOwnProperty;var fnToString=hasOwn.toString;var ObjectFunctionString=fnToString.call(Object);var support={};var isFunction=function isFunction(obj){return typeof obj==="function"&&typeof obj.nodeType!=="number";};var isWindow=function isWindow(obj){return obj!=null&&obj===obj.window;};var document=window.document;var preservedScriptAttributes={type:true,src:true,nonce:true,noModule:true};function DOMEval(code,node,doc){doc=doc||document;var i,val,script=doc.createElement("script");script.text=code;if(node){for(i in preservedScriptAttributes){val=node[i]||node.getAttribute&&node.getAttribute(i);if(val){script.setAttribute(i,val);}}}
doc.head.appendChild(script).parentNode.removeChild(script);}
function toType(obj){if(obj==null){return obj+"";}
return typeof obj==="object"||typeof obj==="function"?class2type[toString.call(obj)]||"object":typeof obj;}
var
version="3.5.1",jQuery=function(selector,context){return new jQuery.fn.init(selector,context);};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,length:0,toArray:function(){return slice.call(this);},get:function(num){if(num==null){return slice.call(this);}
return num<0?this[num+this.length]:this[num];},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);ret.prevObject=this;return ret;},each:function(callback){return jQuery.each(this,callback);},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem);}));},slice:function(){return this.pushStack(slice.apply(this,arguments));},first:function(){return this.eq(0);},last:function(){return this.eq(-1);},even:function(){return this.pushStack(jQuery.grep(this,function(_elem,i){return(i+1)%2;}));},odd:function(){return this.pushStack(jQuery.grep(this,function(_elem,i){return i%2;}));},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[]);},end:function(){return this.prevObject||this.constructor();},push:push,sort:arr.sort,splice:arr.splice};jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[i]||{};i++;}
if(typeof target!=="object"&&!isFunction(target)){target={};}
if(i===length){target=this;i--;}
for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){copy=options[name];if(name==="__proto__"||target===copy){continue;}
if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=Array.isArray(copy)))){src=target[name];if(copyIsArray&&!Array.isArray(src)){clone=[];}else if(!copyIsArray&&!jQuery.isPlainObject(src)){clone={};}else{clone=src;}
copyIsArray=false;target[name]=jQuery.extend(deep,clone,copy);}else if(copy!==undefined){target[name]=copy;}}}}
return target;};jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:true,error:function(msg){throw new Error(msg);},noop:function(){},isPlainObject:function(obj){var proto,Ctor;if(!obj||toString.call(obj)!=="[object Object]"){return false;}
proto=getProto(obj);if(!proto){return true;}
Ctor=hasOwn.call(proto,"constructor")&&proto.constructor;return typeof Ctor==="function"&&fnToString.call(Ctor)===ObjectFunctionString;},isEmptyObject:function(obj){var name;for(name in obj){return false;}
return true;},globalEval:function(code,options,doc){DOMEval(code,{nonce:options&&options.nonce},doc);},each:function(obj,callback){var length,i=0;if(isArrayLike(obj)){length=obj.length;for(;i<length;i++){if(callback.call(obj[i],i,obj[i])===false){break;}}}else{for(i in obj){if(callback.call(obj[i],i,obj[i])===false){break;}}}
return obj;},makeArray:function(arr,results){var ret=results||[];if(arr!=null){if(isArrayLike(Object(arr))){jQuery.merge(ret,typeof arr==="string"?[arr]:arr);}else{push.call(ret,arr);}}
return ret;},inArray:function(elem,arr,i){return arr==null?-1:indexOf.call(arr,elem,i);},merge:function(first,second){var len=+second.length,j=0,i=first.length;for(;j<len;j++){first[i++]=second[j];}
first.length=i;return first;},grep:function(elems,callback,invert){var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;for(;i<length;i++){callbackInverse=!callback(elems[i],i);if(callbackInverse!==callbackExpect){matches.push(elems[i]);}}
return matches;},map:function(elems,callback,arg){var length,value,i=0,ret=[];if(isArrayLike(elems)){length=elems.length;for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret.push(value);}}}else{for(i in elems){value=callback(elems[i],i,arg);if(value!=null){ret.push(value);}}}
return flat(ret);},guid:1,support:support});if(typeof Symbol==="function"){jQuery.fn[Symbol.iterator]=arr[Symbol.iterator];}
jQuery.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(_i,name){class2type["[object "+name+"]"]=name.toLowerCase();});function isArrayLike(obj){var length=!!obj&&"length"in obj&&obj.length,type=toType(obj);if(isFunction(obj)||isWindow(obj)){return false;}
return type==="array"||length===0||typeof length==="number"&&length>0&&(length-1)in obj;}
var Sizzle=(function(window){var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date(),preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),nonnativeSelectorCache=createCache(),sortOrder=function(a,b){if(a===b){hasDuplicate=true;}
return 0;},hasOwn=({}).hasOwnProperty,arr=[],pop=arr.pop,pushNative=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){var i=0,len=list.length;for(;i<len;i++){if(list[i]===elem){return i;}}
return-1;},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|"+"ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\[\\da-fA-F]{1,6}"+whitespace+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",attributes="\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+
whitespace+"*\\]",pseudos=":("+identifier+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|"+".*"+")\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+
whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rdescend=new RegExp(whitespace+"|>"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={"ID":new RegExp("^#("+identifier+")"),"CLASS":new RegExp("^\\.("+identifier+")"),"TAG":new RegExp("^("+identifier+"|[*])"),"ATTR":new RegExp("^"+attributes),"PSEUDO":new RegExp("^"+pseudos),"CHILD":new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+
whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+
whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),"bool":new RegExp("^(?:"+booleans+")$","i"),"needsContext":new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rhtml=/HTML$/i,rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,runescape=new RegExp("\\\\[\\da-fA-F]{1,6}"+whitespace+"?|\\\\([^\\r\\n\\f])","g"),funescape=function(escape,nonHex){var high="0x"+escape.slice(1)-0x10000;return nonHex?nonHex:high<0?String.fromCharCode(high+0x10000):String.fromCharCode(high>>10|0xD800,high&0x3FF|0xDC00);},rcssescape=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,fcssescape=function(ch,asCodePoint){if(asCodePoint){if(ch==="\0"){return"\uFFFD";}
return ch.slice(0,-1)+"\\"+
ch.charCodeAt(ch.length-1).toString(16)+" ";}
return"\\"+ch;},unloadHandler=function(){setDocument();},inDisabledFieldset=addCombinator(function(elem){return elem.disabled===true&&elem.nodeName.toLowerCase()==="fieldset";},{dir:"parentNode",next:"legend"});try{push.apply((arr=slice.call(preferredDoc.childNodes)),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType;}catch(e){push={apply:arr.length?function(target,els){pushNative.apply(target,slice.call(els));}:function(target,els){var j=target.length,i=0;while((target[j++]=els[i++])){}
target.length=j-1;}};}
function Sizzle(selector,context,results,seed){var m,i,elem,nid,match,groups,newSelector,newContext=context&&context.ownerDocument,nodeType=context?context.nodeType:9;results=results||[];if(typeof selector!=="string"||!selector||nodeType!==1&&nodeType!==9&&nodeType!==11){return results;}
if(!seed){setDocument(context);context=context||document;if(documentIsHTML){if(nodeType!==11&&(match=rquickExpr.exec(selector))){if((m=match[1])){if(nodeType===9){if((elem=context.getElementById(m))){if(elem.id===m){results.push(elem);return results;}}else{return results;}}else{if(newContext&&(elem=newContext.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results;}}}else if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results;}else if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results;}}
if(support.qsa&&!nonnativeSelectorCache[selector+" "]&&(!rbuggyQSA||!rbuggyQSA.test(selector))&&(nodeType!==1||context.nodeName.toLowerCase()!=="object")){newSelector=selector;newContext=context;if(nodeType===1&&(rdescend.test(selector)||rcombinators.test(selector))){newContext=rsibling.test(selector)&&testContext(context.parentNode)||context;if(newContext!==context||!support.scope){if((nid=context.getAttribute("id"))){nid=nid.replace(rcssescape,fcssescape);}else{context.setAttribute("id",(nid=expando));}}
groups=tokenize(selector);i=groups.length;while(i--){groups[i]=(nid?"#"+nid:":scope")+" "+
toSelector(groups[i]);}
newSelector=groups.join(",");}
try{push.apply(results,newContext.querySelectorAll(newSelector));return results;}catch(qsaError){nonnativeSelectorCache(selector,true);}finally{if(nid===expando){context.removeAttribute("id");}}}}}
return select(selector.replace(rtrim,"$1"),context,results,seed);}
function createCache(){var keys=[];function cache(key,value){if(keys.push(key+" ")>Expr.cacheLength){delete cache[keys.shift()];}
return(cache[key+" "]=value);}
return cache;}
function markFunction(fn){fn[expando]=true;return fn;}
function assert(fn){var el=document.createElement("fieldset");try{return!!fn(el);}catch(e){return false;}finally{if(el.parentNode){el.parentNode.removeChild(el);}
el=null;}}
function addHandle(attrs,handler){var arr=attrs.split("|"),i=arr.length;while(i--){Expr.attrHandle[arr[i]]=handler;}}
function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&a.sourceIndex-b.sourceIndex;if(diff){return diff;}
if(cur){while((cur=cur.nextSibling)){if(cur===b){return-1;}}}
return a?1:-1;}
function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type;};}
function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type;};}
function createDisabledPseudo(disabled){return function(elem){if("form"in elem){if(elem.parentNode&&elem.disabled===false){if("label"in elem){if("label"in elem.parentNode){return elem.parentNode.disabled===disabled;}else{return elem.disabled===disabled;}}
return elem.isDisabled===disabled||elem.isDisabled!==!disabled&&inDisabledFieldset(elem)===disabled;}
return elem.disabled===disabled;}else if("label"in elem){return elem.disabled===disabled;}
return false;};}
function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[(j=matchIndexes[i])]){seed[j]=!(matches[j]=seed[j]);}}});});}
function testContext(context){return context&&typeof context.getElementsByTagName!=="undefined"&&context;}
support=Sizzle.support={};isXML=Sizzle.isXML=function(elem){var namespace=elem.namespaceURI,docElem=(elem.ownerDocument||elem).documentElement;return!rhtml.test(namespace||docElem&&docElem.nodeName||"HTML");};setDocument=Sizzle.setDocument=function(node){var hasCompare,subWindow,doc=node?node.ownerDocument||node:preferredDoc;if(doc==document||doc.nodeType!==9||!doc.documentElement){return document;}
document=doc;docElem=document.documentElement;documentIsHTML=!isXML(document);if(preferredDoc!=document&&(subWindow=document.defaultView)&&subWindow.top!==subWindow){if(subWindow.addEventListener){subWindow.addEventListener("unload",unloadHandler,false);}else if(subWindow.attachEvent){subWindow.attachEvent("onunload",unloadHandler);}}
support.scope=assert(function(el){docElem.appendChild(el).appendChild(document.createElement("div"));return typeof el.querySelectorAll!=="undefined"&&!el.querySelectorAll(":scope fieldset div").length;});support.attributes=assert(function(el){el.className="i";return!el.getAttribute("className");});support.getElementsByTagName=assert(function(el){el.appendChild(document.createComment(""));return!el.getElementsByTagName("*").length;});support.getElementsByClassName=rnative.test(document.getElementsByClassName);support.getById=assert(function(el){docElem.appendChild(el).id=expando;return!document.getElementsByName||!document.getElementsByName(expando).length;});if(support.getById){Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId;};};Expr.find["ID"]=function(id,context){if(typeof context.getElementById!=="undefined"&&documentIsHTML){var elem=context.getElementById(id);return elem?[elem]:[];}};}else{Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return node&&node.value===attrId;};};Expr.find["ID"]=function(id,context){if(typeof context.getElementById!=="undefined"&&documentIsHTML){var node,i,elems,elem=context.getElementById(id);if(elem){node=elem.getAttributeNode("id");if(node&&node.value===id){return[elem];}
elems=context.getElementsByName(id);i=0;while((elem=elems[i++])){node=elem.getAttributeNode("id");if(node&&node.value===id){return[elem];}}}
return[];}};}
Expr.find["TAG"]=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!=="undefined"){return context.getElementsByTagName(tag);}else if(support.qsa){return context.querySelectorAll(tag);}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while((elem=results[i++])){if(elem.nodeType===1){tmp.push(elem);}}
return tmp;}
return results;};Expr.find["CLASS"]=support.getElementsByClassName&&function(className,context){if(typeof context.getElementsByClassName!=="undefined"&&documentIsHTML){return context.getElementsByClassName(className);}};rbuggyMatches=[];rbuggyQSA=[];if((support.qsa=rnative.test(document.querySelectorAll))){assert(function(el){var input;docElem.appendChild(el).innerHTML="<a id='"+expando+"'></a>"+"<select id='"+expando+"-\r\\' msallowcapture=''>"+"<option selected=''></option></select>";if(el.querySelectorAll("[msallowcapture^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")");}
if(!el.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")");}
if(!el.querySelectorAll("[id~="+expando+"-]").length){rbuggyQSA.push("~=");}
input=document.createElement("input");input.setAttribute("name","");el.appendChild(input);if(!el.querySelectorAll("[name='']").length){rbuggyQSA.push("\\["+whitespace+"*name"+whitespace+"*="+
whitespace+"*(?:''|\"\")");}
if(!el.querySelectorAll(":checked").length){rbuggyQSA.push(":checked");}
if(!el.querySelectorAll("a#"+expando+"+*").length){rbuggyQSA.push(".#.+[+~]");}
el.querySelectorAll("\\\f");rbuggyQSA.push("[\\r\\n\\f]");});assert(function(el){el.innerHTML="<a href='' disabled='disabled'></a>"+"<select disabled='disabled'><option/></select>";var input=document.createElement("input");input.setAttribute("type","hidden");el.appendChild(input).setAttribute("name","D");if(el.querySelectorAll("[name=d]").length){rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?=");}
if(el.querySelectorAll(":enabled").length!==2){rbuggyQSA.push(":enabled",":disabled");}
docElem.appendChild(el).disabled=true;if(el.querySelectorAll(":disabled").length!==2){rbuggyQSA.push(":enabled",":disabled");}
el.querySelectorAll("*,:x");rbuggyQSA.push(",.*:");});}
if((support.matchesSelector=rnative.test((matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector)))){assert(function(el){support.disconnectedMatch=matches.call(el,"*");matches.call(el,"[s!='']:x");rbuggyMatches.push("!=",pseudos);});}
rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));hasCompare=rnative.test(docElem.compareDocumentPosition);contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16));}:function(a,b){if(b){while((b=b.parentNode)){if(b===a){return true;}}}
return false;};sortOrder=hasCompare?function(a,b){if(a===b){hasDuplicate=true;return 0;}
var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;if(compare){return compare;}
compare=(a.ownerDocument||a)==(b.ownerDocument||b)?a.compareDocumentPosition(b):1;if(compare&1||(!support.sortDetached&&b.compareDocumentPosition(a)===compare)){if(a==document||a.ownerDocument==preferredDoc&&contains(preferredDoc,a)){return-1;}
if(b==document||b.ownerDocument==preferredDoc&&contains(preferredDoc,b)){return 1;}
return sortInput?(indexOf(sortInput,a)-indexOf(sortInput,b)):0;}
return compare&4?-1:1;}:function(a,b){if(a===b){hasDuplicate=true;return 0;}
var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup){return a==document?-1:b==document?1:aup?-1:bup?1:sortInput?(indexOf(sortInput,a)-indexOf(sortInput,b)):0;}else if(aup===bup){return siblingCheck(a,b);}
cur=a;while((cur=cur.parentNode)){ap.unshift(cur);}
cur=b;while((cur=cur.parentNode)){bp.unshift(cur);}
while(ap[i]===bp[i]){i++;}
return i?siblingCheck(ap[i],bp[i]):ap[i]==preferredDoc?-1:bp[i]==preferredDoc?1:0;};return document;};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements);};Sizzle.matchesSelector=function(elem,expr){setDocument(elem);if(support.matchesSelector&&documentIsHTML&&!nonnativeSelectorCache[expr+" "]&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret;}}catch(e){nonnativeSelectorCache(expr,true);}}
return Sizzle(expr,document,null,[elem]).length>0;};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!=document){setDocument(context);}
return contains(context,elem);};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!=document){setDocument(elem);}
var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null;};Sizzle.escape=function(sel){return(sel+"").replace(rcssescape,fcssescape);};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg);};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while((elem=results[i++])){if(elem===results[i]){j=duplicates.push(i);}}
while(j--){results.splice(duplicates[j],1);}}
sortInput=null;return results;};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType){while((node=elem[i++])){ret+=getText(node);}}else if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent;}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem);}}}else if(nodeType===3||nodeType===4){return elem.nodeValue;}
return ret;};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{"ATTR":function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape);if(match[2]==="~="){match[3]=" "+match[3]+" ";}
return match.slice(0,4);},"CHILD":function(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0]);}
match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+((match[7]+match[8])||match[3]==="odd");}else if(match[3]){Sizzle.error(match[0]);}
return match;},"PSEUDO":function(match){var excess,unquoted=!match[6]&&match[2];if(matchExpr["CHILD"].test(match[0])){return null;}
if(match[3]){match[2]=match[4]||match[5]||"";}else if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess);}
return match.slice(0,3);}},filter:{"TAG":function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return true;}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName;};},"CLASS":function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!=="undefined"&&elem.getAttribute("class")||"");});},"ATTR":function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==="!=";}
if(!operator){return true;}
result+="";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false;};},"CHILD":function(type,what,_argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";return first===1&&last===0?function(elem){return!!elem.parentNode;}:function(elem,_context,xml){var cache,uniqueCache,outerCache,node,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType,diff=false;if(parent){if(simple){while(dir){node=elem;while((node=node[dir])){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false;}}
start=dir=type==="only"&&!start&&"nextSibling";}
return true;}
start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){node=parent;outerCache=node[expando]||(node[expando]={});uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={});cache=uniqueCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=nodeIndex&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if(node.nodeType===1&&++diff&&node===elem){uniqueCache[type]=[dirruns,nodeIndex,diff];break;}}}else{if(useCache){node=elem;outerCache=node[expando]||(node[expando]={});uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={});cache=uniqueCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=nodeIndex;}
if(diff===false){while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){outerCache=node[expando]||(node[expando]={});uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={});uniqueCache[type]=[dirruns,diff];}
if(node===elem){break;}}}}}
diff-=last;return diff===first||(diff%first===0&&diff/first>=0);}};},"PSEUDO":function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando]){return fn(argument);}
if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i]);}}):function(elem){return fn(elem,0,args);};}
return fn;}},pseudos:{"not":markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,_context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if((elem=unmatched[i])){seed[i]=!(matches[i]=elem);}}}):function(elem,_context,xml){input[0]=elem;matcher(input,null,xml,results);input[0]=null;return!results.pop();};}),"has":markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0;};}),"contains":markFunction(function(text){text=text.replace(runescape,funescape);return function(elem){return(elem.textContent||getText(elem)).indexOf(text)>-1;};}),"lang":markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang);}
lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if((elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0;}}while((elem=elem.parentNode)&&elem.nodeType===1);return false;};}),"target":function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id;},"root":function(elem){return elem===docElem;},"focus":function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex);},"enabled":createDisabledPseudo(false),"disabled":createDisabledPseudo(true),"checked":function(elem){var nodeName=elem.nodeName.toLowerCase();return(nodeName==="input"&&!!elem.checked)||(nodeName==="option"&&!!elem.selected);},"selected":function(elem){if(elem.parentNode){elem.parentNode.selectedIndex;}
return elem.selected===true;},"empty":function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeType<6){return false;}}
return true;},"parent":function(elem){return!Expr.pseudos["empty"](elem);},"header":function(elem){return rheader.test(elem.nodeName);},"input":function(elem){return rinputs.test(elem.nodeName);},"button":function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button";},"text":function(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()==="text");},"first":createPositionalPseudo(function(){return[0];}),"last":createPositionalPseudo(function(_matchIndexes,length){return[length-1];}),"eq":createPositionalPseudo(function(_matchIndexes,length,argument){return[argument<0?argument+length:argument];}),"even":createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i);}
return matchIndexes;}),"odd":createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i);}
return matchIndexes;}),"lt":createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument>length?length:argument;for(;--i>=0;){matchIndexes.push(i);}
return matchIndexes;}),"gt":createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i);}
return matchIndexes;})}};Expr.pseudos["nth"]=Expr.pseudos["eq"];for(i in{radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i);}
for(i in{submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i);}
function setFilters(){}
setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters();tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached){return parseOnly?0:cached.slice(0);}
soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar;}
groups.push((tokens=[]));}
matched=false;if((match=rcombinators.exec(soFar))){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length);}
for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length);}}
if(!matched){break;}}
return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0);};function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++){selector+=tokens[i].value;}
return selector;}
function addCombinator(matcher,combinator,base){var dir=combinator.dir,skip=combinator.next,key=skip||dir,checkNonElements=base&&key==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml);}}
return false;}:function(elem,context,xml){var oldCache,uniqueCache,outerCache,newCache=[dirruns,doneName];if(xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true;}}}}else{while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});uniqueCache=outerCache[elem.uniqueID]||(outerCache[elem.uniqueID]={});if(skip&&skip===elem.nodeName.toLowerCase()){elem=elem[dir]||elem;}else if((oldCache=uniqueCache[key])&&oldCache[0]===dirruns&&oldCache[1]===doneName){return(newCache[2]=oldCache[2]);}else{uniqueCache[key]=newCache;if((newCache[2]=matcher(elem,context,xml))){return true;}}}}}
return false;};}
function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return false;}}
return true;}:matchers[0];}
function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results);}
return results;}
function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if((elem=unmatched[i])){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i);}}}}
return newUnmatched;}
function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter);}
if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector);}
return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml);}
if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if((elem=temp[i])){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem);}}}
if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if((elem=matcherOut[i])){temp.push((matcherIn[i]=elem));}}
postFinder(null,(matcherOut=[]),temp,xml);}
i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem);}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml);}else{push.apply(results,matcherOut);}}});}
function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext;},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1;},implicitRelative,true),matchers=[function(elem,context,xml){var ret=(!leadingRelative&&(xml||context!==outermostContext))||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));checkContext=null;return ret;}];for(;i<len;i++){if((matcher=Expr.relative[tokens[i].type])){matchers=[addCombinator(elementMatcher(matchers),matcher)];}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break;}}
return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens((tokens=tokens.slice(j))),j<len&&toSelector(tokens));}
matchers.push(matcher);}}
return elementMatcher(matchers);}
function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find["TAG"]("*",outermost),dirrunsUnique=(dirruns+=contextBackup==null?1:Math.random()||0.1),len=elems.length;if(outermost){outermostContext=context==document||context||outermost;}
for(;i!==len&&(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;if(!context&&elem.ownerDocument!=document){setDocument(elem);xml=!documentIsHTML;}
while((matcher=elementMatchers[j++])){if(matcher(elem,context||document,xml)){results.push(elem);break;}}
if(outermost){dirruns=dirrunsUnique;}}
if(bySet){if((elem=!matcher&&elem)){matchedCount--;}
if(seed){unmatched.push(elem);}}}
matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while((matcher=setMatchers[j++])){matcher(unmatched,setMatched,context,xml);}
if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results);}}}
setMatched=condense(setMatched);}
push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&(matchedCount+setMatchers.length)>1){Sizzle.uniqueSort(results);}}
if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup;}
return unmatched;};return bySet?markFunction(superMatcher):superMatcher;}
compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!match){match=tokenize(selector);}
i=match.length;while(i--){cached=matcherFromTokens(match[i]);if(cached[expando]){setMatchers.push(cached);}else{elementMatchers.push(cached);}}
cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));cached.selector=selector;}
return cached;};select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled=typeof selector==="function"&&selector,match=!seed&&tokenize((selector=compiled.selector||selector));results=results||[];if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find["ID"](token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results;}else if(compiled){context=context.parentNode;}
selector=selector.slice(tokens.shift().value.length);}
i=matchExpr["needsContext"].test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[(type=token.type)]){break;}
if((find=Expr.find[type])){if((seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results;}
break;}}}}
(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,!context||rsibling.test(selector)&&testContext(context.parentNode)||context);return results;};support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=!!hasDuplicate;setDocument();support.sortDetached=assert(function(el){return el.compareDocumentPosition(document.createElement("fieldset"))&1;});if(!assert(function(el){el.innerHTML="<a href='#'></a>";return el.firstChild.getAttribute("href")==="#";})){addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML){return elem.getAttribute(name,name.toLowerCase()==="type"?1:2);}});}
if(!support.attributes||!assert(function(el){el.innerHTML="<input/>";el.firstChild.setAttribute("value","");return el.firstChild.getAttribute("value")==="";})){addHandle("value",function(elem,_name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input"){return elem.defaultValue;}});}
if(!assert(function(el){return el.getAttribute("disabled")==null;})){addHandle(booleans,function(elem,name,isXML){var val;if(!isXML){return elem[name]===true?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null;}});}
return Sizzle;})(window);jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.pseudos;jQuery.uniqueSort=jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains;jQuery.escapeSelector=Sizzle.escape;var dir=function(elem,dir,until){var matched=[],truncate=until!==undefined;while((elem=elem[dir])&&elem.nodeType!==9){if(elem.nodeType===1){if(truncate&&jQuery(elem).is(until)){break;}
matched.push(elem);}}
return matched;};var siblings=function(n,elem){var matched=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){matched.push(n);}}
return matched;};var rneedsContext=jQuery.expr.match.needsContext;function nodeName(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase();};var rsingleTag=(/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i);function winnow(elements,qualifier,not){if(isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not;});}
if(qualifier.nodeType){return jQuery.grep(elements,function(elem){return(elem===qualifier)!==not;});}
if(typeof qualifier!=="string"){return jQuery.grep(elements,function(elem){return(indexOf.call(qualifier,elem)>-1)!==not;});}
return jQuery.filter(qualifier,elements,not);}
jQuery.filter=function(expr,elems,not){var elem=elems[0];if(not){expr=":not("+expr+")";}
if(elems.length===1&&elem.nodeType===1){return jQuery.find.matchesSelector(elem,expr)?[elem]:[];}
return jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return elem.nodeType===1;}));};jQuery.fn.extend({find:function(selector){var i,ret,len=this.length,self=this;if(typeof selector!=="string"){return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++){if(jQuery.contains(self[i],this)){return true;}}}));}
ret=this.pushStack([]);for(i=0;i<len;i++){jQuery.find(selector,self[i],ret);}
return len>1?jQuery.uniqueSort(ret):ret;},filter:function(selector){return this.pushStack(winnow(this,selector||[],false));},not:function(selector){return this.pushStack(winnow(this,selector||[],true));},is:function(selector){return!!winnow(this,typeof selector==="string"&&rneedsContext.test(selector)?jQuery(selector):selector||[],false).length;}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,init=jQuery.fn.init=function(selector,context,root){var match,elem;if(!selector){return this;}
root=root||rootjQuery;if(typeof selector==="string"){if(selector[0]==="<"&&selector[selector.length-1]===">"&&selector.length>=3){match=[null,selector,null];}else{match=rquickExpr.exec(selector);}
if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,true));if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){for(match in context){if(isFunction(this[match])){this[match](context[match]);}else{this.attr(match,context[match]);}}}
return this;}else{elem=document.getElementById(match[2]);if(elem){this[0]=elem;this.length=1;}
return this;}}else if(!context||context.jquery){return(context||root).find(selector);}else{return this.constructor(context).find(selector);}}else if(selector.nodeType){this[0]=selector;this.length=1;return this;}else if(isFunction(selector)){return root.ready!==undefined?root.ready(selector):selector(jQuery);}
return jQuery.makeArray(selector,this);};init.prototype=jQuery.fn;rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){var i=0;for(;i<l;i++){if(jQuery.contains(this,targets[i])){return true;}}});},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],targets=typeof selectors!=="string"&&jQuery(selectors);if(!rneedsContext.test(selectors)){for(;i<l;i++){for(cur=this[i];cur&&cur!==context;cur=cur.parentNode){if(cur.nodeType<11&&(targets?targets.index(cur)>-1:cur.nodeType===1&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break;}}}}
return this.pushStack(matched.length>1?jQuery.uniqueSort(matched):matched);},index:function(elem){if(!elem){return(this[0]&&this[0].parentNode)?this.first().prevAll().length:-1;}
if(typeof elem==="string"){return indexOf.call(jQuery(elem),this[0]);}
return indexOf.call(this,elem.jquery?elem[0]:elem);},add:function(selector,context){return this.pushStack(jQuery.uniqueSort(jQuery.merge(this.get(),jQuery(selector,context))));},addBack:function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector));}});function sibling(cur,dir){while((cur=cur[dir])&&cur.nodeType!==1){}
return cur;}
jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null;},parents:function(elem){return dir(elem,"parentNode");},parentsUntil:function(elem,_i,until){return dir(elem,"parentNode",until);},next:function(elem){return sibling(elem,"nextSibling");},prev:function(elem){return sibling(elem,"previousSibling");},nextAll:function(elem){return dir(elem,"nextSibling");},prevAll:function(elem){return dir(elem,"previousSibling");},nextUntil:function(elem,_i,until){return dir(elem,"nextSibling",until);},prevUntil:function(elem,_i,until){return dir(elem,"previousSibling",until);},siblings:function(elem){return siblings((elem.parentNode||{}).firstChild,elem);},children:function(elem){return siblings(elem.firstChild);},contents:function(elem){if(elem.contentDocument!=null&&getProto(elem.contentDocument)){return elem.contentDocument;}
if(nodeName(elem,"template")){elem=elem.content||elem;}
return jQuery.merge([],elem.childNodes);}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);if(name.slice(-5)!=="Until"){selector=until;}
if(selector&&typeof selector==="string"){matched=jQuery.filter(selector,matched);}
if(this.length>1){if(!guaranteedUnique[name]){jQuery.uniqueSort(matched);}
if(rparentsprev.test(name)){matched.reverse();}}
return this.pushStack(matched);};});var rnothtmlwhite=(/[^\x20\t\r\n\f]+/g);function createOptions(options){var object={};jQuery.each(options.match(rnothtmlwhite)||[],function(_,flag){object[flag]=true;});return object;}
jQuery.Callbacks=function(options){options=typeof options==="string"?createOptions(options):jQuery.extend({},options);var
firing,memory,fired,locked,list=[],queue=[],firingIndex=-1,fire=function(){locked=locked||options.once;fired=firing=true;for(;queue.length;firingIndex=-1){memory=queue.shift();while(++firingIndex<list.length){if(list[firingIndex].apply(memory[0],memory[1])===false&&options.stopOnFalse){firingIndex=list.length;memory=false;}}}
if(!options.memory){memory=false;}
firing=false;if(locked){if(memory){list=[];}else{list="";}}},self={add:function(){if(list){if(memory&&!firing){firingIndex=list.length-1;queue.push(memory);}
(function add(args){jQuery.each(args,function(_,arg){if(isFunction(arg)){if(!options.unique||!self.has(arg)){list.push(arg);}}else if(arg&&arg.length&&toType(arg)!=="string"){add(arg);}});})(arguments);if(memory&&!firing){fire();}}
return this;},remove:function(){jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1){list.splice(index,1);if(index<=firingIndex){firingIndex--;}}});return this;},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:list.length>0;},empty:function(){if(list){list=[];}
return this;},disable:function(){locked=queue=[];list=memory="";return this;},disabled:function(){return!list;},lock:function(){locked=queue=[];if(!memory&&!firing){list=memory="";}
return this;},locked:function(){return!!locked;},fireWith:function(context,args){if(!locked){args=args||[];args=[context,args.slice?args.slice():args];queue.push(args);if(!firing){fire();}}
return this;},fire:function(){self.fireWith(this,arguments);return this;},fired:function(){return!!fired;}};return self;};function Identity(v){return v;}
function Thrower(ex){throw ex;}
function adoptValue(value,resolve,reject,noValue){var method;try{if(value&&isFunction((method=value.promise))){method.call(value).done(resolve).fail(reject);}else if(value&&isFunction((method=value.then))){method.call(value,resolve,reject);}else{resolve.apply(undefined,[value].slice(noValue));}}catch(value){reject.apply(undefined,[value]);}}
jQuery.extend({Deferred:function(func){var tuples=[["notify","progress",jQuery.Callbacks("memory"),jQuery.Callbacks("memory"),2],["resolve","done",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),0,"resolved"],["reject","fail",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),1,"rejected"]],state="pending",promise={state:function(){return state;},always:function(){deferred.done(arguments).fail(arguments);return this;},"catch":function(fn){return promise.then(null,fn);},pipe:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(_i,tuple){var fn=isFunction(fns[tuple[4]])&&fns[tuple[4]];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);if(returned&&isFunction(returned.promise)){returned.promise().progress(newDefer.notify).done(newDefer.resolve).fail(newDefer.reject);}else{newDefer[tuple[0]+"With"](this,fn?[returned]:arguments);}});});fns=null;}).promise();},then:function(onFulfilled,onRejected,onProgress){var maxDepth=0;function resolve(depth,deferred,handler,special){return function(){var that=this,args=arguments,mightThrow=function(){var returned,then;if(depth<maxDepth){return;}
returned=handler.apply(that,args);if(returned===deferred.promise()){throw new TypeError("Thenable self-resolution");}
then=returned&&(typeof returned==="object"||typeof returned==="function")&&returned.then;if(isFunction(then)){if(special){then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special));}else{maxDepth++;then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special),resolve(maxDepth,deferred,Identity,deferred.notifyWith));}}else{if(handler!==Identity){that=undefined;args=[returned];}
(special||deferred.resolveWith)(that,args);}},process=special?mightThrow:function(){try{mightThrow();}catch(e){if(jQuery.Deferred.exceptionHook){jQuery.Deferred.exceptionHook(e,process.stackTrace);}
if(depth+1>=maxDepth){if(handler!==Thrower){that=undefined;args=[e];}
deferred.rejectWith(that,args);}}};if(depth){process();}else{if(jQuery.Deferred.getStackHook){process.stackTrace=jQuery.Deferred.getStackHook();}
window.setTimeout(process);}};}
return jQuery.Deferred(function(newDefer){tuples[0][3].add(resolve(0,newDefer,isFunction(onProgress)?onProgress:Identity,newDefer.notifyWith));tuples[1][3].add(resolve(0,newDefer,isFunction(onFulfilled)?onFulfilled:Identity));tuples[2][3].add(resolve(0,newDefer,isFunction(onRejected)?onRejected:Thrower));}).promise();},promise:function(obj){return obj!=null?jQuery.extend(obj,promise):promise;}},deferred={};jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[5];promise[tuple[1]]=list.add;if(stateString){list.add(function(){state=stateString;},tuples[3-i][2].disable,tuples[3-i][3].disable,tuples[0][2].lock,tuples[0][3].lock);}
list.add(tuple[3].fire);deferred[tuple[0]]=function(){deferred[tuple[0]+"With"](this===deferred?undefined:this,arguments);return this;};deferred[tuple[0]+"With"]=list.fireWith;});promise.promise(deferred);if(func){func.call(deferred,deferred);}
return deferred;},when:function(singleValue){var
remaining=arguments.length,i=remaining,resolveContexts=Array(i),resolveValues=slice.call(arguments),master=jQuery.Deferred(),updateFunc=function(i){return function(value){resolveContexts[i]=this;resolveValues[i]=arguments.length>1?slice.call(arguments):value;if(!(--remaining)){master.resolveWith(resolveContexts,resolveValues);}};};if(remaining<=1){adoptValue(singleValue,master.done(updateFunc(i)).resolve,master.reject,!remaining);if(master.state()==="pending"||isFunction(resolveValues[i]&&resolveValues[i].then)){return master.then();}}
while(i--){adoptValue(resolveValues[i],updateFunc(i),master.reject);}
return master.promise();}});var rerrorNames=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;jQuery.Deferred.exceptionHook=function(error,stack){if(window.console&&window.console.warn&&error&&rerrorNames.test(error.name)){window.console.warn("jQuery.Deferred exception: "+error.message,error.stack,stack);}};jQuery.readyException=function(error){window.setTimeout(function(){throw error;});};var readyList=jQuery.Deferred();jQuery.fn.ready=function(fn){readyList.then(fn).catch(function(error){jQuery.readyException(error);});return this;};jQuery.extend({isReady:false,readyWait:1,ready:function(wait){if(wait===true?--jQuery.readyWait:jQuery.isReady){return;}
jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return;}
readyList.resolveWith(document,[jQuery]);}});jQuery.ready.then=readyList.then;function completed(){document.removeEventListener("DOMContentLoaded",completed);window.removeEventListener("load",completed);jQuery.ready();}
if(document.readyState==="complete"||(document.readyState!=="loading"&&!document.documentElement.doScroll)){window.setTimeout(jQuery.ready);}else{document.addEventListener("DOMContentLoaded",completed);window.addEventListener("load",completed);}
var access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=key==null;if(toType(key)==="object"){chainable=true;for(i in key){access(elems,fn,i,key[i],true,emptyGet,raw);}}else if(value!==undefined){chainable=true;if(!isFunction(value)){raw=true;}
if(bulk){if(raw){fn.call(elems,value);fn=null;}else{bulk=fn;fn=function(elem,_key,value){return bulk.call(jQuery(elem),value);};}}
if(fn){for(;i<len;i++){fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));}}}
if(chainable){return elems;}
if(bulk){return fn.call(elems);}
return len?fn(elems[0],key):emptyGet;};var rmsPrefix=/^-ms-/,rdashAlpha=/-([a-z])/g;function fcamelCase(_all,letter){return letter.toUpperCase();}
function camelCase(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase);}
var acceptData=function(owner){return owner.nodeType===1||owner.nodeType===9||!(+owner.nodeType);};function Data(){this.expando=jQuery.expando+Data.uid++;}
Data.uid=1;Data.prototype={cache:function(owner){var value=owner[this.expando];if(!value){value={};if(acceptData(owner)){if(owner.nodeType){owner[this.expando]=value;}else{Object.defineProperty(owner,this.expando,{value:value,configurable:true});}}}
return value;},set:function(owner,data,value){var prop,cache=this.cache(owner);if(typeof data==="string"){cache[camelCase(data)]=value;}else{for(prop in data){cache[camelCase(prop)]=data[prop];}}
return cache;},get:function(owner,key){return key===undefined?this.cache(owner):owner[this.expando]&&owner[this.expando][camelCase(key)];},access:function(owner,key,value){if(key===undefined||((key&&typeof key==="string")&&value===undefined)){return this.get(owner,key);}
this.set(owner,key,value);return value!==undefined?value:key;},remove:function(owner,key){var i,cache=owner[this.expando];if(cache===undefined){return;}
if(key!==undefined){if(Array.isArray(key)){key=key.map(camelCase);}else{key=camelCase(key);key=key in cache?[key]:(key.match(rnothtmlwhite)||[]);}
i=key.length;while(i--){delete cache[key[i]];}}
if(key===undefined||jQuery.isEmptyObject(cache)){if(owner.nodeType){owner[this.expando]=undefined;}else{delete owner[this.expando];}}},hasData:function(owner){var cache=owner[this.expando];return cache!==undefined&&!jQuery.isEmptyObject(cache);}};var dataPriv=new Data();var dataUser=new Data();var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/[A-Z]/g;function getData(data){if(data==="true"){return true;}
if(data==="false"){return false;}
if(data==="null"){return null;}
if(data===+data+""){return+data;}
if(rbrace.test(data)){return JSON.parse(data);}
return data;}
function dataAttr(elem,key,data){var name;if(data===undefined&&elem.nodeType===1){name="data-"+key.replace(rmultiDash,"-$&").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=getData(data);}catch(e){}
dataUser.set(elem,key,data);}else{data=undefined;}}
return data;}
jQuery.extend({hasData:function(elem){return dataUser.hasData(elem)||dataPriv.hasData(elem);},data:function(elem,name,data){return dataUser.access(elem,name,data);},removeData:function(elem,name){dataUser.remove(elem,name);},_data:function(elem,name,data){return dataPriv.access(elem,name,data);},_removeData:function(elem,name){dataPriv.remove(elem,name);}});jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(key===undefined){if(this.length){data=dataUser.get(elem);if(elem.nodeType===1&&!dataPriv.get(elem,"hasDataAttrs")){i=attrs.length;while(i--){if(attrs[i]){name=attrs[i].name;if(name.indexOf("data-")===0){name=camelCase(name.slice(5));dataAttr(elem,name,data[name]);}}}
dataPriv.set(elem,"hasDataAttrs",true);}}
return data;}
if(typeof key==="object"){return this.each(function(){dataUser.set(this,key);});}
return access(this,function(value){var data;if(elem&&value===undefined){data=dataUser.get(elem,key);if(data!==undefined){return data;}
data=dataAttr(elem,key);if(data!==undefined){return data;}
return;}
this.each(function(){dataUser.set(this,key,value);});},null,value,arguments.length>1,null,true);},removeData:function(key){return this.each(function(){dataUser.remove(this,key);});}});jQuery.extend({queue:function(elem,type,data){var queue;if(elem){type=(type||"fx")+"queue";queue=dataPriv.get(elem,type);if(data){if(!queue||Array.isArray(data)){queue=dataPriv.access(elem,type,jQuery.makeArray(data));}else{queue.push(data);}}
return queue||[];}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type);};if(fn==="inprogress"){fn=queue.shift();startLength--;}
if(fn){if(type==="fx"){queue.unshift("inprogress");}
delete hooks.stop;fn.call(elem,next,hooks);}
if(!startLength&&hooks){hooks.empty.fire();}},_queueHooks:function(elem,type){var key=type+"queueHooks";return dataPriv.get(elem,key)||dataPriv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){dataPriv.remove(elem,[type+"queue",key]);})});}});jQuery.fn.extend({queue:function(type,data){var setter=2;if(typeof type!=="string"){data=type;type="fx";setter--;}
if(arguments.length<setter){return jQuery.queue(this[0],type);}
return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type);}});},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type);});},clearQueue:function(type){return this.queue(type||"fx",[]);},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){if(!(--count)){defer.resolveWith(elements,[elements]);}};if(typeof type!=="string"){obj=type;type=undefined;}
type=type||"fx";while(i--){tmp=dataPriv.get(elements[i],type+"queueHooks");if(tmp&&tmp.empty){count++;tmp.empty.add(resolve);}}
resolve();return defer.promise(obj);}});var pnum=(/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/).source;var rcssNum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i");var cssExpand=["Top","Right","Bottom","Left"];var documentElement=document.documentElement;var isAttached=function(elem){return jQuery.contains(elem.ownerDocument,elem);},composed={composed:true};if(documentElement.getRootNode){isAttached=function(elem){return jQuery.contains(elem.ownerDocument,elem)||elem.getRootNode(composed)===elem.ownerDocument;};}
var isHiddenWithinTree=function(elem,el){elem=el||elem;return elem.style.display==="none"||elem.style.display===""&&isAttached(elem)&&jQuery.css(elem,"display")==="none";};function adjustCSS(elem,prop,valueParts,tween){var adjusted,scale,maxIterations=20,currentValue=tween?function(){return tween.cur();}:function(){return jQuery.css(elem,prop,"");},initial=currentValue(),unit=valueParts&&valueParts[3]||(jQuery.cssNumber[prop]?"":"px"),initialInUnit=elem.nodeType&&(jQuery.cssNumber[prop]||unit!=="px"&&+initial)&&rcssNum.exec(jQuery.css(elem,prop));if(initialInUnit&&initialInUnit[3]!==unit){initial=initial/2;unit=unit||initialInUnit[3];initialInUnit=+initial||1;while(maxIterations--){jQuery.style(elem,prop,initialInUnit+unit);if((1-scale)*(1-(scale=currentValue()/initial||0.5))<=0){maxIterations=0;}
initialInUnit=initialInUnit/scale;}
initialInUnit=initialInUnit*2;jQuery.style(elem,prop,initialInUnit+unit);valueParts=valueParts||[];}
if(valueParts){initialInUnit=+initialInUnit||+initial||0;adjusted=valueParts[1]?initialInUnit+(valueParts[1]+1)*valueParts[2]:+valueParts[2];if(tween){tween.unit=unit;tween.start=initialInUnit;tween.end=adjusted;}}
return adjusted;}
var defaultDisplayMap={};function getDefaultDisplay(elem){var temp,doc=elem.ownerDocument,nodeName=elem.nodeName,display=defaultDisplayMap[nodeName];if(display){return display;}
temp=doc.body.appendChild(doc.createElement(nodeName));display=jQuery.css(temp,"display");temp.parentNode.removeChild(temp);if(display==="none"){display="block";}
defaultDisplayMap[nodeName]=display;return display;}
function showHide(elements,show){var display,elem,values=[],index=0,length=elements.length;for(;index<length;index++){elem=elements[index];if(!elem.style){continue;}
display=elem.style.display;if(show){if(display==="none"){values[index]=dataPriv.get(elem,"display")||null;if(!values[index]){elem.style.display="";}}
if(elem.style.display===""&&isHiddenWithinTree(elem)){values[index]=getDefaultDisplay(elem);}}else{if(display!=="none"){values[index]="none";dataPriv.set(elem,"display",display);}}}
for(index=0;index<length;index++){if(values[index]!=null){elements[index].style.display=values[index];}}
return elements;}
jQuery.fn.extend({show:function(){return showHide(this,true);},hide:function(){return showHide(this);},toggle:function(state){if(typeof state==="boolean"){return state?this.show():this.hide();}
return this.each(function(){if(isHiddenWithinTree(this)){jQuery(this).show();}else{jQuery(this).hide();}});}});var rcheckableType=(/^(?:checkbox|radio)$/i);var rtagName=(/<([a-z][^\/\0>\x20\t\r\n\f]*)/i);var rscriptType=(/^$|^module$|\/(?:java|ecma)script/i);(function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio");input.setAttribute("checked","checked");input.setAttribute("name","t");div.appendChild(input);support.checkClone=div.cloneNode(true).cloneNode(true).lastChild.checked;div.innerHTML="<textarea>x</textarea>";support.noCloneChecked=!!div.cloneNode(true).lastChild.defaultValue;div.innerHTML="<option></option>";support.option=!!div.lastChild;})();var wrapMap={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;if(!support.option){wrapMap.optgroup=wrapMap.option=[1,"<select multiple='multiple'>","</select>"];}
function getAll(context,tag){var ret;if(typeof context.getElementsByTagName!=="undefined"){ret=context.getElementsByTagName(tag||"*");}else if(typeof context.querySelectorAll!=="undefined"){ret=context.querySelectorAll(tag||"*");}else{ret=[];}
if(tag===undefined||tag&&nodeName(context,tag)){return jQuery.merge([context],ret);}
return ret;}
function setGlobalEval(elems,refElements){var i=0,l=elems.length;for(;i<l;i++){dataPriv.set(elems[i],"globalEval",!refElements||dataPriv.get(refElements[i],"globalEval"));}}
var rhtml=/<|&#?\w+;/;function buildFragment(elems,context,scripts,selection,ignored){var elem,tmp,tag,wrap,attached,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;for(;i<l;i++){elem=elems[i];if(elem||elem===0){if(toType(elem)==="object"){jQuery.merge(nodes,elem.nodeType?[elem]:elem);}else if(!rhtml.test(elem)){nodes.push(context.createTextNode(elem));}else{tmp=tmp||fragment.appendChild(context.createElement("div"));tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();wrap=wrapMap[tag]||wrapMap._default;tmp.innerHTML=wrap[1]+jQuery.htmlPrefilter(elem)+wrap[2];j=wrap[0];while(j--){tmp=tmp.lastChild;}
jQuery.merge(nodes,tmp.childNodes);tmp=fragment.firstChild;tmp.textContent="";}}}
fragment.textContent="";i=0;while((elem=nodes[i++])){if(selection&&jQuery.inArray(elem,selection)>-1){if(ignored){ignored.push(elem);}
continue;}
attached=isAttached(elem);tmp=getAll(fragment.appendChild(elem),"script");if(attached){setGlobalEval(tmp);}
if(scripts){j=0;while((elem=tmp[j++])){if(rscriptType.test(elem.type||"")){scripts.push(elem);}}}}
return fragment;}
var
rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,rtypenamespace=/^([^.]*)(?:\.(.+)|)/;function returnTrue(){return true;}
function returnFalse(){return false;}
function expectSync(elem,type){return(elem===safeActiveElement())===(type==="focus");}
function safeActiveElement(){try{return document.activeElement;}catch(err){}}
function on(elem,types,selector,data,fn,one){var origFn,type;if(typeof types==="object"){if(typeof selector!=="string"){data=data||selector;selector=undefined;}
for(type in types){on(elem,type,selector,data,types[type],one);}
return elem;}
if(data==null&&fn==null){fn=selector;data=selector=undefined;}else if(fn==null){if(typeof selector==="string"){fn=data;data=undefined;}else{fn=data;data=selector;selector=undefined;}}
if(fn===false){fn=returnFalse;}else if(!fn){return elem;}
if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments);};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++);}
return elem.each(function(){jQuery.event.add(this,types,fn,data,selector);});}
jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.get(elem);if(!acceptData(elem)){return;}
if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector;}
if(selector){jQuery.find.matchesSelector(documentElement,selector);}
if(!handler.guid){handler.guid=jQuery.guid++;}
if(!(events=elemData.events)){events=elemData.events=Object.create(null);}
if(!(eventHandle=elemData.handle)){eventHandle=elemData.handle=function(e){return typeof jQuery!=="undefined"&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):undefined;};}
types=(types||"").match(rnothtmlwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){continue;}
special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn);if(!(handlers=events[type])){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle);}}}
if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid;}}
if(selector){handlers.splice(handlers.delegateCount++,0,handleObj);}else{handlers.push(handleObj);}
jQuery.event.global[type]=true;}},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.hasData(elem)&&dataPriv.get(elem);if(!elemData||!(events=elemData.events)){return;}
types=(types||"").match(rnothtmlwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,true);}
continue;}
special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;handlers=events[type]||[];tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");origCount=j=handlers.length;while(j--){handleObj=handlers[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){handlers.splice(j,1);if(handleObj.selector){handlers.delegateCount--;}
if(special.remove){special.remove.call(elem,handleObj);}}}
if(origCount&&!handlers.length){if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false){jQuery.removeEvent(elem,type,elemData.handle);}
delete events[type];}}
if(jQuery.isEmptyObject(events)){dataPriv.remove(elem,"handle events");}},dispatch:function(nativeEvent){var i,j,ret,matched,handleObj,handlerQueue,args=new Array(arguments.length),event=jQuery.event.fix(nativeEvent),handlers=(dataPriv.get(this,"events")||Object.create(null))[event.type]||[],special=jQuery.event.special[event.type]||{};args[0]=event;for(i=1;i<arguments.length;i++){args[i]=arguments[i];}
event.delegateTarget=this;if(special.preDispatch&&special.preDispatch.call(this,event)===false){return;}
handlerQueue=jQuery.event.handlers.call(this,event,handlers);i=0;while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){event.currentTarget=matched.elem;j=0;while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped()){if(!event.rnamespace||handleObj.namespace===false||event.rnamespace.test(handleObj.namespace)){event.handleObj=handleObj;event.data=handleObj.data;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined){if((event.result=ret)===false){event.preventDefault();event.stopPropagation();}}}}}
if(special.postDispatch){special.postDispatch.call(this,event);}
return event.result;},handlers:function(event,handlers){var i,handleObj,sel,matchedHandlers,matchedSelectors,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&!(event.type==="click"&&event.button>=1)){for(;cur!==this;cur=cur.parentNode||this){if(cur.nodeType===1&&!(event.type==="click"&&cur.disabled===true)){matchedHandlers=[];matchedSelectors={};for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector+" ";if(matchedSelectors[sel]===undefined){matchedSelectors[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>-1:jQuery.find(sel,this,null,[cur]).length;}
if(matchedSelectors[sel]){matchedHandlers.push(handleObj);}}
if(matchedHandlers.length){handlerQueue.push({elem:cur,handlers:matchedHandlers});}}}}
cur=this;if(delegateCount<handlers.length){handlerQueue.push({elem:cur,handlers:handlers.slice(delegateCount)});}
return handlerQueue;},addProp:function(name,hook){Object.defineProperty(jQuery.Event.prototype,name,{enumerable:true,configurable:true,get:isFunction(hook)?function(){if(this.originalEvent){return hook(this.originalEvent);}}:function(){if(this.originalEvent){return this.originalEvent[name];}},set:function(value){Object.defineProperty(this,name,{enumerable:true,configurable:true,writable:true,value:value});}});},fix:function(originalEvent){return originalEvent[jQuery.expando]?originalEvent:new jQuery.Event(originalEvent);},special:{load:{noBubble:true},click:{setup:function(data){var el=this||data;if(rcheckableType.test(el.type)&&el.click&&nodeName(el,"input")){leverageNative(el,"click",returnTrue);}
return false;},trigger:function(data){var el=this||data;if(rcheckableType.test(el.type)&&el.click&&nodeName(el,"input")){leverageNative(el,"click");}
return true;},_default:function(event){var target=event.target;return rcheckableType.test(target.type)&&target.click&&nodeName(target,"input")&&dataPriv.get(target,"click")||nodeName(target,"a");}},beforeunload:{postDispatch:function(event){if(event.result!==undefined&&event.originalEvent){event.originalEvent.returnValue=event.result;}}}}};function leverageNative(el,type,expectSync){if(!expectSync){if(dataPriv.get(el,type)===undefined){jQuery.event.add(el,type,returnTrue);}
return;}
dataPriv.set(el,type,false);jQuery.event.add(el,type,{namespace:false,handler:function(event){var notAsync,result,saved=dataPriv.get(this,type);if((event.isTrigger&1)&&this[type]){if(!saved.length){saved=slice.call(arguments);dataPriv.set(this,type,saved);notAsync=expectSync(this,type);this[type]();result=dataPriv.get(this,type);if(saved!==result||notAsync){dataPriv.set(this,type,false);}else{result={};}
if(saved!==result){event.stopImmediatePropagation();event.preventDefault();return result.value;}}else if((jQuery.event.special[type]||{}).delegateType){event.stopPropagation();}}else if(saved.length){dataPriv.set(this,type,{value:jQuery.event.trigger(jQuery.extend(saved[0],jQuery.Event.prototype),saved.slice(1),this)});event.stopImmediatePropagation();}}});}
jQuery.removeEvent=function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle);}};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props);}
if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=src.defaultPrevented||src.defaultPrevented===undefined&&src.returnValue===false?returnTrue:returnFalse;this.target=(src.target&&src.target.nodeType===3)?src.target.parentNode:src.target;this.currentTarget=src.currentTarget;this.relatedTarget=src.relatedTarget;}else{this.type=src;}
if(props){jQuery.extend(this,props);}
this.timeStamp=src&&src.timeStamp||Date.now();this[jQuery.expando]=true;};jQuery.Event.prototype={constructor:jQuery.Event,isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,isSimulated:false,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue;if(e&&!this.isSimulated){e.preventDefault();}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue;if(e&&!this.isSimulated){e.stopPropagation();}},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue;if(e&&!this.isSimulated){e.stopImmediatePropagation();}
this.stopPropagation();}};jQuery.each({altKey:true,bubbles:true,cancelable:true,changedTouches:true,ctrlKey:true,detail:true,eventPhase:true,metaKey:true,pageX:true,pageY:true,shiftKey:true,view:true,"char":true,code:true,charCode:true,key:true,keyCode:true,button:true,buttons:true,clientX:true,clientY:true,offsetX:true,offsetY:true,pointerId:true,pointerType:true,screenX:true,screenY:true,targetTouches:true,toElement:true,touches:true,which:function(event){var button=event.button;if(event.which==null&&rkeyEvent.test(event.type)){return event.charCode!=null?event.charCode:event.keyCode;}
if(!event.which&&button!==undefined&&rmouseEvent.test(event.type)){if(button&1){return 1;}
if(button&2){return 3;}
if(button&4){return 2;}
return 0;}
return event.which;}},jQuery.event.addProp);jQuery.each({focus:"focusin",blur:"focusout"},function(type,delegateType){jQuery.event.special[type]={setup:function(){leverageNative(this,type,expectSync);return false;},trigger:function(){leverageNative(this,type);return true;},delegateType:delegateType};});jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;if(!related||(related!==target&&!jQuery.contains(target,related))){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix;}
return ret;}};});jQuery.fn.extend({on:function(types,selector,data,fn){return on(this,types,selector,data,fn);},one:function(types,selector,data,fn){return on(this,types,selector,data,fn,1);},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this;}
if(typeof types==="object"){for(type in types){this.off(type,selector,types[type]);}
return this;}
if(selector===false||typeof selector==="function"){fn=selector;selector=undefined;}
if(fn===false){fn=returnFalse;}
return this.each(function(){jQuery.event.remove(this,types,fn,selector);});}});var
rnoInnerhtml=/<script|<style|<link/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function manipulationTarget(elem,content){if(nodeName(elem,"table")&&nodeName(content.nodeType!==11?content:content.firstChild,"tr")){return jQuery(elem).children("tbody")[0]||elem;}
return elem;}
function disableScript(elem){elem.type=(elem.getAttribute("type")!==null)+"/"+elem.type;return elem;}
function restoreScript(elem){if((elem.type||"").slice(0,5)==="true/"){elem.type=elem.type.slice(5);}else{elem.removeAttribute("type");}
return elem;}
function cloneCopyEvent(src,dest){var i,l,type,pdataOld,udataOld,udataCur,events;if(dest.nodeType!==1){return;}
if(dataPriv.hasData(src)){pdataOld=dataPriv.get(src);events=pdataOld.events;if(events){dataPriv.remove(dest,"handle events");for(type in events){for(i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type,events[type][i]);}}}}
if(dataUser.hasData(src)){udataOld=dataUser.access(src);udataCur=jQuery.extend({},udataOld);dataUser.set(dest,udataCur);}}
function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();if(nodeName==="input"&&rcheckableType.test(src.type)){dest.checked=src.checked;}else if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue;}}
function domManip(collection,args,callback,ignored){args=flat(args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=collection.length,iNoClone=l-1,value=args[0],valueIsFunction=isFunction(value);if(valueIsFunction||(l>1&&typeof value==="string"&&!support.checkClone&&rchecked.test(value))){return collection.each(function(index){var self=collection.eq(index);if(valueIsFunction){args[0]=value.call(this,index,self.html());}
domManip(self,args,callback,ignored);});}
if(l){fragment=buildFragment(args,collection[0].ownerDocument,false,collection,ignored);first=fragment.firstChild;if(fragment.childNodes.length===1){fragment=first;}
if(first||ignored){scripts=jQuery.map(getAll(fragment,"script"),disableScript);hasScripts=scripts.length;for(;i<l;i++){node=fragment;if(i!==iNoClone){node=jQuery.clone(node,true,true);if(hasScripts){jQuery.merge(scripts,getAll(node,"script"));}}
callback.call(collection[i],node,i);}
if(hasScripts){doc=scripts[scripts.length-1].ownerDocument;jQuery.map(scripts,restoreScript);for(i=0;i<hasScripts;i++){node=scripts[i];if(rscriptType.test(node.type||"")&&!dataPriv.access(node,"globalEval")&&jQuery.contains(doc,node)){if(node.src&&(node.type||"").toLowerCase()!=="module"){if(jQuery._evalUrl&&!node.noModule){jQuery._evalUrl(node.src,{nonce:node.nonce||node.getAttribute("nonce")},doc);}}else{DOMEval(node.textContent.replace(rcleanScript,""),node,doc);}}}}}}
return collection;}
function remove(elem,selector,keepData){var node,nodes=selector?jQuery.filter(selector,elem):elem,i=0;for(;(node=nodes[i])!=null;i++){if(!keepData&&node.nodeType===1){jQuery.cleanData(getAll(node));}
if(node.parentNode){if(keepData&&isAttached(node)){setGlobalEval(getAll(node,"script"));}
node.parentNode.removeChild(node);}}
return elem;}
jQuery.extend({htmlPrefilter:function(html){return html;},clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(true),inPage=isAttached(elem);if(!support.noCloneChecked&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){destElements=getAll(clone);srcElements=getAll(elem);for(i=0,l=srcElements.length;i<l;i++){fixInput(srcElements[i],destElements[i]);}}
if(dataAndEvents){if(deepDataAndEvents){srcElements=srcElements||getAll(elem);destElements=destElements||getAll(clone);for(i=0,l=srcElements.length;i<l;i++){cloneCopyEvent(srcElements[i],destElements[i]);}}else{cloneCopyEvent(elem,clone);}}
destElements=getAll(clone,"script");if(destElements.length>0){setGlobalEval(destElements,!inPage&&getAll(elem,"script"));}
return clone;},cleanData:function(elems){var data,elem,type,special=jQuery.event.special,i=0;for(;(elem=elems[i])!==undefined;i++){if(acceptData(elem)){if((data=elem[dataPriv.expando])){if(data.events){for(type in data.events){if(special[type]){jQuery.event.remove(elem,type);}else{jQuery.removeEvent(elem,type,data.handle);}}}
elem[dataPriv.expando]=undefined;}
if(elem[dataUser.expando]){elem[dataUser.expando]=undefined;}}}}});jQuery.fn.extend({detach:function(selector){return remove(this,selector,true);},remove:function(selector){return remove(this,selector);},text:function(value){return access(this,function(value){return value===undefined?jQuery.text(this):this.empty().each(function(){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){this.textContent=value;}});},null,value,arguments.length);},append:function(){return domManip(this,arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.appendChild(elem);}});},prepend:function(){return domManip(this,arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild);}});},before:function(){return domManip(this,arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this);}});},after:function(){return domManip(this,arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this.nextSibling);}});},empty:function(){var elem,i=0;for(;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.textContent="";}}
return this;},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents);});},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined&&elem.nodeType===1){return elem.innerHTML;}
if(typeof value==="string"&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=jQuery.htmlPrefilter(value);try{for(;i<l;i++){elem=this[i]||{};if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.innerHTML=value;}}
elem=0;}catch(e){}}
if(elem){this.empty().append(value);}},null,value,arguments.length);},replaceWith:function(){var ignored=[];return domManip(this,arguments,function(elem){var parent=this.parentNode;if(jQuery.inArray(this,ignored)<0){jQuery.cleanData(getAll(this));if(parent){parent.replaceChild(elem,this);}}},ignored);}});jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;for(;i<=last;i++){elems=i===last?this:this.clone(true);jQuery(insert[i])[original](elems);push.apply(ret,elems.get());}
return this.pushStack(ret);};});var rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i");var getStyles=function(elem){var view=elem.ownerDocument.defaultView;if(!view||!view.opener){view=window;}
return view.getComputedStyle(elem);};var swap=function(elem,options,callback){var ret,name,old={};for(name in options){old[name]=elem.style[name];elem.style[name]=options[name];}
ret=callback.call(elem);for(name in options){elem.style[name]=old[name];}
return ret;};var rboxStyle=new RegExp(cssExpand.join("|"),"i");(function(){function computeStyleTests(){if(!div){return;}
container.style.cssText="position:absolute;left:-11111px;width:60px;"+"margin-top:1px;padding:0;border:0";div.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;"+"margin:auto;border:1px;padding:1px;"+"width:60%;top:1%";documentElement.appendChild(container).appendChild(div);var divStyle=window.getComputedStyle(div);pixelPositionVal=divStyle.top!=="1%";reliableMarginLeftVal=roundPixelMeasures(divStyle.marginLeft)===12;div.style.right="60%";pixelBoxStylesVal=roundPixelMeasures(divStyle.right)===36;boxSizingReliableVal=roundPixelMeasures(divStyle.width)===36;div.style.position="absolute";scrollboxSizeVal=roundPixelMeasures(div.offsetWidth/3)===12;documentElement.removeChild(container);div=null;}
function roundPixelMeasures(measure){return Math.round(parseFloat(measure));}
var pixelPositionVal,boxSizingReliableVal,scrollboxSizeVal,pixelBoxStylesVal,reliableTrDimensionsVal,reliableMarginLeftVal,container=document.createElement("div"),div=document.createElement("div");if(!div.style){return;}
div.style.backgroundClip="content-box";div.cloneNode(true).style.backgroundClip="";support.clearCloneStyle=div.style.backgroundClip==="content-box";jQuery.extend(support,{boxSizingReliable:function(){computeStyleTests();return boxSizingReliableVal;},pixelBoxStyles:function(){computeStyleTests();return pixelBoxStylesVal;},pixelPosition:function(){computeStyleTests();return pixelPositionVal;},reliableMarginLeft:function(){computeStyleTests();return reliableMarginLeftVal;},scrollboxSize:function(){computeStyleTests();return scrollboxSizeVal;},reliableTrDimensions:function(){var table,tr,trChild,trStyle;if(reliableTrDimensionsVal==null){table=document.createElement("table");tr=document.createElement("tr");trChild=document.createElement("div");table.style.cssText="position:absolute;left:-11111px";tr.style.height="1px";trChild.style.height="9px";documentElement.appendChild(table).appendChild(tr).appendChild(trChild);trStyle=window.getComputedStyle(tr);reliableTrDimensionsVal=parseInt(trStyle.height)>3;documentElement.removeChild(table);}
return reliableTrDimensionsVal;}});})();function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;computed=computed||getStyles(elem);if(computed){ret=computed.getPropertyValue(name)||computed[name];if(ret===""&&!isAttached(elem)){ret=jQuery.style(elem,name);}
if(!support.pixelBoxStyles()&&rnumnonpx.test(ret)&&rboxStyle.test(name)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=ret;ret=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth;}}
return ret!==undefined?ret+"":ret;}
function addGetHookIf(conditionFn,hookFn){return{get:function(){if(conditionFn()){delete this.get;return;}
return(this.get=hookFn).apply(this,arguments);}};}
var cssPrefixes=["Webkit","Moz","ms"],emptyStyle=document.createElement("div").style,vendorProps={};function vendorPropName(name){var capName=name[0].toUpperCase()+name.slice(1),i=cssPrefixes.length;while(i--){name=cssPrefixes[i]+capName;if(name in emptyStyle){return name;}}}
function finalPropName(name){var final=jQuery.cssProps[name]||vendorProps[name];if(final){return final;}
if(name in emptyStyle){return name;}
return vendorProps[name]=vendorPropName(name)||name;}
var
rdisplayswap=/^(none|table(?!-c[ea]).+)/,rcustomProp=/^--/,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"};function setPositiveNumber(_elem,value,subtract){var matches=rcssNum.exec(value);return matches?Math.max(0,matches[2]-(subtract||0))+(matches[3]||"px"):value;}
function boxModelAdjustment(elem,dimension,box,isBorderBox,styles,computedVal){var i=dimension==="width"?1:0,extra=0,delta=0;if(box===(isBorderBox?"border":"content")){return 0;}
for(;i<4;i+=2){if(box==="margin"){delta+=jQuery.css(elem,box+cssExpand[i],true,styles);}
if(!isBorderBox){delta+=jQuery.css(elem,"padding"+cssExpand[i],true,styles);if(box!=="padding"){delta+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles);}else{extra+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles);}}else{if(box==="content"){delta-=jQuery.css(elem,"padding"+cssExpand[i],true,styles);}
if(box!=="margin"){delta-=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles);}}}
if(!isBorderBox&&computedVal>=0){delta+=Math.max(0,Math.ceil(elem["offset"+dimension[0].toUpperCase()+dimension.slice(1)]-
computedVal-
delta-
extra-
0.5))||0;}
return delta;}
function getWidthOrHeight(elem,dimension,extra){var styles=getStyles(elem),boxSizingNeeded=!support.boxSizingReliable()||extra,isBorderBox=boxSizingNeeded&&jQuery.css(elem,"boxSizing",false,styles)==="border-box",valueIsBorderBox=isBorderBox,val=curCSS(elem,dimension,styles),offsetProp="offset"+dimension[0].toUpperCase()+dimension.slice(1);if(rnumnonpx.test(val)){if(!extra){return val;}
val="auto";}
if((!support.boxSizingReliable()&&isBorderBox||!support.reliableTrDimensions()&&nodeName(elem,"tr")||val==="auto"||!parseFloat(val)&&jQuery.css(elem,"display",false,styles)==="inline")&&elem.getClientRects().length){isBorderBox=jQuery.css(elem,"boxSizing",false,styles)==="border-box";valueIsBorderBox=offsetProp in elem;if(valueIsBorderBox){val=elem[offsetProp];}}
val=parseFloat(val)||0;return(val+
boxModelAdjustment(elem,dimension,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles,val))+"px";}
jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return ret===""?"1":ret;}}}},cssNumber:{"animationIterationCount":true,"columnCount":true,"fillOpacity":true,"flexGrow":true,"flexShrink":true,"fontWeight":true,"gridArea":true,"gridColumn":true,"gridColumnEnd":true,"gridColumnStart":true,"gridRow":true,"gridRowEnd":true,"gridRowStart":true,"lineHeight":true,"opacity":true,"order":true,"orphans":true,"widows":true,"zIndex":true,"zoom":true},cssProps:{},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return;}
var ret,type,hooks,origName=camelCase(name),isCustomProp=rcustomProp.test(name),style=elem.style;if(!isCustomProp){name=finalPropName(origName);}
hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rcssNum.exec(value))&&ret[1]){value=adjustCSS(elem,name,ret);type="number";}
if(value==null||value!==value){return;}
if(type==="number"&&!isCustomProp){value+=ret&&ret[3]||(jQuery.cssNumber[origName]?"":"px");}
if(!support.clearCloneStyle&&value===""&&name.indexOf("background")===0){style[name]="inherit";}
if(!hooks||!("set"in hooks)||(value=hooks.set(elem,value,extra))!==undefined){if(isCustomProp){style.setProperty(name,value);}else{style[name]=value;}}}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret;}
return style[name];}},css:function(elem,name,extra,styles){var val,num,hooks,origName=camelCase(name),isCustomProp=rcustomProp.test(name);if(!isCustomProp){name=finalPropName(origName);}
hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(hooks&&"get"in hooks){val=hooks.get(elem,true,extra);}
if(val===undefined){val=curCSS(elem,name,styles);}
if(val==="normal"&&name in cssNormalTransform){val=cssNormalTransform[name];}
if(extra===""||extra){num=parseFloat(val);return extra===true||isFinite(num)?num||0:val;}
return val;}});jQuery.each(["height","width"],function(_i,dimension){jQuery.cssHooks[dimension]={get:function(elem,computed,extra){if(computed){return rdisplayswap.test(jQuery.css(elem,"display"))&&(!elem.getClientRects().length||!elem.getBoundingClientRect().width)?swap(elem,cssShow,function(){return getWidthOrHeight(elem,dimension,extra);}):getWidthOrHeight(elem,dimension,extra);}},set:function(elem,value,extra){var matches,styles=getStyles(elem),scrollboxSizeBuggy=!support.scrollboxSize()&&styles.position==="absolute",boxSizingNeeded=scrollboxSizeBuggy||extra,isBorderBox=boxSizingNeeded&&jQuery.css(elem,"boxSizing",false,styles)==="border-box",subtract=extra?boxModelAdjustment(elem,dimension,extra,isBorderBox,styles):0;if(isBorderBox&&scrollboxSizeBuggy){subtract-=Math.ceil(elem["offset"+dimension[0].toUpperCase()+dimension.slice(1)]-
parseFloat(styles[dimension])-
boxModelAdjustment(elem,dimension,"border",false,styles)-
0.5);}
if(subtract&&(matches=rcssNum.exec(value))&&(matches[3]||"px")!=="px"){elem.style[dimension]=value;value=jQuery.css(elem,dimension);}
return setPositiveNumber(elem,value,subtract);}};});jQuery.cssHooks.marginLeft=addGetHookIf(support.reliableMarginLeft,function(elem,computed){if(computed){return(parseFloat(curCSS(elem,"marginLeft"))||elem.getBoundingClientRect().left-
swap(elem,{marginLeft:0},function(){return elem.getBoundingClientRect().left;}))+"px";}});jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){var i=0,expanded={},parts=typeof value==="string"?value.split(" "):[value];for(;i<4;i++){expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];}
return expanded;}};if(prefix!=="margin"){jQuery.cssHooks[prefix+suffix].set=setPositiveNumber;}});jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(Array.isArray(name)){styles=getStyles(elem);len=name.length;for(;i<len;i++){map[name[i]]=jQuery.css(elem,name[i],false,styles);}
return map;}
return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name);},name,value,arguments.length>1);}});function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing);}
jQuery.Tween=Tween;Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem;this.prop=prop;this.easing=easing||jQuery.easing._default;this.options=options;this.start=this.now=this.cur();this.end=end;this.unit=unit||(jQuery.cssNumber[prop]?"":"px");},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this);},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];if(this.options.duration){this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration);}else{this.pos=eased=percent;}
this.now=(this.end-this.start)*eased+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this);}
if(hooks&&hooks.set){hooks.set(this);}else{Tween.propHooks._default.set(this);}
return this;}};Tween.prototype.init.prototype=Tween.prototype;Tween.propHooks={_default:{get:function(tween){var result;if(tween.elem.nodeType!==1||tween.elem[tween.prop]!=null&&tween.elem.style[tween.prop]==null){return tween.elem[tween.prop];}
result=jQuery.css(tween.elem,tween.prop,"");return!result||result==="auto"?0:result;},set:function(tween){if(jQuery.fx.step[tween.prop]){jQuery.fx.step[tween.prop](tween);}else if(tween.elem.nodeType===1&&(jQuery.cssHooks[tween.prop]||tween.elem.style[finalPropName(tween.prop)]!=null)){jQuery.style(tween.elem,tween.prop,tween.now+tween.unit);}else{tween.elem[tween.prop]=tween.now;}}}};Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){if(tween.elem.nodeType&&tween.elem.parentNode){tween.elem[tween.prop]=tween.now;}}};jQuery.easing={linear:function(p){return p;},swing:function(p){return 0.5-Math.cos(p*Math.PI)/2;},_default:"swing"};jQuery.fx=Tween.prototype.init;jQuery.fx.step={};var
fxNow,inProgress,rfxtypes=/^(?:toggle|show|hide)$/,rrun=/queueHooks$/;function schedule(){if(inProgress){if(document.hidden===false&&window.requestAnimationFrame){window.requestAnimationFrame(schedule);}else{window.setTimeout(schedule,jQuery.fx.interval);}
jQuery.fx.tick();}}
function createFxNow(){window.setTimeout(function(){fxNow=undefined;});return(fxNow=Date.now());}
function genFx(type,includeWidth){var which,i=0,attrs={height:type};includeWidth=includeWidth?1:0;for(;i<4;i+=2-includeWidth){which=cssExpand[i];attrs["margin"+which]=attrs["padding"+which]=type;}
if(includeWidth){attrs.opacity=attrs.width=type;}
return attrs;}
function createTween(value,prop,animation){var tween,collection=(Animation.tweeners[prop]||[]).concat(Animation.tweeners["*"]),index=0,length=collection.length;for(;index<length;index++){if((tween=collection[index].call(animation,prop,value))){return tween;}}}
function defaultPrefilter(elem,props,opts){var prop,value,toggle,hooks,oldfire,propTween,restoreDisplay,display,isBox="width"in props||"height"in props,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHiddenWithinTree(elem),dataShow=dataPriv.get(elem,"fxshow");if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");if(hooks.unqueued==null){hooks.unqueued=0;oldfire=hooks.empty.fire;hooks.empty.fire=function(){if(!hooks.unqueued){oldfire();}};}
hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;if(!jQuery.queue(elem,"fx").length){hooks.empty.fire();}});});}
for(prop in props){value=props[prop];if(rfxtypes.test(value)){delete props[prop];toggle=toggle||value==="toggle";if(value===(hidden?"hide":"show")){if(value==="show"&&dataShow&&dataShow[prop]!==undefined){hidden=true;}else{continue;}}
orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop);}}
propTween=!jQuery.isEmptyObject(props);if(!propTween&&jQuery.isEmptyObject(orig)){return;}
if(isBox&&elem.nodeType===1){opts.overflow=[style.overflow,style.overflowX,style.overflowY];restoreDisplay=dataShow&&dataShow.display;if(restoreDisplay==null){restoreDisplay=dataPriv.get(elem,"display");}
display=jQuery.css(elem,"display");if(display==="none"){if(restoreDisplay){display=restoreDisplay;}else{showHide([elem],true);restoreDisplay=elem.style.display||restoreDisplay;display=jQuery.css(elem,"display");showHide([elem]);}}
if(display==="inline"||display==="inline-block"&&restoreDisplay!=null){if(jQuery.css(elem,"float")==="none"){if(!propTween){anim.done(function(){style.display=restoreDisplay;});if(restoreDisplay==null){display=style.display;restoreDisplay=display==="none"?"":display;}}
style.display="inline-block";}}}
if(opts.overflow){style.overflow="hidden";anim.always(function(){style.overflow=opts.overflow[0];style.overflowX=opts.overflow[1];style.overflowY=opts.overflow[2];});}
propTween=false;for(prop in orig){if(!propTween){if(dataShow){if("hidden"in dataShow){hidden=dataShow.hidden;}}else{dataShow=dataPriv.access(elem,"fxshow",{display:restoreDisplay});}
if(toggle){dataShow.hidden=!hidden;}
if(hidden){showHide([elem],true);}
anim.done(function(){if(!hidden){showHide([elem]);}
dataPriv.remove(elem,"fxshow");for(prop in orig){jQuery.style(elem,prop,orig[prop]);}});}
propTween=createTween(hidden?dataShow[prop]:0,prop,anim);if(!(prop in dataShow)){dataShow[prop]=propTween.start;if(hidden){propTween.end=propTween.start;propTween.start=0;}}}}
function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props){name=camelCase(index);easing=specialEasing[name];value=props[index];if(Array.isArray(value)){easing=value[1];value=props[index]=value[0];}
if(index!==name){props[name]=value;delete props[index];}
hooks=jQuery.cssHooks[name];if(hooks&&"expand"in hooks){value=hooks.expand(value);delete props[name];for(index in value){if(!(index in props)){props[index]=value[index];specialEasing[index]=easing;}}}else{specialEasing[name]=easing;}}}
function Animation(elem,properties,options){var result,stopped,index=0,length=Animation.prefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem;}),tick=function(){if(stopped){return false;}
var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;for(;index<length;index++){animation.tweens[index].run(percent);}
deferred.notifyWith(elem,[animation,percent,remaining]);if(percent<1&&length){return remaining;}
if(!length){deferred.notifyWith(elem,[animation,1,0]);}
deferred.resolveWith(elem,[animation]);return false;},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(true,{specialEasing:{},easing:jQuery.easing._default},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);animation.tweens.push(tween);return tween;},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped){return this;}
stopped=true;for(;index<length;index++){animation.tweens[index].run(1);}
if(gotoEnd){deferred.notifyWith(elem,[animation,1,0]);deferred.resolveWith(elem,[animation,gotoEnd]);}else{deferred.rejectWith(elem,[animation,gotoEnd]);}
return this;}}),props=animation.props;propFilter(props,animation.opts.specialEasing);for(;index<length;index++){result=Animation.prefilters[index].call(animation,elem,props,animation.opts);if(result){if(isFunction(result.stop)){jQuery._queueHooks(animation.elem,animation.opts.queue).stop=result.stop.bind(result);}
return result;}}
jQuery.map(props,createTween,animation);if(isFunction(animation.opts.start)){animation.opts.start.call(elem,animation);}
animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always);jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue}));return animation;}
jQuery.Animation=jQuery.extend(Animation,{tweeners:{"*":[function(prop,value){var tween=this.createTween(prop,value);adjustCSS(tween.elem,prop,rcssNum.exec(value),tween);return tween;}]},tweener:function(props,callback){if(isFunction(props)){callback=props;props=["*"];}else{props=props.match(rnothtmlwhite);}
var prop,index=0,length=props.length;for(;index<length;index++){prop=props[index];Animation.tweeners[prop]=Animation.tweeners[prop]||[];Animation.tweeners[prop].unshift(callback);}},prefilters:[defaultPrefilter],prefilter:function(callback,prepend){if(prepend){Animation.prefilters.unshift(callback);}else{Animation.prefilters.push(callback);}}});jQuery.speed=function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!isFunction(easing)&&easing};if(jQuery.fx.off){opt.duration=0;}else{if(typeof opt.duration!=="number"){if(opt.duration in jQuery.fx.speeds){opt.duration=jQuery.fx.speeds[opt.duration];}else{opt.duration=jQuery.fx.speeds._default;}}}
if(opt.queue==null||opt.queue===true){opt.queue="fx";}
opt.old=opt.complete;opt.complete=function(){if(isFunction(opt.old)){opt.old.call(this);}
if(opt.queue){jQuery.dequeue(this,opt.queue);}};return opt;};jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHiddenWithinTree).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback);},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);if(empty||dataPriv.get(this,"finish")){anim.stop(true);}};doAnimation.finish=doAnimation;return empty||optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation);},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd);};if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined;}
if(clearQueue){this.queue(type||"fx",[]);}
return this.each(function(){var dequeue=true,index=type!=null&&type+"queueHooks",timers=jQuery.timers,data=dataPriv.get(this);if(index){if(data[index]&&data[index].stop){stopQueue(data[index]);}}else{for(index in data){if(data[index]&&data[index].stop&&rrun.test(index)){stopQueue(data[index]);}}}
for(index=timers.length;index--;){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);dequeue=false;timers.splice(index,1);}}
if(dequeue||!gotoEnd){jQuery.dequeue(this,type);}});},finish:function(type){if(type!==false){type=type||"fx";}
return this.each(function(){var index,data=dataPriv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;data.finish=true;jQuery.queue(this,type,[]);if(hooks&&hooks.stop){hooks.stop.call(this,true);}
for(index=timers.length;index--;){if(timers[index].elem===this&&timers[index].queue===type){timers[index].anim.stop(true);timers.splice(index,1);}}
for(index=0;index<length;index++){if(queue[index]&&queue[index].finish){queue[index].finish.call(this);}}
delete data.finish;});}});jQuery.each(["toggle","show","hide"],function(_i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==="boolean"?cssFn.apply(this,arguments):this.animate(genFx(name,true),speed,easing,callback);};});jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback);};});jQuery.timers=[];jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;fxNow=Date.now();for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer){timers.splice(i--,1);}}
if(!timers.length){jQuery.fx.stop();}
fxNow=undefined;};jQuery.fx.timer=function(timer){jQuery.timers.push(timer);jQuery.fx.start();};jQuery.fx.interval=13;jQuery.fx.start=function(){if(inProgress){return;}
inProgress=true;schedule();};jQuery.fx.stop=function(){inProgress=null;};jQuery.fx.speeds={slow:600,fast:200,_default:400};jQuery.fn.delay=function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=window.setTimeout(next,time);hooks.stop=function(){window.clearTimeout(timeout);};});};(function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox";support.checkOn=input.value!=="";support.optSelected=opt.selected;input=document.createElement("input");input.value="t";input.type="radio";support.radioValue=input.value==="t";})();var boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1);},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name);});}});jQuery.extend({attr:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(nType===3||nType===8||nType===2){return;}
if(typeof elem.getAttribute==="undefined"){return jQuery.prop(elem,name,value);}
if(nType!==1||!jQuery.isXMLDoc(elem)){hooks=jQuery.attrHooks[name.toLowerCase()]||(jQuery.expr.match.bool.test(name)?boolHook:undefined);}
if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name);return;}
if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret;}
elem.setAttribute(name,value+"");return value;}
if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){return ret;}
ret=jQuery.find.attr(elem,name);return ret==null?undefined:ret;},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&value==="radio"&&nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val;}
return value;}}}},removeAttr:function(elem,value){var name,i=0,attrNames=value&&value.match(rnothtmlwhite);if(attrNames&&elem.nodeType===1){while((name=attrNames[i++])){elem.removeAttribute(name);}}}});boolHook={set:function(elem,value,name){if(value===false){jQuery.removeAttr(elem,name);}else{elem.setAttribute(name,name);}
return name;}};jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(_i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle,lowercaseName=name.toLowerCase();if(!isXML){handle=attrHandle[lowercaseName];attrHandle[lowercaseName]=ret;ret=getter(elem,name,isXML)!=null?lowercaseName:null;attrHandle[lowercaseName]=handle;}
return ret;};});var rfocusable=/^(?:input|select|textarea|button)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1);},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name];});}});jQuery.extend({prop:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(nType===3||nType===8||nType===2){return;}
if(nType!==1||!jQuery.isXMLDoc(elem)){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name];}
if(value!==undefined){if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret;}
return(elem[name]=value);}
if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){return ret;}
return elem[name];},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");if(tabindex){return parseInt(tabindex,10);}
if(rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href){return 0;}
return-1;}}},propFix:{"for":"htmlFor","class":"className"}});if(!support.optSelected){jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;if(parent&&parent.parentNode){parent.parentNode.selectedIndex;}
return null;},set:function(elem){var parent=elem.parentNode;if(parent){parent.selectedIndex;if(parent.parentNode){parent.parentNode.selectedIndex;}}}};}
jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this;});function stripAndCollapse(value){var tokens=value.match(rnothtmlwhite)||[];return tokens.join(" ");}
function getClass(elem){return elem.getAttribute&&elem.getAttribute("class")||"";}
function classesToArray(value){if(Array.isArray(value)){return value;}
if(typeof value==="string"){return value.match(rnothtmlwhite)||[];}
return[];}
jQuery.fn.extend({addClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,getClass(this)));});}
classes=classesToArray(value);if(classes.length){while((elem=this[i++])){curValue=getClass(elem);cur=elem.nodeType===1&&(" "+stripAndCollapse(curValue)+" ");if(cur){j=0;while((clazz=classes[j++])){if(cur.indexOf(" "+clazz+" ")<0){cur+=clazz+" ";}}
finalValue=stripAndCollapse(cur);if(curValue!==finalValue){elem.setAttribute("class",finalValue);}}}}
return this;},removeClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,getClass(this)));});}
if(!arguments.length){return this.attr("class","");}
classes=classesToArray(value);if(classes.length){while((elem=this[i++])){curValue=getClass(elem);cur=elem.nodeType===1&&(" "+stripAndCollapse(curValue)+" ");if(cur){j=0;while((clazz=classes[j++])){while(cur.indexOf(" "+clazz+" ")>-1){cur=cur.replace(" "+clazz+" "," ");}}
finalValue=stripAndCollapse(cur);if(curValue!==finalValue){elem.setAttribute("class",finalValue);}}}}
return this;},toggleClass:function(value,stateVal){var type=typeof value,isValidValue=type==="string"||Array.isArray(value);if(typeof stateVal==="boolean"&&isValidValue){return stateVal?this.addClass(value):this.removeClass(value);}
if(isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,getClass(this),stateVal),stateVal);});}
return this.each(function(){var className,i,self,classNames;if(isValidValue){i=0;self=jQuery(this);classNames=classesToArray(value);while((className=classNames[i++])){if(self.hasClass(className)){self.removeClass(className);}else{self.addClass(className);}}}else if(value===undefined||type==="boolean"){className=getClass(this);if(className){dataPriv.set(this,"__className__",className);}
if(this.setAttribute){this.setAttribute("class",className||value===false?"":dataPriv.get(this,"__className__")||"");}}});},hasClass:function(selector){var className,elem,i=0;className=" "+selector+" ";while((elem=this[i++])){if(elem.nodeType===1&&(" "+stripAndCollapse(getClass(elem))+" ").indexOf(className)>-1){return true;}}
return false;}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,valueIsFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret;}
ret=elem.value;if(typeof ret==="string"){return ret.replace(rreturn,"");}
return ret==null?"":ret;}
return;}
valueIsFunction=isFunction(value);return this.each(function(i){var val;if(this.nodeType!==1){return;}
if(valueIsFunction){val=value.call(this,i,jQuery(this).val());}else{val=value;}
if(val==null){val="";}else if(typeof val==="number"){val+="";}else if(Array.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+"";});}
hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks||!("set"in hooks)||hooks.set(this,val,"value")===undefined){this.value=val;}});}});jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return val!=null?val:stripAndCollapse(jQuery.text(elem));}},select:{get:function(elem){var value,option,i,options=elem.options,index=elem.selectedIndex,one=elem.type==="select-one",values=one?null:[],max=one?index+1:options.length;if(index<0){i=max;}else{i=one?index:0;}
for(;i<max;i++){option=options[i];if((option.selected||i===index)&&!option.disabled&&(!option.parentNode.disabled||!nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value;}
values.push(value);}}
return values;},set:function(elem,value){var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;while(i--){option=options[i];if(option.selected=jQuery.inArray(jQuery.valHooks.option.get(option),values)>-1){optionSet=true;}}
if(!optionSet){elem.selectedIndex=-1;}
return values;}}}});jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(Array.isArray(value)){return(elem.checked=jQuery.inArray(jQuery(elem).val(),value)>-1);}}};if(!support.checkOn){jQuery.valHooks[this].get=function(elem){return elem.getAttribute("value")===null?"on":elem.value;};}});support.focusin="onfocusin"in window;var rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,stopPropagationCallback=function(e){e.stopPropagation();};jQuery.extend(jQuery.event,{trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,lastElement,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];cur=lastElement=tmp=elem=elem||document;if(elem.nodeType===3||elem.nodeType===8){return;}
if(rfocusMorph.test(type+jQuery.event.triggered)){return;}
if(type.indexOf(".")>-1){namespaces=type.split(".");type=namespaces.shift();namespaces.sort();}
ontype=type.indexOf(":")<0&&"on"+type;event=event[jQuery.expando]?event:new jQuery.Event(type,typeof event==="object"&&event);event.isTrigger=onlyHandlers?2:3;event.namespace=namespaces.join(".");event.rnamespace=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;event.result=undefined;if(!event.target){event.target=elem;}
data=data==null?[event]:jQuery.makeArray(data,[event]);special=jQuery.event.special[type]||{};if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===false){return;}
if(!onlyHandlers&&!special.noBubble&&!isWindow(elem)){bubbleType=special.delegateType||type;if(!rfocusMorph.test(bubbleType+type)){cur=cur.parentNode;}
for(;cur;cur=cur.parentNode){eventPath.push(cur);tmp=cur;}
if(tmp===(elem.ownerDocument||document)){eventPath.push(tmp.defaultView||tmp.parentWindow||window);}}
i=0;while((cur=eventPath[i++])&&!event.isPropagationStopped()){lastElement=cur;event.type=i>1?bubbleType:special.bindType||type;handle=(dataPriv.get(cur,"events")||Object.create(null))[event.type]&&dataPriv.get(cur,"handle");if(handle){handle.apply(cur,data);}
handle=ontype&&cur[ontype];if(handle&&handle.apply&&acceptData(cur)){event.result=handle.apply(cur,data);if(event.result===false){event.preventDefault();}}}
event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(eventPath.pop(),data)===false)&&acceptData(elem)){if(ontype&&isFunction(elem[type])&&!isWindow(elem)){tmp=elem[ontype];if(tmp){elem[ontype]=null;}
jQuery.event.triggered=type;if(event.isPropagationStopped()){lastElement.addEventListener(type,stopPropagationCallback);}
elem[type]();if(event.isPropagationStopped()){lastElement.removeEventListener(type,stopPropagationCallback);}
jQuery.event.triggered=undefined;if(tmp){elem[ontype]=tmp;}}}}
return event.result;},simulate:function(type,elem,event){var e=jQuery.extend(new jQuery.Event(),event,{type:type,isSimulated:true});jQuery.event.trigger(e,null,elem);}});jQuery.fn.extend({trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this);});},triggerHandler:function(type,data){var elem=this[0];if(elem){return jQuery.event.trigger(type,data,elem,true);}}});if(!support.focusin){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event));};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this.document||this,attaches=dataPriv.access(doc,fix);if(!attaches){doc.addEventListener(orig,handler,true);}
dataPriv.access(doc,fix,(attaches||0)+1);},teardown:function(){var doc=this.ownerDocument||this.document||this,attaches=dataPriv.access(doc,fix)-1;if(!attaches){doc.removeEventListener(orig,handler,true);dataPriv.remove(doc,fix);}else{dataPriv.access(doc,fix,attaches);}}};});}
var location=window.location;var nonce={guid:Date.now()};var rquery=(/\?/);jQuery.parseXML=function(data){var xml;if(!data||typeof data!=="string"){return null;}
try{xml=(new window.DOMParser()).parseFromString(data,"text/xml");}catch(e){xml=undefined;}
if(!xml||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data);}
return xml;};var
rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;function buildParams(prefix,obj,traditional,add){var name;if(Array.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v);}else{buildParams(prefix+"["+(typeof v==="object"&&v!=null?i:"")+"]",v,traditional,add);}});}else if(!traditional&&toType(obj)==="object"){for(name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add);}}else{add(prefix,obj);}}
jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,valueOrFunction){var value=isFunction(valueOrFunction)?valueOrFunction():valueOrFunction;s[s.length]=encodeURIComponent(key)+"="+
encodeURIComponent(value==null?"":value);};if(a==null){return"";}
if(Array.isArray(a)||(a.jquery&&!jQuery.isPlainObject(a))){jQuery.each(a,function(){add(this.name,this.value);});}else{for(prefix in a){buildParams(prefix,a[prefix],traditional,add);}}
return s.join("&");};jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray());},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this;}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type));}).map(function(_i,elem){var val=jQuery(this).val();if(val==null){return null;}
if(Array.isArray(val)){return jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")};});}
return{name:elem.name,value:val.replace(rCRLF,"\r\n")};}).get();}});var
r20=/%20/g,rhash=/#.*$/,rantiCache=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,prefilters={},transports={},allTypes="*/".concat("*"),originAnchor=document.createElement("a");originAnchor.href=location.href;function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*";}
var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnothtmlwhite)||[];if(isFunction(func)){while((dataType=dataTypes[i++])){if(dataType[0]==="+"){dataType=dataType.slice(1)||"*";(structure[dataType]=structure[dataType]||[]).unshift(func);}else{(structure[dataType]=structure[dataType]||[]).push(func);}}}};}
function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=(structure===transports);function inspect(dataType){var selected;inspected[dataType]=true;jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);inspect(dataTypeOrTransport);return false;}else if(seekingTransport){return!(selected=dataTypeOrTransport);}});return selected;}
return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*");}
function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:(deep||(deep={})))[key]=src[key];}}
if(deep){jQuery.extend(true,target,deep);}
return target;}
function ajaxHandleResponses(s,jqXHR,responses){var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("Content-Type");}}
if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break;}}}
if(dataTypes[0]in responses){finalDataType=dataTypes[0];}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break;}
if(!firstDataType){firstDataType=type;}}
finalDataType=finalDataType||firstDataType;}
if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType);}
return responses[finalDataType];}}
function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1]){for(conv in s.converters){converters[conv.toLowerCase()]=s.converters[conv];}}
current=dataTypes.shift();while(current){if(s.responseFields[current]){jqXHR[s.responseFields[current]]=response;}
if(!prev&&isSuccess&&s.dataFilter){response=s.dataFilter(response,s.dataType);}
prev=current;current=dataTypes.shift();if(current){if(current==="*"){current=prev;}else if(prev!=="*"&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];if(!conv){for(conv2 in converters){tmp=conv2.split(" ");if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];if(conv){if(conv===true){conv=converters[conv2];}else if(converters[conv2]!==true){current=tmp[0];dataTypes.unshift(tmp[1]);}
break;}}}}
if(conv!==true){if(conv&&s.throws){response=conv(response);}else{try{response=conv(response);}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current};}}}}}}
return{state:"success",data:response};}
jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:location.href,type:"GET",isLocal:rlocalProtocol.test(location.protocol),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":JSON.parse,"text xml":jQuery.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target);},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined;}
options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,urlAnchor,completed,fireGlobals,i,uncached,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(completed){if(!responseHeaders){responseHeaders={};while((match=rheaders.exec(responseHeadersString))){responseHeaders[match[1].toLowerCase()+" "]=(responseHeaders[match[1].toLowerCase()+" "]||[]).concat(match[2]);}}
match=responseHeaders[key.toLowerCase()+" "];}
return match==null?null:match.join(", ");},getAllResponseHeaders:function(){return completed?responseHeadersString:null;},setRequestHeader:function(name,value){if(completed==null){name=requestHeadersNames[name.toLowerCase()]=requestHeadersNames[name.toLowerCase()]||name;requestHeaders[name]=value;}
return this;},overrideMimeType:function(type){if(completed==null){s.mimeType=type;}
return this;},statusCode:function(map){var code;if(map){if(completed){jqXHR.always(map[jqXHR.status]);}else{for(code in map){statusCode[code]=[statusCode[code],map[code]];}}}
return this;},abort:function(statusText){var finalText=statusText||strAbort;if(transport){transport.abort(finalText);}
done(0,finalText);return this;}};deferred.promise(jqXHR);s.url=((url||s.url||location.href)+"").replace(rprotocol,location.protocol+"//");s.type=options.method||options.type||s.method||s.type;s.dataTypes=(s.dataType||"*").toLowerCase().match(rnothtmlwhite)||[""];if(s.crossDomain==null){urlAnchor=document.createElement("a");try{urlAnchor.href=s.url;urlAnchor.href=urlAnchor.href;s.crossDomain=originAnchor.protocol+"//"+originAnchor.host!==urlAnchor.protocol+"//"+urlAnchor.host;}catch(e){s.crossDomain=true;}}
if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional);}
inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(completed){return jqXHR;}
fireGlobals=jQuery.event&&s.global;if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart");}
s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);cacheURL=s.url.replace(rhash,"");if(!s.hasContent){uncached=s.url.slice(cacheURL.length);if(s.data&&(s.processData||typeof s.data==="string")){cacheURL+=(rquery.test(cacheURL)?"&":"?")+s.data;delete s.data;}
if(s.cache===false){cacheURL=cacheURL.replace(rantiCache,"$1");uncached=(rquery.test(cacheURL)?"&":"?")+"_="+(nonce.guid++)+
uncached;}
s.url=cacheURL+uncached;}else if(s.data&&s.processData&&(s.contentType||"").indexOf("application/x-www-form-urlencoded")===0){s.data=s.data.replace(r20,"+");}
if(s.ifModified){if(jQuery.lastModified[cacheURL]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]);}
if(jQuery.etag[cacheURL]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL]);}}
if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType);}
jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+
(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i]);}
if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||completed)){return jqXHR.abort();}
strAbort="abort";completeDeferred.add(s.complete);jqXHR.done(s.success);jqXHR.fail(s.error);transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport");}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s]);}
if(completed){return jqXHR;}
if(s.async&&s.timeout>0){timeoutTimer=window.setTimeout(function(){jqXHR.abort("timeout");},s.timeout);}
try{completed=false;transport.send(requestHeaders,done);}catch(e){if(completed){throw e;}
done(-1,e);}}
function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;if(completed){return;}
completed=true;if(timeoutTimer){window.clearTimeout(timeoutTimer);}
transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;isSuccess=status>=200&&status<300||status===304;if(responses){response=ajaxHandleResponses(s,jqXHR,responses);}
if(!isSuccess&&jQuery.inArray("script",s.dataTypes)>-1){s.converters["text script"]=function(){};}
response=ajaxConvert(s,response,jqXHR,isSuccess);if(isSuccess){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");if(modified){jQuery.lastModified[cacheURL]=modified;}
modified=jqXHR.getResponseHeader("etag");if(modified){jQuery.etag[cacheURL]=modified;}}
if(status===204||s.type==="HEAD"){statusText="nocontent";}else if(status===304){statusText="notmodified";}else{statusText=response.state;success=response.data;error=response.error;isSuccess=!error;}}else{error=statusText;if(status||!statusText){statusText="error";if(status<0){status=0;}}}
jqXHR.status=status;jqXHR.statusText=(nativeStatusText||statusText)+"";if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR]);}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error]);}
jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]);}
completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!(--jQuery.active)){jQuery.event.trigger("ajaxStop");}}}
return jqXHR;},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json");},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script");}});jQuery.each(["get","post"],function(_i,method){jQuery[method]=function(url,data,callback,type){if(isFunction(data)){type=type||callback;callback=data;data=undefined;}
return jQuery.ajax(jQuery.extend({url:url,type:method,dataType:type,data:data,success:callback},jQuery.isPlainObject(url)&&url));};});jQuery.ajaxPrefilter(function(s){var i;for(i in s.headers){if(i.toLowerCase()==="content-type"){s.contentType=s.headers[i]||"";}}});jQuery._evalUrl=function(url,options,doc){return jQuery.ajax({url:url,type:"GET",dataType:"script",cache:true,async:false,global:false,converters:{"text script":function(){}},dataFilter:function(response){jQuery.globalEval(response,options,doc);}});};jQuery.fn.extend({wrapAll:function(html){var wrap;if(this[0]){if(isFunction(html)){html=html.call(this[0]);}
wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0]);}
wrap.map(function(){var elem=this;while(elem.firstElementChild){elem=elem.firstElementChild;}
return elem;}).append(this);}
return this;},wrapInner:function(html){if(isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i));});}
return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html);}else{self.append(html);}});},wrap:function(html){var htmlIsFunction=isFunction(html);return this.each(function(i){jQuery(this).wrapAll(htmlIsFunction?html.call(this,i):html);});},unwrap:function(selector){this.parent(selector).not("body").each(function(){jQuery(this).replaceWith(this.childNodes);});return this;}});jQuery.expr.pseudos.hidden=function(elem){return!jQuery.expr.pseudos.visible(elem);};jQuery.expr.pseudos.visible=function(elem){return!!(elem.offsetWidth||elem.offsetHeight||elem.getClientRects().length);};jQuery.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest();}catch(e){}};var xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();support.cors=!!xhrSupported&&("withCredentials"in xhrSupported);support.ajax=xhrSupported=!!xhrSupported;jQuery.ajaxTransport(function(options){var callback,errorCallback;if(support.cors||xhrSupported&&!options.crossDomain){return{send:function(headers,complete){var i,xhr=options.xhr();xhr.open(options.type,options.url,options.async,options.username,options.password);if(options.xhrFields){for(i in options.xhrFields){xhr[i]=options.xhrFields[i];}}
if(options.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(options.mimeType);}
if(!options.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest";}
for(i in headers){xhr.setRequestHeader(i,headers[i]);}
callback=function(type){return function(){if(callback){callback=errorCallback=xhr.onload=xhr.onerror=xhr.onabort=xhr.ontimeout=xhr.onreadystatechange=null;if(type==="abort"){xhr.abort();}else if(type==="error"){if(typeof xhr.status!=="number"){complete(0,"error");}else{complete(xhr.status,xhr.statusText);}}else{complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,(xhr.responseType||"text")!=="text"||typeof xhr.responseText!=="string"?{binary:xhr.response}:{text:xhr.responseText},xhr.getAllResponseHeaders());}}};};xhr.onload=callback();errorCallback=xhr.onerror=xhr.ontimeout=callback("error");if(xhr.onabort!==undefined){xhr.onabort=errorCallback;}else{xhr.onreadystatechange=function(){if(xhr.readyState===4){window.setTimeout(function(){if(callback){errorCallback();}});}};}
callback=callback("abort");try{xhr.send(options.hasContent&&options.data||null);}catch(e){if(callback){throw e;}}},abort:function(){if(callback){callback();}}};}});jQuery.ajaxPrefilter(function(s){if(s.crossDomain){s.contents.script=false;}});jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, "+"application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(text){jQuery.globalEval(text);return text;}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false;}
if(s.crossDomain){s.type="GET";}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain||s.scriptAttrs){var script,callback;return{send:function(_,complete){script=jQuery("<script>").attr(s.scriptAttrs||{}).prop({charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove();callback=null;if(evt){complete(evt.type==="error"?404:200,evt.type);}});document.head.appendChild(script[0]);},abort:function(){if(callback){callback();}}};}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||(jQuery.expando+"_"+(nonce.guid++));this[callback]=true;return callback;}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==false&&(rjsonp.test(s.url)?"url":typeof s.data==="string"&&(s.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&rjsonp.test(s.data)&&"data");if(jsonProp||s.dataTypes[0]==="jsonp"){callbackName=s.jsonpCallback=isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;if(jsonProp){s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName);}else if(s.jsonp!==false){s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName;}
s.converters["script json"]=function(){if(!responseContainer){jQuery.error(callbackName+" was not called");}
return responseContainer[0];};s.dataTypes[0]="json";overwritten=window[callbackName];window[callbackName]=function(){responseContainer=arguments;};jqXHR.always(function(){if(overwritten===undefined){jQuery(window).removeProp(callbackName);}else{window[callbackName]=overwritten;}
if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;oldCallbacks.push(callbackName);}
if(responseContainer&&isFunction(overwritten)){overwritten(responseContainer[0]);}
responseContainer=overwritten=undefined;});return"script";}});support.createHTMLDocument=(function(){var body=document.implementation.createHTMLDocument("").body;body.innerHTML="<form></form><form></form>";return body.childNodes.length===2;})();jQuery.parseHTML=function(data,context,keepScripts){if(typeof data!=="string"){return[];}
if(typeof context==="boolean"){keepScripts=context;context=false;}
var base,parsed,scripts;if(!context){if(support.createHTMLDocument){context=document.implementation.createHTMLDocument("");base=context.createElement("base");base.href=document.location.href;context.head.appendChild(base);}else{context=document;}}
parsed=rsingleTag.exec(data);scripts=!keepScripts&&[];if(parsed){return[context.createElement(parsed[1])];}
parsed=buildFragment([data],context,scripts);if(scripts&&scripts.length){jQuery(scripts).remove();}
return jQuery.merge([],parsed.childNodes);};jQuery.fn.load=function(url,params,callback){var selector,type,response,self=this,off=url.indexOf(" ");if(off>-1){selector=stripAndCollapse(url.slice(off));url=url.slice(0,off);}
if(isFunction(params)){callback=params;params=undefined;}else if(params&&typeof params==="object"){type="POST";}
if(self.length>0){jQuery.ajax({url:url,type:type||"GET",dataType:"html",data:params}).done(function(responseText){response=arguments;self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText);}).always(callback&&function(jqXHR,status){self.each(function(){callback.apply(this,response||[jqXHR.responseText,status,jqXHR]);});});}
return this;};jQuery.expr.pseudos.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem;}).length;};jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};if(position==="static"){elem.style.position="relative";}
curOffset=curElem.offset();curCSSTop=jQuery.css(elem,"top");curCSSLeft=jQuery.css(elem,"left");calculatePosition=(position==="absolute"||position==="fixed")&&(curCSSTop+curCSSLeft).indexOf("auto")>-1;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left;}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0;}
if(isFunction(options)){options=options.call(elem,i,jQuery.extend({},curOffset));}
if(options.top!=null){props.top=(options.top-curOffset.top)+curTop;}
if(options.left!=null){props.left=(options.left-curOffset.left)+curLeft;}
if("using"in options){options.using.call(elem,props);}else{if(typeof props.top==="number"){props.top+="px";}
if(typeof props.left==="number"){props.left+="px";}
curElem.css(props);}}};jQuery.fn.extend({offset:function(options){if(arguments.length){return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i);});}
var rect,win,elem=this[0];if(!elem){return;}
if(!elem.getClientRects().length){return{top:0,left:0};}
rect=elem.getBoundingClientRect();win=elem.ownerDocument.defaultView;return{top:rect.top+win.pageYOffset,left:rect.left+win.pageXOffset};},position:function(){if(!this[0]){return;}
var offsetParent,offset,doc,elem=this[0],parentOffset={top:0,left:0};if(jQuery.css(elem,"position")==="fixed"){offset=elem.getBoundingClientRect();}else{offset=this.offset();doc=elem.ownerDocument;offsetParent=elem.offsetParent||doc.documentElement;while(offsetParent&&(offsetParent===doc.body||offsetParent===doc.documentElement)&&jQuery.css(offsetParent,"position")==="static"){offsetParent=offsetParent.parentNode;}
if(offsetParent&&offsetParent!==elem&&offsetParent.nodeType===1){parentOffset=jQuery(offsetParent).offset();parentOffset.top+=jQuery.css(offsetParent,"borderTopWidth",true);parentOffset.left+=jQuery.css(offsetParent,"borderLeftWidth",true);}}
return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",true),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",true)};},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent;while(offsetParent&&jQuery.css(offsetParent,"position")==="static"){offsetParent=offsetParent.offsetParent;}
return offsetParent||documentElement;});}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win;if(isWindow(elem)){win=elem;}else if(elem.nodeType===9){win=elem.defaultView;}
if(val===undefined){return win?win[prop]:elem[method];}
if(win){win.scrollTo(!top?val:win.pageXOffset,top?val:win.pageYOffset);}else{elem[method]=val;}},method,val,arguments.length);};});jQuery.each(["top","left"],function(_i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed){computed=curCSS(elem,prop);return rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed;}});});jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),extra=defaultExtra||(margin===true||value===true?"margin":"border");return access(this,function(elem,type,value){var doc;if(isWindow(elem)){return funcName.indexOf("outer")===0?elem["inner"+name]:elem.document.documentElement["client"+name];}
if(elem.nodeType===9){doc=elem.documentElement;return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name]);}
return value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra);},type,chainable?margin:undefined,chainable);};});});jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(_i,type){jQuery.fn[type]=function(fn){return this.on(type,fn);};});jQuery.fn.extend({bind:function(types,data,fn){return this.on(types,null,data,fn);},unbind:function(types,fn){return this.off(types,null,fn);},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn);},undelegate:function(selector,types,fn){return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn);},hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver);}});jQuery.each(("blur focus focusin focusout resize scroll click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup contextmenu").split(" "),function(_i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name);};});var rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;jQuery.proxy=function(fn,context){var tmp,args,proxy;if(typeof context==="string"){tmp=fn[context];context=fn;fn=tmp;}
if(!isFunction(fn)){return undefined;}
args=slice.call(arguments,2);proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)));};proxy.guid=fn.guid=fn.guid||jQuery.guid++;return proxy;};jQuery.holdReady=function(hold){if(hold){jQuery.readyWait++;}else{jQuery.ready(true);}};jQuery.isArray=Array.isArray;jQuery.parseJSON=JSON.parse;jQuery.nodeName=nodeName;jQuery.isFunction=isFunction;jQuery.isWindow=isWindow;jQuery.camelCase=camelCase;jQuery.type=toType;jQuery.now=Date.now;jQuery.isNumeric=function(obj){var type=jQuery.type(obj);return(type==="number"||type==="string")&&!isNaN(obj-parseFloat(obj));};jQuery.trim=function(text){return text==null?"":(text+"").replace(rtrim,"");};if(typeof define==="function"&&define.amd){define("jquery",[],function(){return jQuery;});}
var
_jQuery=window.jQuery,_$=window.$;jQuery.noConflict=function(deep){if(window.$===jQuery){window.$=_$;}
if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery;}
return jQuery;};if(typeof noGlobal==="undefined"){window.jQuery=window.$=jQuery;}
return jQuery;});;(function(){var jquery_init=jQuery.fn.init;jQuery.fn.init=function(selector,context,rootjQuery){if(selector&&typeof selector==='string'){var hash_position=selector.indexOf('#');if(hash_position>=0){var bracket_position=selector.indexOf('<');if(bracket_position>hash_position){throw'Syntax error, unrecognized expression: '+selector;}}}
return jquery_init.call(this,selector,context,rootjQuery);};jQuery.fn.init.prototype=jquery_init.prototype;if($.ajaxPrefilter){$.ajaxPrefilter(function(s){if(s.crossDomain){s.contents.script=false;}});}
else if($.httpData){var jquery_httpData=$.httpData;$.httpData=function(xhr,type,s){if(!type&&(!s||!Drupal.urlIsLocal(s.url))){var content_type=xhr.getResponseHeader('content-type')||'';if(content_type.indexOf('javascript')>=0){type='text';}}
return jquery_httpData.call(this,xhr,type,s);};$.httpData.prototype=jquery_httpData.prototype;}})();var Drupal=Drupal||{'settings':{},'behaviors':{},'themes':{},'locale':{}};Drupal.jsEnabled=document.getElementsByTagName&&document.createElement&&document.createTextNode&&document.documentElement&&document.getElementById;Drupal.attachBehaviors=function(context){context=context||document;if(Drupal.jsEnabled){jQuery.each(Drupal.behaviors,function(){this(context);});}};Drupal.checkPlain=function(str){str=String(str);var replace={'&':'&amp;',"'":'&#39;','"':'&quot;','<':'&lt;','>':'&gt;'};for(var character in replace){var regex=new RegExp(character,'g');str=str.replace(regex,replace[character]);}
return str;};Drupal.t=function(str,args){if(Drupal.locale.strings&&Drupal.locale.strings[str]){str=Drupal.locale.strings[str];}
if(args){for(var key in args){switch(key.charAt(0)){case'@':args[key]=Drupal.checkPlain(args[key]);break;case'!':break;case'%':default:args[key]=Drupal.theme('placeholder',args[key]);break;}
str=str.replace(key,args[key]);}}
return str;};Drupal.formatPlural=function(count,singular,plural,args){var args=args||{};args['@count']=count;var index=Drupal.locale.pluralFormula?Drupal.locale.pluralFormula(args['@count']):((args['@count']==1)?0:1);if(index==0){return Drupal.t(singular,args);}
else if(index==1){return Drupal.t(plural,args);}
else{args['@count['+index+']']=args['@count'];delete args['@count'];return Drupal.t(plural.replace('@count','@count['+index+']'),args);}};Drupal.absoluteUrl=function(url){var urlParsingNode=document.createElement('a');try{url=decodeURIComponent(url);}catch(e){}
urlParsingNode.setAttribute('href',url);return urlParsingNode.cloneNode(false).href;};Drupal.urlIsLocal=function(url){var absoluteUrl=Drupal.absoluteUrl(url);var protocol=location.protocol;if(protocol==='http:'&&absoluteUrl.indexOf('https:')===0){protocol='https:';}
var baseUrl=protocol+'//'+location.host+Drupal.settings.basePath.slice(0,-1);try{absoluteUrl=decodeURIComponent(absoluteUrl);}catch(e){}
try{baseUrl=decodeURIComponent(baseUrl);}catch(e){}
return absoluteUrl===baseUrl||absoluteUrl.indexOf(baseUrl+'/')===0;};Drupal.theme=function(func){for(var i=1,args=[];i<arguments.length;i++){args.push(arguments[i]);}
return(Drupal.theme[func]||Drupal.theme.prototype[func]).apply(this,args);};Drupal.parseJson=function(data){if((data.substring(0,1)!='{')&&(data.substring(0,1)!='[')){return{status:0,data:data.length?data:Drupal.t('Unspecified error')};}
return eval('('+data+');');};Drupal.freezeHeight=function(){Drupal.unfreezeHeight();var div=document.createElement('div');$(div).css({position:'absolute',top:'0px',left:'0px',width:'1px',height:$('body').css('height')}).attr('id','freeze-height');$('body').append(div);};Drupal.unfreezeHeight=function(){$('#freeze-height').remove();};Drupal.encodeURIComponent=function(item,uri){uri=uri||location.href;item=encodeURIComponent(item).replace(/%2F/g,'/');return(uri.indexOf('?q=')!=-1)?item:item.replace(/%26/g,'%2526').replace(/%23/g,'%2523').replace(/\/\//g,'/%252F');};Drupal.getSelection=function(element){if(typeof(element.selectionStart)!='number'&&document.selection){var range1=document.selection.createRange();var range2=range1.duplicate();range2.moveToElementText(element);range2.setEndPoint('EndToEnd',range1);var start=range2.text.length-range1.text.length;var end=start+range1.text.length;return{'start':start,'end':end};}
return{'start':element.selectionStart,'end':element.selectionEnd};};Drupal.ahahError=function(xmlhttp,uri){if(xmlhttp.status==200){if(jQuery.trim($(xmlhttp.responseText).text())){var message=Drupal.t("An error occurred. \n@uri\n@text",{'@uri':uri,'@text':xmlhttp.responseText});}
else{var message=Drupal.t("An error occurred. \n@uri\n(no information available).",{'@uri':uri,'@text':xmlhttp.responseText});}}
else{var message=Drupal.t("An HTTP error @status occurred. \n@uri",{'@uri':uri,'@status':xmlhttp.status});}
return message;}
if(Drupal.jsEnabled){$(document.documentElement).addClass('js');$(document).ready(function(){Drupal.attachBehaviors(this);});}
Drupal.theme.prototype={placeholder:function(str){return'<em>'+Drupal.checkPlain(str)+'</em>';}};;var t_whitelabels_menu_size_init;$(document).ready(function(){whitelabels_window_size_init();whitelabels_same_size_init();whitelabels_footer_bottom_init();whitelabels_height_helpers_init();setTimeout(whitelabels_same_size_init,1000);$(window).resize(function(){whitelabels_window_size_init();whitelabels_same_size_init();setTimeout(whitelabels_same_size_init,1000);});whitelabels_helpers_init();whitelabels_hamburger_init();});function whitelabels_height_helpers_init(i){i=i||0;var header_height=$('.whitelabel_custom_header').outerHeight(true)||0;var footer_height=$('#custom_footer').outerHeight(true)||0;if($('.wl_minheight_full_wo_header').length>0){$('.wl_minheight_full_wo_header').css('min-height','calc(100vh - '+header_height+'px)');}
if($('.wl_minheight_full_wo_header_footer').length>0){$('.wl_minheight_full_wo_header_footer').css('min-height','calc(100vh - '+(parseFloat(header_height)+parseFloat(footer_height))+'px)');}
if($('.wl_minheight_full_wo_footer').length>0){$('.wl_minheight_full_wo_footer').css('min-height','calc(100vh - '+footer_height+'px)');}
if(i>3)return;setTimeout(function(){whitelabels_height_helpers_init(++i)},i*1000);}
function whitelabels_footer_bottom_init(i){i=i||0;if($('#custom_footer').length<1)return;if($('.whitelabel_custom_header').length<1)return;var footer_height=$('#custom_footer').outerHeight(true);var header_height=$('.whitelabel_custom_header').outerHeight(true);$('#main_container').css('min-height','calc(100vh - '+(parseFloat(header_height)+parseFloat(footer_height))+'px)');if(i>10)return;setTimeout(function(){whitelabels_footer_bottom_init(++i)},i*1000);}
function whitelabels_window_size_init(){$('body').removeClass('window_size_desktop').removeClass('window_size_tablet').removeClass('window_size_mobile');var device='desktop';var unset1='mobile';var unset2='tablet';var width=self.window.innerWidth;if(width<=960){device='tablet';unset2='desktop';}
if(width<=640){device='mobile';unset1='tablet';}
$('body').addClass('window_size_'+device).removeClass('window_size_'+unset1).removeClass('window_size_'+unset2);clearTimeout(t_whitelabels_menu_size_init);t_whitelabels_menu_size_init=setTimeout(whitelabels_menu_size_init,100);}
function whitelabels_menu_size_init(once){if($('.wl_menu_navmenu5').length<1)return;var height=$('.wl_menu_navmenu5').outerHeight(true);if(height>75){$('.wl_menu_navmenu5').addClass('wl_menu_smaller');}
if($('.wl_menu_container').outerHeight(true)>=100){$('.wl_menu_container').removeClass('wl_width_xl');$('.wl_menu_container').addClass('wl_width_xxl');}}
function whitelabels_helpers_init(){if($('.resize-width-field').length>0){$('.resize-width-field').change(function(){var resize_factor=parseFloat($(this).attr('data-resize-factor'));var length=$(this).find('option:selected')?$(this).find('option:selected').html().length:$(this).val().length;$(this).css('width',(length*resize_factor)+'px');});}}
function whitelabels_same_size_init(){var size={};$('.same-height').each(function(){var key=$(this).attr('data-same-height');$(this).css('min-height','initial');if($(this).hasClass('same-height-skip-desktop')){if($('body').hasClass('window_size_desktop')){return;}}
if($(this).hasClass('same-height-skip-mobile')){if($('body').hasClass('window_size_mobile')){return;}}
if($(this).hasClass('same-height-skip-tablet')){if($('body').hasClass('window_size_tablet')){return;}}
var height=$(this).height();if(typeof size[key]=='undefined'){size[key]=height;}else{if(size[key]<height){size[key]=height;}}});$('.same-height').each(function(){var key=$(this).attr('data-same-height');if(typeof size[key]!=='undefined'){$(this).css('min-height',size[key]);}});}
function whitelabels_hamburger_init(){$('#menuToggle input').click(function(){var menu=$(this).parent();if($(menu).hasClass('active')){$(menu).removeClass('active');}else{$(menu).addClass('active');}});}
function whitelabels_check_ie(){var ua=window.navigator.userAgent;var msie=ua.indexOf('MSIE ');var trident=ua.indexOf('Trident/');return(msie>0||trident>0);};jQuery.uaMatch=function(ua){ua=ua.toLowerCase();var match=/(chrome)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[];return{browser:match[1]||"",version:match[2]||"0"};};matched=jQuery.uaMatch(navigator.userAgent);browser={};if(matched.browser){browser[matched.browser]=true;browser.version=matched.version;}
if(browser.chrome){browser.webkit=true;}else if(browser.webkit){browser.safari=true;}
jQuery.browser=browser;;Drupal.behaviors.block_edit=function(context){if(Drupal.settings.block_edit.hover_links){$('.node-edit-link, .block-edit-link').hide();$('div.block, div.node').mouseover(function(){$(this).find('.node-edit-link, .block-edit-link').css('display','block');});$('div.block, div.node').mouseout(function(){$(this).find('.node-edit-link, .block-edit-link').css('display','none');});};};;Drupal.behaviors.initThickbox=function(context){$('a,area,input',context).filter('.thickbox:not(.initThickbox-processed)').addClass('initThickbox-processed').click(function(){var t=this.title||this.name||null;var a=this.href||this.alt;var g=this.rel||false;tb_show(t,a,g);this.blur();return false;});};function tb_show(caption,url,imageGroup){var settings=Drupal.settings.thickbox;tb_setBrowserExtra();try{if(typeof document.body.style.maxHeight==='undefined'){$('body','html').css({height:'100%',width:'100%'});$('html').css('overflow','hidden');if(document.getElementById('TB_HideSelect')===null){$('body').append('<iframe id="TB_HideSelect"></iframe><div id="TB_overlay"></div><div id="TB_window"></div>');$('#TB_overlay').click(tb_remove);}}
else{if(document.getElementById('TB_overlay')===null){$('body').append('<div id="TB_overlay"></div><div id="TB_window"></div>');$('#TB_overlay').click(tb_remove);}}
if($.browserextra.macfirefox){$('#TB_overlay').addClass('TB_overlayMacFFBGHack');}
else{$('#TB_overlay').addClass('TB_overlayBG');}
if(caption===null){caption='';}
$('body').append('<div id="TB_load"></div>');$('#TB_load').show();var baseURL;if(url.indexOf('?')!==-1){baseURL=url.substr(0,url.indexOf('?'));}
else{baseURL=url;}
var urlString=/\.jpg$|\.jpeg$|\.png$|\.gif$|\.bmp$/;var urlType=baseURL.toLowerCase().match(urlString);if(urlType=='.jpg'||urlType=='.jpeg'||urlType=='.png'||urlType=='.gif'||urlType=='.bmp'){TB_PrevCaption='';TB_PrevURL='';TB_PrevHTML='';TB_NextCaption='';TB_NextURL='';TB_NextHTML='';TB_imageCount='';TB_FoundURL=false;if(imageGroup){TB_TempArray=$('a[rel='+imageGroup+']').get();for(TB_Counter=0;((TB_Counter<TB_TempArray.length)&&(TB_NextHTML===''));TB_Counter++){var urlTypeTemp=TB_TempArray[TB_Counter].href.toLowerCase().match(urlString);if(!(TB_TempArray[TB_Counter].href==url)){if(TB_FoundURL){TB_NextCaption=TB_TempArray[TB_Counter].title;TB_NextURL=TB_TempArray[TB_Counter].href;TB_NextHTML='<span id="TB_next">&nbsp;&nbsp;<a href="#">'+settings.next+'</a></span>';}
else{TB_PrevCaption=TB_TempArray[TB_Counter].title;TB_PrevURL=TB_TempArray[TB_Counter].href;TB_PrevHTML='<span id="TB_prev">&nbsp;&nbsp;<a href="#">'+settings.prev+'</a></span>';}}
else{TB_FoundURL=true;if(TB_TempArray.length>1){TB_imageCount=settings.image_count.replace(/\!current/,(TB_Counter+1)).replace(/\!total/,TB_TempArray.length);}}}}
imgPreloader=new Image();prevImg=new Image();nextImg=new Image();imgPreloader.onload=function(){imgPreloader.onload=null;var TB_Links=$('a[class*="thickbox"]');var i=-1;TB_Links.each(function(n){if(this.href==imgPreloader.src){i=n;}});if(i!=-1){if(i>0){prevImg.src=TB_Links[i-1].href;}
if(i+1<TB_Links.length){nextImg.src=TB_Links[i+1].href;}}
var pagesize=tb_getPageSize();var x=pagesize[0]-100;var y=pagesize[1]-100;var imageWidth=imgPreloader.width;var imageHeight=imgPreloader.height;if(imageWidth>x){imageHeight=imageHeight*(x/imageWidth);imageWidth=x;if(imageHeight>y){imageWidth=imageWidth*(y/imageHeight);imageHeight=y;}}
else if(imageHeight>y){imageWidth=imageWidth*(y/imageHeight);imageHeight=y;if(imageWidth>x){imageHeight=imageHeight*(x/imageWidth);imageWidth=x;}}
TB_WIDTH=imageWidth<320?350:imageWidth+30;TB_HEIGHT=imageHeight+60;$('#TB_window').append('<a href="" id="TB_ImageOff" title="'+settings.next_close+'"><img id="TB_Image" src="'+url+'" width="'+imageWidth+'" height="'+imageHeight+'" alt="'+caption+'" /></a><div id="TB_caption">'+caption+'<div id="TB_secondLine">'+TB_imageCount+TB_PrevHTML+TB_NextHTML+'</div></div><div id="TB_closeWindow"><a href="#" id="TB_closeWindowButton" title="'+settings.close+'">'+settings.close+'</a> </div>');$('#TB_closeWindowButton').click(tb_remove);if(!(TB_PrevHTML==='')){function goPrev(){if($(document).unbind('click',goPrev)){$(document).unbind('click',goPrev);}
$('#TB_window').remove();$('body').append('<div id="TB_window"></div>');tb_show(TB_PrevCaption,TB_PrevURL,imageGroup);return false;}
$('#TB_prev').click(goPrev);}
if(!(TB_NextHTML==='')){function goNext(){$('#TB_window').remove();$('body').append('<div id="TB_window"></div>');tb_show(TB_NextCaption,TB_NextURL,imageGroup);return false;}
$('#TB_next').click(goNext);$('#TB_ImageOff').click(goNext);}
else{$('#TB_ImageOff').click(tb_remove);}
document.onkeydown=function(e){if(e==null){keycode=event.keyCode;escapeKey=27;}
else if($.browser.safari||$.browser.opera){keycode=e.which;escapeKey=27;}
else{keycode=e.keyCode;escapeKey=e.DOM_VK_ESCAPE;}
key=String.fromCharCode(keycode).toLowerCase();if(key=='x'||key=='c'||keycode==escapeKey){tb_remove();}
else if(key=='n'||keycode==39){if(!(TB_NextHTML=='')){document.onkeydown='';goNext();}}
else if(key=='p'||keycode==37){if(!(TB_PrevHTML=='')){document.onkeydown='';goPrev();}}};tb_position();$('#TB_load').remove();$('#TB_window').css({display:'block',opacity:0}).animate({opacity:1},400);};imgPreloader.src=url;}
else{var queryString=url.replace(/^[^\?]+\??/,'');var params=tb_parseQuery(queryString);TB_WIDTH=(params['width']*1)+30||630;TB_HEIGHT=(params['height']*1)+40||440;ajaxContentW=TB_WIDTH-30;ajaxContentH=TB_HEIGHT-45;if(url.indexOf('TB_iframe')!=-1){urlNoQuery=url.split('TB_');$('#TB_iframeContent').remove();if(params['modal']!='true'){$('#TB_window').append('<div id="TB_title"><div id="TB_ajaxWindowTitle">'+caption+'</div><div id="TB_closeAjaxWindow"><a href="#" id="TB_closeWindowButton" title="'+settings.close+'">'+settings.close+'</a> </div></div><iframe frameborder="0" hspace="0" src="'+urlNoQuery[0]+'" id="TB_iframeContent" name="TB_iframeContent'+Math.round(Math.random()*1000)+'" onload="tb_showIframe()" style="width:'+(ajaxContentW+29)+'px;height:'+(ajaxContentH+17)+'px;"></iframe>');}
else{$('#TB_overlay').unbind();$('#TB_window').append('<iframe frameborder="0" hspace="0" src="'+urlNoQuery[0]+'" id="TB_iframeContent" name="TB_iframeContent'+Math.round(Math.random()*1000)+'" onload="tb_showIframe()" style="width:'+(ajaxContentW+29)+'px;height:'+(ajaxContentH+17)+'px;"></iframe>');}}
else{if($('#TB_window').css('display')!='block'){if(params['modal']!='true'){$('#TB_window').append('<div id="TB_title"><div id="TB_ajaxWindowTitle">'+caption+'</div><div id="TB_closeAjaxWindow"><a href="#" id="TB_closeWindowButton" title="'+settings.close+'">'+settings.close+'</a> </div></div><div id="TB_ajaxContent" style="width:'+ajaxContentW+'px;height:'+ajaxContentH+'px"></div>');window.setTimeout("tb_focusFirstFormElement()",1000);}
else{$('#TB_overlay').unbind();$('#TB_window').append('<div id="TB_ajaxContent" class="TB_modal" style="width:'+ajaxContentW+'px;height:'+ajaxContentH+'px;"></div>');}}
else{$('#TB_ajaxContent')[0].style.width=ajaxContentW+'px';$('#TB_ajaxContent')[0].style.height=ajaxContentH+'px';$('#TB_ajaxContent')[0].scrollTop=0;$('#TB_ajaxWindowTitle').html(caption);}}
$('#TB_closeWindowButton').click(tb_remove);if(url.indexOf('TB_inline')!=-1){$('#TB_ajaxContent').append($('#'+params['inlineId']).children());$('#TB_window').unload(function(){$('#'+params['inlineId']).append($('#TB_ajaxContent').children());});tb_position();$('#TB_load').remove();$('#TB_window').css({display:'block',opacity:0}).animate({opacity:1},400);}
else if(url.indexOf('TB_iframe')!=-1){tb_position();if($.browserextra.iphone){$('#TB_load').remove();$('#TB_window').css({display:'block',opacity:0}).animate({opacity:1},400);}}
else{$('#TB_ajaxContent').load(url+='&random='+(new Date().getTime()),function(){tb_position();$('#TB_load').remove();Drupal.attachBehaviors('#TB_ajaxContent');$('#TB_window').css({display:'block',opacity:0}).animate({opacity:1},400);});}}
if(!params['modal']){document.onkeyup=function(e){if(e==null){keycode=event.keyCode;escapeKey=27;}
else if($.browser.safari||$.browser.opera){keycode=e.which;escapeKey=27;}
else{keycode=e.keyCode;escapeKey=e.DOM_VK_ESCAPE;}
key=String.fromCharCode(keycode).toLowerCase();if(keycode==escapeKey){tb_remove();}};}}
catch(e){}}
function tb_showIframe(){$('#TB_load').remove();if($('#TB_window').css('display')!='block')
$('#TB_window').css({display:'block',opacity:0}).animate({opacity:1},400);}
function tb_remove(){$('#TB_imageOff').unbind('click');$('#TB_overlay').unbind('click');$('#TB_closeWindowButton').unbind('click');$('#TB_window').fadeOut(400,function(){$('#TB_window,#TB_overlay,#TB_HideSelect').trigger('unload').unbind().remove();});$('#TB_load').remove();if(typeof document.body.style.maxHeight=='undefined'){$('body','html').css({height:'auto',width:'auto'});$('html').css('overflow','');}
document.onkeydown='';document.onkeyup='';return false;}
function tb_position(){$('#TB_window').css({marginLeft:'-'+parseInt((TB_WIDTH/2),10)+'px',width:TB_WIDTH+'px'});if(!($.browserextra.msie6)){$('#TB_window').css({marginTop:'-'+parseInt((TB_HEIGHT/2),10)+'px'});}}
function tb_parseQuery(query){var Params={};if(!query){return Params;}
var Pairs=query.split(/[;&]/);for(var i=0;i<Pairs.length;i++){var KeyVal=Pairs[i].split('=');if(!KeyVal||KeyVal.length!=2){continue;}
var key=unescape(KeyVal[0]);var val=unescape(KeyVal[1]);val=val.replace(/\+/g,' ');Params[key]=val;}
return Params;}
function tb_getPageSize(){var de=document.documentElement;var w=window.innerWidth||self.innerWidth||(de&&de.clientWidth)||document.body.clientWidth;var h=window.innerHeight||self.innerHeight||(de&&de.clientHeight)||document.body.clientHeight;arrayPageSize=[w,h];return arrayPageSize;}
function tb_setBrowserExtra(){if($.browserextra){return;}
var userAgent=navigator.userAgent.toLowerCase();$.browserextra={iphone:/iphone/.test(userAgent),msie6:/msie/.test(userAgent)&&!/opera/.test(userAgent)&&/msie 6\.0/.test(userAgent)&&!/msie 7\.0/.test(userAgent)&&!/msie 8\.0/.test(userAgent),macfirefox:/mac/.test(userAgent)&&/firefox/.test(userAgent)};}
function tb_focusFirstFormElement(){$('#TB_window form input[type=text]:first').focus();};$(document).ready(function(){$('.thumbs_list1 ul.business_cards_list li#bc_upload_card a').click(function(event){if(typeof Drupal.settings.is_flstheme!='undefined'){if(Drupal.settings.is_flstheme){if(!(fls_browser.msie||navigator.userAgent.indexOf("Trident")>=0))
return false;}}
event.preventDefault();if(Drupal.settings.bc_multicard){return false;}
if(typeof BCUP_POPUP!='undefined')
BCUP_POPUP.init();else
PO_UC.init();fls_events_add('clicks_bc_step2_upload');return false;});$('.thumbs_list1 ul.business_cards_list li a').click(function(){if($(this).closest('#bc_upload_card').length)
return false;var card_id=$(this).attr('href');card_id=card_id.split('/');card_id=card_id[card_id.length-1];if(Drupal.settings.bc_multicard){url=Drupal.settings.bc_multicard+card_id;if(parseInt(Drupal.settings.bc_clid)>0)
url+='/'+Drupal.settings.bc_clid;window.location=url;return false;}
if((Drupal.settings.bcworkflow_popup&&Drupal.settings.bcworkflow2_split)&&(typeof(Drupal.settings.templateBackground)==="undefined"||Drupal.settings.templateBackground=="")){PO_bcstep2.init();$('#bcworkflow_card_id').val(card_id);return false;}
return true;});$('.thumbs_list1 ul.business_cards_list li').bind('mouseover',function(){if(typeof Drupal.settings.is_flstheme!='undefined'){if(Drupal.settings.is_flstheme){if($(this).attr('id')=='bc_upload_card'){return;}}}
var offset=$(this).offset();$('body').append('<div class="logo_notice1">'+Drupal.settings.step2_texttojs.text1+'</div>');$('.logo_notice1').css('position','absolute').css('top',offset.top-35+'px').css('left',offset.left+55+'px').css('display','');}).bind('mouseout',function(){$('.logo_notice1').remove();});$('#edit-logo-type').change(function(){$('#bcstep2-categories-form').submit();});$('#business_cards_search_field input').focus(function(){if($('#business_cards_search_field input').val()==Drupal.settings.sphinxDefaultSearch){$('#business_cards_search_field input').val('');}});$('#business_cards_search_field input').blur(function(){if($('#business_cards_search_field input').val().length<1)
$('#business_cards_search_field input').val(Drupal.settings.sphinxDefaultSearch);});$('#business_cards_search_submit').click(function(){console.log('click on submit');console.log($(this).parents('form'));$(this).parents('form').submit();});});$(window).on('load',function(){if(Drupal.settings.feedback_lightbox){BCFEEDBACK.init();}else{PO_bcstep2_2.init();}});var PO_bcstep2={init:function(){if($('.bcworkflow_lightbox').length>0&&$('.overlay').length>0){PO_bcstep2.placePopUp();if(Drupal.settings.step2_infinite_scroll){$('.bcworkflow_lightbox').css('margin-top',$(window).scrollTop());$('body').css('overflow','hidden');}else{$('html, body').animate({scrollTop:0},'fast');}
$('.bcworkflow_lightbox .close, .bcworkflow_lightbox .noThankYou').click(PO_bcstep2.hidePopUp)}},placePopUp:function(){var overlay=$('.overlay:first');var thankYouBox=$('.bcworkflow_lightbox');$('.overlay, .bcworkflow_lightbox').remove();var docH=$(document).height();var docW=$(document).width();overlay.css({"width":docW+"px","height":docH+"px"});thankYouBox.prependTo('body');overlay.prependTo('body');$('#bcworkflow_CardNewLogo').click(function(){$('#bcworkflow_card_type').val('CardNewLogo');$('#business-cards-step2-popup-form').submit();return false;});$('#bcworkflow_CardOwnLogo').click(function(){$('#bcworkflow_card_type').val('CardOwnLogo');$('#business-cards-step2-popup-form').submit();return false;});$('#bcworkflow_CardNoLogo,#bcworkflow_online,#bcworkflow_graphic').click(function(){$('#bcworkflow_card_type').val('CardNoLogo');$('#business-cards-step2-popup-form').submit();return false;});$('#bcworkflow_CardNoLogo2').click(function(){$('.bcworkflow_lightbox h4').hide();$('.bcworkflow_step').hide();$('.bcworkflow_lightbox h4.h4_godaddybc').show();$('.bcworkflow_step_godaddybc').show();});if(Drupal.settings.select_logo){$('#bcworkflow_CardNewLogo').trigger('click');return;}
thankYouBox.show();var bW=$('.bcworkflow_lightbox').width();var bH=$('.bcworkflow_lightbox').height();var wW=$(window).width();var wH=$(window).height();bW=wW/2-bW/2;bH=wH/2-bH/2;$('.bcworkflow_lightbox').css({left:bW,top:bH>40?bH:40});$('.overlay:first').show();if($.browser.msie&&$.browser.version=='8.0'){$('.overlay').css('filter','alpha(opacity=30)');}},hidePopUp:function(){$('.bcworkflow_lightbox').fadeOut();$('.overlay').fadeOut();$('.bcworkflow_lightbox').hide();$('.overlay').hide();if(Drupal.settings.step2_infinite_scroll){$('body').css('overflow','');}
return false;}}
var PO_bcstep2_2={init:function(){if($('.bcworkflow2_lightbox').length>0&&$('.overlay').length>0&&$('.overlay:visible').length==0){PO_bcstep2_2.placePopUp();$('html, body').animate({scrollTop:0},'fast');$('.bcworkflow2_lightbox .close, .bcworkflow_lightbox .noThankYou').click(PO_bcstep2_2.hidePopUp)}},placePopUp:function(){var overlay=$('.overlay:first');var thankYouBox=$('.bcworkflow2_lightbox');$('.overlay, .bcworkflow2_lightbox').remove();var docH=$(document).height();var docW=$(document).width();overlay.css({"width":docW+"px","height":docH+"px"});thankYouBox.prependTo('body');overlay.prependTo('body');thankYouBox.show();var bW=$('.bcworkflow2_lightbox').width();var bH=$('.bcworkflow2_lightbox').height();var wW=$(window).width();var wH=$(window).height();bW=wW/2-bW/2;bH=wH/2-bH/2;$('.bcworkflow2_lightbox').css({left:bW,top:bH>40?bH:40});$('.overlay:first').show();$('.bchomepopup_category').click(function(){var category_id=$(this).attr('id');category_id=category_id.split('_');category_id=category_id[category_id.length-1];$('#bcworkflow_category').val(category_id);$('#business-cards-step2-popup-home-form').submit();return false;});$('#business-cards-step2-popup-category-form #bcworkflow_category').change(function(){$('#business-cards-step2-popup-category-form').submit();return false;});$('#business-cards-step2-popup-category-form .view_all').click(function(){var category_id=0;$('#bcworkflow_category').val(category_id);$('#business-cards-step2-popup-category-form').submit();return false;});},hidePopUp:function(){$('#bcworkflow_category').val(0);if(Drupal.settings.bc_step2_lightbox_set!==undefined&&Drupal.settings.bc_step2_lightbox_set!='step2'&&Drupal.settings.bc_step2_lightbox_set!='step2-infinite-scroll'){$('#business-cards-step2-popup-category-form').submit();}
else
$('#business-cards-step2-popup-home-form').submit();return false;}}
var PO_UC={init:function(){if($('.pouc_lightbox').length>0&&$('.overlay').length>0){PO_UC.placePopUp();$('html, body').animate({scrollTop:0},'fast');$('.pouc_lightbox .close, .pouc_lightbox .noThankYou').click(PO_UC.hidePopUp);$('.pouc_lightbox a.bc-free-blue-btn').click(PO_UC.hidePopUp);$('.pouc_lightbox a.bc-free-orange-btn').click(PO_UC.uploadBc);}},placePopUp:function(){var overlay=$('.overlay:first');var thankYouBox=$('.pouc_lightbox');$('.overlay, .pouc_lightbox').remove();var docH=$(document).height();var docW=$(document).width();overlay.css({"width":docW+"px","height":docH+"px"});thankYouBox.prependTo('body');overlay.prependTo('body');thankYouBox.show();var bW=$('.pouc_lightbox').width();var bH=$('.pouc_lightbox').height();var wW=$(window).width();var wH=$(window).height();bW=wW/2-bW/2;bH=wH/2-bH/2;$('.pouc_lightbox').css({left:bW,top:bH>40?bH:40});$('.overlay:first').show();if($.browser.msie&&$.browser.version=='8.0'){$('.overlay').css('filter','alpha(opacity=30)');}},hidePopUp:function(){$('.pouc_lightbox').fadeOut();$('.overlay').fadeOut();$('.pouc_lightbox').hide();$('.overlay').hide();return false;},uploadBc:function(){if($('#bc_upload_card a').length){var url=$('#bc_upload_card a').attr('href');if(url){PO_UC.hidePopUp();window.location=url;}}}}
function validate_feedback(){var response=true;$('#bc_feedback').css('border','1px solid #929292');$('#bc_email').css('border','1px solid #929292');if(!$('#bc_feedback').val()||$('#bc_feedback').val().length>90){$('#bc_feedback').css('border','1px solid red');response=false;}
if($('#bc_email').val()){if(!isValidEmail($('#bc_email').val())){$('#bc_email').css('border','1px solid red');response=false;}}
return response;}
var BCFEEDBACK={init:function(){if($('.bc_feedback_lightbox').length>0&&$('.overlay').length>0){BCFEEDBACK.placePopUp();$('.bc_feedback_lightbox .close').click(function(){BCFEEDBACK.hidePopUp();});$('#close_continue_button').click(function(){BCFEEDBACK.hidePopUp();});$('#submit-feedback').click(function(){if(validate_feedback()){$.ajax({type:"POST",url:Drupal.settings.baseUrl+'/feedback-js',dataType:"json",data:$("#business-cards-step2-feedback-form").serialize(),success:function(Response){$('#content1').hide();$('#content2').show();}});}});}},placePopUp:function(){var overlay=$('.overlay:first');var thankYouBox=$('.thankYouBox.bc_feedback_lightbox');$('.overlay, .thankYouBox.bc_feedback_lightbox').remove();var docH=$(document).height();var docW=$(document).width();overlay.css({"width":docW+"px","height":docH+"px"});thankYouBox.prependTo('body');overlay.prependTo('body');overlay.show();thankYouBox.show();var bW=$('.thankYouBox.bc_feedback_lightbox').width();var bH=$('.thankYouBox.bc_feedback_lightbox').height();var wW=$(window).width();var wH=$(window).height();bW=wW/2-bW/2;bH=wH/2-bH/2;$('.thankYouBox.bc_feedback_lightbox').css({left:bW,top:bH>40?bH:40});},hidePopUp:function(){$('.bc_feedback_lightbox').hide();$('.overlay').hide();return false;}};function setFlashHeight(newHeight){$('#'+attributes.id).attr('height',newHeight);$('#flash_container').css({width:'auto',height:'auto','text-align':'left'});}
function editor_event_dispatched(){ga('send','event','button','click','Clicked Safe Line Help Button');};;$(document).ready(function(){var timerId;function hideSubmenu(){$('.myaccount_topnav .menu.my_account').removeClass('active');$('.flstheme_usermenu').hide();}
$('.myaccount_topnav .menu.my_account').mouseover(function(){if(timerId!='undefined')clearTimeout(timerId);$(this).addClass('active');$(".myaccount_topnav .menu.my_account .submenu").remove();$('.flstheme_usermenu').show();});$('.myaccount_topnav .menu.my_account, .flstheme_usermenu').mouseout(function(){timerId=setTimeout(hideSubmenu,50);});$('.flstheme_usermenu').mouseover(function(){if(timerId!='undefined')clearTimeout(timerId);$('.myaccount_topnav .menu.my_account').addClass('active');$(this).show();});$(".flstheme_topmenu.websites .usermenu_edit_website").click(function(){show_loading_overlay(Drupal.settings.lightbox_loading_text);var site_id;site_id=$(this).attr("id");var lang="";if(Drupal.settings.lang!=''){lang=Drupal.settings.lang+"/";}
$.ajax({url:Drupal.settings.baseUrl+"/"+lang+"websites/edit/"+site_id+"?check=1",type:'post',dataType:'json',success:function(result){if(result["success"]==2){$('#TB_overlay').remove();$('#TB_window').remove();ACTIVATEDOMAIN.init();return false;}else{if(lang!=''){window.location=Drupal.settings.baseUrl+"/"+lang+"websites/edit/"+site_id;}else{window.location=Drupal.settings.baseUrl+"/"+lang+"website/industry-selection/"+site_id;}}}});return false;});});;$(document).ready(function(){if($('#navmobile2_menu').length>0){menus_navmobile2_init();}
footer_language_select_init();});function footer_language_select_init(){$('.footer_language_select').change(function(){window.location=$(this).find('option:selected').val();});}
function menus_navmobile2_init(){$('#navmobile2_menuToggle .navmobile2_hamburger_button').click(function(){var menu=$('#navmobile2_menuToggle');var submenu=$('#navmobile2_menuToggle #navmobile2_menu');if($(menu).hasClass('active')){$(submenu).css('right','-100%');$("#navmobile2_menuToggle .navmobile2_hamburger_button").addClass("activate_menu");setTimeout(function(){$(menu).removeClass('active');},500);}else{$(menu).addClass('active');$("#navmobile2_menuToggle .navmobile2_hamburger_button").removeClass("activate_menu");setTimeout(function(){$(submenu).css('right','0%');},100);}});$('.navmobile2_top_element').bind('click touch',function(e){var hasSubmenu=false;var submenu=$(this).parents('li').find('.navmobile2_submenu');var parent=submenu.parents('li');if(submenu.length>0&&submenu.find('.navmobile2_submenu_element')){hasSubmenu=true;}
if(hasSubmenu){e.preventDefault();if(submenu.hasClass('selected')){submenu.removeClass('selected');parent.removeClass('selected');menus_general_remove_classes(parent,'data-selected-class');return false;}else{$('#navmobile2_menuToggle li.selected').each(function(){menus_general_remove_classes($(this),'data-selected-class');});$('#navmobile2_menuToggle .selected').removeClass('selected');submenu.addClass('selected');parent.addClass('selected');menus_general_add_classes(parent,'data-selected-class');return false;}}else{window.location=$(this).attr('href');}});}
function menus_general_add_classes(o,el){var classes=$(o).attr(el);if(typeof classes.length==='undefined')return;classes=classes.split(' ');$.each(classes,function(k,v){$(o).addClass(v);});}
function menus_general_remove_classes(o,el){var classes=$(o).attr(el);if(typeof classes.length==='undefined')return;classes=classes.split(' ');$.each(classes,function(k,v){$(o).removeClass(v);});};;(function($){var helper={},current,title,tID,IE=$.browser.msie&&/MSIE\s(5\.5|6\.)/.test(navigator.userAgent),track=false;$.tooltip={blocked:false,defaults:{delay:200,fade:false,showURL:true,extraClass:"",top:15,left:15,id:"tooltip"},block:function(){$.tooltip.blocked=!$.tooltip.blocked;}};$.fn.extend({tooltip:function(settings){settings=$.extend({},$.tooltip.defaults,settings);createHelper(settings);return this.each(function(){$.data(this,"tooltip",settings);this.tOpacity=helper.parent.css("opacity");this.tooltipText=this.title;$(this).removeAttr("title");this.alt="";}).mouseover(save).mouseout(hide).click(hide);},fixPNG:IE?function(){return this.each(function(){var image=$(this).css('backgroundImage');if(image.match(/^url\(["']?(.*\.png)["']?\)$/i)){image=RegExp.$1;$(this).css({'backgroundImage':'none','filter':"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+image+"')"}).each(function(){var position=$(this).css('position');if(position!='absolute'&&position!='relative')$(this).css('position','relative');});}});}:function(){return this;},unfixPNG:IE?function(){return this.each(function(){$(this).css({'filter':'',backgroundImage:''});});}:function(){return this;},hideWhenEmpty:function(){return this.each(function(){$(this)[$(this).html()?"show":"hide"]();});},url:function(){return this.attr('href')||this.attr('src');}});function createHelper(settings){if(helper.parent)return;helper.parent=$('<div id="'+settings.id+'"><h3></h3><div class="body"></div><div class="url"></div></div>').appendTo(document.body).hide();if($.fn.bgiframe)helper.parent.bgiframe();helper.title=$('h3',helper.parent);helper.body=$('div.body',helper.parent);helper.url=$('div.url',helper.parent);}function settings(element){return $.data(element,"tooltip");}function handle(event){if(settings(this).delay)tID=setTimeout(show,settings(this).delay);else
show();track=!!settings(this).track;$(document.body).bind('mousemove',update);update(event);}function save(){if($.tooltip.blocked||this==current||(!this.tooltipText&&!settings(this).bodyHandler))return;current=this;title=this.tooltipText;if(settings(this).bodyHandler){helper.title.hide();var bodyContent=settings(this).bodyHandler.call(this);if(bodyContent.nodeType||bodyContent.jquery){helper.body.empty().append(bodyContent)}else{helper.body.html(bodyContent);}helper.body.show();}else if(settings(this).showBody){var parts=title.split(settings(this).showBody);helper.title.html(parts.shift()).show();helper.body.empty();for(var i=0,part;(part=parts[i]);i++){if(i>0)helper.body.append("<br/>");helper.body.append(part);}helper.body.hideWhenEmpty();}else{helper.title.html(title).show();helper.body.hide();}if(settings(this).showURL&&$(this).url())helper.url.html($(this).url().replace('http://','')).show();else
helper.url.hide();helper.parent.addClass(settings(this).extraClass);if(settings(this).fixPNG)helper.parent.fixPNG();handle.apply(this,arguments);}function show(){tID=null;if((!IE||!$.fn.bgiframe)&&settings(current).fade){if(helper.parent.is(":animated"))helper.parent.stop().show().fadeTo(settings(current).fade,current.tOpacity);else
helper.parent.is(':visible')?helper.parent.fadeTo(settings(current).fade,current.tOpacity):helper.parent.fadeIn(settings(current).fade);}else{helper.parent.show();}update();}function update(event){if($.tooltip.blocked)return;if(event&&event.target.tagName=="OPTION"){return;}if(!track&&helper.parent.is(":visible")){$(document.body).unbind('mousemove',update)}if(current==null){$(document.body).unbind('mousemove',update);return;}helper.parent.removeClass("viewport-right").removeClass("viewport-bottom");var left=helper.parent[0].offsetLeft;var top=helper.parent[0].offsetTop;if(event){left=event.pageX+settings(current).left;top=event.pageY+settings(current).top;var right='auto';if(settings(current).positionLeft){right=$(window).width()-left;left='auto';}helper.parent.css({left:left,right:right,top:top});}var v=viewport(),h=helper.parent[0];if(v.x+v.cx<h.offsetLeft+h.offsetWidth){left-=h.offsetWidth+20+settings(current).left;helper.parent.css({left:left+'px'}).addClass("viewport-right");}if(v.y+v.cy<h.offsetTop+h.offsetHeight){top-=h.offsetHeight+20+settings(current).top;helper.parent.css({top:top+'px'}).addClass("viewport-bottom");}}function viewport(){return{x:$(window).scrollLeft(),y:$(window).scrollTop(),cx:$(window).width(),cy:$(window).height()};}function hide(event){if($.tooltip.blocked)return;if(tID)clearTimeout(tID);current=null;var tsettings=settings(this);function complete(){helper.parent.removeClass(tsettings.extraClass).hide().css("opacity","");}if((!IE||!$.fn.bgiframe)&&tsettings.fade){if(helper.parent.is(':animated'))helper.parent.stop().fadeTo(tsettings.fade,0,complete);else
helper.parent.stop().fadeOut(tsettings.fade,complete);}else
complete();if(settings(this).fixPNG)helper.parent.unfixPNG();}})(jQuery);;(function($){$.fn.jqm=function(o){var p={overlay:50,overlayClass:'jqmOverlay',closeClass:'jqmClose',trigger:'.jqModal',ajax:F,ajaxText:'',target:F,modal:F,toTop:F,onShow:F,onHide:F,onLoad:F};return this.each(function(){if(this._jqm)return H[this._jqm].c=$.extend({},H[this._jqm].c,o);s++;this._jqm=s;H[s]={c:$.extend(p,$.jqm.params,o),a:F,w:$(this).addClass('jqmID'+s),s:s};if(p.trigger)$(this).jqmAddTrigger(p.trigger);});};$.fn.jqmAddClose=function(e){return hs(this,e,'jqmHide');};$.fn.jqmAddTrigger=function(e){return hs(this,e,'jqmShow');};$.fn.jqmShow=function(t){return this.each(function(){t=t||window.event;$.jqm.open(this._jqm,t);});};$.fn.jqmHide=function(t){return this.each(function(){t=t||window.event;$.jqm.close(this._jqm,t)});};$.jqm={hash:{},open:function(s,t){var h=H[s],c=h.c,cc='.'+c.closeClass,z=(parseInt(h.w.css('z-index'))),z=(z>0)?z:3000,o=$('<div></div>').css({height:'100%',width:'100%',position:'fixed',left:0,top:0,'z-index':z-1,opacity:c.overlay/100});if(h.a)return F;h.t=t;h.a=true;h.w.css('z-index',z);if(c.modal){if(!A[0])L('bind');A.push(s);}
else if(c.overlay>0)h.w.jqmAddClose(o);else o=F;h.o=(o)?o.addClass(c.overlayClass).prependTo('body'):F;if(ie6){$('html,body').css({height:'100%',width:'100%'});if(o){o=o.css({position:'absolute'})[0];for(var y in{Top:1,Left:1})o.style.setExpression(y.toLowerCase(),"(_=(document.documentElement.scroll"+y+" || document.body.scroll"+y+"))+'px'");}}
if(c.ajax){var r=c.target||h.w,u=c.ajax,r=(typeof r=='string')?$(r,h.w):$(r),u=(u.substr(0,1)=='@')?$(t).attr(u.substring(1)):u;r.html(c.ajaxText).load(u,function(){if(c.onLoad)c.onLoad.call(this,h);if(cc)h.w.jqmAddClose($(cc,h.w));e(h);});}
else if(cc)h.w.jqmAddClose($(cc,h.w));if(c.toTop&&h.o)h.w.before('<span id="jqmP'+h.w[0]._jqm+'"></span>').insertAfter(h.o);(c.onShow)?c.onShow(h):h.w.show();e(h);return F;},close:function(s){var h=H[s];if(!h.a)return F;h.a=F;if(A[0]){A.pop();if(!A[0])L('unbind');}
if(h.c.toTop&&h.o)$('#jqmP'+h.w[0]._jqm).after(h.w).remove();if(h.c.onHide)h.c.onHide(h);else{h.w.hide();if(h.o)h.o.remove();}return F;},params:{}};var s=0,H=$.jqm.hash,A=[],ie6=$.browser.msie&&($.browser.version=="6.0"),F=false,i=$('<iframe src="javascript:false;document.write(\'\');" class="jqm"></iframe>').css({opacity:0}),e=function(h){if(ie6)if(h.o)h.o.html('<p style="width:100%;height:100%"/>').prepend(i);else if(!$('iframe.jqm',h.w)[0])h.w.prepend(i);f(h);},f=function(h){try{$(':input:visible',h.w)[0].focus();}catch(_){}},L=function(t){$()[t]("keypress",m)[t]("keydown",m)[t]("mousedown",m);},m=function(e){var h=H[A[A.length-1]],r=(!$(e.target).parents('.jqmID'+h.s)[0]);if(r)f(h);return!r;},hs=function(w,t,c){return w.each(function(){var s=this._jqm;$(t).each(function(){if(!this[c]){this[c]=[];$(this).click(function(){for(var i in{jqmShow:1,jqmHide:1})for(var s in this[i])if(H[this[i][s]])H[this[i][s]].w[i](this);return F;});}this[c].push(s);});});};})(jQuery);;(function($){var options={};var returnHash=[];$.fn.RSV=function(params){options=$.extend({},$.fn.RSV.defaults,params);return this.each(function(){$(this).bind('submit',{currForm:this,options:options},$(this).RSV.validate);});};$.fn.RSV.defaults={rules:[],displayType:"alert-all",errorFieldClass:null,errorTextIntro:"Please fix the following error(s) and resubmit:",errorJSItemBullet:"* ",errorHTMLItemBullet:"&bull; ",errorTargetElementId:"rsvErrors",customErrorHandler:null,onCompleteHandler:null};$.fn.RSV.validate=function(event)
{options=event.data.options;var form=event.data.currForm;var rules=options.rules;returnHash=[];for(var i=0;i<rules.length;i++)
{var row=rules[i].replace(/\\,/ig,"%%C%%");row=row.split(",");var satisfiesIfConditions=true;while(row[0].match("^if:"))
{var cond=row[0];cond=cond.replace("if:","");var comparison="equal";var parts=[];if(cond.search("!=")!=-1)
{parts=cond.split("!=");comparison="not_equal";}
else
parts=cond.split("=");var fieldToCheck=parts[0];var valueToCheck=parts[1];var fieldnameValue="";if(form[fieldToCheck].type==undefined)
{for(var j=0;j<form[fieldToCheck].length;j++)
{if(form[fieldToCheck][j].checked)
fieldnameValue=form[fieldToCheck][j].value;}}
else if(form[fieldToCheck].type=="checkbox")
{if(form[fieldToCheck].checked)
fieldnameValue=form[parts[0]].value;}
else
fieldnameValue=form[parts[0]].value;if(comparison=="equal"&&fieldnameValue!=valueToCheck)
{satisfiesIfConditions=false;break;}
else if(comparison=="not_equal"&&fieldnameValue==valueToCheck)
{satisfiesIfConditions=false;break;}
else
row.shift();}
if(!satisfiesIfConditions)
continue;var requirement=row[0];var fieldName=row[1];var fieldName2,fieldName3,errorMessage,lengthRequirements,date_flag;if(requirement!="function"&&form[fieldName]==undefined)
{alert("RSV Error: the field \""+fieldName+"\" doesn't exist! Please check your form and settings.");return false;}
if(requirement!="function"&&options.errorFieldClass)
{if(form[fieldName].type==undefined)
{for(var j=0;j<form[fieldName].length;j++)
{if($(form[fieldName][j]).hasClass(options.errorFieldClass))
$(form[fieldName][j]).removeClass(options.errorFieldClass);}}
else
{if($(form[fieldName]).hasClass(options.errorFieldClass))
$(form[fieldName]).removeClass(options.errorFieldClass);}}
if(row.length==6)
{fieldName2=row[2];fieldName3=row[3];date_flag=row[4];errorMessage=row[5];}
else if(row.length==5)
{fieldName2=row[2];fieldName3=row[3];errorMessage=row[4];}
else if(row.length==4)
{fieldName2=row[2];errorMessage=row[3];}
else
errorMessage=row[2];if(requirement.match("^length"))
{lengthRequirements=requirement;requirement="length";}
if(requirement.match("^range"))
{rangeRequirements=requirement;requirement="range";}
switch(requirement)
{case"required":if(form[fieldName].type==undefined)
{var oneIsChecked=false;for(var j=0;j<form[fieldName].length;j++)
{if(form[fieldName][j].checked)
oneIsChecked=true;}
if(!oneIsChecked)
{if(!processError(form[fieldName],errorMessage))
return false;}}
else if(form[fieldName].type=="select-multiple")
{var oneIsSelected=false;for(var k=0;k<form[fieldName].length;k++)
{if(form[fieldName][k].selected)
oneIsSelected=true;}
if(!oneIsSelected||form[fieldName].length==0)
{if(!processError(form[fieldName],errorMessage))
return false;}}
else if(form[fieldName].type=="checkbox")
{if(!form[fieldName].checked)
{if(!processError(form[fieldName],errorMessage))
return false;}}
else if(!form[fieldName].value)
{if(!processError(form[fieldName],errorMessage))
return false;}
break;case"digits_only":if(form[fieldName].value&&form[fieldName].value.match(/\D/))
{if(!processError(form[fieldName],errorMessage))
return false;}
break;case"letters_only":if(form[fieldName].value&&form[fieldName].value.match(/[^a-zA-Z]/))
{if(!processError(form[fieldName],errorMessage))
return false;}
break;case"is_alpha":if(form[fieldName].value&&form[fieldName].value.match(/\W/))
{if(!processError(form[fieldName],errorMessage))
return false;}
break;case"custom_alpha":var conversion={"L":"[A-Z]","V":"[AEIOU]","l":"[a-z]","v":"[aeiou]","D":"[a-zA-Z]","F":"[aeiouAEIOU]","C":"[BCDFGHJKLMNPQRSTVWXYZ]","x":"[0-9]","c":"[bcdfghjklmnpqrstvwxyz]","X":"[1-9]","E":"[bcdfghjklmnpqrstvwxyzBCDFGHJKLMNPQRSTVWXYZ]"};var reg_exp_str="";for(var j=0;j<fieldName2.length;j++)
{if(conversion[fieldName2.charAt(j)])
reg_exp_str+=conversion[fieldName2.charAt(j)];else
reg_exp_str+=fieldName2.charAt(j);}
var reg_exp=new RegExp(reg_exp_str);if(form[fieldName].value&&reg_exp.exec(form[fieldName].value)==null)
{if(!processError(form[fieldName],errorMessage))
return false;}
break;case"reg_exp":var reg_exp_str=fieldName2.replace(/%%C%%/ig,",");if(row.length==5)
var reg_exp=new RegExp(reg_exp_str,fieldName3);else
var reg_exp=new RegExp(reg_exp_str);if(form[fieldName].value&&reg_exp.exec(form[fieldName].value)==null)
{if(!processError(form[fieldName],errorMessage))
return false;}
break;case"length":comparison_rule="";rule_string="";if(lengthRequirements.match(/length=/))
{comparison_rule="equal";rule_string=lengthRequirements.replace("length=","");}
else if(lengthRequirements.match(/length>=/))
{comparison_rule="greater_than_or_equal";rule_string=lengthRequirements.replace("length>=","");}
else if(lengthRequirements.match(/length>/))
{comparison_rule="greater_than";rule_string=lengthRequirements.replace("length>","");}
else if(lengthRequirements.match(/length<=/))
{comparison_rule="less_than_or_equal";rule_string=lengthRequirements.replace("length<=","");}
else if(lengthRequirements.match(/length</))
{comparison_rule="less_than";rule_string=lengthRequirements.replace("length<","");}
switch(comparison_rule)
{case"greater_than_or_equal":if(!(form[fieldName].value.length>=parseInt(rule_string)))
{if(!processError(form[fieldName],errorMessage))
return false;}
break;case"greater_than":if(!(form[fieldName].value.length>parseInt(rule_string)))
{if(!processError(form[fieldName],errorMessage))
return false;}
break;case"less_than_or_equal":if(!(form[fieldName].value.length<=parseInt(rule_string)))
{if(!processError(form[fieldName],errorMessage))
return false;}
break;case"less_than":if(!(form[fieldName].value.length<parseInt(rule_string)))
{if(!processError(form[fieldName],errorMessage))
return false;}
break;case"equal":var range_or_exact_number=rule_string.match(/[^_]+/);var fieldCount=range_or_exact_number[0].split("-");if(fieldCount.length==2)
{if(form[fieldName].value.length<fieldCount[0]||form[fieldName].value.length>fieldCount[1])
{if(!processError(form[fieldName],errorMessage))
return false;}}
else
{if(form[fieldName].value.length!=fieldCount[0])
{if(!processError(form[fieldName],errorMessage))
return false;}}
break;}
break;case"valid_email":if(form[fieldName].value&&!isValidEmail(form[fieldName].value))
{if(!processError(form[fieldName],errorMessage))
return false;}
break;case"valid_date":var isLaterDate=false;if(date_flag=="later_date")
isLaterDate=true;else if(date_flag=="any_date")
isLaterDate=false;if(!isValidDate(form[fieldName].value,form[fieldName2].value,form[fieldName3].value,isLaterDate))
{if(!processError(form[fieldName],errorMessage))
return false;}
break;case"same_as":if(form[fieldName].value!=form[fieldName2].value)
{if(!processError(form[fieldName],errorMessage))
return false;}
break;case"range":comparison_rule="";rule_string="";if(rangeRequirements.match(/range=/))
{comparison_rule="equal";rule_string=rangeRequirements.replace("range=","");}
else if(rangeRequirements.match(/range>=/))
{comparison_rule="greater_than_or_equal";rule_string=rangeRequirements.replace("range>=","");}
else if(rangeRequirements.match(/range>/))
{comparison_rule="greater_than";rule_string=rangeRequirements.replace("range>","");}
else if(rangeRequirements.match(/range<=/))
{comparison_rule="less_than_or_equal";rule_string=rangeRequirements.replace("range<=","");}
else if(rangeRequirements.match(/range</))
{comparison_rule="less_than";rule_string=rangeRequirements.replace("range<","");}
switch(comparison_rule)
{case"greater_than_or_equal":if(!(form[fieldName].value>=Number(rule_string)))
{if(!processError(form[fieldName],errorMessage))
return false;}
break;case"greater_than":if(!(form[fieldName].value>Number(rule_string)))
{if(!processError(form[fieldName],errorMessage))
return false;}
break;case"less_than_or_equal":if(!(form[fieldName].value<=Number(rule_string)))
{if(!processError(form[fieldName],errorMessage))
return false;}
break;case"less_than":if(!(form[fieldName].value<Number(rule_string)))
{if(!processError(form[fieldName],errorMessage))
return false;}
break;case"equal":var rangeValues=rule_string.split("-");if((form[fieldName].value<Number(rangeValues[0]))||(form[fieldName].value>Number(rangeValues[1])))
{if(!processError(form[fieldName],errorMessage))
return false;}
break;}
break;case"function":custom_function=fieldName;eval("var result = "+custom_function+"()");if(result.constructor.toString().indexOf("Array")!=-1)
{for(var j=0;j<result.length;j++)
{if(!processError(result[j][0],result[j][1]))
return false;}}
break;default:alert("Unknown requirement flag in validateFields(): "+requirement);return false;}}
if(typeof options.customErrorHandler=='function')
return options.customErrorHandler(form,returnHash);else if(options.displayType=="alert-all")
{var errorStr=options.errorTextIntro+"\n\n";for(var i=0;i<returnHash.length;i++)
{errorStr+=options.errorJSItemBullet+returnHash[i][1]+"\n";styleField(returnHash[i][0],i==0);}
if(returnHash.length>0)
{alert(errorStr);return false;}}
else if(options.displayType=="display-html")
{var success=displayHTMLErrors(form,returnHash);if(!success)
return false;}
if(typeof options.onCompleteHandler=='function')
return options.onCompleteHandler();else
return true;}
function processError(obj,message)
{message=message.replace(/%%C%%/ig,",");var continueProcessing=true;switch(options.displayType)
{case"alert-one":alert(message);styleField(obj,true);continueProcessing=false;break;case"alert-all":case"display-html":returnHash.push([obj,message]);break;}
return continueProcessing;}
function displayHTMLErrors(f,errorInfo)
{var errorHTML=options.errorTextIntro+"<br /><br />";for(var i=0;i<errorInfo.length;i++)
{errorHTML+=options.errorHTMLItemBullet+errorInfo[i][1]+"<br />";styleField(errorInfo[i][0],i==0);}
if(errorInfo.length>0)
{$("#"+options.errorTargetElementId).css("display","block");$("#"+options.errorTargetElementId).html(errorHTML);return false;}
return true;}
function styleField(field,focus)
{if(field.type==undefined)
{if(focus)
field[0].focus();for(var i=0;i<field.length;i++)
{if(!$(field[i]).hasClass(options.errorFieldClass))
$(field[i]).addClass(options.errorFieldClass);}}
else
{if(options.errorFieldClass)
$(field).addClass(options.errorFieldClass);if(focus)
field.focus();}}
function isValidEmail(str)
{var s=$.trim(str);var at="@";var dot=".";var lat=s.indexOf(at);var lstr=s.length;var ldot=s.indexOf(dot);if(s.indexOf(at)==-1||(s.indexOf(at)==-1||s.indexOf(at)==0||s.indexOf(at)==lstr)||(s.indexOf(dot)==-1||s.indexOf(dot)==0||s.indexOf(dot)==lstr)||(s.indexOf(at,(lat+1))!=-1)||(s.substring(lat-1,lat)==dot||s.substring(lat+1,lat+2)==dot)||(s.indexOf(dot,(lat+2))==-1)||(s.indexOf(" ")!=-1))
{return false;}
return true;}
function isValidDate(month,day,year,isLaterDate)
{var daysInMonth;if((year%4==0)&&((year%100!=0)||(year%400==0)))
daysInMonth=[31,29,31,30,31,30,31,31,30,31,30,31];else
daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31];if(!month||!day||!year)return false;if(1>month||month>12)return false;if(year<0)return false;if(1>day||day>daysInMonth[month-1])return false;if(isLaterDate)
{var today=new Date();var currMonth=today.getMonth()+1;var currDay=today.getDate();var currYear=today.getFullYear();if(String(currMonth).length==1)currMonth="0"+currMonth;if(String(currDay).length==1)currDay="0"+currDay;var currDate=String(currYear)+String(currMonth)+String(currDay);if(String(month).length==1)month="0"+month;if(String(day).length==1)day="0"+day;incomingDate=String(year)+String(month)+String(day);if(Number(currDate)>Number(incomingDate))
return false;}
return true;}})(jQuery);;function createCookie(name,value,days){if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));var expires="; expires="+date.toGMTString();}
else var expires="";document.cookie=name+"="+value+expires+"; path=/";}
function msieversion(){var rv=-1;if(navigator.appName=='Microsoft Internet Explorer')
{var ua=navigator.userAgent;var re=new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");if(re.exec(ua)!=null)
rv=parseFloat(RegExp.$1);}
else if(navigator.appName=='Netscape')
{var ua=navigator.userAgent;var re=new RegExp("Trident/.*rv:([0-9]{1,}[\.0-9]{0,})");if(re.exec(ua)!=null)
rv=parseFloat(RegExp.$1);}
return(rv!=-1);}
function readCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length);}
return null;}
var showZoomImage=0;var showZoomImageInterval='';function openFancyZoom(elemID){clickFancyZoom($('#'+elemID));}
function clickFancyZoom(obj){var href=$(obj).attr('href');$('#zoomImageBigContainer .tdContent img').attr('src',href);$('body,html').scrollTo({top:0,left:0}).css('overflow','hidden');if(showZoomImage){openZoomImageFct();return false;}else{showZoomImageInterval=setInterval('openZoomImageFct()',100);return false;}}
function openZoomImageFct(){if(showZoomImage){showZoomImageFct();}}
function showZoomImageFct(){var width=$(window).width();var height=$(window).height();var widthImg=$('#zoomImageBigContainer').width();var heightImg=$('#zoomImageBigContainer').height();if(width<widthImg||height<heightImg){var ratioHeight=height/heightImg;var ratioWidth=width/widthImg;if(ratioHeight>ratioWidth){$('#zoomImageBigContainer img').width((width-40)+'px');}else{$('#zoomImageBigContainer img').height((height-40)+'px');}
widthImg=$('#zoomImageBigContainer').width();heightImg=$('#zoomImageBigContainer').height();width=$(window).width();height=$(window).height();}
$('#zoomImageBigContainer').css('top',(height-heightImg)/2);$('#zoomImageBigContainer').css('left',(width-widthImg)/2);$('#zoomImageBigContainer').css('display','none').removeClass('zoomImageHide');$('#zoomImageBigContainer').slideDown('slow');showZoomImage=0;clearInterval(showZoomImageInterval);return false;}
function allowOnlyNumbers(evt){evt=(evt)?evt:window.event;var charCode=(evt.which)?evt.which:evt.keyCode;var allowed=[35,36,37,39,46];if(charCode>31&&(charCode<48||charCode>57)){if($.inArray(charCode,allowed)!=-1){return true;}
if(charCode>=96&&charCode<=105){return true;}
return false;}
return true;}
function validateOnlyNumbers(obj,evt){var value=parseInt(obj.val());if(isNaN(value)){obj.val('');}
else
obj.val(value);}
function weeblyapp_js_init(){$('body').addClass('body_weebly_app');if($('body #logo_index a').length){$('body #logo_index a').attr('href','#');}
if($('body #logo a').length){$('body #logo a').attr('href','#');}}
function submit_1and1_page_height(){console.log('iframe_height sent: '+$('body').height());var height=$('body').height()+20;if(height<50){if($('.logos_background_page').length){height=$('.logos_background_page').height();}}
window.parent.postMessage(height,'*');}
function onElementHeightChange(elm,callback){var lastHeight=elm.clientHeight,newHeight;(function run(){newHeight=elm.clientHeight;if(lastHeight!=newHeight)
callback();lastHeight=newHeight;if(elm.onElementHeightChangeTimer)
clearTimeout(elm.onElementHeightChangeTimer);elm.onElementHeightChangeTimer=setTimeout(run,200);})();}
function fls_init_body_classes(){if(typeof Drupal.settings.body_classes=='object'){$.each(Drupal.settings.body_classes,function(k,v){if(typeof v=='string'){$('body').addClass(v);}});}
else if(typeof Drupal.settings.body_classes=='string'){$('body').addClass(Drupal.settings.body_classes);}}
function lazyload_init(){lazyload_check();$(window).scroll(lazyload_check);}
function lazyload_check(){if($('.lazyload').length<1)return;var window_bottom=$(window).scrollTop()+$(window).height();$('.lazyload').each(function(){var div_top=$(this).offset().top;if(div_top>0&&div_top<=window_bottom+200){lazyload_process(this);}});}
function lazyload_process(o){$(o).one('load',function(){$(o).removeClass('lazyload')}).attr('src',$(o).attr('data-src')).removeAttr('data-lazy');if($(o).attr('data-class')){$(o).removeClass('lazyload').addClass($(o).attr('data-class'));}}
$(document).ready(function(){lazyload_init();$('input,textarea').each(function(){if($(this).prop('required')){$(this).on('invalid',function(){this.setCustomValidity(Drupal.settings.please_fill_in);});$(this).on('input',function(){this.setCustomValidity('');});}});fls_init_body_classes();$('.fls-auto-resize-text').autoTextSizeFls();if(self!=top){setTimeout(function(){submit_1and1_page_height();onElementHeightChange($('body')[0],submit_1and1_page_height);},500);}
if(typeof Drupal.settings.weeblyapp_flow!='undefined'){if(Drupal.settings.weeblyapp_flow){weeblyapp_js_init();}}
$('.radio_mic').mousedown(function(){ga('send','event','Podcast','Click','Podcast microphone');});$('.sizeIsNumber').keydown(function(evt){return allowOnlyNumbers(evt);});$('.sizeIsNumber').change(function(evt){return validateOnlyNumbers($(this),evt);});Drupal.settings.jqm_url='';var language='';if(Drupal.settings.lang!='en'){language='/'+Drupal.settings.lang;}
if(Drupal.settings.baseUrl.indexOf('https')>=0){Drupal.settings.jqm_url=language+'/jqm/secure/';}
else Drupal.settings.jqm_url=language+'/jqm/ajax/';$('#edit-submit').css('display','inline-block');if($("#step4_special_offer3").length==0)
$('#edit-submit').click(function(){if($('#user-pass').length>0)$('#user-pass').submit();if($('#user-login').length>0)$('#user-login').submit();})
if($('a.highslide').length>0){$.ajax({url:'jqm/template',success:function(Response){$('body').append('<div class="zoomImageHide" id="zoomImageBigContainer">'+Response+'</div>');$('#zoomImageBigContainer .tdContent').css('width','auto').css('height','auto').append('<img src="#" />');$('#zoomImageBigContainer .tdContent img').click(function(){$('#zoomImageBigContainer').slideUp('slow',function(){$(this).addClass('zoomImageHide').css('display','');$('body,html').css('overflow','');$('#zoomImageBigContainer img').width('auto');$('#zoomImageBigContainer img').height('auto');});}).bind('load',function(){$('#zoomImageBigContainer').css('display','none').removeClass('zoomImageHide');showZoomImage=1;});}});}
$('a.highslide').click(function(){clickFancyZoom(this);return false;});try{if($('#spam_free_policy_terms_and_cond').length){var positionTAC1=$('#spam_free_policy_terms_and_cond').offset();var leftTAC1=positionTAC1.left;var topTAC1=positionTAC1.top;$('#terms_and_conditions_container').css('top',topTAC1-5-$('#terms_and_conditions_container').height());$('#terms_and_conditions_container').css('left',leftTAC1-($('#terms_and_conditions_container').width()/2));}
if($('.protect_privacy').length){var positionTAC4=$('.logo_creator_protect_privacy').offset();var leftTAC4=positionTAC4.left;var topTAC4=positionTAC4.top;$('#privacy_policy_container').css('top',topTAC4-100);$('#privacy_policy_container').css('left',leftTAC4-($('#privacy_policy_container').width()/2));var privacyObj=$('#privacy_policy_container');$('#privacy_policy_container').remove();$('body').append(privacyObj);}
if($('#terms_and_conditions_general_container').length){var positionTAC2=$('#terms_and_cond').offset();var leftTAC2=positionTAC2.left;var topTAC2=positionTAC2.top;$('#terms_and_conditions_general_container').css('top',topTAC2-5-$('#terms_and_conditions_general_container').height());$('#terms_and_conditions_general_container').css('left',leftTAC2-($('#terms_and_conditions_general_container').width()/2));}
if($('#privacy_policy_general_container').length){var positionTAC3=$('#privacy_modal').offset();var leftTAC3=positionTAC3.left;var topTAC3=positionTAC3.top;$('#privacy_policy_general_container').css('top',topTAC3-5-$('#privacy_policy_general_container').height());$('#privacy_policy_general_container').css('left',leftTAC3-($('#privacy_policy_general_container').width()/2));}}catch(err){}
$('#edit-logo-type').click(function(){$('#edit-logo-type').addClass('highlight_field');}).bind('mouseout',function(){$('#edit-logo-type').removeClass('highlight_field');});$('#edit-logo-type option').bind('mouseover',function(){$('#edit-logo-type').addClass('highlight_field');});$('#edit-country').click(function(){$('#edit-country').addClass('highlight_field');}).bind('mouseout',function(){$('#edit-country').removeClass('highlight_field');});$('#edit-country option').bind('mouseover',function(){$('#edit-country').addClass('highlight_field');});$('.tooltipspan').tooltip({track:true,delay:0,showURL:false,showBody:" - ",fade:250});$('#spam_free_policy, .index5v2_why a:first').each(function(){var text=$(this).attr('title');if(text==undefined||!text){var classname=$(this).attr('class');if(!classname)classname=$(this).parent().attr('class');var text=$('.'+classname+'_hover').html();text=text.replace('<a href="#">','');}
if(text!=undefined&&text){$(this).attr('textattr',text);$(this).attr('title','');}}).click(function(){$('#tooltip').remove();var text=$(this).attr('textattr');if(text==undefined||!text)return false;var pos=$(this).offset();var width=$(this).width();pos.left+=width+5;$('body').append('<div style="max-width:300px;top:'+pos.top+'px;left:'+pos.left+'px;" id="tooltip" class="viewport-right"><a href="#" style="position:absolute;right:5px;top:1px;text-decoration:none;" class="tooltip-closex">&#10006;</a><p style="padding:5px;" class="tooltip-text">'+text+'</p></div>');$('#tooltip a.tooltip-closex').click(function(){$('#tooltip').remove();return false;});return false;});$('#spam_free_policy_why_phone').tooltip({track:true,delay:0,showURL:false,showBody:" - ",fade:250});$('#spam_free_policy_terms_and_cond,#terms_and_cond,.spam_free_policy_terms_and_cond').click(function(){var language='';if(Drupal.settings.lang){language='/'+Drupal.settings.lang;}
window.open(language+'/terms');return false;});$('#privacy_modal,.protect_privacy').click(function(){var language='';if(Drupal.settings.lang){language='/'+Drupal.settings.lang;}
window.open(language+'/privacy');return false;});if($("#step4_special_offer3").length==0)
$('#step-1-form #edit-submit').click(function(){additionalErrorHTML="";$("#rsvErrors").html("").css('display','none');var errorHTML=Drupal.settings.step_1_form.form_header_error;if($('input[name="logo_first_line"]').val()==""){additionalErrorHTML+=Drupal.settings.step_1_form.logo_first_line.required;$('input[name="logo_first_line"]').addClass('errorFieldDemo5');$('#logo_first_line_label').addClass('signup_error_label');$('#logo_first_line_error_icon').show();}else{$('input[name="logo_first_line"]').removeClass('errorFieldDemo5');$('#logo_first_line_label').removeClass('signup_error_label');$('#logo_first_line_error_icon').hide();}
if(Drupal.settings.logocategory_split_set==2){if($('#edit-logo-type').val()=="-1"){additionalErrorHTML+=Drupal.settings.step_1_form.logo_type.invalid;$('#edit-logo-type').addClass('errorFieldDemo5');fls_events_add('error_msg_not_selecting_logo_category',1);}
else{$('#edit-logo-type').removeClass('errorFieldDemo5');}}
if($('input[name="first_name"]').val()==""){additionalErrorHTML+=Drupal.settings.step_1_form.first_name.required;$('input[name="first_name"]').addClass('errorFieldDemo5');$('#logo_first_name_label').addClass('signup_error_label');$('#logo_first_name_error_icon').show();}else{$('input[name="first_name"]').removeClass('errorFieldDemo5');$('#logo_first_name_label').removeClass('signup_error_label');$('#logo_first_name_error_icon').hide();}
if($('input[name="last_name"]').val()==""){additionalErrorHTML+=Drupal.settings.step_1_form.last_name.required;"&#8226;&nbsp;<strong>Last Name:</strong> Required information<br />";$('input[name="last_name"]').addClass('errorFieldDemo5');$('#logo_last_name_label').addClass('signup_error_label');$('#logo_last_name_error_icon').show();}else{$('input[name="last_name"]').removeClass('errorFieldDemo5');$('#logo_last_name_label').removeClass('signup_error_label');$('#logo_last_name_error_icon').hide();}
if($('input[name="phone"]').val()==""){additionalErrorHTML+=Drupal.settings.step_1_form.phone.required;$('input[name="phone"]').addClass('errorFieldDemo5');$('#phone_label').addClass('signup_error_label');$('#phone_error_icon').show();}else{if(!validate_phone_function($('input[name="phone"]').val())){additionalErrorHTML+=Drupal.settings.step_1_form.phone.invalid;$('input[name="phone"]').addClass('errorFieldDemo5');$('#phone_label').addClass('signup_error_label');$('#phone_error_icon').show();}else{$('input[name="phone"]').removeClass('errorFieldDemo5');$('#phone_label').removeClass('signup_error_label');$('#phone_error_icon').hide();}}
var emailValid=1;$('input[name="email"]').removeClass('errorFieldDemo5');$('#email_label').removeClass('signup_error_label');$('#email_error_icon').hide();if($('input[name="email"]').length){if($('input[name="email"]').val()==""){emailValid=0;additionalErrorHTML+=Drupal.settings.step_1_form.email.required;$('input[name="email"]').addClass('errorFieldDemo5');$('#email_label').addClass('signup_error_label');$('#email_error_icon').show();}else{if(!isValidEmail($('input[name="email"]').val())){emailValid=0;additionalErrorHTML+=Drupal.settings.step_1_form.email.invalid;$('input[name="email"]').addClass('errorFieldDemo5');$('#email_label').addClass('signup_error_label');$('#email_error_icon').show();}}}
$('input[name="confirm_email"]').removeClass('errorFieldDemo5');$('#confirm_email_label').removeClass('signup_error_label');$('#confirm_email_error_icon').hide();if($('input[name="email"]').length&&$('input[name="confirm_email"]').length){if($('input[name="confirm_email"]').val()==""){additionalErrorHTML+=Drupal.settings.step_1_form.confirm_email.required;$('input[name="confirm_email"]').addClass('errorFieldDemo5');$('#confirm_email_label').addClass('signup_error_label');$('#confirm_email_error_icon').show();}else{if($.trim($('input[name="confirm_email"]').val().toLowerCase())!=$.trim($('input[name="email"]').val().toLowerCase())){additionalErrorHTML+=Drupal.settings.step_1_form.confirm_email.not_confirm;$('input[name="confirm_email"]').addClass('errorFieldDemo5');$('#confirm_email_label').addClass('signup_error_label');$('#confirm_email_error_icon').show();}}}
if(!$('input[name="agree_terms"]').is(':checked')&&!Drupal.settings.terms_acceptance_set){additionalErrorHTML+=Drupal.settings.step_1_form.agree_terms.required;$('input[name="agree_terms"]').addClass('errorFieldDemo5');$('#edit-agree-terms-wrapper label').addClass('signup_error_label');$("label[for='index5_agree_terms']").addClass('signup_error_label');$('#termd_and_conditions_error_icon').show();}else{$('input[name="agree_terms"]').removeClass('errorFieldDemo5');$('#edit-agree-terms-wrapper label').removeClass('signup_error_label');$("label[for='index5_agree_terms']").removeClass('signup_error_label');$('#termd_and_conditions_error_icon').hide();}
if(!$('input[name="agree_privacy"]').is(':checked')){additionalErrorHTML+=Drupal.settings.step_1_form.agree_privacy.required;$('input[name="agree_privacy"]').addClass('errorFieldDemo5');$('#edit-agree-privacy-wrapper label').addClass('signup_error_label');$("label[for='index5_agree_privacy']").addClass('signup_error_label');$('#privacy_and_policy_error_icon').show();}else{$('input[name="agree_privacy"]').removeClass('errorFieldDemo5');$('#edit-agree-privacy-wrapper label').removeClass('signup_error_label');$("label[for='index5_agree_privacy']").removeClass('signup_error_label');$('#privacy_and_policy_error_icon').hide();}
if(additionalErrorHTML){errorHTML+=additionalErrorHTML;$("#rsvErrors").css("display","block");$("#rsvErrors").html(errorHTML);return false;}
var user_country=$('#edit-country option:selected').val();$('#step-1-form').submit();});$('#step-1-form').bind('submit',function(){if(typeof stop_duplicate_form_submit!=='undefined')return false;else stop_duplicate_form_submit=true;});$('.product_buynow').click(function(){var id=$(this).attr('id');if(id){id=id.split('_');if(!(id[1]>0))
return true;}
if($(this).hasClass('similar_tpl')){fls_store_promo_product_similar_tpl_click_direct_save(this);}
else
fls_store_promo_product_click_direct_save(this);if(id)return false;});if(typeof(Drupal.settings.ismobile)!='undefined'){if(Drupal.settings.ismobile){$('.menu_element .menu_item a').click(function(){return false;})}}
extra_class="";if(Drupal.settings.term_update_message)extra_class="term_notify_msg";if(Drupal.settings.hurricane_message_show)extra_class="hurricane_msg";if(Drupal.settings.temporary_special_message_show)extra_class="temporary_special_msg";if(typeof(Drupal.settings.coupon_message)!='undefined'&&window===window.parent){if(Drupal.settings.show_coupon_banner&&Drupal.settings.term_update_message){$('body').append('<div class="banner_container"><div class="coupon-message"><span class="coupon-message-icon"><span class="msg">'+Drupal.settings.coupon_message+'</span><span class="close"></span></div><div class="coupon-message '+extra_class+'"><span class="msg">'+Drupal.settings.term_notification_message+'</span></span><span class="close"></span></div></div>');$('body').removeClass('body-coupon-message');$('body').addClass('body-term-message');}else if(Drupal.settings.show_coupon_banner&&Drupal.settings.hurricane_message_show){$('body').append('<div class="banner_container"><div class="coupon-message"><span class="coupon-message-icon"><span class="msg">'+Drupal.settings.coupon_message+'</span><span class="close"></span></div><div class="coupon-message '+extra_class+'"><span class="msg">'+Drupal.settings.hurricane_message+'</span></span><span class="close"></span></div></div>');$('body').removeClass('body-coupon-message');$('body').addClass('body-term-message');}else if(Drupal.settings.show_coupon_banner&&Drupal.settings.temporary_special_message_show){$('body').append('<div class="banner_container"><div class="coupon-message"><span class="coupon-message-icon"><span class="msg">'+Drupal.settings.coupon_message+'</span><span class="close"></span></div><div class="coupon-message '+extra_class+'"><span class="msg">'+Drupal.settings.temporary_special_message+'</span></span><span class="close"></span></div></div>');$('body').removeClass('body-coupon-message');$('body').addClass('body-term-message');}else{$('body').append('<div class="coupon-message '+extra_class+'"><span class="coupon-message-icon"><span class="msg">'+Drupal.settings.coupon_message+'</span></span><span class="close"></span></div>');$('body').removeClass('body-term-message');$('body').addClass('body-coupon-message');}
$('.holiday-time-banner').hide();$('.covid19-banner').hide();}
$('.coupon-message .hurricane_info').click(function(e){e.preventDefault();alert(Drupal.settings.hurricane_message_info);return false;});$('.holiday-time-banner .close-holiday-time').click(function(e){e.preventDefault();fls_replace_cookie_with_session('holiday_card_hide',1);$('.holiday-time-banner').slideUp('fast');return false;});$('.ada_banner .close-ada-banner').click(function(e){e.preventDefault();fls_replace_cookie_with_session('adabanner_hide',1);$('.ada_banner').slideUp('fast');return false;});$('.covid19-banner .close-covid19').click(function(e){e.preventDefault();fls_replace_cookie_with_session('covid19_hide',1);$('.covid19-banner').slideUp('fast');return false;});$('.coupon-message span.close').click(function(){if($(this).parent().hasClass('domain')){$('.coupon-message.domain').remove();fls_replace_cookie_with_session('coupon_message',null);}else if($(this).parent().hasClass('term_notify_msg')){$('.coupon-message.term_notify_msg').remove();fls_replace_cookie_with_session('close_notification_bar',1);}else if($(this).parent().hasClass('hurricane_msg')){$('.coupon-message.hurricane_msg').remove();fls_replace_cookie_with_session('hurricane_message',1);}else if($(this).parent().hasClass('temporary_special_msg')){$('.coupon-message.temporary_special_msg').remove();fls_replace_cookie_with_session('temporary_special_msg',1);}else{$('.coupon-message:not(.term_notify_msg, .hurricane_msg, .domain, .temporary_special_msg)').remove();fls_replace_cookie_with_session('coupon_message',null);}
if(Drupal.settings.term_update_message){if($('body').hasClass('body-term-message')){$('body').removeClass('body-term-message');$('body').addClass('body-coupon-message');}else $('body').removeClass('body-coupon-message');}else $('body').removeClass('body-coupon-message');fls_banner_message_resize();});fls_banner_message_resize();fls_logo_global_leavebehind_init();$('.popup_css_container a.close').click(function(e){e.preventDefault();$('.popup_css_overlay').hide();$('.popup_css').hide();return false;});$('.popup_css_showonready').show();fls_products_also_viewed();fls_password_expired_disable_all_links();});function fls_replace_cookie_with_session(name,value){var data_send={};if(value===null)value='flsUnsetCookieNull';data_send[name]=value;$.ajax({url:Drupal.settings.baseUrl+'/cookie-session-replacement',type:"POST",data:data_send,dataType:"json",success:function(response){}});}
function fls_password_expired_disable_all_links(){if($('.password_expired_disable_all_links').length==1){$('.custom_header, #custom_footer').append('<div class="fls_password_expired_overlay"></div>').css('position','relative');$('#admin-menu').remove();}}
function fls_store_promo_product_similar_tpl_click_direct_save(obj){var id=$(obj).attr('id');if(id){id=id.split('_');fls_store_promo_product_similar_tpl_direct_save(id[1],id[2],id[3],id[4]);return false;}}
function fls_store_promo_product_click_direct_save(obj){var id=$(obj).attr('id');if(id){id=id.split('_');fls_store_promo_product_direct_save(id[1],id[2],id[3]);return false;}}
var additionalErrorHTML;function fls_track_title_page(){var v=$.cookie('track_title_page');var vg=Drupal.settings.track_title_page;var path=Drupal.settings.fls_path;path=path.split('/');var p=$.cookie('fls_check_plugin');var flash='';var java='';var referrer='';if(p=='1'){flash=PluginDetect.getVersion('flash');java='';}
if(p){var title=$('head title').text();var head_title=$.cookie('head_title');if(head_title=='1'){$.cookie('head_title',title);}
$.ajax({url:Drupal.settings.baseUrl+'/track-title-page',type:"POST",data:({title:title,flash:flash,java:java,referrer:referrer}),dataType:"json",success:function(msg){$('#edit-country').val(msg['country_data']['country_id']);$('#edit-country').trigger('change');}});}}
function isValidEmail(str)
{var re=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return str.match(re);}
function validate_phone_function(){if(!$('#edit-phone').length)return true;var phone=document.getElementById("edit-phone").value;var country_id=$('#edit-country').val();if(country_id=='1'||country_id=='2'||country_id=='01'||country_id=='02'){var regexpn1=/^[-+.()_xX0-9 ]+$/;}else{var regexpn1=/^[-+.()_xX0-9 \/]+$/;}
var regexpn3=/([0]{7}|[1]{7}|[2]{7}|[3]{7}|[4]{7}|[5]{7}|[6]{7}|[7]{7}|[8]{7}|[9]{7})/;var valid=false;if(phone.match(regexpn1)){valid=true;}else{valid=false;}
if(valid){var count=0;for(var i=0;i<phone.length;i++){var c=parseInt(phone.charAt(i));if(c>=0&&c<=9){count++;}}
if(country_id=='1'||country_id=='2'||country_id=='01'||country_id=='02'){if(count<10||count>11){valid=false;}}else if(country_id=='50'){if(count<7||count>15){valid=false;}}else{if(count<8||count>15){valid=false;}}
if(phone=='555-1212'||phone.indexOf('555-1212')>=0)valid=false;if(phone.match(regexpn3))valid=false;}
return valid;}
function validate_phone(phone){if(!phone)return true;var country_id=$('#edit-country').val();if(country_id=='1'||country_id=='2'||country_id=='01'||country_id=='02'){var regexpn1=/^[-+.()_xX0-9 ]+$/;}else{var regexpn1=/^[-+.()_xX0-9 \/]+$/;}
var regexpn3=/([0]{7}|[1]{7}|[2]{7}|[3]{7}|[4]{7}|[5]{7}|[6]{7}|[7]{7}|[8]{7}|[9]{7})/;var valid=false;if(phone.match(regexpn1)){valid=true;}else{valid=false;}
if(valid){var count=0;for(var i=0;i<phone.length;i++){var c=parseInt(phone.charAt(i));if(c>=0&&c<=9){count++;}}
if(country_id=='1'||country_id=='2'||country_id=='01'||country_id=='02'){if(count<10||count>11){valid=false;}}else if(country_id=='50'){if(count<7||count>15){valid=false;}}else{if(count<8||count>15){valid=false;}}
if(phone=='555-1212'||phone.indexOf('555-1212')>=0)valid=false;if(phone.match(regexpn3))valid=false;}
return valid;}
function fls_validate_domain(domain){if(!domain)
return false;var re=new RegExp(/^(([a-zA-Z]{1})|([a-zA-Z]{1}[a-zA-Z]{1})|([a-zA-Z]{1}[0-9]{1})|([0-9]{1}[a-zA-Z]{1})|([a-zA-Z0-9][a-zA-Z0-9-_]{1,61}[a-zA-Z0-9]))\.([a-zA-Z]{2,6}|[a-zA-Z0-9-]{2,30}\.[a-zA-Z]{2,3})$/);return domain.match(re);}
function loadPageAfterLogin(){window.location='mylogos';}
function clickPopupsListen(){$('#popups .popups_login_forgot a').click(function(){var element=$('.popups_login_forgot a');var options={'href':element.attr('href'),'onComplete':'clickPopupsListen'};options.noUpdate=1;switch(element.attr('class')){case'forgot_password_modal':options.forceReturn='user/notice/reset';options.hideResult=0;break;case'login_modal':options.forceReturn='mylogos';options.afterSubmit='loadPageAfterLogin';break;default:break;}
Drupal.popups.close();Drupal.popups.openPath(element,options);return false;});}
function jqm_calculate_position(link,container){var offset=$(link).offset();var top=offset.top-5-320;var left=offset.left-(360/2);if(top<0)top=0;if(left<0)left=0;$(container).css('top',top);$(container).css('left',left);}
function printPT(){$('#printPage').click(function(){var className=$(this).attr('class');var content=$('.WordSection1').html();window.open(Drupal.settings.baseUrl+'/jqm/print/'+className,'','width=600, height=400,scrollbars=1');return false;});}
function fls_email_exist_redirect(){var language='';var destination='';if(Drupal.settings.lang!='en')language='/'+Drupal.settings.lang;if(Drupal.settings.destination!=undefined){destination='?destination='+Drupal.settings.destination;}
window.location=Drupal.settings.baseUrl+language+'/user/login'+destination;}
function store_format_price(price,country_id,currency){var price_as_text='';var price_as_text=price.toFixed(2);if(currency){switch(country_id){case 0:case 1:default:price_as_text=currency+price_as_text;break;}}else{switch(country_id){case 0:case 1:default:break;}}
return price_as_text;}
function fls_store_step3_track(editor_version){window.onbeforeunload=null;}
function fls_store_promo_product_similar_tpl_direct_save(lid,editor,product_id,tpl_id){show_loading_overlay();var base_url=Drupal.settings.baseUrl;if(Drupal.settings.lang&&Drupal.settings.lang!='en'){base_url+='/'+Drupal.settings.lang;}
var base_url_nossl=base_url.replace('https://','http://');var url='';var isHttps=Drupal.settings.baseUrl.indexOf('https://');if(isHttps==-1){base_url=base_url_nossl;url+=base_url+'/product/directsave/'+lid+'/'+editor+'/'+tpl_id;}else{url+=base_url+'/product/directsave/ssl/'+lid+'/'+editor+'/'+tpl_id;}
if(product_id==36&&Drupal.settings.upsell_country=='US'){window.location=base_url+'/pens';return false;}
$.ajax({url:url,dataType:"json",success:function(Response){if(Response.success=='1'){var url=base_url;var lds='';if($('#lds').length){if($('#lds').val()==1){lds='&lds=1';}}
url+='/product/options/'+product_id+'?lid='+Response['lid']+lds;window.location=url;}else{if(Response.success=='0'&&Response.errcode==-1){window.location=base_url+$('#promo_'+lid+'_'+editor+'_'+product_id).attr('href');return;}
if($('#TB_load').length){if(typeof Drupal.settings.storage_failed_message!='undefined'){$('#TB_load p').html(Drupal.settings.storage_failed_message);$('#TB_load p .refresh_page').click(function(e){e.preventDefault();location.reload();return false;});}}}}});return false;}
function fls_store_promo_product_direct_save(lid,editor,product_id){show_loading_overlay();var base_url=Drupal.settings.baseUrl;if(Drupal.settings.lang&&Drupal.settings.lang!='en'){base_url+='/'+Drupal.settings.lang;}
var base_url_nossl=base_url.replace('https://','http://');var url='';var isHttps=Drupal.settings.baseUrl.indexOf('https://');if(isHttps==-1){base_url=base_url_nossl;url+=base_url+'/product/directsave/'+lid+'/'+editor;}else{url+=base_url+'/product/directsave/ssl/'+lid+'/'+editor;}
if(product_id==36&&Drupal.settings.upsell_country=='US'){window.location=base_url+'/pens';return false;}
$.ajax({url:url,dataType:"json",success:function(Response){console.log('success');if(Response.success=='1'){var url=base_url;var lds='';if($('#lds').length){if($('#lds').val()==1){lds='&lds=1';}}
url+='/product/options/'+product_id+'?lid='+Response['lid']+lds;window.location=url;}else{if(Response.success=='0'&&Response.errcode==-1){window.location=base_url+$('#promo_'+lid+'_'+editor+'_'+product_id).attr('href');return;}
if($('#TB_load').length){if(typeof Drupal.settings.storage_failed_message!='undefined'){$('#TB_load p').html(Drupal.settings.storage_failed_message);$('#TB_load p .refresh_page').click(function(e){e.preventDefault();location.reload();return false;});}}}}});return false;}
function fls_popunder_callback(param){$('.logo_promo_product_lightbox,#flash_promo_products_popup').hide();var popup_url=Drupal.settings.custom_popunder_url||Drupal.settings.popunder_url;fls_new_page(popup_url,'width=1000, height=690,scrollbars=yes,resizable=yes, location=yes, toolbar=yes, menubar=yes','step4');Drupal.settings.offer_flash_submited=true;var fls_popunder_callback_timer=typeof(fls_popunder_callback_timer_overwrite)!='undefined'?fls_popunder_callback_timer_overwrite:2000;setTimeout(function(){if(typeof param!='undefined'){if(param.length){if($(param+" .popunder_click").length)
param+=" .popunder_click";$(param).trigger('mousedown').trigger('click').focus();$(param)[0].click();popunder_hide_elements();return;}}
$('.popunder_click_holder:last').trigger('click');window.location=$('.popunder_click_holder:last').attr('href');},fls_popunder_callback_timer);}
function fls_store_holiday_card_direct_save(logo_id,editor,card_id){show_loading_overlay();var base_url=Drupal.settings.baseUrl;if(Drupal.settings.lang&&Drupal.settings.lang!='en'){base_url+='/'+Drupal.settings.lang;}
var base_url_nossl=base_url.replace('https://','http://');var url='';var isHttps=Drupal.settings.baseUrl.indexOf('https://');if(isHttps==-1){base_url=base_url_nossl;url+=base_url+'/product/directsave/'+logo_id+'/'+editor+'/'+card_id;}else{url+=base_url+'/product/directsave/ssl/'+logo_id+'/'+editor+'/'+card_id;}
$.ajax({url:url,dataType:"json",success:function(Response){if(Response.success=='1'){var url=base_url;url+='/holiday-greeting-cards/options/'+Response['lid'];window.location=url;}else{return true;}}});return false;}
function is_inside_iframe(){var inside_iframe=false;try
{if(top!==self){inside_iframe=true;}}
catch(err){inside_iframe=true;}
return inside_iframe;}
function fls_events_add_ajax(field_name,field_value){var key=field_name+field_value;if(typeof Drupal.settings.fls_events_add_ajax=='undefined')Drupal.settings.fls_events_add_ajax={};if(typeof Drupal.settings.fls_events_add_ajax[key]!='undefined'){if(Drupal.settings.fls_events_add_ajax[key])return false;}
Drupal.settings.fls_events_add_ajax[key]=1;$.ajax({url:Drupal.settings.basePath+'set_tracking_from_ajax',type:"POST",data:({field_name:field_name,field_value:field_value,}),success:function(data){Drupal.settings.fls_events_add_ajax[key]=0;return;}});}
function fls_events_add(event,val){var events_tracked_with_ajax=['nr_err_msg_on_checkout','hit_checkout_cart_section','hit_checkout_upsell_section','hit_checkout_billing_section','hit_checkout_payment_section','hit_checkout_shipping_section','hit_checkout_account_section','logoselect_max_page','logoselect_logo_like_pref','logoselect_logo_like_recom','logoselect_logo_unlike_pref','logoselect_logo_unlike_recom','fired_523moreinfo_lightbox','fired_premiumlogomoreinfo_lightbox','fired_uberallmoreinfo_lightbox','fired_467moreinfo_lightbox','checkout_premium_logo_447_checked','checkout_business_listing_561_checked','checkout_google_apps_523_checked','checkout_google_apps_467_checked','fired_473moreinfo_lightbox','checkout_473upsell_checked','saw_plp_lb','payment_method_selected','clicked_select_a_plan','plan_selected','weebly_package_2','weebly_package_3','weebly_package_4','bc_step3_editor_loaded'];if(events_tracked_with_ajax.indexOf(event)!==-1){fls_events_add_ajax(event,val);return;}
if(!val){fls_events_add_simple(event);return;}
var date=new Date();date.setTime(date.getTime()+(3*24*60*60*1000));if((data=$.cookie('tr_events_val_queue'))){data=$.deparam(data);}
else{data={};}
data[event]=val;data=$.param(data);if(!fls_events_check_skip(event)){$.cookie("tr_events_val_queue",data,{expires:date,path:'/'});}}
function fls_events_add_simple(event){var data;var date=new Date();date.setTime(date.getTime()+(3*24*60*60*1000));if((data=$.cookie('tr_events_queue')))
data+=',';else
data='';data+=event;if(!fls_events_check_skip(event)){$.cookie("tr_events_queue",data,{expires:date,path:'/'});}}
function fls_events_check_skip(event){var skip_update=false;if(typeof Drupal.settings.split_test_skip_updates!='undefined'){for(var i in Drupal.settings.split_test_skip_updates){for(var j in Drupal.settings.split_test_skip_updates[i]){var jpath=j.replace('*','');if(Drupal.settings.fls_path.indexOf(jpath)===0){if($.inArray(event,Drupal.settings.split_test_skip_updates[i][j])!==-1){skip_update=true;}}}}}
return skip_update;}
function fls_ga_track_event(name,action){if(typeof(action)=='undefined')
action='Click';if(Drupal.settings.ga_status){ga('send','event',name,action);}}
function fls_store_round_up(price){var price_o=parseFloat(price);price=price_o.toFixed(2);price_o=price_o.toFixed(6);var diff=price_o-price;if(diff>0){var arr_price=price.split('.');if(arr_price[1]!=undefined){var p=parseInt(arr_price[1]);p++;if(p.toString().length==1){p='0'+p;}
else if(p.toString().length==3){p=p-100;arr_price[0]++;}
arr_price[1]=p;price=arr_price.join('.');price=parseFloat(price);}}
price=parseFloat(price);price=price.toFixed(2);return price;}
function fls_new_page(url,attr_string,window_identifier){Drupal.settings.leavebehind_popup_submitted=true;var unique_identifier='flswin_'+window_identifier;var status=$.cookie(unique_identifier);if(status!==null)return false;fls_new_page_status_change(window_identifier,0);if(attr_string==undefined)attr_string='';var browser=$.browser;if(Drupal.settings.browser_details_name=="chrome"){var parent_url=url.split("?offer=1");if(parent_url[0]!==undefined){$('body').append('<a id="fls_open_new_page" class="none" style="display:none" href="'+parent_url[0]+'">  </a>');setTimeout(function(){window.location=url;},100);fls_simulate_click(true,false,false,'fls_open_new_page');}}else{$('body').append('<a id="fls_open_new_page" class="none" style="display:none" href="'+url+'">  </a>');fls_open_popup(url,attr_string);}
return false;}
function fls_simulate_click(ctrl,shift,isMiddle,linkTargetId){var evt=document.createEvent('MouseEvents');evt.initMouseEvent('click',true,true,window,0,0,0,0,0,ctrl,false,shift,false,isMiddle?1:0,null);document.getElementById(linkTargetId).dispatchEvent(evt);return false;}
mywindow=false;function fls_open_popup(url,attr_string){ga('send','event','Leave Behind','Popunder','Popunder Opened');fls_events_add('leavebehind_popup_opened');if(attr_string==undefined)attr_string='';mywindow=window.open(url,'mywindow',attr_string);mywindow.blur();window.open("javascript:window.focus()","_self","");window.focus();return false;}
function fls_new_page_status_change(window_identifier,status){var unique_identifier='flswin_'+window_identifier;var options={path:'/'};$.cookie(unique_identifier,status,options);}
function fls_new_page_get_status(window_identifier){var unique_identifier='flswin_'+window_identifier;return $.cookie(unique_identifier);}
(function($){$.deparam=function(params,coerce){var obj={},coerce_types={'true':!0,'false':!1,'null':null};$.each(params.replace(/\+/g,' ').split('&'),function(j,v){var param=v.split('='),key=decodeURIComponent(param[0]),val,cur=obj,i=0,keys=key.split(']['),keys_last=keys.length-1;if(/\[/.test(keys[0])&&/\]$/.test(keys[keys_last])){keys[keys_last]=keys[keys_last].replace(/\]$/,'');keys=keys.shift().split('[').concat(keys);keys_last=keys.length-1;}else{keys_last=0;}
if(param.length===2){val=decodeURIComponent(param[1]);if(coerce){val=val&&!isNaN(val)?+val:val==='undefined'?undefined:coerce_types[val]!==undefined?coerce_types[val]:val;}
if(keys_last){for(;i<=keys_last;i++){key=keys[i]===''?cur.length:keys[i];cur=cur[key]=i<keys_last?cur[key]||(keys[i+1]&&isNaN(keys[i+1])?{}:[]):val;}}else{obj[key]=val;}}else if(key){obj[key]=coerce?undefined:'';}});return obj;};})(jQuery);var id=0;function popunder_init_element(o){if(Drupal.settings.browser_details_name=='ie')
return false;id++;var url=Drupal.settings.popunder_close_location;var param='.popunder_parent_container_'+id;$(o).addClass('popunder_parent_container popunder_parent_container_'+id);$(o).append('<div id="popunder_object_container_'+id+'"><script>popunder_get_flash_object("popunder_object_container_'+id+'","'+url+'","'+param+'")</script></div>');}
function popunder_get_flash_object(id,url,param){var swfVersionStr="10.0.0";var flashvars={};var params={};params.wmode='transparent';params.menu=false;params.AllowScriptAccess='always';var attributes={};params.flashVars='url='+url+'&callback=fls_popunder_callback&window=flwindow&param='+param;swfobject.embedSWF(Drupal.settings.popunder_flash_object_location,id,"1","1",swfVersionStr,'',flashvars,params,attributes);}
function popunder_hide_elements(){$('.popunder_parent_container  object').hide();}
function popunder_add(o){popunder_init_element($(o));$(o).click(function(){var url=Drupal.settings.custom_popunder_url||Drupal.settings.popunder_url;if(typeof Drupal.settings.offer_flash_submited=='undefined'&&Drupal.settings.browser_details_name!=='chrome')
fls_new_page(url,'width=1000, height=690,scrollbars=yes,resizable=yes, location=yes, toolbar=yes, menubar=yes','step4');});}
function fls_logo_global_leavebehind_init(){if(typeof Drupal.settings.show_step4_offer=='undefined')return;if(!Drupal.settings.show_step4_offer)return;switch(Drupal.settings.fls_path){case'home':popunder_add('#choose_design_index a');break;}}
function fls_store_disable_fields_in_progress(){$('.upsells_new_check_logo input').prop('disabled',true);$('.google_upsell_dropdown_seat').prop('disabled',true);}
function fls_store_restore_fields_in_progress(){$('.upsells_new_check_logo input').each(function(){var id=$(this).attr('id');var disabled=$('label[for='+id+']').hasClass('disabled');$(this).prop('disabled',disabled);});$('.google_upsell_dropdown_seat').prop('disabled',false);}
(function($){$.fn.getTextWidth=function(){var spanText=$("BODY #spanCalculateTextWidth");if(spanText.length<=0){spanText=$("<span id='spanCalculateTextWidth' style='filter: alpha(0);'></span>");spanText.appendTo("BODY");}
var valu=this.val();if(!valu)valu=this.text();spanText.text(valu);spanText.css({"fontSize":this.css('fontSize'),"fontWeight":this.css('fontWeight'),"fontFamily":this.css('fontFamily'),"position":"absolute","top":0,"opacity":0,"left":-2000});return spanText.outerWidth()+parseInt(this.css('paddingLeft'))+'px';};$.fn.getTextHeight=function(width){var spanText=$("BODY #spanCalculateTextHeight");if(spanText.length<=0){spanText=$("<span id='spanCalculateTextHeight'></span>");spanText.appendTo("BODY");}
var valu=this.val();if(!valu)valu=this.text();spanText.text(valu);spanText.css({"fontSize":this.css('fontSize'),"fontWeight":this.css('fontWeight'),"fontFamily":this.css('fontFamily'),"top":0,"left":-1*parseInt(width)+'px',"position":'absolute',"display":"inline-block","width":width});return spanText.innerHeight()+'px';};$.fn.autoTextSizeFls=function(truncate){if(typeof(truncate=='undefined'))truncate=0;var min_size=8;var max_size=parseInt(this.css('font-size'));this.autoTextSize(min_size,max_size,truncate);}
$.fn.autoTextSize=function(minSize,maxSize,truncate){var _self=this,_width=_self.innerWidth(),_textWidth=parseInt(_self.getTextWidth()),_fontSize=parseInt(_self.css('font-size'));while(_width<_textWidth||(maxSize&&_fontSize>parseInt(maxSize))){if(minSize&&_fontSize<=parseInt(minSize))break;_fontSize--;_self.attr('style','font-size: '+_fontSize+"px !important;");_textWidth=parseInt(_self.getTextWidth());}
if(truncate)_self.autoTruncateText();};$.fn.autoTruncateText=function(){var _self=this,_width=_self.outerWidth(),_textHeight=parseInt(_self.getTextHeight(_width)),_text=_self.text();while(_textHeight>_self.outerHeight()){_text=_text.slice(0,-1);_self.text(_text);_textHeight=parseInt(_self.getTextHeight(_width));_truncated=true;}
if(!_truncated)return;_text=_text.slice(0,-3);var lastChar=_text[_text.length-1];if(lastChar==' '||lastChar=='.')_text=_text.slice(0,-1);_self.text(_text+'...');};})(jQuery);function fls_banner_message_resize(){console.log('a1');if($('.coupon-message').length){console.log('a2');var height=0;$('.coupon-message').each(function(){height+=$(this).height();});console.log(height);$('body').append('<style>.fls_banner_dynamic_padding{padding-top: '+height+'px !important}</style>');$('body').addClass('fls_banner_dynamic_padding');}else{console.log('ax');$('body').removeClass('body-coupon-message').removeClass('fls_banner_dynamic_padding').removeClass('body-term-message');}}
function fls_products_also_viewed(){if($('.node-edit-link').length>0){if($('.relatedProducts').length>0){if($('.relatedProducts .product').length==0)$('.relatedProducts .title').hide();}}}
function update_my_cart_number(total_items){if($('.nav_my_cart').length>0){if($('.nav_my_cart .material-icons').length<1){var mycart=$('.nav_my_cart').text().split('(')[0];$('.nav_my_cart').text(mycart+'('+total_items+')');}else{$('.nav_my_cart').html('<span class="material-icons font-size-16 margin-5 margin-horizontal ">shopping_cart</span>'+' '+total_items);}}}
function storageAvailable(type){var storage;try{storage=window[type];var x='__storage_test__';storage.setItem(x,x);storage.removeItem(x);return true;}
catch(e){return e instanceof DOMException&&(e.code===22||e.code===1014||e.name==='QuotaExceededError'||e.name==='NS_ERROR_DOM_QUOTA_REACHED')&&(storage&&storage.length!==0);}}
var isLocalStorageAvailableShow=0;function local_storage_set(name,value,micro_timestamp){if(typeof micro_timestamp=='unefined')micro_timestamp=0;if(storageAvailable('localStorage')){if(!isLocalStorageAvailableShow){console.log('localStorage is available');isLocalStorageAvailableShow=1;}
localStorage.setItem(name,value);if(micro_timestamp&&micro_timestamp>0){localStorage.setItem(name+'___expire_',micro_timestamp);}
if(value===null){localStorage.removeItem(name);localStorage.removeItem(name+'___expire_');}}}
function local_storage_get(name,default_value){if(storageAvailable('localStorage')){console.log('localStorage is available');isLocalStorageAvailableShow=1;var micro_timestamp=localStorage.getItem(name+'___expire_');if(typeof micro_timestamp!='undefined'){var date=new Date();var now=date.getTime();if(now>micro_timestamp){localStorage.removeItem(name);localStorage.removeItem(name+'___expire_');}}
var value=localStorage.getItem(name);if(typeof value!='undefined')default_value=value;}
return default_value;};(function($){$.scrollTo=function(target,settings){return $('html,body').scrollTo(target,settings);};$.scrollTo.defaults={axis:'y',speed:1};$.fn.scrollTo=function(target,settings){settings=$.extend({},$.scrollTo.defaults,settings);settings.queue=settings.queue&&settings.axis.length==2;if(settings.queue)
settings.speed=Math.ceil(settings.speed/2);if(typeof settings.offset=='number')
settings.offset={left:settings.offset,top:settings.offset};return this.each(function(){var $elem=$(this),t=target,toff,attr={};switch(typeof t){case'number':case'string':if(/^([+-]=)?\d+(px)?$/.test(t)){t={top:t,left:t};break;}
t=$(t,this);case'object':if(t.is||t.style)
toff=(t=$(t)).offset();}
$.each(settings.axis.split(''),parse);animate(settings.onAfter);function parse(i,axis){var Pos=axis=='x'?'Left':'Top',pos=Pos.toLowerCase(),key='scroll'+Pos,act=$elem[0][key];attr[key]=toff?toff[pos]+($elem.is('html,body')?0:act-$elem.offset()[pos]):t[pos];if(settings.margin&&t.css)
attr[key]-=parseInt(t.css('margin'+Pos))||0;if(settings.offset&&settings.offset[pos])
attr[key]+=settings.offset[pos];if(!i&&settings.queue){if(act!=attr[key])
animate(settings.onAfterFirst);delete attr[key];}};function animate(callback){$elem.animate(attr,settings.speed,settings.easing,function(){if(callback)
callback.call(this,$elem,attr,t);});};});};})(jQuery);;jQuery.cookie=function(name,value,options){if(typeof value!='undefined'){options=options||{};if(value===null){value='';options.expires=-1;}
var expires='';if(options.expires&&(typeof options.expires=='number'||options.expires.toUTCString)){var date;if(typeof options.expires=='number'){date=new Date();date.setTime(date.getTime()+(options.expires*24*60*60*1000));}else{date=options.expires;}
expires='; expires='+date.toUTCString();}
var path=options.path?'; path='+(options.path):'';var domain=options.domain?'; domain='+(options.domain):'';var secure=options.secure?'; secure':'';document.cookie=[name,'=',encodeURIComponent(value),expires,path,domain,secure].join('');}else{var cookieValue=null;if(document.cookie&&document.cookie!=''){var cookies=document.cookie.split(';');for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)==(name+'=')){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break;}}}
return cookieValue;}};;window.Socialite=(function(window,document,undefined)
{'use strict';var uid=0,instances=[],networks={},widgets={},rstate=/^($|loaded|complete)/,euc=window.encodeURIComponent;var socialite={settings:{},trim:function(str)
{return str.trim?str.trim():str.replace(/^\s+|\s+$/g,'');},hasClass:function(el,cn)
{return(' '+el.className+' ').indexOf(' '+cn+' ')!==-1;},addClass:function(el,cn)
{if(!socialite.hasClass(el,cn)){el.className=(el.className==='')?cn:el.className+' '+cn;}},removeClass:function(el,cn)
{el.className=socialite.trim(' '+el.className+' '.replace(' '+cn+' ',' '));},extendObject:function(to,from,overwrite)
{for(var prop in from){var hasProp=to[prop]!==undefined;if(hasProp&&typeof from[prop]==='object'){socialite.extendObject(to[prop],from[prop],overwrite);}else if(overwrite||!hasProp){to[prop]=from[prop];}}},getElements:function(context,cn)
{var i=0,el=[],gcn=!!context.getElementsByClassName,all=gcn?context.getElementsByClassName(cn):context.getElementsByTagName('*');for(;i<all.length;i++){if(gcn||socialite.hasClass(all[i],cn)){el.push(all[i]);}}
return el;},getDataAttributes:function(el,noprefix,nostr)
{var i=0,str='',obj={},attr=el.attributes;for(;i<attr.length;i++){var key=attr[i].name,val=attr[i].value;if(val.length&&key.indexOf('data-')===0){if(noprefix){key=key.substring(5);}
if(nostr){obj[key]=val;}else{str+=euc(key)+'='+euc(val)+'&';}}}
return nostr?obj:str;},copyDataAttributes:function(from,to,noprefix,nohyphen)
{var attr=socialite.getDataAttributes(from,noprefix,true);for(var i in attr){to.setAttribute(nohyphen?i.replace(/-/g,'_'):i,attr[i]);}},createIframe:function(src,instance)
{var iframe=document.createElement('iframe');iframe.style.cssText='overflow: hidden; border: none;';socialite.extendObject(iframe,{src:src,allowtransparency:'true',frameborder:'0',scrolling:'no'},true);if(instance){iframe.onload=iframe.onreadystatechange=function()
{if(rstate.test(iframe.readyState||'')){iframe.onload=iframe.onreadystatechange=null;socialite.activateInstance(instance);}};}
return iframe;},networkReady:function(name)
{return networks[name]?networks[name].loaded:undefined;},appendNetwork:function(network)
{if(!network||network.appended){return;}
if(typeof network.append==='function'&&network.append(network)===false){network.appended=network.loaded=true;socialite.activateAll(network);return;}
if(network.script){network.el=document.createElement('script');socialite.extendObject(network.el,network.script,true);network.el.async=true;network.el.onload=network.el.onreadystatechange=function()
{if(rstate.test(network.el.readyState||'')){network.el.onload=network.el.onreadystatechange=null;network.loaded=true;if(typeof network.onload==='function'&&network.onload(network)===false){return;}
socialite.activateAll(network);}};document.body.appendChild(network.el);}
network.appended=true;},removeNetwork:function(network)
{if(!socialite.networkReady(network.name)){return false;}
if(network.el.parentNode){network.el.parentNode.removeChild(network.el);}
return!(network.appended=network.loaded=false);},reloadNetwork:function(name)
{var network=networks[name];if(network&&socialite.removeNetwork(network)){socialite.appendNetwork(network);}},createInstance:function(el,widget)
{var proceed=true,instance={el:el,uid:uid++,widget:widget};instances.push(instance);if(widget.process!==undefined){proceed=(typeof widget.process==='function')?widget.process(instance):false;}
if(proceed){socialite.processInstance(instance);}
instance.el.setAttribute('data-socialite',instance.uid);instance.el.className='socialite '+widget.name+' socialite-instance';return instance;},processInstance:function(instance)
{var el=instance.el;instance.el=document.createElement('div');instance.el.className=el.className;socialite.copyDataAttributes(el,instance.el);if(el.nodeName.toLowerCase()==='a'&&!el.getAttribute('data-default-href')){instance.el.setAttribute('data-default-href',el.getAttribute('href'));}
var parent=el.parentNode;parent.insertBefore(instance.el,el);parent.removeChild(el);},activateInstance:function(instance)
{if(instance&&!instance.loaded){instance.loaded=true;if(typeof instance.widget.activate==='function'){instance.widget.activate(instance);}
socialite.addClass(instance.el,'socialite-loaded');return instance.onload?instance.onload(instance.el):null;}},activateAll:function(network)
{if(typeof network==='string'){network=networks[network];}
for(var i=0;i<instances.length;i++){var instance=instances[i];if(instance.init&&instance.widget.network===network){socialite.activateInstance(instance);}}},load:function(context,el,w,onload,process)
{context=(context&&typeof context==='object'&&context.nodeType===1)?context:document;if(!el||typeof el!=='object'){socialite.load(context,socialite.getElements(context,'socialite'),w,onload,process);return;}
var i;if(/Array/.test(Object.prototype.toString.call(el))){for(i=0;i<el.length;i++){socialite.load(context,el[i],w,onload,process);}
return;}
if(el.nodeType!==1){return;}
if(!w||!widgets[w]){w=null;var classes=el.className.split(' ');for(i=0;i<classes.length;i++){if(widgets[classes[i]]){w=classes[i];break;}}
if(!w){return;}}
var instance,widget=widgets[w],sid=parseInt(el.getAttribute('data-socialite'),10);if(!isNaN(sid)){for(i=0;i<instances.length;i++){if(instances[i].uid===sid){instance=instances[i];break;}}}else{instance=socialite.createInstance(el,widget);}
if(process||!instance){return;}
if(!instance.init){instance.init=true;instance.onload=(typeof onload==='function')?onload:null;widget.init(instance);}
if(!widget.network.appended){socialite.appendNetwork(widget.network);}else{if(socialite.networkReady(widget.network.name)){socialite.activateInstance(instance);}}},activate:function(el,w,onload)
{window.Socialite.load(null,el,w,onload);},process:function(context,el,w)
{window.Socialite.load(context,el,w,null,true);},network:function(n,params)
{networks[n]={name:n,el:null,appended:false,loaded:false,widgets:{}};if(params){socialite.extendObject(networks[n],params);}},widget:function(n,w,params)
{params.name=n+'-'+w;if(!networks[n]||widgets[params.name]){return;}
params.network=networks[n];networks[n].widgets[w]=widgets[params.name]=params;},setup:function(params)
{socialite.extendObject(socialite.settings,params,true);}};return socialite;})(window,window.document);(function(window,document,Socialite,undefined)
{Socialite.setup({facebook:{lang:'en_GB',appId:null},twitter:{lang:'en'},googleplus:{lang:'en-GB'}});Socialite.network('facebook',{script:{src:'//connect.facebook.net/{{language}}/sdk.js',id:'facebook-jssdk'},append:function(network)
{var fb=document.createElement('div'),settings=Socialite.settings.facebook,events={onlike:'edge.create',onunlike:'edge.remove',onsend:'message.send'};fb.id='fb-root';document.body.appendChild(fb);network.script.src=network.script.src.replace('{{language}}',settings.lang);window.fbAsyncInit=function(){window.FB.init({appId:settings.appId,xfbml:true,version:'v2.2'});for(var e in events){if(typeof settings[e]==='function'){window.FB.Event.subscribe(events[e],settings[e]);}}};}});var facebookInit=function(instance)
{var el=document.createElement('div');el.className=instance.widget.fbtype;Socialite.copyDataAttributes(instance.el,el);instance.el.appendChild(el);if(window.FB&&window.FB.XFBML){window.FB.XFBML.parse(instance.el);}};Socialite.widget('facebook','like',{init:facebookInit,fbtype:'fb-like'});Socialite.widget('facebook','share',{init:facebookInit,fbtype:'fb-share-button'});Socialite.network('twitter',{script:{src:'//platform.twitter.com/widgets.js',id:'twitter-wjs',charset:'utf-8'},append:function()
{var notwttr=(typeof window.twttr!=='object'),settings=Socialite.settings.twitter,events=['click','tweet','retweet','favorite','follow'];if(notwttr){window.twttr=(t={_e:[],ready:function(f){t._e.push(f);}});}
window.twttr.ready(function(twttr)
{for(var i=0;i<events.length;i++){var e=events[i];if(typeof settings['on'+e]==='function'){twttr.events.bind(e,settings['on'+e]);}}
Socialite.activateAll('twitter');});return notwttr;}});var twitterInit=function(instance)
{var el=document.createElement('a');el.className=instance.widget.name+'-button';Socialite.copyDataAttributes(instance.el,el);el.setAttribute('href',instance.el.getAttribute('data-default-href'));el.setAttribute('data-lang',instance.el.getAttribute('data-lang')||Socialite.settings.twitter.lang);instance.el.appendChild(el);};var twitterActivate=function(instance)
{if(window.twttr&&typeof window.twttr.widgets==='object'&&typeof window.twttr.widgets.load==='function'){window.twttr.widgets.load();}};Socialite.widget('twitter','share',{init:twitterInit,activate:twitterActivate});Socialite.widget('twitter','follow',{init:twitterInit,activate:twitterActivate});Socialite.widget('twitter','hashtag',{init:twitterInit,activate:twitterActivate});Socialite.widget('twitter','mention',{init:twitterInit,activate:twitterActivate});Socialite.widget('twitter','timeline',{init:twitterInit,activate:twitterActivate});Socialite.widget('twitter','embed',{process:function(instance)
{instance.innerEl=instance.el;if(!instance.innerEl.getAttribute('data-lang')){instance.innerEl.setAttribute('data-lang',Socialite.settings.twitter.lang);}
instance.el=document.createElement('div');instance.el.className=instance.innerEl.className;instance.innerEl.className='';instance.innerEl.parentNode.insertBefore(instance.el,instance.innerEl);instance.el.appendChild(instance.innerEl);},init:function(instance)
{instance.innerEl.className='twitter-tweet';},activate:twitterActivate});Socialite.network('googleplus',{script:{src:'//apis.google.com/js/plusone.js'},append:function(network)
{if(window.gapi){return false;}
window.___gcfg={lang:Socialite.settings.googleplus.lang,parsetags:'explicit'};}});var googleplusInit=function(instance)
{var el=document.createElement('div');el.className='g-'+instance.widget.gtype;Socialite.copyDataAttributes(instance.el,el);instance.el.appendChild(el);instance.gplusEl=el;};var googleplusEvent=function(instance,callback){return(typeof callback!=='function')?null:function(data){callback(instance.el,data);};};var googleplusActivate=function(instance)
{var type=instance.widget.gtype;if(window.gapi&&window.gapi[type]){var settings=Socialite.settings.googleplus,params=Socialite.getDataAttributes(instance.el,true,true),events=['onstartinteraction','onendinteraction','callback'];for(var i=0;i<events.length;i++){params[events[i]]=googleplusEvent(instance,settings[events[i]]);}
window.gapi[type].render(instance.gplusEl,params);}};Socialite.widget('googleplus','one',{init:googleplusInit,activate:googleplusActivate,gtype:'plusone'});Socialite.widget('googleplus','share',{init:googleplusInit,activate:googleplusActivate,gtype:'plus'});Socialite.widget('googleplus','badge',{init:googleplusInit,activate:googleplusActivate,gtype:'plus'});Socialite.widget('googleplus','follow',{init:googleplusInit,activate:googleplusActivate,gtype:'follow'});Socialite.network('linkedin',{script:{src:'//platform.linkedin.com/in.js'}});var linkedinInit=function(instance)
{var el=document.createElement('script');el.type='IN/'+instance.widget.intype;Socialite.copyDataAttributes(instance.el,el);instance.el.appendChild(el);if(typeof window.IN==='object'&&typeof window.IN.parse==='function'){window.IN.parse(instance.el);Socialite.activateInstance(instance);}};Socialite.widget('linkedin','share',{init:linkedinInit,intype:'Share'});Socialite.widget('linkedin','recommend',{init:linkedinInit,intype:'RecommendProduct'});Socialite.widget('linkedin','follow',{init:linkedinInit,intype:'FollowCompany'});})(window,window.document,window.Socialite);(function(){var s=window._socialite;if(/Array/.test(Object.prototype.toString.call(s))){for(var i=0,len=s.length;i<len;i++){if(typeof s[i]==='function'){s[i]();}}}})();;var PluginDetect={handler:function(c,b,a){return function(){c(b,a)}},isDefined:function(b){return typeof b!="undefined"},isArray:function(b){return(b&&b.constructor===Array)},isFunc:function(b){return typeof b=="function"},isString:function(b){return typeof b=="string"},isNum:function(b){return typeof b=="number"},isStrNum:function(b){return(typeof b=="string"&&(/\d/).test(b))},getNumRegx:/[\d][\d\.\_,-]*/,splitNumRegx:/[\.\_,-]/g,getNum:function(b,c){var d=this,a=d.isStrNum(b)?(d.isDefined(c)?new RegExp(c):d.getNumRegx).exec(b):null;return a?a[0].replace(d.splitNumRegx,","):null},compareNums:function(h,f,d){var e=this,c,b,a,g=parseInt;if(e.isStrNum(h)&&e.isStrNum(f)){if(e.isDefined(d)&&d.compareNums){return d.compareNums(h,f)}c=h.split(e.splitNumRegx);b=f.split(e.splitNumRegx);for(a=0;a<Math.min(c.length,b.length);a++){if(g(c[a],10)>g(b[a],10)){return 1}if(g(c[a],10)<g(b[a],10)){return-1}}}return 0},formatNum:function(b,c){var d=this,a,e;if(!d.isStrNum(b)){return null}if(!d.isNum(c)){c=4}c--;e=b.replace(/\s/g,"").split(d.splitNumRegx).concat(["0","0","0","0"]);for(a=0;a<4;a++){if(/^(0+)(.+)$/.test(e[a])){e[a]=RegExp.$2}if(a>c||!(/\d/).test(e[a])){e[a]="0"}}return e.slice(0,4).join(",")},$$hasMimeType:function(a){return function(d){if(!a.isIE){var c,b,e,f=a.isString(d)?[d]:d;for(e=0;e<f.length;e++){if(/[^\s]/.test(f[e])&&(c=navigator.mimeTypes[f[e]])&&(b=c.enabledPlugin)&&(b.name||b.description)){return c}}}return null}},findNavPlugin:function(l,e,c){var j=this,h=new RegExp(l,"i"),d=(!j.isDefined(e)||e)?/\d/:0,k=c?new RegExp(c,"i"):0,a=navigator.plugins,g="",f,b,m;for(f=0;f<a.length;f++){m=a[f].description||g;b=a[f].name||g;if((h.test(m)&&(!d||d.test(RegExp.leftContext+RegExp.rightContext)))||(h.test(b)&&(!d||d.test(RegExp.leftContext+RegExp.rightContext)))){if(!k||!(k.test(m)||k.test(b))){return a[f]}}}return null},getMimeEnabledPlugin:function(a,e){var d=this,b,c=new RegExp(e,"i");if((b=d.hasMimeType(a))&&(b=b.enabledPlugin)&&(c.test(b.description||"")||c.test(b.name||""))){return b}return 0},getPluginFileVersion:function(f,b){var h=this,e,d,g,a,c=-1;if(h.OS>2||!f||!f.version||!(e=h.getNum(f.version))){return b}if(!b){return e}e=h.formatNum(e);b=h.formatNum(b);d=b.split(h.splitNumRegx);g=e.split(h.splitNumRegx);for(a=0;a<d.length;a++){if(c>-1&&a>c&&d[a]!="0"){return b}if(g[a]!=d[a]){if(c==-1){c=a}if(d[a]!="0"){return b}}}return e},AXO:window.ActiveXObject,getAXO:function(b,a){var g=null,f,d=false,c=this;try{g=new c.AXO(b);d=true}catch(f){}if(c.isDefined(a)){delete g;return d}return g},convertFuncs:function(f){var a,g,d,b=/^[\$][\$]/,c={};for(a in f){if(b.test(a)){c[a]=1}}for(a in c){try{g=a.slice(2);if(g.length>0&&!f[g]){f[g]=f[a](f)}}catch(d){}}},initScript:function(){var c=this,a=navigator,d="/",h=a.userAgent||"",f=a.vendor||"",b=a.platform||"",g=a.product||"";c.OS=(/win/i).test(b)?1:((/mac/i).test(b)?2:((/linux/i).test(b)?3:4));c.convertFuncs(c);c.isIE=new Function("return "+d+"*@cc_on!@*"+d+"false")();c.verIE=c.isIE&&(/MSIE\s*(\d+\.?\d*)/i).test(h)?parseFloat(RegExp.$1,10):null;c.ActiveXEnabled=false;if(c.isIE){var e,i=["Msxml2.XMLHTTP","Msxml2.DOMDocument","Microsoft.XMLDOM","ShockwaveFlash.ShockwaveFlash","TDCCtl.TDCCtl","Shell.UIHelper","Scripting.Dictionary","wmplayer.ocx"];for(e=0;e<i.length;e++){if(c.getAXO(i[e],1)){c.ActiveXEnabled=true;break}}c.head=c.isDefined(document.getElementsByTagName)?document.getElementsByTagName("head")[0]:null}c.isGecko=(/Gecko/i).test(g)&&(/Gecko\s*\/\s*\d/i).test(h);c.verGecko=c.isGecko?c.formatNum((/rv\s*\:\s*([\.\,\d]+)/i).test(h)?RegExp.$1:"0.9"):null;c.isSafari=(/Safari\s*\/\s*\d/i).test(h)&&(/Apple/i).test(f);c.isChrome=(/Chrome\s*\/\s*\d/i).test(h);c.isOpera=(/Opera\s*[\/]?\s*(\d+\.?\d*)/i).test(h);c.verOpera=c.isOpera&&((/Version\s*\/\s*(\d+\.?\d*)/i).test(h)||1)?parseFloat(RegExp.$1,10):null;;c.addWinEvent("load",c.handler(c.runWLfuncs,c));},init:function(d,a){var c=this,b;if(!c.isString(d)){return-3}if(d.length==1){c.getVersionDelimiter=d;return-3}b=c[d.toLowerCase().replace(/\s/g,"")];if(!b||!b.getVersion){return-3}c.plugin=b;if(!c.isDefined(b.installed)||a==true){b.installed=b.version=b.version0=b.getVersionDone=null;b.$=c}c.garbage=false;if(c.isIE&&!c.ActiveXEnabled){if(b!==c.java){return-2}}return 1},fPush:function(b,a){var c=this;if(c.isArray(a)&&(c.isFunc(b)||(c.isArray(b)&&b.length>0&&c.isFunc(b[0])))){a[a.length]=b}},callArray:function(b){var c=this,a;if(c.isArray(b)){for(a=0;a<b.length;a++){if(b[a]===null){return}c.call(b[a]);b[a]=null}}},call:function(c){var b=this,a=b.isArray(c)?c.length:-1;if(a>0&&b.isFunc(c[0])){c[0](b,a>1?c[1]:0,a>2?c[2]:0,a>3?c[3]:0)}else{if(b.isFunc(c)){c(b)}}},getVersionDelimiter:",",$$getVersion:function(a){return function(g,d,c){var e=a.init(g),f,b;if(e<0){return null}f=a.plugin;if(f.getVersionDone!=1){f.getVersion(d,c);if(f.getVersionDone===null){f.getVersionDone=1}}a.cleanup();b=(f.version||f.version0);return b?b.replace(a.splitNumRegx,a.getVersionDelimiter):b}},cleanup:function(){var a=this;if(a.garbage&&a.isDefined(window.CollectGarbage)){window.CollectGarbage()}},addWinEvent:function(d,c){var e=this,a=window,b;if(e.isFunc(c)){if(a.addEventListener){a.addEventListener(d,c,false)}else{if(a.attachEvent){a.attachEvent("on"+d,c)}else{b=a["on"+d];a["on"+d]=e.winHandler(c,b)}}}},winHandler:function(d,c){return function(){d();if(typeof c=="function"){c()}}},WLfuncs:[0],runWLfuncs:function(a){a.winLoaded=true;a.callArray(a.WLfuncs);if(a.onDoneEmptyDiv){a.onDoneEmptyDiv()}},winLoaded:false,$$onWindowLoaded:function(a){return function(b){if(a.winLoaded){a.call(b)}else{a.fPush(b,a.WLfuncs)}}},$$onDetectionDone:function(a){return function(h,g,e,b){var c=a.init(h),j,d;if(c==-3){return-1}d=a.plugin;if(d.getVersionDone!=1){j=a.isMinVersion?a.isMinVersion(h,"0",e,b):a.getVersion(h,e,b)}if(d.installed!=-0.5&&d.installed!=0.5){a.call(g);return 1}if(d!==a.java){return 1};a.fPush(g,d.funcs);return 0;;return 1}},div:null,divWidth:50,pluginSize:1,emptyDiv:function(){var c=this,a,e,b,d=0;if(c.div&&c.div.childNodes){for(a=c.div.childNodes.length-1;a>=0;a--){b=c.div.childNodes[a];if(b&&b.childNodes){if(d==0){for(e=b.childNodes.length-1;e>=0;e--){b.removeChild(b.childNodes[e])}c.div.removeChild(b)}else{}}}}},onDoneEmptyDiv:function(){var a=this;if(!a.winLoaded){return}if(a.WLfuncs&&a.WLfuncs.length>0&&a.isFunc(a.WLfuncs[a.WLfuncs.length-1])){return}if(a.java){if(a.java.OTF==3){return}if(a.java.funcs&&a.java.funcs.length>0&&a.isFunc(a.java.funcs[a.java.funcs.length-1])){return}}a.emptyDiv()},getObject:function(c,a){var g,d=this,f=null,b=d.getContainer(c);try{if(b&&b.firstChild){f=b.firstChild}if(a&&f){f.focus()}}catch(g){}return f},getContainer:function(a){return(a&&a[0]?a[0]:null)},instantiate:function(j,c,g,a,k){var m,n=document,i=this,r,q=n.createElement("span"),o,h,f="<";var l=function(t,s){var v=t.style,d,u;if(!v){return}v.outline="none";v.border="none";v.padding="0px";v.margin="0px";v.visibility="visible";if(i.isArray(s)){for(d=0;d<s.length;d=d+2){try{v[s[d]]=s[d+1]}catch(u){}}return}},b=function(){var t,u="pd33993399",s=null,d=(n.getElementsByTagName("body")[0]||n.body);if(!d){try{n.write(f+'div id="'+u+'">o'+f+"/div>");s=n.getElementById(u)}catch(t){}}d=(n.getElementsByTagName("body")[0]||n.body);if(d){if(d.firstChild&&i.isDefined(d.insertBefore)){d.insertBefore(i.div,d.firstChild)}else{d.appendChild(i.div)}if(s){d.removeChild(s)}}else{}};if(!i.isDefined(a)){a=""}if(i.isString(j)&&(/[^\s]/).test(j)){r=f+j+' width="'+i.pluginSize+'" height="'+i.pluginSize+'" ';for(o=0;o<c.length;o=o+2){if(/[^\s]/.test(c[o+1])){r+=c[o]+'="'+c[o+1]+'" '}}r+=">";for(o=0;o<g.length;o=o+2){if(/[^\s]/.test(g[o+1])){r+=f+'param name="'+g[o]+'" value="'+g[o+1]+'" />'}}r+=a+f+"/"+j+">"}else{r=a}if(!i.div){i.div=n.createElement("div");h=n.getElementById("plugindetect");if(h){i.div=h}else{i.div.id="plugindetect";b()}l(i.div,["width",i.divWidth+"px","height",(i.pluginSize+3)+"px","fontSize",(i.pluginSize+3)+"px","lineHeight",(i.pluginSize+3)+"px","verticalAlign","baseline","display","block"]);if(!h){l(i.div,["position","absolute","right","0px","top","0px"])}}if(i.div&&i.div.parentNode){i.div.appendChild(q);l(q,["fontSize",(i.pluginSize+3)+"px","lineHeight",(i.pluginSize+3)+"px","verticalAlign","baseline","display","inline"]);;try{if(q&&q.parentNode){q.focus()}}catch(m){}try{q.innerHTML=r}catch(m){}if(q.childNodes.length==1&&!(i.isGecko&&i.compareNums(i.verGecko,"1,5,0,0")<0)){l(q.firstChild,["display","inline"])}return[q]}return[null]},java:{mimeType:["application/x-java-applet","application/x-java-vm","application/x-java-bean"],mimeTypeJPI:"application/x-java-applet;jpi-version=",classID:"clsid:8AD9C840-044E-11D1-B3E9-00805F499D93",DTKclassID:"clsid:CAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA",DTKmimeType:["application/java-deployment-toolkit","application/npruntime-scriptable-plugin;DeploymentToolkit"],JavaVersions:[[1,9,2,30],[1,8,2,30],[1,7,2,30],[1,6,1,30],[1,5,1,30],[1,4,2,30],[1,3,1,30]],searchJavaPluginAXO:function(){var h=null,a=this,c=a.$,g=[],j=[1,5,0,14],i=[1,6,0,2],f=[1,3,1,0],e=[1,4,2,0],d=[1,5,0,7],b=false;if(!c.ActiveXEnabled){return null};if(c.verIE>=a.minIEver){g=a.searchJavaAXO(i,i,b);if(g.length>0&&b){g=a.searchJavaAXO(j,j,b)}}else{if(g.length==0){g=a.searchJavaAXO(f,e,false)}}if(g.length>0){h=g[0]}a.JavaPlugin_versions=[].concat(g);return h},searchJavaAXO:function(l,i,m){var n,f,h=this.$,q,k,a,e,g,j,b,r=[];if(h.compareNums(l.join(","),i.join(","))>0){i=l}i=h.formatNum(i.join(","));var o,d="1,4,2,0",c="JavaPlugin."+l[0]+""+l[1]+""+l[2]+""+(l[3]>0?("_"+(l[3]<10?"0":"")+l[3]):"");for(n=0;n<this.JavaVersions.length;n++){f=this.JavaVersions[n];q="JavaPlugin."+f[0]+""+f[1];g=f[0]+"."+f[1]+".";for(a=f[2];a>=0;a--){b="JavaWebStart.isInstalled."+g+a+".0";if(h.compareNums(f[0]+","+f[1]+","+a+",0",i)>=0&&!h.getAXO(b,1)){continue}o=h.compareNums(f[0]+","+f[1]+","+a+",0",d)<0?true:false;for(e=f[3];e>=0;e--){k=a+"_"+(e<10?"0"+e:e);j=q+k;if(h.getAXO(j,1)&&(o||h.getAXO(b,1))){r[r.length]=g+k;if(!m){return r}}if(j==c){return r}}if(h.getAXO(q+a,1)&&(o||h.getAXO(b,1))){r[r.length]=g+a;if(!m){return r}}if(q+a==c){return r}}}return r},minIEver:7,getMimeJPIversion:function(){var h,a=this,d=a.$,c=new RegExp("("+a.mimeTypeJPI+")(\\d.*)","i"),k=new RegExp("Java","i"),e,j,f="",i={},g=0,b;for(h=0;h<navigator.mimeTypes.length;h++){j=navigator.mimeTypes[h];if(c.test(j.type)&&(e=j.enabledPlugin)&&(j=RegExp.$2)&&(k.test(e.description||f)||k.test(e.name||f))){i["a"+d.formatNum(j)]=j}}b="0,0,0,0";for(h in i){g++;e=h.slice(1);if(d.compareNums(e,b)>0){b=e}}a.mimeTypeJPIresult=g>0?a.mimeTypeJPI+i["a"+b]:"";return g>0?b:null},queryNoApplet00:function(a){var b=window.java,c;try{if(b.lang){a.value=[b.lang.System.getProperty("java.version")+" ",b.lang.System.getProperty("java.vendor")+" "]}}catch(c){}},queryNoApplet:function(){var b=this,c=b.$,d,a=b.queryNoApplet;if(!a.value){a.value=[null,null];if(!c.isIE&&window.java){if(c.OS==2&&c.isOpera&&c.verOpera<9.2&&c.verOpera>=9){}else{if(c.isGecko&&c.compareNums(c.verGecko,"1,9,0,0")<0&&c.compareNums(c.verGecko,"1,8,0,0")>=0){}else{b.queryNoApplet00(a)}}}}return a.value},forceVerifyTag:[],jar:[],Enabled:navigator.javaEnabled(),VENDORS:["Sun Microsystems Inc.","Apple Computer, Inc."],init:function(){var a=this,b=a.$;a.tryApplet=[2,2,2];a.DOMobj=[0,0,0,0,0,0];a.Applet0Index=3;a.OTF=0;a.BridgeResult=[[null,null],[null,null],[null,null]];a.JavaActive=[0,0,0];a.All_versions=[];a.mimeTypeJPIresult="";a.mimeObj=b.hasMimeType(a.mimeType);a.JavaPlugin_versions=[];a.funcs=[];var c=a.NOTF;if(c){c.$=b;c.count=0;c.intervalLength=250;c.countMax=33}},getVersion:function(c,h){var e,b=this,d=b.$,g=vendor=versionEnabled=null;if(b.getVersionDone===null){b.init()}var i;if(d.isArray(h)){for(i=0;i<b.tryApplet.length;i++){if(d.isNum(h[i])){b.tryApplet[i]=h[i]}}}for(i=0;i<b.forceVerifyTag.length;i++){b.tryApplet[i]=b.forceVerifyTag[i]}if(d.isString(c)){b.jar[b.jar.length]=c}if(b.getVersionDone==0){if(!b.version||b.useAnyTag()){e=b.queryAnyApplet(c);if(e[0]){b.installed=1;b.EndGetVersion(e[0],e[1])}}return}var f=b.queryDeployTK();if(f.JRE){g=f.JRE;vendor=b.VENDORS[0]}if(!d.isIE){var l,j,a,k;k=(b.mimeObj&&b.Enabled)?true:false;if(!g&&(e=b.getMimeJPIversion())!==null){g=e}if(!g&&b.mimeObj){e="Java[^\\d]*Plug-in";a=d.findNavPlugin(e);if(a){e=new RegExp(e,"i");l=e.test(a.description||"")?d.getNum(a.description):null;j=e.test(a.name||"")?d.getNum(a.name):null;if(l&&j){g=(d.compareNums(d.formatNum(l),d.formatNum(j))>=0)?l:j}else{g=l||j}}}if(!g&&b.mimeObj&&d.isSafari&&d.OS==2){a=d.findNavPlugin("Java.*\\d.*Plug-in.*Cocoa",0);if(a){l=d.getNum(a.description);if(l){g=l}}}if(g){b.version0=g;if(b.Enabled){versionEnabled=g}}}else{if(!g&&f.status==0){g=b.searchJavaPluginAXO();if(g){vendor=b.VENDORS[0]}}if(g){b.version0=g;if(b.Enabled&&d.ActiveXEnabled){versionEnabled=g}}}if(!versionEnabled||b.useAnyTag()){e=b.queryAnyApplet(c);if(e[0]){versionEnabled=e[0];vendor=e[1]}}if(!versionEnabled&&(e=b.queryNoApplet())[0]){b.version0=versionEnabled=e[0];vendor=e[1];if(b.installed==-0.5){b.installed=0.5}}if(d.isSafari&&d.OS==2){if(!versionEnabled&&k){if(b.installed===null){b.installed=0}else{if(b.installed==-0.5){b.installed=0.5}}}}if(b.jreDisabled()){versionEnabled=null};if(b.installed===null){b.installed=versionEnabled?1:(g?-0.2:-1)}b.EndGetVersion(versionEnabled,vendor)},EndGetVersion:function(b,d){var a=this,c=a.$;if(a.version0){a.version0=c.formatNum(c.getNum(a.version0))}if(b){a.version=c.formatNum(c.getNum(b));a.vendor=(c.isString(d)?d:"")}if(a.getVersionDone!=1){a.getVersionDone=0}},jreDisabled:function(){var c=this,e=c.$,d=c.queryDeployTK().JRE,a=0,b;if(d&&e.OS==1){if((e.isGecko&&e.compareNums(e.verGecko,"1,9,2,0")>=0&&e.compareNums(d,"1,6,0,12")<0)||(e.isChrome&&e.compareNums(d,"1,6,0,12")<0)){a=1}};return a},queryDeployTK:function(){var d=this,g=d.$,b=d.queryDeployTK,i,a,c,h=len=null;if(!b.JREall){b.JREall=[];b.JRE=null;b.status=0}else{return b}if((g.isGecko&&g.compareNums(g.verGecko,g.formatNum("1.6"))<=0)||g.isSafari||(g.isIE&&!g.ActiveXEnabled)){return b}if(g.isIE&&g.verIE>=6){d.DOMobj[0]=g.instantiate("object",[],[]);h=g.getObject(d.DOMobj[0])}else{if(!g.isIE&&(c=g.hasMimeType(d.DTKmimeType))&&c.type){d.DOMobj[0]=g.instantiate("object",["type",c.type],[]);h=g.getObject(d.DOMobj[0])}}if(h){if(g.isIE&&g.verIE>=6){try{h.classid=d.DTKclassID}catch(i){}};try{var f=h.jvms;if(f){len=f.getLength();if(g.isNum(len)){b.status=len>0?1:-1;for(a=0;a<len;a++){c=g.getNum(f.get(len-1-a).version);if(c){b.JREall[a]=c}}}}}catch(i){}}if(b.JREall.length>0){b.JRE=g.formatNum(b.JREall[0])}return b},queryAnyApplet:function(f){var n=this,e=n.$,o=n.BridgeResult,h=n.DOMobj,b=n.Applet0Index,i="&nbsp;&nbsp;&nbsp;&nbsp;",t="A.class";if(!e.isString(f)||!(/\.jar\s*$/).test(f)||(/\\/).test(f)){return[null,null]}if(n.OTF<1){n.OTF=1}if(n.jreDisabled()){return[null,null]}if((e.isGecko||e.isChrome||(e.isOpera&&!n.Enabled))&&!n.mimeObj&&!n.queryNoApplet()[0]){return[null,null]}if(n.OTF<2){n.OTF=2}if(!h[1]&&n.canUseObjectTag()){h[1]=e.instantiate("object",[],[],i)}if(!h[2]){h[2]=e.instantiate("",[],[],i)}var d=f,r="",m;if((/[\/]/).test(f)){m=f.split("/");d=m[m.length-1];m[m.length-1]="";r=m.join("/")}var j=["archive",d,"code",t],l=["mayscript","true"],q=["scriptable","true"].concat(l),g=!e.isIE&&n.mimeObj&&n.mimeObj.type?n.mimeObj.type:n.mimeType[0];if(!h[b]&&n.canUseObjectTag()&&n.canTryApplet(0)){h[b]=e.isIE?e.instantiate("object",["type",g].concat(j),["codebase",r].concat(j).concat(q),i,n):e.instantiate("object",["type",g,"archive",d,"classid","java:"+t],["codebase",r,"archive",d].concat(q),i,n);o[0]=[0,0];n.query1Applet(b)}if(!h[b+1]&&n.canUseAppletTag()&&n.canTryApplet(1)){h[b+1]=e.isIE?e.instantiate("applet",["alt",i].concat(l).concat(j),["codebase",r].concat(l),i,n):e.instantiate("applet",["codebase",r,"alt",i].concat(l).concat(j),[].concat(l),i,n);o[1]=[0,0];n.query1Applet(b+1)}if(!h[b+2]&&n.canUseObjectTag()&&n.canTryApplet(2)){h[b+2]=e.isIE?e.instantiate("object",["classid",n.classID],["codebase",r].concat(j).concat(q),i,n):e.instantiate();o[2]=[0,0];n.query1Applet(b+2)};if(n.OTF<3&&((h[b]&&!o[0][0])||(h[b+1]&&!o[1][0])||(e.isIE&&h[b+2]&&!o[2][0]))){var c=n.NOTF.isJavaActive();if(c>=0){n.OTF=3;n.installed=c==1?0.5:-0.5;n.NOTF.initAppletQuery()}};var k,a=0;for(k=0;k<o.length;k++){if(h[b+k]||n.canTryApplet(k)){a++}else{break}}if(a==o.length){n.getVersionDone=n.forceVerifyTag.length>0?0:1}return n.getBR()},canUseAppletTag:function(){var a=this;return((!a.$.isIE||a.Enabled)?true:false)},canUseObjectTag:function(){return((!this.$.isIE||this.$.ActiveXEnabled)?true:false)},useAnyTag:function(){var b=this,a;for(a=0;a<b.tryApplet.length;a++){if(b.canTryApplet(a)){return true}}return false},canTryApplet:function(c){var a=this,b=a.$;if(a.tryApplet[c]==3){return true}if(!a.version0||!a.Enabled||(b.isIE&&!b.ActiveXEnabled)){if(a.tryApplet[c]==2){return true}if(a.tryApplet[c]==1&&!a.getBR()[0]){return true}}return false},getBR:function(){var b=this.BridgeResult,a;for(a=0;a<b.length;a++){if(b[a][0]){return[b[a][0],b[a][1]]}}return[b[0][0],b[0][1]]},query1Applet:function(g){var f,c=this,d=c.$,a=vendor=null,b=d.getObject(c.DOMobj[g],true);if(b){try{a=b.getVersion()+" ";vendor=b.getVendor()+" ";b.statusbar(d.winLoaded?" ":" ")}catch(f){}if(d.isStrNum(a)){c.BridgeResult[g-c.Applet0Index]=[a,vendor]}try{if(d.isIE&&a&&b.readyState!=4){d.garbage=true;b.parentNode.removeChild(b)}}catch(f){}}},NOTF:{isJavaActive:function(){var e=this,c=e.$.java,a,b,d=-9;for(a=c.Applet0Index;a<c.DOMobj.length;a++){b=e.isJavaActive_x_(a);c.JavaActive[a-c.Applet0Index]=b;if(b>d){d=b}}return d},isJavaActive_x_:function(g){var h=this,d=h.$,c=d.java,f,b=d.getObject(c.DOMobj[g]),a=h.status(g);if(a==-2){return-2}if(h.status(1)>=0){return 0}try{if(d.isIE&&d.verIE>=c.minIEver&&b.object){return 1}}catch(f){}if(a==1&&(d.isIE||((c.version0&&c.Enabled&&c.mimeObj)||c.queryNoApplet()[0]))){return 1}if(a<0){return-1}return 0},status:function(c){var f=this,d=f.$,b=d.java,h,a=d.getObject(b.DOMobj[c]),j=d.getContainer(b.DOMobj[c]),k=f.getObjectWidth(j),g=d.getContainer(b.DOMobj[2]),i=f.getObjectWidth(g);if(!a||!j){return-2}try{if(k>=0&&i>=0){if(k==i&&k>d.pluginSize){return-1}if(k!=i&&k==d.pluginSize&&d.winLoaded&&(!d.isIE||a.readyState==4)){return 1}}}catch(h){}return 0},getObjectWidth:function(c){if(c){var a=c.scrollWidth||c.offsetWidth,b=this.$;if(b.isNum(a)){return a}}return-1},initAppletQuery:function(){var b=this,a=b.$;if(!b.onIntervalQuery){b.onIntervalQuery=b.$$onIntervalQuery(b);if(!a.winLoaded){a.WLfuncs[0]=b.winOnLoadQuery}setTimeout(b.onIntervalQuery,b.intervalLength)}},winOnLoadQuery:function(c){var b=c.java,d=b.NOTF,a;if(b.OTF==3){a=d.AppletQuery();d.queryCleanup(a[1],a[2])}},$$onIntervalQuery:function(a){return function(){var d=a.$,c=d.java,b;if(c.OTF==3){b=a.AppletQuery();if(b[0]||(d.winLoaded&&a.count>a.countMax)){a.queryCleanup(b[1],b[2])}}a.count++;if(c.OTF==3){setTimeout(a.onIntervalQuery,a.intervalLength)}}},AppletQuery:function(){var f=this,e=f.$,d=e.java,b,a,c;for(b=0;b<d.BridgeResult.length;b++){d.query1Applet(b+d.Applet0Index)}a=d.getBR();c=(a[0]||f.isJavaActive()<0)?true:false;return[c,a[0],a[1]]},queryCleanup:function(d,g){var f=this,e=f.$,c=e.java,a;if(c.OTF==4){return}c.OTF=4;var b=f.isJavaActive()==1?true:false;if(d||c.queryNoApplet()[0]){c.installed=1}else{if(b){if(c.version0){c.installed=1;d=c.version0}else{c.installed=0}}else{if(c.installed==0.5){c.installed=0}else{if(c.version0){c.installed=-0.2}else{c.installed=-1}}}}c.EndGetVersion(d,g);e.callArray(c.funcs);if(e.onDoneEmptyDiv){e.onDoneEmptyDiv()}}},append:function(e,d){for(var c=0;c<d.length;c++){e[e.length]=d[c]}},JavaFix:function(){}},flash:{mimeType:["application/x-shockwave-flash","application/futuresplash"],progID:"ShockwaveFlash.ShockwaveFlash",classID:"clsid:D27CDB6E-AE6D-11CF-96B8-444553540000",getVersion:function(){var b=function(i){if(!i){return null}var e=/[\d][\d\,\.\s]*[rRdD]{0,1}[\d\,]*/.exec(i);return e?e[0].replace(/[rRdD\.]/g,",").replace(/\s/g,""):null};var d,h=this,f=h.$,j,g,k=null,c=null,a=null;if(!f.isIE){d=f.findNavPlugin("Flash");if(d&&d.description&&f.hasMimeType(h.mimeType)){k=b(d.description)}if(k){k=f.getPluginFileVersion(d,k)}}else{for(g=15;g>2;g--){c=f.getAXO(h.progID+"."+g);if(c){a=g.toString();break}}if(a=="6"){try{c.AllowScriptAccess="always"}catch(j){return"6,0,21,0"}}try{k=b(c.GetVariable("$version"))}catch(j){}if(!k&&a){k=a}}h.installed=k?1:-1;h.version=f.formatNum(k);return true}},zz:0};PluginDetect.initScript();;var payment_type_paypal=0;var stickyObjects=new Array();var startPrice=0;var payment_form_submited=0;$(document).ready(function(){if($('#checkoutv3').length==0){}else{fls_update_total_price();if(Drupal.settings.imagesrollover!=undefined){for(var k in Drupal.settings.imagesrollover){MM_preloadImages(Drupal.settings.imagesrollover[k]);}}}
$('#spam_free_policy_why.lang_v_nonen').tooltip({track:true,delay:0,showURL:false,showBody:" - ",fade:250});if($('#spam_free_policy_why.lang_v_en').length>0){var free_policy_why_title=$('#spam_free_policy_why').attr('title');$('#spam_free_policy_why').attr('title','');$('#spam_free_policy_why').click(function(){return false;})
$('#spam_free_policy_why').mouseover(function(){if($('#whyPopup').length==0){$(this).parent().append('<div id="whyPopup">'+free_policy_why_title+'</div>');$('#whyPopup img').attr('src','https://freelogo-assets.s3.amazonaws.com/sites/all/themes/freelogoservices/images/credit_cards.jpg');$('#whyPopup p').append('<img src="'+'https://freelogo-assets.s3.amazonaws.com/sites/all/themes/freelogoservices/images/cvc_tooltip.png" />');}});$('#spam_free_policy_why').mouseout(function(){$('#whyPopup').remove();});$('#spam_free_policy_why').parent().click(function(e){if($(e.target).is('#closeWhyPopup')){$('#whyPopup').remove();}
return false;});}
$("#checkoutv3 .scrollerConteiner li").mouseover(function(event){var li=$(this);var input_id=li.children('input').attr('id');var ids=input_id.split('-');var current_img_id=ids[2];$('.imgRollOver').remove();$('<div class="imgRollOver"></div>').appendTo('body');$('.imgRollOver').css({"position":"absolute","width":"150px","border":"solid 2px #383838","background":"#FFF","z-index":"999"}).append('<img src="'+Drupal.settings.imagesrollover[current_img_id]+'" />');$('.imgRollOver img').css({"padding-top":"5px"});var tooltipX=event.pageX+20;var tooltipY=event.pageY-90;$('.imgRollOver').css({top:tooltipY,left:tooltipX});});$("#checkoutv3 .scrollerConteiner li").mousemove(function(event){var tooltipX=event.pageX+20;var tooltipY=event.pageY-90;$('.imgRollOver').css({top:tooltipY,left:tooltipX});});$("#checkoutv3 .scrollerConteiner li").mouseout(function(){$('.imgRollOver').remove();});$('#step-checkout1 .order-logos').click(fls_update_total_price);var country_id=$('#edit-country').val();if(country_id=='221'){$('#edit-zip-label span.required').css('display','none');}else{$('#edit-zip-label span.required').css('display','');}
$('#edit-country').change(function(){fls_update_payment_types($(this).val());});$('p.paypal_js_disable').remove();setTimeout(function(){$('#paypal-payment-form').submit();},1000);$('#edit-payment-type').change(fls_checkout_update_form_fields);$('#security_guarantee').tooltip({track:true,delay:0,showURL:false,showBody:" - ",fade:250});$('#fls-store-payment-form #edit-promo-code').bind('blur',function(){var code=$(this).val();if(!startPrice){startPrice=$('.checkout_total .price span').html();}
if(code){$.ajax({url:'apply-promo/'+code,success:function(price){if(price){$('.checkout_total .price span').html(price);}else{$('.checkout_total .price span').html(startPrice);}}});}else{$('.checkout_total .price span').html(startPrice);}});$('.sticky').each(function(){var offset=$(this).offset();this.initialTop=offset.top;stickyObjects.push(this);});$(window).scroll(function(){if(stickyObjects){var scrollTop=$(this).scrollTop();var offsetTop=0;var offset=0;for(var i in stickyObjects){if(scrollTop>stickyObjects[i].initialTop){$(stickyObjects[i]).css('position','fixed').css('top',0);}else{$(stickyObjects[i]).css('position','').css('top','');}}}});$('#edit-country').each(fls_change_states);$('#payment-form #edit-submit').click(function(){additionalErrorHTML="";$("#rsvErrors").html("").css('display','none');var errorHTML=Drupal.settings.checkout_form.form_header_error;if($('#edit-confirm-card-no-err').val()!=""||$('#check_confirm').length<0){$('html, body').animate({scrollTop:$(".payment").offset().top},500);}
if(Drupal.settings.page_logo_products){var has_products=false;$('.productbox_addtocart input').each(function(){if(this.checked)
has_products=true;});if(!has_products){additionalErrorHTML+=Drupal.settings.checkout_form.products.required;$('.productbox_addtocart input').addClass('errorFieldDemo5');$('.productbox_addtocart label').addClass('signup_error_label');}
else{$('.productbox_addtocart input').removeClass('errorFieldDemo5');$('.productbox_addtocart label').removeClass('signup_error_label');}}
if($('#edit-payment-type').val()==""||$('#edit-payment-type').val()=="0"){additionalErrorHTML+=Drupal.settings.checkout_form.payment_type.required;$('#edit-payment-type').addClass('errorFieldDemo5');$('#edit-payment-type-label').addClass('signup_error_label');$('#edit-payment-type-label-icon').show();}else{$('#edit-payment-type').removeClass('errorFieldDemo5');$('#edit-payment-type-label').removeClass('signup_error_label');$('#edit-payment-type-label-icon').hide();}
if($('#edit-first-name').val()==""){additionalErrorHTML+=Drupal.settings.checkout_form.first_name.required;$('#edit-first-name').addClass('errorFieldDemo5');$('#edit-first-name-label').addClass('signup_error_label');$('#edit-first-name-label-icon').show();}else{$('#edit-first-name').removeClass('errorFieldDemo5');$('#edit-first-name-label').removeClass('signup_error_label');$('#edit-first-name-label-icon').hide();}
if($('#edit-last-name').val()==""){additionalErrorHTML+=Drupal.settings.checkout_form.last_name.required;$('#edit-last-name').addClass('errorFieldDemo5');$('#edit-last-name-label').addClass('signup_error_label');$('#edit-last-name-label-icon').show();}else{$('#edit-last-name').removeClass('errorFieldDemo5');$('#edit-last-name-label').removeClass('signup_error_label');$('#edit-last-name-label-icon').hide();}
additionalErrorHTML=validate_custom_fields(additionalErrorHTML);if($('#edit-card-number').val()==""){additionalErrorHTML+=Drupal.settings.checkout_form.card_number.required;$('#edit-card-number').addClass('errorFieldDemo5');$('#edit-card-number-label').addClass('signup_error_label');$('#edit-card-number-label-icon').show();}else{$('#edit-card-number').removeClass('errorFieldDemo5');$('#edit-card-number-label').removeClass('signup_error_label');$('#edit-card-number-label-icon').hide();}
if(!Drupal.settings.hasbraintree&&$('#edit-security-code').val()==""){additionalErrorHTML+=Drupal.settings.checkout_form.security_code.required;$('#edit-security-code').addClass('errorFieldDemo5');$('#edit-security-code-label').addClass('signup_error_label');$('#edit-security-code-label-icon').show();}else{$('#edit-security-code').removeClass('errorFieldDemo5');$('#edit-security-code-label').removeClass('signup_error_label');$('#edit-security-code-label-icon').hide();}
var valid_exp_date=1;if($('#edit-expiration-date-mm').val()==""){valid_exp_date=0;additionalErrorHTML+=Drupal.settings.checkout_form.expiration_date.required;$('#edit-expiration-date-mm').addClass('errorFieldDemo5');$('#edit-expiration-date-label').addClass('signup_error_label');$('#edit-expiration-date-label-icon').show();}else{$('#edit-expiration-date-mm').removeClass('errorFieldDemo5');$('#edit-expiration-date-label').removeClass('signup_error_label');$('#edit-expiration-date-label-icon').hide();}
if($('#edit-expiration-date-yy').val()==""){if(valid_exp_date){additionalErrorHTML+=Drupal.settings.checkout_form.expiration_date.required;}
$('#edit-expiration-date-yy').addClass('errorFieldDemo5');$('#edit-expiration-date-label').addClass('signup_error_label');$('#edit-expiration-date-label-icon').show();}else{$('#edit-expiration-date-yy').removeClass('errorFieldDemo5');$('#edit-expiration-date-label').removeClass('signup_error_label');$('#edit-expiration-date-label-icon').hide();}
if($('#edit-phone').val()==""){additionalErrorHTML+=Drupal.settings.checkout_form.phone.required;$('#edit-phone').addClass('errorFieldDemo5');$('#edit-phone-label').addClass('signup_error_label');$('#edit-phone-label-icon').show();}else if(!validate_phone_function()){additionalErrorHTML+=Drupal.settings.checkout_form.phone.invalid;$('#edit-phone').addClass('errorFieldDemo5');$('#edit-phone-label').addClass('signup_error_label');$('#edit-phone-label-icon').show();}else{$('#edit-phone').removeClass('errorFieldDemo5');$('#edit-phone-label').removeClass('signup_error_label');$('#edit-phone-label-icon').hide();}
if($('#edit-billing-address').val()==""){additionalErrorHTML+=Drupal.settings.checkout_form.billing_address.required;$('#edit-billing-address').addClass('errorFieldDemo5');$('#edit-billing-address-label').addClass('signup_error_label');$('#edit-billing-address-label-icon').show();}else{$('#edit-billing-address').removeClass('errorFieldDemo5');$('#edit-billing-address-label').removeClass('signup_error_label');$('#edit-billing-address-label-icon').hide();}
if($('#edit-city').val()==""){additionalErrorHTML+=Drupal.settings.checkout_form.city.required;$('#edit-city').addClass('errorFieldDemo5');$('#edit-city-label').addClass('signup_error_label');$('#edit-city-label-icon').show();}else{$('#edit-city').removeClass('errorFieldDemo5');$('#edit-city-label').removeClass('signup_error_label');$('#edit-city-label-icon').hide();}
var val=$('#edit-country').val();if(val=='1'){if($('#edit-stateus').val()==""){additionalErrorHTML+=Drupal.settings.checkout_form.stateus.required;$('#edit-stateus').addClass('errorFieldDemo5');$('#edit-stateus-label').addClass('signup_error_label');$('#edit-stateus-label-icon').show();}else{$('#edit-stateus').removeClass('errorFieldDemo5');$('#edit-stateus-label').removeClass('signup_error_label');$('#edit-stateus-label-icon').hide();}}else if(val=='2'){if($('#edit-statecan').val()==""){additionalErrorHTML+=Drupal.settings.checkout_form.statecan.required;$('#edit-statecan').addClass('errorFieldDemo5');$('#edit-statecan-label').addClass('signup_error_label');$('#edit-statecan-label-icon').show();}else{$('#edit-statecan').removeClass('errorFieldDemo5');$('#edit-statecan-label').removeClass('signup_error_label');$('#edit-statecan-label-icon').hide();}}else if(val=='36'){if($('#edit-statebr').val()==""){additionalErrorHTML+=Drupal.settings.checkout_form.statebr.required;$('#edit-statebr').addClass('errorFieldDemo5');$('#edit-statebr-label').addClass('signup_error_label');$('#edit-statebr-label-icon').show();}else{$('#edit-statebr').removeClass('errorFieldDemo5');$('#edit-statebr-label').removeClass('signup_error_label');$('#edit-statebr-label-icon').hide();}}
else{}
if(val!='221'){if($('#edit-zip').val()==""){additionalErrorHTML+=Drupal.settings.checkout_form.zip.required
$('#edit-zip').addClass('errorFieldDemo5');$('#edit-zip-label').addClass('signup_error_label');$('#edit-zip-label-icon').show();}else{$('#edit-zip').removeClass('errorFieldDemo5');$('#edit-zip-label').removeClass('signup_error_label');$('#edit-zip-label-icon').hide();}}
if(additionalErrorHTML){errorHTML+=additionalErrorHTML;$("#rsvErrors").css("display","block");$("#rsvErrors").html(errorHTML);return false;}
$('#edit-submit').hide();$('#payment_progress').show();$('#payment-form').submit();return false;});$('#payment-form #edit-submit-paypal').click(function(){additionalErrorHTML="";$("#rsvErrors").html("").css('display','none');var errorHTML=Drupal.settings.checkout_form.form_header_error;additionalErrorHTML=validate_custom_fields(additionalErrorHTML);if(additionalErrorHTML){errorHTML+=additionalErrorHTML;$("#rsvErrors").css("display","block");$("#rsvErrors").html(errorHTML);$("#rsvErrors").parent().parent().show();return false;}
$('#payment_progress').show();$('#payment-form').submit();return false;});setInterval(function(){if(paypal_point_wait<3){$('#paypal_point_wait').append('.');paypal_point_wait++;}else{$('#paypal_point_wait').text('');paypal_point_wait=0;}},300);$('#payment-form').each(function(){fls_checkout_update_form_fields();});setTimeout(function(){if(!$.browser.msie||$('#edit-payment-type').length==0)return;fls_payment_type_is_selected=false;if($('#edit-payment-type option:selected').length){fls_payment_type_is_selected=true;}
if(!fls_payment_type_is_selected){$('#edit-payment-type option:first').prop('selected',true);}},0);});var paypal_point_wait=0;function validate_custom_fields(additionalErrorHTML){if($('#edit-confirm-card-no-err').val()==""&&$('#check_confirm').length>0){$('html, body').animate({scrollTop:$(".left_bc_preview").offset().top},500);$('#check_confirm input').parent().find('label').css('color','#CD0000');$('#check_confirm input').parent().parent().css('border','1px solid #CD0000');$('.proof_error_show').show();additionalErrorHTML+=Drupal.settings.checkout_form.confirm_card_no_err.required;}
return additionalErrorHTML;}
function fls_update_payment_types(country_id){if($('#step-checkout1').length>0||$('#ipage_checkout_main').length>0){show_loading_overlay();}
$('input.errorFieldDemo5, select.errorFieldDemo5').removeClass('errorFieldDemo5');$('div.error_icon').css('display','none');$('label.signup_error_label').removeClass('signup_error_label');if(country_id=='221'){$('#edit-zip-label span.required').css('display','none');}else{$('#edit-zip-label span.required').css('display','');}
if($('#edit-payment-type').length<=0){$('#edit-country').each(fls_change_states);return;}
if(Drupal.settings.checkout_form.payment_types_url==undefined){$('#edit-country').each(fls_change_states);return;}
$('#edit-payment-type').prop('disabled',true);$.ajax({url:Drupal.settings.checkout_form.payment_types_url,type:"POST",data:({country_id:country_id,form_buld_id:$('input[name=form_build_id]').val(),first_name:$('input[name=first_name]').val(),last_name:$('input[name=last_name]').val(),address:$('input[name=billing_address]').val(),address2:$('input[name=billing_address2]').val(),city:$('input[name=city]').val(),state:$('input[name=state]').val(),zip:$('input[name=zip]').val(),phone:$('input[name=phone]').val(),order_logos:$('#edit-order-logos').val()}),dataType:"json",success:function(data){location.reload();$('#edit-payment-type option').each(function(){var val=$(this).attr('value');if(val!="0"){$(this).remove();}});for(var i in data){$('#edit-payment-type').append($("<option></option>").attr("value",i).text(data[i]));}
$('#edit-payment-type').prop('disabled',false);$('#edit-payment-type').each(fls_checkout_update_form_fields);$('#edit-country').each(fls_change_states);}})}
function fls_change_states(){var val=$(this).val();$('#edit-statebr').removeClass('errorFieldDemo5');$('#edit-statebr-label').removeClass('signup_error_label');$('#edit-statebr-label-icon').hide();$('#edit-statecan').removeClass('errorFieldDemo5');$('#edit-statecan-label').removeClass('signup_error_label');$('#edit-statecan-label-icon').hide();$('#edit-stateus').removeClass('errorFieldDemo5');$('#edit-stateus-label').removeClass('signup_error_label');$('#edit-stateus-label-icon').hide();$('#edit-statees').removeClass('errorFieldDemo5');$('#edit-statees-label').removeClass('signup_error_label');$('#edit-statees-label-icon').hide();$('#edit-stateit').removeClass('errorFieldDemo5');$('#edit-stateit-label').removeClass('signup_error_label');$('#edit-stateit-label-icon').hide();$('#edit-statemx').removeClass('errorFieldDemo5');$('#edit-statemx-label').removeClass('signup_error_label');$('#edit-statemx-label-icon').hide();$('#edit-state').removeClass('errorFieldDemo5');$('#edit-state-label').removeClass('signup_error_label');$('#edit-state-label-icon').hide();$('.states').parent().parent().parent().hide();if(val=='1'||val=='01'){$('#edit-stateus').parent().parent().parent().show();}else if(val=='2'||val=='02'){$('#edit-statecan').parent().parent().parent().show();}else if(val=='36'){$('#edit-statebr').parent().parent().parent().show();}else if(val=='203'){if($('#edit-statees').length>0){$('#edit-statees').parent().parent().parent().show();}else{$('#edit-state').parent().parent().parent().show();}}else if(val=='112'){if($('#edit-stateit').length>0){$('#edit-stateit').parent().parent().parent().show();}else{$('#edit-state').parent().parent().parent().show();}}else if(val=='143'){if($('#edit-statemx').length>0){$('#edit-statemx').parent().parent().parent().show();}else{$('#edit-state').parent().parent().parent().show();}}else{$('#edit-state').parent().parent().parent().show();}}
function fls_checkout_update_form_fields(){if(Drupal.settings.payment_type_js_callback){for(var i in Drupal.settings.payment_type_js_callback){eval(Drupal.settings.payment_type_js_callback[i]+'()');}}
var value=$(this).val();if(typeof(value)=='undefined')return;if(!value)return;value=value.replace(/\*/g,'');if(Drupal.settings.default_remove_fields===undefined){Drupal.settings.default_remove_fields=0;}
if(Drupal.settings.default_remove_fields){value='paypal';$('.payment_types_imgs').hide();}
if(value=='paypal'){payment_type_paypal=1;$('#payment-form .form_table tr').each(function(){var paypal=null;paypal=$(this).find('#edit-submit-paypal,#edit-payment-type,#edit-promo-code, .upsells_new_right');if(paypal.length<=0){$(this).css('display','none');}else{$(this).css('display','');}
if(Drupal.settings.checkout_form.payment_types_url!=undefined){if($(this).find('#edit-country').length>0){$(this).css('display','');}}});}else if(payment_type_paypal){$('#payment-form .form_table tr').each(function(){var paypal=null;paypal=$(this).find('#edit-submit-paypal');if(paypal.length>0){$(this).css('display','none');}else{$(this).css('display','');}});$('#edit-country').each(fls_change_states);payment_type_paypal=0;}}
function fls_update_total_price(){var no=1;var logos=new Array();$('#step-checkout1 .order-logos').each(function(){var attr=$(this).prop('checked');if(attr){no++;logos.push($(this).val());$(this).parent().addClass('logo_added');}else{$(this).parent().removeClass('logo_added');}});$('#edit-order-logos').val(logos.join(','));$('#step-checkout1 .checkout-multi-total-logos .total').text(no);no--;var price=parseFloat(Drupal.settings.checkout_first_price);var sum=parseFloat(no*parseFloat(Drupal.settings.checkout_price_item));var total=price+sum;total=total.toFixed(2);$('#step-checkout1 .checkout-multi-total-price .total').text(total);}
function update_payment_with_upsells_new_logo(action,type){return;if(Drupal.settings.promo_code_upsells)
return;if($('.upsells_new_total_price > span').length>0){var pricetext=$('.upsells_new_total_price > span').html();var obj=$('.upsells_new_total_price > span');}else{return;}
pricetext=parseFloat(pricetext);var newprice="";if($(action).is(":checked")){if($(action).hasClass("inputChecked")){if(($(action).attr('id')!=Drupal.settings.upsell_google_id&&$(action).attr('id')!=523&&$(action).attr('id')!=532&&$(action).attr('id')!=Drupal.settings.hosting_prod_id)||($(action).attr('id')==Drupal.settings.upsell_google_id&&!$(action).hasClass("seatUpdated"))||($(action).attr('id')==523&&!$(action).hasClass("seatUpdated"))||($(action).attr('id')==532&&!$(action).hasClass("seatUpdated"))||($(action).attr('id')==Drupal.settings.hosting_prod_id&&$("#weebly_packs").length==0))
return false;}else{$(action).addClass("inputChecked");}
$('#edit-'+$(action).val()).attr('value','1');var upsell_price=Drupal.settings.additional_offers[$(action).val()]['price'][Drupal.settings.upsell_country];if(upsell_price==undefined){upsell_price=Drupal.settings.additional_offers[$(action).val()]['default_price'];}
if($(action).attr('id')==Drupal.settings.upsell_google_id&&$("#seat_values").length>0)upsell_price=$('#seat_values option:selected').val()*upsell_price;else if($(action).attr('id')==523&&$("#bundle_seat_values").length>0){upsell_price=($('#bundle_seat_values option:selected').val()-1)*Drupal.settings.google_prod_price*1+upsell_price*1;}
else if($(action).attr('id')==532&&$("#custom_bundle_seat_values").length>0){upsell_price=($('#custom_bundle_seat_values option:selected').val()-1)*Drupal.settings.google_prod_price*1+upsell_price*1;}else if($(action).attr('id')==Drupal.settings.hosting_prod_id&&$("#weebly_packs").length>0&&Drupal.settings.weebly_packages!=undefined){upsell_price=upsell_price*1+Drupal.settings.weebly_packages[$("#weebly_packs option:selected").val()]['price']*1;}
newprice=parseFloat(pricetext)+parseFloat(upsell_price);newprice=newprice.toFixed(2);obj.html(newprice);if($('span.buy_now_price').length){$('span.buy_now_price').html(newprice);}
if($(action).attr('id')=='38')
{$('.attributes-box').css('display','block');}
if($(action).attr('id')=='447'){fls_events_add('added_cart_premium_upsell');}}else{if(!$(action).hasClass("inputChecked")){if(($(action).attr('id')!=Drupal.settings.upsell_google_id&&$(action).attr('id')!=523&&$(action).attr('id')!=532&&$(action).attr('id')!=Drupal.settings.hosting_prod_id)||($(action).attr('id')==Drupal.settings.upsell_google_id&&!$(action).hasClass("seatUpdated"))||($(action).attr('id')==523&&!$(action).hasClass("seatUpdated"))||($(action).attr('id')==532&&!$(action).hasClass("seatUpdated"))||($(action).attr('id')==Drupal.settings.hosting_prod_id&&$("#weebly_packs").length==0))
return false;}else{$(action).removeClass("inputChecked");}
$('#edit-'+$(action).val()).attr('value','');$('.attributes-box').css('display','none');if(type){var upsell_price=Drupal.settings.additional_offers[$(action).val()]['price'][Drupal.settings.upsell_country];if(upsell_price==undefined){upsell_price=Drupal.settings.additional_offers[$(action).val()]['default_price'];}
if($(action).attr('id')==Drupal.settings.upsell_google_id&&$("#seat_values").length>0)upsell_price=$('#seat_values option:selected').val()*upsell_price;else if($(action).attr('id')==523&&$("#bundle_seat_values").length>0){upsell_price=($('#bundle_seat_values option:selected').val()-1)*Drupal.settings.google_prod_price*1+upsell_price*1;}
else if($(action).attr('id')==532&&$("#custom_bundle_seat_values").length>0){upsell_price=($('#custom_bundle_seat_values option:selected').val()-1)*Drupal.settings.google_prod_price*1+upsell_price*1;}
else if($(action).attr('id')==Drupal.settings.hosting_prod_id&&$("#weebly_packs").length>0&&Drupal.settings.weebly_packages!=undefined){upsell_price=parseFloat(upsell_price)*1+Drupal.settings.weebly_packages[$("#weebly_packs option:selected").val()]['price']*1;}
newprice=pricetext-upsell_price;newprice=Math.round(newprice*100)/100;newprice=parseFloat(Math.round(newprice*100)/100).toFixed(2);obj.html(newprice);if($('span.buy_now_price').length){$('span.buy_now_price').html(newprice);}}else{var lng=0;if(Drupal.settings.notice_upsells){notice_upsells=Drupal.settings.notice_upsells;lng=notice_upsells.length;}
pricetext=Math.round(pricetext*100)/100;pricetext=parseFloat(Math.round(pricetext*100)/100).toFixed(2);obj.html(pricetext);if($('span.buy_now_price').length&&lng&&lng>0){$('span.buy_now_price').html(newprice);}}}
return newprice;}
function update_payment_with_upsells_from_notice(upsell){if($('.upsells_new_total_price > span').length>0){var pricetext=$('.upsells_new_total_price > span').html();var obj=$('.upsells_new_total_price > span');}else{return;}
if(Drupal.settings.current_price){pricetext=Drupal.settings.current_price;}
pricetext=parseFloat(pricetext);var newprice="";$('#edit-'+upsell).attr('value','1');newprice=parseFloat(pricetext)+parseFloat(Drupal.settings.additional_offers[upsell]['price'][Drupal.settings.upsell_country]);newprice=newprice.toFixed(2);obj.html(newprice);if($('span.buy_now_price').length){$('span.buy_now_price').html(newprice);}
Drupal.settings.current_price=newprice;return newprice;}
$(document).ready(function(){$('.upsells_new_check_logo input').each(function(){update_payment_with_upsells_new_logo(this,0);});$('.upsells_new_check_logo input').click(function(){update_payment_with_upsells_new_logo(this,1);});if(Drupal.settings.notice_upsells){var lng=0;notice_upsells=Drupal.settings.notice_upsells;lng=notice_upsells.length;if(lng&&lng>0){for(var i=0;i<lng;i++){update_payment_with_upsells_from_notice(notice_upsells[i]);}}}
$('.upsell-info').click(function(){return false;});$('.upsell-info').each(function(){$(this).hover(function(){var free_policy_why_title=$(this).attr('rel');if($(this).parent().find('.whyPopupUpsell').length==0){$(this).parent().append('<div class="whyPopupUpsell">'+free_policy_why_title+'</div>');}
$(this).parent().find('.whyPopupUpsell').show();},function(){$(this).parent().find('.whyPopupUpsell').hide();});});$('.upsells_new_see').click(function(){return false;});$('.upsells_new_see').each(function(){$(this).hover(function(){var free_policy_why_title=$(this).attr('rel');if($(this).parent().find('.whyPopupUpsell').length==0){var whyPopupId=$(this).parent().parent().parent().attr('id');var whyPopupClass='mouse_over_'+$(this).parent().parent().attr('item');$(this).parent().append('<div id="whyPopupUpsell_'+whyPopupId+'" class="whyPopupUpsell '+whyPopupClass+'">'+free_policy_why_title+'</div>');}
$(this).parent().find('.whyPopupUpsell').show();$(this).parent().parent().parent().parent().parent().css({'z-index':'3','position':'relative'});},function(){$(this).parent().find('.whyPopupUpsell').hide();$(this).parent().parent().parent().parent().parent().css({'z-index':'1'});});});$('.upsells_new_img').each(function(){$(this).hover(function(){if($(this).parent().parent().find('.upsells_new_see').length!=0){var free_policy_why_title=$(this).parent().parent().find('.upsells_new_see').attr('rel');if($(this).parent().parent().find('.whyPopupUpsell').length==0){var whyPopupId=$(this).parent().parent().attr('id');var whyPopupClass='mouse_over_'+$(this).parent().parent().attr('item');$(this).parent().parent().find('.upsells_new_details').append('<div id="whyPopupUpsell_'+whyPopupId+'" class="whyPopupUpsell '+whyPopupClass+'">'+free_policy_why_title+'</div>');}
$(this).parent().parent().find('.whyPopupUpsell').css('left','0px');$(this).parent().parent().find('.whyPopupUpsell').css('top','-10px');$(this).parent().parent().find('.whyPopupUpsell').show();$(this).parent().parent().parent().parent().css({'z-index':'3','position':'relative'});}},function(){$(this).parent().parent().find('.whyPopupUpsell').hide();$(this).parent().parent().find('.whyPopupUpsell').css('left','270px');$(this).parent().parent().find('.whyPopupUpsell').css('top','10px');$(this).parent().parent().parent().parent().css({'z-index':'1'});});});});function fls_store_checkout_get_vendor_name(){if($('#fls-store-payment-form #edit-payment-type').length)var payment_type_val=$('#fls-store-payment-form #edit-payment-type').val();if($('#fls-store-account-checkout-form #edit-payment-type').length)var payment_type_val=$('#fls-store-account-checkout-form #edit-payment-type').val();console.log(payment_type_val);var vendor_name=Drupal.settings.checkout_form.available_vendors[payment_type_val];return vendor_name;}
function fls_store_checkout_btpaypal_check(){if(typeof fls_braintree_paypal_checkout_check!='function')
return false;return fls_braintree_paypal_checkout_check();};$(document).ready(function(){logo_creator_step1_init();});function load_logo_design_form(){$("<div class='form_title'>"+Drupal.settings.logo_design_form_subtitle+"</div>").insertBefore(".form_table");$(".form_table tr:last>td:first").css("height","0px");$(".signupBtn .orangeBtn_center").html(Drupal.settings.logo_design_form_button);$(".form_table tr:nth-child(2)").insertAfter($(".form_table tr:nth-child(4)"));$(".step1_form tr .label").each(function(){var html=$(this).html();if($(this).find('label').length){if($(this).next('td').find('input').val()=="")
$(this).next('td').find('input').attr("value",$(this).find('label').html());$(this).next('td').find('input').attr("title",$(this).find('label').html());}else{temp=html.split('<span');if(temp.length>0){if(temp[0]){if($(this).next('td').find('input').val()=="")
$(this).next('td').find('input').attr("value",temp[0]);$(this).next('td').find('input').attr("title",temp[0]);}}}
if($(this).next('td').find('input').val()==$(this).next('td').find('input').attr("title"))
$(this).next('td').find('input').addClass('text-label');if(!$(this).next('td').find('select').attr('id'))
$(this).hide();});$('input[type="text"]').each(function(){if(this.value==""){this.value=$(this).attr('title');$(this).addClass('text-label');}
$(this).focus(function(){if(this.value==$(this).attr('title')){this.value='';$(this).removeClass('text-label');}});$(this).blur(function(){if(this.value==''){this.value=$(this).attr('title');$(this).addClass('text-label');}});});if(Drupal.settings.logocategory_split_set==2){$('#logo-creator-step1-page-form select').each(function(){if(this.value=="-1"){$(this).addClass('text-label');}
$(this).focus(function(){$(this).removeClass('text-label');});$(this).blur(function(){if(this.value=='-1'){$(this).addClass('text-label');}});});}}
function fls_find_form(obj){var current=false;var idok='';if($(obj).is('form')){idok=$(obj).attr(id);}
if($(obj).is('body')){idok='false';}
while(current==false){obj=$(obj).parent();if($(obj).is('form')){idok=$(obj).attr('id');current=true;}
if($(obj).is('body')){idok='false';}}
return idok;}
function logo_creator_step1_init(){$('form input[type=text]').each(function(){$(this).bind('keypress',function(e){var idform=fls_find_form(this);if(e.keyCode==13&&idform!='fls-store-payment-form'){setTimeout(function(){$('#'+idform+' #edit-submit').click();},500);}});});$('form input[type=password]').each(function(){$(this).bind('keypress',function(e){var idform=fls_find_form(this);if(e.keyCode==13&&idform!='fls-store-payment-form'){$('#'+idform+' #edit-submit').click();}});});$('#edit-submit').css('display','inline-block');$('#logo-creator-step1-page-form #edit-submit').click(function(){additionalErrorHTML="";$("#rsvErrors").html("").css('display','none');var errorHTML=Drupal.settings.step_1_form.form_header_form;if($(".page-body-logo-design").length>0){errorHTML='';$("#rsvErrors").parent().parent().addClass("customErrMsg");}
if($('input[name="new_design"]').length>0&&$('input[name="new_design"]').val()=='logomaker'){if($('#edit-logo-type').val()=="00"){additionalErrorHTML+=Drupal.settings.step_1_form.logo_type.required;$('#edit-logo-type').addClass('errorFieldDemo5');}
else{$('#edit-logo-type').removeClass('errorFieldDemo5');}}
if(Drupal.settings.logocategory_split_set==2){if($('#edit-logo-type').val()=="-1"){additionalErrorHTML+=Drupal.settings.step_1_form.logo_type.invalid;$('#edit-logo-type').addClass('errorFieldDemo5');fls_events_add('error_msg_not_selecting_logo_category',1);}
else{$('#edit-logo-type').removeClass('errorFieldDemo5');}}
if($('input[name="new_design"]').length>0&&$('input[name="new_design"]').val()=='logocategory'){if($('#edit-logo-type').val()=="-1"){additionalErrorHTML+=Drupal.settings.step_1_form.logo_type.invalid;$('#edit-logo-type').addClass('errorFieldDemo5');fls_events_add('error_msg_second_lb',1);}
else{$('#edit-logo-type').removeClass('errorFieldDemo5');}}
if($('input[name="logo_first_line"]').val()==""||$('input[name="logo_first_line"]').val()==$('input[name="logo_first_line"]').attr('title')){additionalErrorHTML+=Drupal.settings.step_1_form.logo_first_line.required;$('input[name="logo_first_line"]').addClass('errorFieldDemo5');$('#edit-first-line-label').addClass('signup_error_label');$('#edit-first-line-label-icon').show();}else{$('input[name="logo_first_line"]').removeClass('errorFieldDemo5');$('#edit-first-line-label').removeClass('signup_error_label');$('#edit-first-line-label-icon').hide();}
if(Drupal.settings.no_leads_email){if($('input[name="email"]').val()==""){additionalErrorHTML+=Drupal.settings.step_1_form.email.required;$('input[name="email"]').addClass('errorFieldDemo5');$('#email-label').addClass('signup_error_label');$('#email-label-icon').show();}else{$('input[name="email"]').removeClass('errorFieldDemo5');$('#email-label').removeClass('signup_error_label');$('#email-label-icon').hide();}
if($('input[name="confirm_email"]').val()==""){additionalErrorHTML+=Drupal.settings.step_1_form.confirm_email.required;$('input[name="confirm_email"]').addClass('errorFieldDemo5');$('#confirm-email-label').addClass('signup_error_label');$('#confirm-email-label-icon').show();}else if($.trim($('input[name="confirm_email"]').val().toLowerCase())!=$.trim($('input[name="email"]').val().toLowerCase())){additionalErrorHTML+=Drupal.settings.step_1_form.confirm_email.not_confirm;$('input[name="confirm_email"]').removeClass('errorFieldDemo5');$('#confirm-email-label').removeClass('signup_error_label');$('#confirm-email-label-icon').hide();}else{$('input[name="confirm_email"]').removeClass('errorFieldDemo5');$('#confirm-email-label').removeClass('signup_error_label');$('#confirm-email-label-icon').hide();}}
if(additionalErrorHTML){if($("#edit-new-design").val()!="")$(".error_icon").hide();errorHTML+=additionalErrorHTML;$("#rsvErrors").css("display","block");$("#rsvErrors").html(errorHTML);var iframe=window.parent.document.getElementById('TB_iframeContent');if(typeof iframe!="undefined"&&iframe!=null){var height=iframe.offsetHeight;iframe.style.height=(height+80)+"px";}
return false;}
else{if($('input[name="logo_second_line"]').val()==$('input[name="logo_second_line"]').attr('title')){$('input[name="logo_second_line"]').val("");}
if($('input[name="tag_line"]').val()==$('input[name="tag_line"]').attr('title')){$('input[name="tag_line"]').val("");}
if($('.step1_popup.step1_popup_ajax').length>0){if(typeof step1_form_submit_ajax=='function'){step1_form_submit_ajax();return false;}}
$('#logo-creator-step1-page-form').submit();return false;}});$('#logo-creator-step1-page-form').bind('submit',function(){if(typeof stop_duplicate_form_submit!=='undefined')return false;else stop_duplicate_form_submit=true;});$('.limitedCountSelect').focus(function(){$(this).attr("size",14);});$('.limitedCountSelect').blur(function(){$(this).attr("size",1);});$('.limitedCountSelect option').click(function(){if($('.limitedCountSelect').attr("size")>1){$('.limitedCountSelect').attr("size",1);$('.limitedCountSelect').blur();}});var isIE11=(!!navigator.userAgent.match(/Trident\/7\./));if($.browser.msie||isIE11){$('.limitedCountSelect').mouseup(function(){if($(this).attr('isopen')=='1'){$(this).attr('isopen','0');setTimeout(function(){$('.limitedCountSelect').trigger('blur');},10);return;}
$(this).attr('isopen','1');});}
if(Drupal.settings.show_step4_offer!=undefined){if(Drupal.settings.browser_details_name!='ie'){$("#step1 .form_table input, #step1 .form_table select").each(function(){$(this).addClass('popunder_click');popunder_init_element($(this).parent())});popunder_init_element($('#step1 #edit-submit'));}
$("#step1 .form_table input, #step1 .form_table select").click(function(){var url=Drupal.settings.baseUrl+"/step4?offer=1";if(Drupal.settings.show_step4_offer!=undefined&&Drupal.settings.show_step4_offer){if(typeof Drupal.settings.offer_flash_submited=='undefined'&&Drupal.settings.browser_details_name!=='op'){fls_new_page(url,'scrollbars=yes,resizable=yes&location=yes&toolbar=yes&menubar=yes','step4');}}
$(this).focus();});}};(function($){$.fn.jCarouselLite=function(o){o=$.extend({btnPrev:null,btnNext:null,btnGo:null,mouseWheel:false,auto:null,speed:200,easing:null,vertical:false,circular:true,visible:3,start:0,scroll:1,beforeStart:null,afterEnd:null},o||{});if(!o.circular)
{$(o.btnPrev).addClass("disabled");}
return this.each(function(){var running=false,animCss=o.vertical?"top":"left",sizeCss=o.vertical?"height":"width";var div=$(this),ul=$("ul",div),tLi=$("li",ul),tl=tLi.length,v=o.visible;if(o.circular){ul.prepend(tLi.slice(tl-v-1+1).clone()).append(tLi.slice(0,v).clone());o.start+=v;}
var li=$("li",ul),itemLength=li.length,curr=o.start;div.css("visibility","visible");li.css({overflow:"hidden",float:o.vertical?"none":"left"});ul.css({margin:"0",padding:"0",position:"relative","list-style-type":"none","z-index":"1"});div.css({overflow:"hidden",position:"relative","z-index":"2"});var liSize=o.vertical?height(li):width(li);var ulSize=liSize*itemLength;var divSize=liSize*v;li.css({width:li.width(),height:li.height()});ul.css(sizeCss,ulSize+"px").css(animCss,-(curr*liSize));div.css(sizeCss,divSize+"px");if(o.btnPrev)
$(o.btnPrev).click(function(){return go(curr-o.scroll);});if(o.btnNext)
$(o.btnNext).click(function(){return go(curr+o.scroll);});if(o.btnGo)
$.each(o.btnGo,function(i,val){$(val).click(function(){return go(o.circular?o.visible+i:i);});});if(o.mouseWheel&&div.mousewheel)
div.mousewheel(function(e,d){return d>0?go(curr-o.scroll):go(curr+o.scroll);});if(o.auto)
setInterval(function(){go(curr+o.scroll);},o.auto+o.speed);function vis(){return li.slice(curr).slice(0,v);};function go(to){if(!running){if(o.beforeStart)
o.beforeStart.call(this,vis());if(o.circular){if(to<=o.start-v-1){ul.css(animCss,-((itemLength-(v*2))*liSize)+"px");curr=to==o.start-v-1?itemLength-(v*2)-1:itemLength-(v*2)-o.scroll;}else if(to>=itemLength-v+1){ul.css(animCss,-((v)*liSize)+"px");curr=to==itemLength-v+1?v+1:v+o.scroll;}else curr=to;}else{if(to<0||to>itemLength-v)return;else curr=to;}
running=true;ul.animate(animCss=="left"?{left:-(curr*liSize)}:{top:-(curr*liSize)},o.speed,o.easing,function(){if(o.afterEnd)
o.afterEnd.call(this,vis());running=false;});if(!o.circular){$(o.btnPrev+","+o.btnNext).removeClass("disabled");$((curr-o.scroll<0&&o.btnPrev)||(curr+o.scroll>itemLength-v&&o.btnNext)||[]).addClass("disabled");}}
return false;};if(itemLength<=o.visible)
$(o.btnNext).addClass("disabled");});};function css(el,prop){return parseInt($.css(el[0],prop))||0;};function width(el){return el[0].offsetWidth+css(el,'marginLeft')+css(el,'marginRight');};function height(el){return el[0].offsetHeight+css(el,'marginTop')+css(el,'marginBottom');};})(jQuery);;$(function(){if($('.inner_step3 .scrollerConteiner ul li').length>0){$(".inner_step3 .scroller").jCarouselLite({btnNext:".next",btnPrev:".prev",circular:false,visible:5});}});$(function(){if($('#step-checkout1 .scrollerConteiner ul li').length>0){$('#checkout-slider-wrapper').css('display','');$("#step-checkout1 .scroller").jCarouselLite({btnNext:".next",btnPrev:".prev",circular:false,visible:4});}});;var check_payment_interval=0;var reorderEUCardType="";var reorderEUCardEditLink="";$(document).ready(function(){if(typeof Drupal.settings.reactivate_message!='undefined'){if(Drupal.settings.reactivate_message.length>0){setTimeout(function(){alert(Drupal.settings.reactivate_message);},500);}}
if(typeof Drupal.settings.saved_logos_action_message!='undefined'){if(Drupal.settings.saved_logos_action_message.length>0){alert(Drupal.settings.saved_logos_action_message);}}
$('.purchased_download_link').mousedown(function(){var category='/mylogos';var event='click';var label='';if($(this).hasClass('purchased_download_png')){label='download_png_only';}
if($(this).hasClass('purchased_logo_email')){label='email_logo';}
if($(this).hasClass('purchased_logo_sms')){label='text_logo';}
ga('send','event',category,event,label);});saved_logos_check_hash_autodownload();$("#websites_block .upgradeBtn").click(function(){$(".page-body-mylogos .checkoutwebsitebundle_popup .container.website_upsell").hide();$(".page-body-mylogos .checkoutwebsitebundle_popup .container.website_upsell .upsells_new_single").hide();Drupal.settings.site_id=$(this).attr("id");CHECKOUTWEBSITEBUNDLE.init();var current;var upsellNr;current=Drupal.settings.domainUpsells[$(this).attr("id")];upsellNr=0;$(".checkoutwebsitebundle_popup .upsells_new_single").each(function(){if(current.indexOf(parseInt($(this).attr("item")))!=-1){upsellNr++;$(this).show();}});if(upsellNr==1)$(".website_upsell .hr").hide();$(".page-body-mylogos .checkoutwebsitebundle_popup .container.website_upsell").show();});$('.show_feedback_popup').click(function(){show_feedback_popup(this);});$('.page-body-mylogos .bc50-banner1 a').click(function(){fls_events_add('bc50_mylogos_banner')});$('#edit-account-form #edit-submit').click(function(){$('#edit-account-form').submit();return false;});$('#fast-password-reset-form #edit-submit').click(function(){$('#fast-password-reset-form').submit();return false;});$('#fls-contactform-form #edit-submit').click(function(){$('#fls-contactform-form').submit();return false;});$('#unsubscribe-form #edit-submit').click(function(){$('#unsubscribe-form').submit();return false;});var logo_id=$('#last_purchased_logo_id_fb').val();if(logo_id){PO.init();}else{$('.thankYouBox, .overlay').css({"display":"none"});var logo_id=$('#last_purchased_logo_id').val();if(logo_id){check_payment_interval=setInterval("check_payment_ajax('"+logo_id+"')",10000);}}
$('.thankYouBox').click(function(e){if($(e.target).is('.purchase')){$.ajax({url:Drupal.settings.baseUrl+'/save-bc-purchase/',dataType:"json",success:function(Response){if(Response.success=='1'){}}});return true;}
if($(e.target).is('.download')||$(e.target).is('.noThankYou')){PO.hidePopUp();}
if($(e.target).is('.shareFB')){FB.ui({method:'feed',name:'Do you LIKE my new logo?',link:'http://www.freelogoservices.com/?utm_campaign=FaceBookLogoShare&utm_medium=ThankyouPageLightbox&utm_source=Facebook',picture:$('#logo_share_fb').attr('src'),caption:'www.FreeLogoServices.com',description:'I created my new logo on FreeLogoServices.com'},function(response){if(response&&response.post_id){Drupal.settings.fbPostID=response.post_id;}
PO.hidePopUp();});}});$('.fb-share-logo').click(function(e){FB.ui({method:'feed',name:Drupal.settings.fbShare.name,link:Drupal.settings.fbShare.utmLink,picture:$(this).parent().parent().parent().find('img.logo_thumb').attr('src'),caption:Drupal.settings.fbShare.caption,description:Drupal.settings.fbShare.description},function(response){if(response&&response.post_id){var lengPref="";if(Drupal.settings.lang)lengPref='/'+Drupal.settings.lang;$.ajax({url:Drupal.settings.baseUrl+lengPref+'/save-fb-share/',dataType:"json",success:function(Response){if(Response.success=='1'){}}});}else{}});});$('.clickable_link').click(function(e){e.preventDefault()});if($('#snapengage_contactus').length>0){$('#SnapABug_P').appendTo('#snapengage_contactus');SnapABug.startLink();}
$("#saved_logos .left .eu_card, #saved_logos .reorderUsCard, #saved_logos .reorderEditUsCard").click(function(){var href=$(this).attr('href');reorderEUCardEditLink=href;var classes=($(this).attr("class")).split(" ");reorderEUCardType=classes[0];href=href.split('/');var logoID=href.pop();if(logoID){var classes=$(this).attr('class');classes=classes.split(' ');var sideID=0;var cl_id=0;var side_clid=0;for(var i in classes){console.log(classes[i])
if(classes[i].indexOf('carddetails')==0){var details=classes[i].split('_');sideID=details[2];cl_id=details[3];side_clid=details[4];}}
bc2eu_init(logoID,sideID,cl_id,side_clid);return false;}});});function bc2eu_after_save_mylogos(data){$('.eucard_popup .eucard_images img').hide();$('.eucard_popup .eucard_images img').attr('src',data['preview1']);var href=$('.eucard_popup .buyNowBtn').attr('href');href=href.split('/');href.pop();href.push(data['design_id']);href=href.join('/');$('.eucard_popup .buyNowBtn').attr('href',href);if(reorderEUCardType=="reorderEditUsCard"){$('.eucard_popup .buyNowBtn').hide();$('.eucard_popup .editCardBtn').attr('href',reorderEUCardEditLink);}else{$('.eucard_popup .continueBtn').hide();}
href=$('.eucard_popup .editCardBtn').attr('href');href=href.split('/');href.pop();href.push(data['design_id']);href=href.join('/');$('.eucard_popup .editCardBtn').attr('href',href);setTimeout(function(){EUCARD.init()},500);$('.eucard_popup .eucard_images img').show();}
function check_payment_ajax(logo_id){if(logo_id){var fbpostid='';if(Drupal.settings.fbPostID!=undefined){fbpostid='?fbPostID=true';}
$.ajax({url:Drupal.settings.baseUrl+'/check-payment/'+logo_id+fbpostid,dataType:"json",success:function(Response){if(Response.success=='1'){clearInterval(check_payment_interval);var url=window.location.href;window.location.href=url;}}});}}
var fls_dow_win=null
function fls_close_download_window(){var url=$(this).attr('href');fls_dow_win=window.open(url,'','width=1,height=1');setTimeout(function(){window.fls_dow_win.close();},2000);return false;}
var PO={init:function(){if($('.thankYouBox').length>0&&$('.overlay').length>0){PO.placePopUp();$('.thankYouBox .close, .thankYouBox .noThankYou').click(PO.hidePopUp)}},initKeep:function(){if($('.thankYouBox').length>0&&$('.overlay').length>0){$(".thankYouBox .feedback_link .feedback_img").show();$(".thankYouBox .feedback_link .feedback_img").css("visibility","hidden");$(".thankYouBox .feedback_link .feedback_hide").hide();PO.placePopUpKeep();$('.thankYouBox .close, .thankYouBox .noThankYou,.thankYouBox .diylogo_no').click(PO.hidePopUpKeep);$(".thankYouBox .feedback_link .feedback_img").css("visibility","visible");}},initKeepF:function(){if($('.feedbackpopup').length>0&&$('.overlay').length>0){$(".feedbackpopup .feedback_link .feedback_img").show();$(".feedbackpopup .feedback_link .feedback_img").css("visibility","hidden");$(".feedbackpopup .feedback_link .feedback_hide").hide();PO.placePopUpKeepF();$('.feedbackpopup .close, .feedbackpopup .noThankYou,.feedbackpopup .diylogo_no').click(PO.hidePopUpKeepF);$(".feedbackpopup .feedback_link .feedback_img").css("visibility","visible");}},initKeepD:function(){if($('.diy_edit_logo').length>0&&$('.overlay').length>0){$(".diy_edit_logo .feedback_link .feedback_img").show();$(".diy_edit_logo .feedback_link .feedback_img").css("visibility","hidden");$(".diy_edit_logo .feedback_link .feedback_hide").hide();PO.placePopUpKeepD();$('.diy_edit_logo .close, .diy_edit_logo .noThankYou,.diy_edit_logo .diylogo_no').click(PO.hidePopUpKeepD);$(".diy_edit_logo .feedback_link .feedback_img").css("visibility","visible");}},placePopUp:function(){var overlay=$('.overlay');var thankYouBox=$('.thankYouBox');$('.overlay, .thankYouBox').remove();var docH=$(document).height();var docW=$(document).width();overlay.css({"width":docW+"px","height":docH+"px"});thankYouBox.prependTo('body');overlay.prependTo('body');overlay.show();thankYouBox.show();var bW=$('.thankYouBox').width();var bH=$('.thankYouBox').height();var wW=$(window).width();var wH=$(window).height();bW=wW/2-bW/2;bH=wH/2-bH/2;$('.thankYouBox').css({left:bW,top:bH>40?bH:40});},placePopUpKeep:function(){var overlay=$('.overlay');var thankYouBox=$('.thankYouBox');$('.overlay, .thankYouBox').remove();var docH=$(document).height();var docW=$(document).width();overlay.css({"width":docW+"px","height":docH+"px"});thankYouBox.prependTo('body');overlay.prependTo('body');overlay.show();var bW=$('.thankYouBox').width();var bH=$('.thankYouBox').height();var wW=$(window).width();var wH=$(window).height();bW=wW/2-bW/2;bH=wH/2-bH/2;$('.thankYouBox').css({left:bW,top:bH>40?bH:40});thankYouBox.show();$('html,body').animate({scrollTop:$('body').offset().top},'slow');},placePopUpKeepF:function(){var overlay=$('.overlay');var thankYouBox=$('.feedbackpopup');$('.overlay, .feedbackpopup').remove();var docH=$(document).height();var docW=$(document).width();overlay.css({"width":docW+"px","height":docH+"px"});thankYouBox.prependTo('body');overlay.prependTo('body');overlay.show();var bW=$('.feedbackpopup').width();var bH=$('.feedbackpopup').height();var wW=$(window).width();var wH=$(window).height();bW=wW/2-bW/2;bH=wH/2-bH/2;$('.feedbackpopup').css({left:bW,top:bH>40?bH:40});thankYouBox.show();$('html,body').animate({scrollTop:$('body').offset().top},'slow');},placePopUpKeepD:function(){var overlay=$('.overlay');var thankYouBox=$('.diy_edit_logo');$('.overlay, .diy_edit_logo').remove();var docH=$(document).height();var docW=$(document).width();overlay.css({"width":docW+"px","height":docH+"px"});thankYouBox.prependTo('body');overlay.prependTo('body');overlay.show();var bW=$('.diy_edit_logo').width();var bH=$('.diy_edit_logo').height();var wW=$(window).width();var wH=$(window).height();bW=wW/2-bW/2;bH=wH/2-bH/2;$('.diy_edit_logo').css({left:bW,top:bH>40?bH:40});thankYouBox.show();$('html,body').animate({scrollTop:$('body').offset().top},'slow');},hidePopUp:function(){$('.thankYouBox').fadeOut();$('.overlay').fadeOut();logo_thankyou_popup_trigger();$('.thankYouBox').remove();$('.overlay').remove();return false;},hidePopUpKeep:function(){$('.thankYouBox').fadeOut();$('.overlay').fadeOut()
return false;},hidePopUpKeepF:function(){$('.feedbackpopup').fadeOut();$('.overlay').fadeOut()
return false;},hidePopUpKeepD:function(){$('.diy_edit_logo').fadeOut();$('.overlay').fadeOut()
return false;}}
function show_purchased_edit_popup(id,bc)
{$('.diylogo_subtitle').hide();if(bc)
$('.diylogo_subtitle_bc').show();else
$('.diylogo_subtitle_logo').show();var link=Drupal.settings.baseUrl;link+=bc?'/business-cards':'';link+='/step3/logo/'+id;$('.diy_edit_logo .diylogo_yes a').attr('href',link);PO.initKeepD();return false;}
function show_feedback_popup(event)
{var link=$(event).attr('href');var banner=$(event).hasClass('banner_mylogos2');$.ajax({url:link,dataType:"json"});PO.initKeepF();$('.thankYouBox .feedback_hide').hide();$.ajax({url:Drupal.settings.baseUrl+'/global-track/ySD0zQA=',dataType:"json"});$('.thankYouBox .feedback_link').click(function(e){e.preventDefault();$(this).find(".feedback_img").hide();$(this).find(".feedback_hide").show();$(this).find(".feedback_hide textarea").select();});$('.thankYouBox #feedback_facebook').click(function(e){$.ajax({url:Drupal.settings.baseUrl+'/global-track/3Cn22gcdcc4=',dataType:"json"});});$('.thankYouBox #feedback_email').click(function(e){$.ajax({url:Drupal.settings.baseUrl+'/global-track/3yX01gk=',dataType:"json"});});$('.thankYouBox #feedback_twitter').click(function(e){$.ajax({url:Drupal.settings.baseUrl+'/global-track/zj...8yxEXbA==',dataType:"json"});});return false;}
function logo_thankyou_popup_trigger(){if(!$('.bc-purchasePopup').length>0&&!$('.tyFacebook').length>0)
return true;var logo_id=$('#last_purchased_logo_id').val();if(logo_id){setTimeout(function(){logo_thankyou_check_status(logo_id)},10000);}}
function logo_thankyou_check_status(logo_id){var fbpostid='';if(Drupal.settings.fbPostID!=undefined){fbpostid='?fbPostID=true';}
$.ajax({url:Drupal.settings.baseUrl+'/check-payment/'+logo_id+fbpostid,dataType:"json",success:function(Response){if(Response.success=='1'){var url=window.location.href;window.location.href=url;}
else{$('.payment_delay_message img').hide();$('.payment_delay_message_generating').hide();}}});}
function saved_logos_check_hash_autodownload(){var hash=window.location.hash;if(!hash)return-1;if(!$(hash).length)return-2;if(hash.substr(0,3)!='#l_')return-3;var logo_id=hash.substr(3);if(!Drupal.settings.autodownload_files)return-4;if(typeof Drupal.settings.autodownload_files[logo_id]=='undefined')return-5;var src=Drupal.settings.autodownload_files[logo_id];if(!$('#saved_logos_iframe').length)return-6;$('#saved_logos_iframe').attr('src',src);};function get_screen_size(){return $(window).width();}
var right_click_disabled=function(){this.apply=function(item){item.bind('mousedown',function(evt){var notice_img=0;if($("body[class*='page-body-notice']").length>0){if(((this.parentElement.className).split(" ")).indexOf("flstheme_notice_right")!==-1){notice_img=1;}}
if(Drupal.settings.is_flstheme){if($('.mobile_view').length==0){if($("body[class*='page-body-step2']").length){ga('send','event','Step2','Click','Image');}}}
if((notice_img&&evt.which==3)||(!notice_img&&evt.which!=1)){return false;}}).bind('contextmenu',function(){return false;});};};function config_bc_suggestion_lightbox(){var suggest_cfg;var lang="en";if(Drupal.settings.lang!="")lang=Drupal.settings.lang;if(lang=="pt")lang="pt-pt";else if(lang=="cn")lang="zh-hans";suggest_cfg={config:Drupal.settings.baseUrl+'/sites/all/themes/freelogoservices/flash/config/config.xml',line1:'test',line2:'here+we+go+again',line3:'',logoID:0,act:'',anchor1:'center',anchor2:'center',anchor3:'',anchorPosition1:'',anchorPosition2:'',anchorPosition3:'',autoscalling:1,type:2,lang:lang,loading:'Loading',suggestCards:1,product_type:'logo',logo_mode:'normal',suggested_first_name:Drupal.settings.bc_default_text['fname'],suggested_last_name:Drupal.settings.bc_default_text['lname'],suggested_job_title:Drupal.settings.bc_default_text['jobtitle'],suggested_addr_1:Drupal.settings.bc_default_text['address1'],suggested_addr_2:Drupal.settings.bc_default_text['address2'],suggested_phone:Drupal.settings.bc_default_text['phone'],suggested_email:Drupal.settings.bc_default_text['email'],suggested_website:Drupal.settings.bc_default_text['website'],bc_suggestion_ids:Drupal.settings.bc_suggestion_cards,parent:1,post_back_data:{parm1:1,param2:3,param3:[11,12,'asdasf'],param4:{asd:12,sdf:13}},card_type:Drupal.settings.bc_type,choice_callback:function(choice){if($.isEmptyObject(choice)){fls_events_add('close_bc_upsell');console.log('X');if(!Drupal.settings.weebly_preview_v2_split_set){$("#FLSBcSuggestLogoStep2Canvas-BackDesignDlg").hide();$(".selector-dlg-wrapper").hide();$('#TB_overlay').remove();$('#TB_window').remove();$('.overlay').first().show();if(fls_show_logowebv2_lightbox()){return false;}}else{$('.overlay').first().show();}
if($('.products_lp_box').length>0&&!$('.logoweb_popup.initialized').length&&!Drupal.settings.weebly_preview_v2_split_set){PP_UL.init();}else{if(Drupal.settings.is_user_logged)
window.location=Drupal.settings.baseUrl+"/notice/"+Drupal.settings.saved_logo_id;else window.location=Drupal.settings.baseUrl+"/step4/";}}else{$('.overlay').first().show();$.post(Drupal.settings.baseUrl+"/color-matched-bc/",{logo_id:Drupal.settings.saved_logo_id,ajax_call:1,bc_svg:choice.bc_svg,bc_parent_id:choice.bc_parent_id,bc_layout:choice.bc_layout,bc_raster:choice.bc_raster},function result(res){fls_events_add('accepted_bc_upsell');lang="";if(Drupal.settings.lang!="")lang="/"+Drupal.settings.lang;window.location=Drupal.settings.baseUrl+lang+"/business-cards/step3/logo/"+res+"?suggest=1";},"json");}},load_complete_callback:function(){if($("body[class*='page-body-step2']").length){if(typeof Drupal.settings.save_logo_timer_obj['bc_editor_end']=='undefined')Drupal.settings.save_logo_timer_obj['bc_editor_end']=Date.now();fls_events_add('bc_suggest_step2_timer',(Drupal.settings.save_logo_timer_obj['bc_editor_end']-Drupal.settings.save_logo_timer_obj['bc_editor_start']));}
Drupal.settings.bc_suggestions_html5_loaded=true;$('#FLSBcSuggestLogoStep2Canvas-BackDesignDlg .fls-button.fls-orangebutton.selector-action').click(function(e){fls_events_add('lightbox_step2bc_negativecta');});$('#FLSBcSuggestLogoStep2Canvas-BackDesignDlg .close-suggest-dlg').click(function(e){fls_events_add('lightbox_step2bc_close');});},before_dlg_show_callback:function(){Drupal.settings.bc_suggestions_html5_completed_loaded=true;console.log('completed loaded');show_loaded_color_bc_suggestion_lightbox();$('.TB_overlayBG').remove();$(".selector-dlg-wrapper .selector-slider .design-item span").addClass("orangeButton");},load_fonts:['Helvetica'],dummy:1};Drupal.settings.bc_suggestions_html5_start_loaded=true;LogoStep2BcSuggest.Init(suggest_cfg);}
function show_loaded_color_bc_suggestion_lightbox(){if(Drupal.settings.bc_suggestions_html5_completed_loaded!=undefined&&$('.thankYouBox.thankYouBoxVisible').length==0){$('.overlay').hide();$('.overlay').first().show();console.log('show overlay');console.log(Drupal.settings.websites_add_to_cart_status);if(Drupal.settings.websites_add_to_cart_status!=undefined&&!Drupal.settings.websites_add_to_cart_status){setTimeout(function(){show_loaded_color_bc_suggestion_lightbox()},400);return false;}
console.log('Show BC suggest!!!');$('#FLS_PageLoadingOverlay').hide();$("#FLSBcSuggestLogoStep2Canvas-BackDesignDlg").show().css('visibility','visible');$(".selector-dlg-wrapper").show();$('.overlay').hide();}else{console.log('Hide BC suggest!!!');$("#FLSBcSuggestLogoStep2Canvas-BackDesignDlg").hide().css('visibility','hidden');$(".selector-dlg-wrapper").hide();}}
function color_bc_suggestion_lightbox(logo_id,fonts){console.log("color_bc_suggestion_lightbox");var myfonts=[];if(fonts!=""){temp=fonts.split(",");if(temp.length>0)
for(i=0;i<temp.length;i++)
myfonts[i]=temp[i];}
console.log("check_logo_direct_save: "+Drupal.settings.step3_save_result);if($("body[class*='page-body-step2']").length&&Drupal.settings.weebly_preview_v2_split_set){fls_show_logowebv2_lightbox();}
interval=setInterval(function(){if(Drupal.settings.bc_suggestions_html5_loaded!=undefined){$('#TB_window').remove();LogoStep2BcSuggest.setLogoId(logo_id,myfonts);clearInterval(interval);}},1000);}
$(document).ready(function(){fls_events_add('screen_size',get_screen_size());if($("#new_logos_nr").length>0){fls_events_add('new_logos_nr',$("#new_logos_nr").val());}
$(".box2 .customize_logos").click(function(){fls_events_add('click_step2_customize_cta');});$(".customize_logo_step2_banner .customize_logos").click(function(){fls_events_add('click_step2_banner_customize_cta');});$(".step2Edit").click(function(){fls_events_add('clicked_edit_logo_text');});$('.deluxeStartNow').click(function(e){e.preventDefault();fls_events_add('deluxeaffiliate_start_now');window.location=$(this).attr('href');return false;});if($('#step2_filters').length>0){step2_filters_init();}
if(Drupal.settings.show_popup_logomix==1)
{tb_show('',Drupal.settings.popup_logomix_url+'?TB_iframe=true&width=571&height=350&modal=true','');}
if(Drupal.settings.show_snap_chat!=undefined&&Drupal.settings.show_snap_chat>0)
{setTimeout(function(){fls_snap_online_chat()},3000);}
if(Drupal.settings.show_popup_cantfind==1)
{}
$('.logoselect_step2_banner a').click(function(e){e.preventDefault();fls_events_add('logoselect_step2_banner_click');window.location=$(this).attr('href');return false;});if($('.pager .step2_pagination_next_only .next').length){$('.pager .step2_pagination_next_only .next').click(function(e){e.preventDefault();ls2s_next_split_click()});}else{$('.pager_step2.ptop li a').click(function(){fls_events_add('clicks_step2_top_pagination')});$('.pager_step2.pbottom li a').click(function(){fls_events_add('clicks_step2_bottom_pagination')});}
if(Drupal.settings.show_ad_logomix==1)
{$('#logomix_ad_step2').addClass(Drupal.settings.ad_logomix_classes);$('#logomix_ad_step2').append('<a href="'+Drupal.settings.ad_logomix_url+'" target="_blank"><img src="'+Drupal.settings.ad_logomix_img+'" alt="logomixad" /></a>')}
var right_click=new right_click_disabled();right_click.apply($('.logo_thumb, .logo_thumb_placeholder, .bcweb_preview img, #page_options #product_image img, #bc_options .product_image img, .websites_domain_page img, .checkout_element_image, #notice_right_container img, .option_steps_form .option img, .businesscards_upsell_page .upsell_info'));$('.thumbs_list1 ul li').click(function(){var ahref=$(this).find('a');if($(ahref).hasClass('multiversion')){tb_show(Drupal.t('Select position for your logo and text'),$(ahref).attr('href'),'');return false;}else{show_loading_overlay();setTimeout(function(){window.location=$(ahref).attr('href');},500);return false;}});$('.select_over_effect').click(function(){$(this).addClass('highlight_field');}).bind('mouseout',function(){$(this).removeClass('highlight_field');});$('.select_over_effect option').bind('mouseover',function(){$(this).parent().addClass('highlight_field');});$('.input_click_effect').click(function(){$(this).addClass('highlight_field');}).bind('blur',function(){$(this).removeClass('highlight_field');});$('.thumbs_list1 ul.ajax-customize li').bind('mouseover click',function(event){if($('.thumbs_list1 ul.ajax-customize li.step2-elem-hover').length){var o=$('.thumbs_list1 ul.ajax-customize li.step2-elem-hover');if(Drupal.settings.step2_save==2){$('#placetoremove').remove();$(o).css('position','relative');$(o).css('left','auto');$(o).css('top','auto');$(o).find('a').css('border-width','1px');$(o).find('a .step2-hover-btns').hide();$(o).find('.favorites-btns .favoriteStatus').hide();$(o).find('.favorites-btns').removeClass('grey-arrow');$(o).find('.favorites-btns').css('zIndex','0');$(o).removeClass('step2-elem-hover');}else{$('.logo_notice1').remove();}}
if(Drupal.settings.step2_save==2){var position=$(this).position();$(this).css('position','absolute');$(this).css('left',position.left);$(this).css('top',position.top);$(this).before("<li id='placetoremove' class='placeHolder' style='width: 200px; float:left;'></li>");if($('.thumbs_list1 ul.ajax-customize li:nth-child(4n)').hasClass('placeHolder')){$('.thumbs_list1 ul.ajax-customize #placetoremove').css('height','154px');}
$(this).find('a').css('border-width','1px');$(this).addClass('step2-elem-hover');console.log("CLICK MOBILE: "+event.type);if(Drupal.settings.step2_split_set==0)$(this).find('a .step2-hover-btns').show();if(Drupal.settings.step2_split_set==1){$(this).addClass('step2-v1-hover');if($(".window_size_mobile").length){$(this).find('a .step2-hover-btns .step2-customize-logo').addClass('dont_count_edit').trigger('click');}}
if(Drupal.settings.step2_split_set==2){$(this).find('a .step2-hover-btns span.step2-save-button').hide();$(this).find('a .step2-hover-btns .step2-v2-hover').show();$(this).find('a .step2-hover-btns').show();};$(this).find('.favorites-btns .favoriteStatus').show();$(this).find('.favorites-btns').addClass('grey-arrow');$(this).find('.favorites-btns').css('zIndex','100000');}else{var offset=$(this).offset();if($('.logo_notice1').length<=0&&!$(this).parent().parent().hasClass('step2b')){$('body').append('<div class="logo_notice1">'+Drupal.settings.step2_texttojs.text1+'</div>');}
$('.logo_notice1').css('position','absolute').css('top',offset.top-35+'px').css('left',offset.left+15+'px').css('display','');}}).bind('mouseout',function(){if(window.navigator.msPointerEnabled){return;}
if(Drupal.settings.step2_save==2){$('#placetoremove').remove();$(this).css('position','relative');$(this).css('left','auto');$(this).css('top','auto');$(this).find('a').css('border-width','1px');$(this).find('a .step2-hover-btns').hide();$(this).find('.favorites-btns .favoriteStatus').hide();$(this).find('.favorites-btns').removeClass('grey-arrow');$(this).find('.favorites-btns').css('zIndex','0');$(this).removeClass('step2-elem-hover');}else{$('.logo_notice1').remove();}}).find('a').click(function(){if(Drupal.settings.step2_save==2){return false;}else{var url=$(this).attr('rel');if(!$(this).hasClass('multiversion')){show_loading_overlay();$.ajax({url:url,type:'post',data:'json=1&action=customize',dataType:'json',success:function(result){if(result['status']=='1'){var query='';if(has_query_url('dev_force_tablet')){query='?dev_force_tablet=1';}
window.location=result['url']+query;}}});return false;}else{tb_show('',url);return false;}}});$('.thickbox-inner .thumbs_list1 li a').click(function(){if(Drupal.settings.step2_save==2){return false;}else{if(!$(this).hasClass('multiversion')){parent.show_loading_overlay();var url=$(this).attr('rel');$.ajax({url:url,type:'post',data:'json=1&action=customize',dataType:'json',success:function(result){if(result['status']=='1'){var query='';if(has_query_url('dev_force_tablet')){query='?dev_force_tablet=1';}
parent.window.location=result['url']+query;}}});return false;}}});$('.step2-save-button, .step2-v2-hover').bind('touchend click',function(){step2_save_button_click(this);return false;});$('.customize_logos').bind('click',function(){STEP2CUSTOMIZELOGOS.init();});$('#edit-logo-type').change(function(){if($(this.form).attr('id')=='step2-categories-form')
$('#step2-categories-form').submit();else
return false;});if($('div#admin-menu ul').length>0){var height=$('div#admin-menu').height();if(height){var dif=height-20;$('body').css('padding-top',dif);}}
if(typeof(pageTracker)!='undefined'){$('.thumbs_list1 a').click(function(){pageTracker._trackPageview($(this).attr('href'));});}
$('.search-logos-btn').click(function(){$('#step2-search-form').submit();return false;});$('#cantfind_button').click(function(){$.ajax({type:'post',url:Drupal.settings.baseUrl+'/cantfindlogo',dataType:'json',data:{message:$("#cantfind_message").val()},success:function(result){PO_step2.hidePopUp();}});});$('#step2_search_text_input').focus(function(){$('#step2_search_text_input').val('');});$('#step2_search_text_input').blur(function(){if($('#step2_search_text_input').val().length<1)
$('#step2_search_text_input').val(Drupal.settings.sphinxDefaultSearch);});if($('.sphinxsearch_popup').length>0)
PO_step2_search.init();$('#step2_search_button, #step2_search_button_icon').click(function(){$('#step2-sphinx-search-form').submit();});$('.SnapABug_Button').attr('click','').bind('click',function(){snapengage_init();SnapABug.startLink();});$('.logos_list .logo_thumb').click(function(){if(Drupal.settings.is_flstheme){if($('.mobile_view').length==0&&$('.tablet_view').length==0){if(typeof Drupal.settings.editbtn_split!='undefined'){if(Drupal.settings.editbtn_split){if($(this).parents('li').find('.step2-save-button.step2-save-logo').length>0){$(this).parents('li').find('.step2-save-button.step2-save-logo').trigger('click');return false;}}}
$(this).parent().find('.step2-customize-logo').addClass('dont_count_edit');var url=$(this).parent().find('.step2-customize-logo').trigger('click');}}});step2_search_design_add_triggers();});function step2_search_design_add_triggers(){console.log('_INITlogo',$('.step2_search_logos_input_submit').length);console.log('_INITbc',$('.step2_search_bcards_input_submit').length);$('.step2_search_logos_input_submit, .step2_search_bcards_input_submit').click(function(e){e.preventDefault();step2_search_logos_input_submit(this);return false;});$('.step2_search_logos_input').bind('keypress',function(e){console.log(e.keyCode);if(e.keyCode==13){$('.step2_search_logos_input_submit').trigger('click');$('.step2_search_bcards_input_submit').trigger('click');return false;}});}
function step2_search_logos_input_submit(o){if(typeof step2_search_logos_input_submit_status!='undefined')return;step2_search_logos_input_submit_status=1;console.log('step2_search_logos_input_submit');var container=$(o).closest('.step2_search_form');console.log(container);var input=container.find('.step2_search_logos_input');var url=new URL(window.location.href);url.searchParams.append('search',input.val());window.location=url.href;}
function fls_show_logowebv2_lightbox(){if(Drupal.settings.weebly_preview_v2_split_set&&$("body[class*='page-body-step3']").length){color_bc_suggestion_lightbox(Drupal.settings.step3_save_result["new_logo_id"],Drupal.settings.var_fonts);}
if(Drupal.settings.logoweb_split_set||Drupal.settings.bc_logoweb_split_set||Drupal.settings.tlds_split_set){if($('.bcweb_popup').length){if(!$('.bcweb_popup.initialized').length){if(Drupal.settings.diy_website_pickyourplan_split_set&&typeof Drupal.settings.weebly_preview_split_set!='undefined'){if(typeof Drupal.settings.logowebv2_ajax!='undefined'&&Drupal.settings.logowebv2_ajax){logowebv2_ajax();Drupal.settings.logowebv2_ajax=false;}
WEEBLYPREVIEW.init('');return true;}else{LOGOWEBV2.init();ga('send','event','Domain LB Logo Flow','Fired','Domain_LB_fired_logo');return true;}}}
ga('send','event','Domain LB Logo Flow','Not_Fired','Domain_LB_not_fired_logo');}
return false;}
function logowebv2_lightbox_show(){if($('.bcweb_popup').length){if(!$('.bcweb_popup.initialized').length){LOGOWEBV2.init();ga('send','event','Domain LB Logo Flow','Fired','Domain_LB_fired_logo');return true;}}
ga('send','event','Domain LB Logo Flow','Not_Fired','Domain_LB_not_fired_logo');}
function ls2s_next_split_click(){fls_events_add('clicks_step2_next');var page=$('.jscroll-added:last').attr('id');if(!page){page=2;}else{page=page.split('-');page=parseInt(page[2])+2;}
if(page>Drupal.settings.total_count_pages){$('.pager .step2_pagination_next_only .next').hide();return false;}
window.location='/step2/page/'+page;return false;}
function loadPageAfterChanges(){var url=window.location;window.location=url;}
function fls_goto(url){alert('a');$('#TB_window').html('<div id="TB_load" class="custom_tb_overlay"><p align="center"><img src="https://freelogo-assets.s3.amazonaws.com/sites/all/themes/freelogoservices/images/loading_animation.gif" /><br />'+Drupal.settings.step2_texttojs.text2+'</p></div>');setTimeout(function(){window.location=url;},500);return false;}
function show_saving_overlay(){$('#TB_overlay').css('opacity','0.94');}
function hide_loading_overlay(){$('#TB_overlay').remove();$('#TB_window').remove();}
function show_loading_overlay(msg,clear,autozindex)
{var message='';if(msg===undefined){message=Drupal.settings.step2_texttojs.text2;}else{message=msg;}
var zindex=102;if(autozindex===undefined)autozindex=0;if(autozindex){$('.thankYouBox, .overlay').each(function(){var zidx=parseInt($(this).css('z-index'));if(zidx>zindex)zindex=zidx+1;});}
if(clear===undefined){clear=0;}
if($('#flash_container').length>0){}
var is_safari=navigator.userAgent.toLowerCase().indexOf('safari')>-1;if(clear){$('#TB_overlay').remove();$('#TB_window').remove();}
if(is_safari&&$('#flash_container').length>0)return;$('body').append('<div id="TB_overlay" class="TB_overlayBG" style="z-index:'+zindex+'"></div>');$('body').append('<div id="TB_window" style="display:block;z-index:'+(zindex+1)+'"><div id="TB_load" class="custom_tb_overlay"><p align="center"><img src="https://freelogo-assets.s3.amazonaws.com/sites/all/themes/freelogoservices/images/loading_animation.gif" /><br /><span>'+message+'</span></p></div></div>');$('#TB_window').show();}
function rand(from,to){return Math.floor(Math.random()*(to-from+1)+from);}
function rand_values(from,to,count){var nr;var pos;var i=0;var status=new Array();if(to-from<count)return status;while(i<=count){nr=rand(from,to);pos=jQuery.inArray(nr,status);if(pos==-1){status.push(parseInt(nr));i++;}}
return status;}
function step2_save_preloader(){if(step2_save_interval_coutner_pos<=10){$('#TB_load span#status').text(step2_save_interval_array[step2_save_interval_coutner_pos]);step2_save_interval_coutner_pos++;}else{clearInterval(step2_save_interval_coutner);}}
function step2_save_start_process(obj){Drupal.settings.save_logo_timer_obj={};Drupal.settings.save_logo_timer_obj['save_logo_and_domain_check_start']=Date.now();if(obj===undefined){obj=this;}
$('#step2_save_logo_preview').remove();if($('#myFavoritesBtn').length&&$('#myFavoritesBtn').css('left')!='0px'){$('#myFavoritesBtn').click();}
var id=$(obj).hasClass('step2-save-logo');if(id){if($(obj).parent().parent().parent().parent().parent().hasClass('step2b')){obj=$(obj).clone();obj.hide();parent.tb_remove();parent.step2_save_start_process(obj);return false;}
show_loading_overlay(Drupal.settings.step2_save_logo_text);var status=new Array();status=rand_values(1,99,10);status.sort(function(a,b){return a-b});step2_save_interval_array=status;step2_save_interval_coutner_pos=0;step2_save_interval_coutner=setInterval(step2_save_preloader,1500);$.ajax({url:$(obj).attr('rel'),type:'post',data:'json=1&action=save',dataType:'json',success:function(result){Drupal.settings.save_logo_timer_obj['save_logo_and_domain_check_end']=Date.now();fls_events_add('save_logo_step2_timer',(Drupal.settings.save_logo_timer_obj['save_logo_and_domain_check_end']-Drupal.settings.save_logo_timer_obj['save_logo_and_domain_check_start']))
Drupal.settings.save_logo_timer_obj['bc_editor_start']=Date.now();if(result['status']=='1'){Drupal.settings.step2_save_result=result;Drupal.settings.skip_domain_result_population=0;if(typeof result['step2_direct_save']!='undefined'){if(result['step2_direct_save']){Drupal.settings.saved_logo_id=result['step2_direct_save'];}}
clearInterval(step2_save_interval_coutner);$('#TB_load span#status').text('100').attr('id','status-done');if(Drupal.settings.force_bc==1){var sep='?';if(result['url'].indexOf('?')>-1){sep='&';}
var query='';var workflow=has_query_url('workflow');if(workflow){query+=sep+'workflow='+workflow;}else{query='';}
window.location=result['url']+query;return false;}
if(typeof result['website_popup']!='undefined'){if(result['website_popup']&&$('.logoweb_popup').length){$('.logoweb_popup .logoweb_images').html($(result['website_popup']).find('.logoweb_images'));}
$('.orangeButton, .bcweb_popup .close').attr('href',result['url']);if(Drupal.settings.diy_website_pickyourplan_split_set){$('.weeblypreview_popup .close, .weeblypreview_popup  .noThankYou,  .diywebsite_popup .close, .diywebsite_popup .noThankYou').attr('href',result['url']);}}
if(typeof result['website_popup_img']!='undefined'){$('.websites_domain_page .left img').attr('src',result['website_popup_img']);$('.thankYouBox.weeblypreview_popup .popup_content').css('background-image','url('+result['weebly_preview_popup_img']+')');$('.thankYouBox.weeblypreview_popup .popup_content .preview ').attr('logo_id',result['website_logo_id']);$('#website_logo_id, .website_logo_id').val(result['website_logo_id']);$('#w_logo_id').val(result['website_logo_id']);Drupal.settings.onelinesearch=result['website_onelinesearch'];$('#websites_domain_search_input').val(result['website_onelinesearch']);$('#websites_domain_search_input_hidden').val(result['website_onelinesearch']);if(typeof result['website_twolinesearch']!='undefined'){Drupal.settings.twolinesearch=result['website_twolinesearch'];}
if(typeof result['website_multisearch']!='undefined')
Drupal.settings.multisearch=result['website_multisearch'];if(typeof result['website_response']!='undefined'){Drupal.settings.websites_populate_data=result['website_response'];}
$('.orangeButton, .bcweb_popup .close').attr('href',result['url']);if(Drupal.settings.diy_website_pickyourplan_split_set){$('.weeblypreview_popup .close, .weeblypreview_popup  .noThankYou,  .diywebsite_popup .close, .diywebsite_popup .noThankYou').attr('href',result['url']);}}
else{$('.bcweb_popup').remove();$('.overlay_bcweb_popup').remove();}
if(result['business_content']&&result['promo_content']){if(result['business_content']){if(Drupal.settings.display_color_matched_bc)
{color_bc_suggestion_lightbox(result['step2_direct_save'],result['logo_fonts']);fls_events_add('logoweb_bc_init');fls_events_add('lightbox_step2bc_views');fls_events_add("fired_color_matched_bc_lightbox");if(!Drupal.settings.weebly_preview_v2_split_set){}}else{$('#business_card_lightbox_content').html(result['business_content']);$('.medium-blue-btn-close').attr('href',result['url']);$('#TB_overlay').remove();$('#TB_window').remove();BC_UL.init();}}
if(result['promo_content']){$('#fls_products_lp').html(result['promo_content']);if(result['bc_50_free']){$('#TB_overlay').remove();$('#TB_window').remove();}
$('.medium-blue-btn-close').attr('href',result['url']);}}else if(result['business_content']&&!result['promo_content']){$('#business_card_lightbox_content').html(result['business_content']);$('.medium-blue-btn-close').attr('href',result['url']);$('#TB_overlay').remove();$('#TB_window').remove();BC_UL.init();}
else{var sep='?';if(result['url'].indexOf('?')>-1){sep='&';}
var query='';var workflow=has_query_url('workflow');if(workflow){query+=sep+'workflow='+workflow;}else{query='';}
window.location=result['url']+query;}}}});}else{var url=$(obj).attr('rel');if($(obj).parent().parent().hasClass('multiversion')){tb_show('',url);}else{if($(obj).parent().parent().parent().parent().parent().hasClass('step2b')){parent.show_loading_overlay();$.ajax({url:$(obj).attr('rel'),type:'post',data:'json=1&action=customize',dataType:'json',success:function(result){if(result['status']=='1'){var sep='?';if(result['url'].indexOf('?')>-1){sep='&';}
var query='';var workflow=has_query_url('workflow');if(workflow){query+=sep+'workflow='+workflow;}else{query='';}
parent.window.location=result['url']+query;}}});return false;}else{show_loading_overlay();$.ajax({url:$(obj).attr('rel'),type:'post',data:'json=1&action=customize',dataType:'json',success:function(result){if(result['status']=='1'){var sep='?';if(result['url'].indexOf('?')>-1){sep='&';}
var query='';var workflow=has_query_url('workflow');if(workflow){query+=sep+'workflow='+workflow;}else{query='';}
window.location=result['url']+query;}}});return false;}}}}
var PO_step2={init:function(){if($('.cantfind_popup').length>0&&$('.overlay').length>0){PO.placePopUp();$('.cantfind_popup .close, .cantfind_popup .noThankYou').click(PO.hidePopUp)}},placePopUp:function(){var overlay=$('.overlay:first');var thankYouBox=$('.cantfind_popup');$('.overlay, .cantfind_popup').remove();var docH=$(document).height();var docW=$(document).width();overlay.css({"width":docW+"px","height":docH+"px"});thankYouBox.prependTo('body');overlay.prependTo('body');overlay.show();thankYouBox.show();var bW=$('.cantfind_popup').width();var bH=$('.cantfind_popup').height();var wW=$(window).width();var wH=$(window).height();bW=wW/2-bW/2;bH=wH/2-bH/2;$('.cantfind_popup').css({left:bW,top:bH>40?bH:40});},hidePopUp:function(){$('.cantfind_popup').fadeOut();$('.overlay').fadeOut();$('.cantfind_popup').remove();$('.overlay').hide();return false;}}
var PO_step2_search={init:function(){if($('.sphinxsearch_popup').length>0&&$('.overlay').length>0){PO_step2_search.placePopUp();$('.sphinxsearch_popup .close, .sphinxsearch_popup .noThankYou').click(PO_step2_search.hidePopUp);$('#step2_search_p_text_input').focus(function(){$('#step2_search_p_text_input').val('');});$('#step2_search_p_text_input').blur(function(){if($('#step2_search_p_text_input').val().length<1)
$('#step2_search_p_text_input').val(Drupal.settings.sphinxDefaultSearch);});$('.sphinxsearch_popup .popup_sphinx_button_search').click(function(){$('#step2-sphinx-search-popup-form').submit();});$('.sphinxsearch_popup .popup_sphinx_button_browse').click(function(){$('#step2-sphinx-search-popup2-form').submit();});var fls_browser=$.browser;if(fls_browser.msie||navigator.userAgent.indexOf("Trident")>=0){$('#edit-logo-type').each(function(index,item){$(item).mouseup(function(){var open=$(item).data("isopen"+index)
if(open)setTimeout(function(){$(item).blur()},10);$(item).data("isopen"+index,!open);});});}}},placePopUp:function(){var overlay=$('.overlay:first');var thankYouBox=$('.sphinxsearch_popup');$('.overlay, .sphinxsearch_popup').remove();var docH=$(document).height();var docW=$(document).width();overlay.css({"width":docW+"px","height":docH+"px"});thankYouBox.prependTo('body');overlay.prependTo('body');overlay.show();thankYouBox.show();var bW=$('.sphinxsearch_popup').width();var bH=$('.sphinxsearch_popup').height();var wW=$(window).width();var wH=$(window).height();bW=wW/2-bW/2;bH=wH/2-bH/2;$('.sphinxsearch_popup').css({left:bW,top:bH>40?bH:40});},hidePopUp:function(){$('.sphinxsearch_popup').fadeOut();$('.overlay').fadeOut();$('.sphinxsearch_popup').remove();$('.overlay').hide();return false;}}
function step2_detect_ie_flash(){var is_ie=navigator.appVersion.indexOf("MSIE")!=-1;var flash=swfobject.getFlashPlayerVersion();var has_flash=true;var pluginData='';for(var i=0,l=navigator.plugins.length;i<l;i++){pluginData+=navigator.plugins[i]['name']+',';}
if(flash.major===undefined||flash.major<10||!isFlashEnabled())
has_flash=false;$.ajax({type:"POST",url:Drupal.settings.baseUrl+'/save-user-data',dataType:'post',data:{is_ie:is_ie,has_flash:has_flash,browser:BrowserDetect.browser+' '+BrowserDetect.version,useragent:navigator.userAgent,os:BrowserDetect.OS,flashVers:flash.major?flash.major+'.'+flash.minor:'0',has_cookie:navigator.cookieEnabled,donottrack:navigator.doNotTrack,language:navigator.language,pluginsd:pluginData}});}
function has_query_url(key){var queries={};$.each(document.location.search.substr(1).split('&'),function(c,q){var i=q.split('=');if(i[1]!==undefined){queries[i[0].toString()]=i[1].toString();}});if(key===undefined){return queries;}else{if(queries[key]!==undefined){return queries[key];}else{return false;}}}
var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS";},searchString:function(data){for(var i=0;i<data.length;i++){var dataString=data[i].string;var dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString){if(dataString.indexOf(data[i].subString)!=-1)
return data[i].identity;}
else if(dataProp)
return data[i].identity;}},searchVersion:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(index==-1)return;return parseFloat(dataString.substring(index+this.versionSearchString.length+1));},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.userAgent,subString:"Macintosh",identity:"Mac"},{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();function isFlashEnabled()
{var hasFlash=false;try
{var fo=new ActiveXObject('ShockwaveFlash.ShockwaveFlash');if(fo)hasFlash=true;}
catch(e)
{if(navigator.mimeTypes["application/x-shockwave-flash"]!=undefined)hasFlash=true;}
return hasFlash;}
function fls_snap_online_chat(){if(Drupal.settings.show_snap_chat!=2){setTimeout(function(){fls_snap_online_chat()},5*1000);return false;}
SnapABug.getAgentStatusAsync(function(online){if(online&&$('#SnapABug_WP').css('display')=='none'){SnapEngage.openProactiveChat(true,false);}});return true;}
function snapengage_init(){SnapEngage.setWidgetId('d9a5fcca-2d61-4e11-ad2c-68a909ef41ac');if(typeof(SnapFLS)!='undefined')
SnapABug=SnapFLS;snapengage_init_process();}
function snapengage_init_process(){SnapEngage.clearAllCookies();if(Drupal.settings.snapengage_init_name){SnapABug.setUserEmail(Drupal.settings.snapengage_init_name);SnapABug.setCallback('MessageSubmit',function(){SnapEngage.clearAllCookies();SnapABug.setUserEmail(Drupal.settings.snapengage_init_name);});}
SnapABug.setCallback('Open',function(status){if($('#flash_container').length>0){$('#flash_container').css('visibility','hidden');$('#flash_container').css('height','0px');Drupal.settings.inner_padding=$('.inner_step3').css('padding');$('.inner_step3').css('padding','0px');}});SnapABug.setCallback('Close',function(type,status){if($('#flash_container').length>0){var vis='visible';var height='';var pad=Drupal.settings.inner_padding;if($('#flash_promo_products_popup').length>0&&$('#flash_promo_products_popup').css('display')=='block')
{vis='hidden';height='0px';pad='0px';}
$('#flash_container').css('visibility',vis);$('#flash_container').css('height',height);$('.inner_step3').css('padding',pad);}});SnapABug.setLocale(Drupal.settings.snapengage_init_data.language_code);SnapABug.initDropdown(Drupal.settings.snapengage_init_data.initDropdown);for(var key in Drupal.settings.snapengage_init_data.questions){SnapABug.addDropdownItem(key,Drupal.settings.snapengage_init_data.questions[key]);}
if(Drupal.settings.snapengage_init_data.page_is_contact_us)
SnapABug.showScreenshotOption(false);}
var PP_UL={init:function(element){if($('.logo_promo_product_lightbox').length>0&&$('.overlay').length>0){PP_UL.placePopUp(element);$('html, body').animate({scrollTop:0},'fast');$("body[class*='body-step2'] .logo_promo_product_lightbox .close, body[class*='body-step2'] .logo_promo_product_lightbox .medium-blue-btn-close").click(function(){fls_events_add("close_promo_upsell_from_step2");});$('.product_buynow').click(function(){fls_events_add("took_promo_upsell_from_step2");var id=$(this).attr('id');if(id){id=id.split('_');if(!(id[1]>0))
return true;}
fls_store_promo_product_click_direct_save(this);if(id)return false;});$('#fls_products_lp .products_lp_title').each(function(){var height=$(this).height();if(height>30){var text=$(this).text();var html='<div class="products_title_narrow">'+text+'</div>';$(this).html(html);}});if(Drupal.settings.show_step4_offer!=undefined&&Drupal.settings.browser_details_name!='ie'){$('#popunder_click, #popunder_click_close').css('display','block');}
$('.logo_promo_product_lightbox .close, .logo_promo_product_lightbox .noThankYou, .logo_promo_product_lightbox #continue_button ').click(function(){$(this).attr('href',$('.logo_promo_product_lightbox .medium-blue-btn-close').attr('href'));});$('#logo_promo_product_lightbox_content .store_checkout_logo_footer a, .logo_promo_product_lightbox .close').click(function(){var url=$(this).attr('href');if(url.indexOf('step4')>-1&&Drupal.settings.show_step4_offer!=undefined&&Drupal.settings.show_step4_offer){if(typeof Drupal.settings.offer_flash_submited=='undefined'&&Drupal.settings.browser_details_name!=='op'&&Drupal.settings.browser_details_name!=='chrome')
fls_new_page(url+'?offer=1','width=1000, height=690,scrollbars=yes,resizable=yes, location=yes, toolbar=yes, menubar=yes','step4');}});}},placePopUp:function(element){fls_events_add("hit_promo_upsell_from_step2");var overlay=$('.overlay:first');var thankYouBox=$('.logo_promo_product_lightbox');$('.overlay, .logo_promo_product_lightbox').remove();var docH=$(document).height();var docW=$(document).width();overlay.css({"width":docW+"px","height":docH+"px"});thankYouBox.prependTo('body');overlay.prependTo('body');thankYouBox.show();var bW=$('.logo_promo_product_lightbox').width();var bH=$('.logo_promo_product_lightbox').height();var wW=$(window).width();var wH=$(window).height();bW=wW/2-bW/2;bH=wH/2-bH/2;$('.logo_promo_product_lightbox').css({left:bW,top:bH>40?bH:40});$('.overlay:first').show();},hidePopUp:function(){$('.logo_promo_product_lightbox').hide();$('.overlay').hide();return false;}}
var BC_UL={init:function(element){if(Drupal.settings.logoweb_split_set){if($('.logoweb_popup').length){if(!$('.logoweb_popup.initialized').length){LOGOWEB.init();return;}}}
if($('.logo_business_card_lightbox').length>0&&$('.overlay').length>0){fls_events_add('logoweb_bc_init');fls_events_add('fired_color_matched_bc_lightbox');BC_UL.placePopUp(element);$('html, body').animate({scrollTop:0},'fast');if(self!=top){var max_height=parseInt($('.logo_business_card_lightbox').outerHeight())+parseInt($('.logo_business_card_lightbox').position().top)*2;if(max_height<682){max_height=682;}
$('.body_container').css('max-height',max_height+'px').css('overflow','hidden');$('.overlay').css('height','100% !important');}
$('.logo_business_card_lightbox .close, .logo_business_card_lightbox .noThankYou, .logo_business_card_lightbox .medium-blue-btn-close ').click(function(){fls_events_add('close_bc_upsell');console.log('close_bc_upsell');BC_UL.hidePopUp()
if($(this).parents('.page-body-return-product').length)
return false;if(fls_show_logowebv2_lightbox()){return false;}
if($('.products_lp_box').length>0&&!$('.logoweb_popup.initialized').length){PP_UL.init();}else{if($('.overlay').length>0){$('.overlay:first').show();}
window.location=$('.logo_business_card_lightbox .medium-blue-btn-close').attr('href');}
return false;});$('body').on('click','#business_card_lightbox_content .bc_action .medium-orange-btn',function(event){show_loading_overlay(undefined,0,1);event.preventDefault();fls_events_add('bc_upsell_direct_save');$('.overlay').first().show();$.post(Drupal.settings.baseUrl+"/color-matched-bc/",{url_hash:$(this).attr('hash')},function result(res){fls_events_add('accepted_bc_upsell');lang="";if(Drupal.settings.lang!="")lang="/"+Drupal.settings.lang;window.location=Drupal.settings.baseUrl+lang+"/business-cards/step3/logo/"+res+"?suggest=1";},"json");});var right_click=new right_click_disabled();right_click.apply($('#business_card_lightbox_content img'));if($('body.mobile_view .bc_fix_container .bc_image').length>0){$('body.mobile_view .bc_fix_container .bc_image').click(function(e){e.preventDefault();$.post(Drupal.settings.baseUrl+"/color-matched-bc/",{url_hash:$(this).parent().find('.bc_action a').attr('hash')},function result(res){fls_events_add('accepted_bc_upsell');lang="";if(Drupal.settings.lang!="")lang="/"+Drupal.settings.lang;window.location=Drupal.settings.baseUrl+lang+"/business-cards/step3/logo/"+res+"?suggest=1";},"json");});}
$('.thankYouBox.logo_business_card_lightbox_logoweb .orangeButton').click(function(){flash_promo_products_finish();});$('.thankYouBox.logo_business_card_lightbox_logoweb .bc_container').click(function(){fls_events_add('bc_upsell_direct_save');window.location=$(this).find('.bc_action a').attr('href')});}else{}},placePopUp:function(element){if(typeof Drupal.settings.save_logo_timer_obj!='undefined'){if(typeof Drupal.settings.save_logo_timer_obj['bc_editor_end']=='undefined')Drupal.settings.save_logo_timer_obj['bc_editor_end']=Date.now();fls_events_add('bc_suggest_step2_timer',(Drupal.settings.save_logo_timer_obj['bc_editor_end']-Drupal.settings.save_logo_timer_obj['bc_editor_start']))}
var overlay=$('.overlay:first');var thankYouBox=$('.logo_business_card_lightbox');$('.overlay, .logo_business_card_lightbox, .TB_overlayBG').remove();var docH=$(document).height();var docW=$(document).width();overlay.css({"width":docW+"px","height":docH+"px"});thankYouBox.prependTo('body');overlay.prependTo('body');thankYouBox.show();var bW=$('.logo_business_card_lightbox').width();var bH=$('.logo_business_card_lightbox').height();var wW=$(window).width();var wH=$(window).height();bW=wW/2-bW/2;bH=wH/2-bH/2;$('.logo_business_card_lightbox').css({left:bW,top:bH>40?bH:40});$('.overlay:first').show();},hidePopUp:function(){$('.logo_business_card_lightbox').hide();$('.overlay').hide();return false;}}
var BC_FREE_UL={init:function(element){if($('.bc50v5_popup').length>0&&$('.overlay').length>0){BC_FREE_UL.placePopUp(element);$('html, body').animate({scrollTop:0},'fast');$('.bc50v5_popup .close, .bc50v5_popup .medium-blue-btn-close').click(function(){BC_FREE_UL.hidePopUp();PP_UL.init();return false;});$('.bc50v5_popup .medium-orange-btn').unbind('click');$('.bc50v5_popup .medium-orange-btn').click(function(){fls_events_add('bc_upsell_direct_save');});}},placePopUp:function(element){var overlay=$('.overlay:first');var thankYouBox=$('.bc50v5_popup');$('.overlay, .bc50v5_popup').remove();var docH=$(document).height();var docW=$(document).width();overlay.css({"width":docW+"px","height":docH+"px"});thankYouBox.prependTo('body');overlay.prependTo('body');thankYouBox.show();var bW=$('.bc50v5_popup').width();var bH=$('.bc50v5_popup').height();var wW=$(window).width();var wH=$(window).height();bW=wW/2-bW/2;bH=wH/2-bH/2;$('.bc50v5_popup').css({left:bW,top:bH>40?bH:40});$('.overlay:first').show();},hidePopUp:function(){$('.bc50v5_popup').remove();$('.overlay').hide();return false;}}
function flash_bc50v5_daisy_process_images(lid){var src=$('.bc50v5_popup #daisyImg img').attr('rel');src=src.replace('logoId',lid);$('.bc50v5_popup #daisyImg img').attr('src',src);}
function step2_save_button_click(o){if(typeof o=='undefined'){o=this;}
if($(o).hasClass("save-new-type-logo")){fls_events_add('click_save_new_logo');}
if($(o).hasClass("edit-new-type-logo")){fls_events_add('click_edit_new_logo');}
if(typeof Drupal.settings.step2_has_logosteps_logo!='undefined'){fls_events_add('logosteps_saved_logo_new');}else{fls_events_add('logosteps_saved_logo_old');}
if(typeof Drupal.settings.logosteps_step2_current_page!='undefined'){fls_events_add('logosteps_page_logo_saved_from',Drupal.settings.logosteps_step2_current_page);}
var workflow=has_query_url('workflow');if($(o).hasClass("step2-save-logo")){if(Drupal.settings.is_flstheme&&$('.mobile_view').length==0){ga('send','event','Step2','Click','Save Logo');}
fls_events_add('logo_step2_save');if(!workflow)fls_events_add('logo_step2_save_logo_flow');}
else if($(o).hasClass("dont_count_edit")){fls_events_add('logoimage_step2_click');}else{if(Drupal.settings.is_flstheme&&$('.mobile_view').length==0){ga('send','event','Step2','Click','Edit Logo');}
fls_events_add('logo_step2_edit');if(!workflow)fls_events_add('logo_step2_edit_logo_flow');}
if(Drupal.settings.display_color_matched_bc){config_bc_suggestion_lightbox();}
step2_save_start_process(o);}
function step2_filters_init(){$('.step2_filter_entry').click(function(e){e.preventDefault();step2_filters_select(this);return false;});$('.apply_filters').click(function(e){e.preventDefault();step2_filters_submit();return false;});$('.clear_filters').click(function(e){e.preventDefault();step2_filters_clear();return false;});step2_filters_initialize();}
function step2_filters_select(o){if(!$(o).hasClass('step2_filter_entry')){o=$(o).parents('.step2_filter_entry');}
var filter_type=$(o).attr('data-filter-type');var filter_name=$(o).attr('data-filter');if(filter_type=='fonts'&&step2_filters_condition_text()){return false;}
if(filter_type=='layout'&&step2_filters_condition_text()){return false;}
if(filter_type=='layout'&&step2_filters_condition_icon()){return false;}
var checkbox=$(o).find('input');checkbox_toggle(checkbox);step2_filters_set_classes();}
function checkbox_is_checked(checkbox){return $(checkbox).prop('checked');}
function checkbox_toggle(checkbox){if(checkbox_is_checked(checkbox)){checkbox_toggle_disable(checkbox);}else{checkbox_toggle_enable(checkbox);}}
function checkbox_toggle_enable(checkbox){$(checkbox).prop('checked',true);}
function checkbox_toggle_disable(checkbox){$(checkbox).prop('checked',false);}
function filter_is_selected(o){return checkbox_is_checked($(o).find('input'));}
function filter_selected_count(filter_name){var count=0;$('.step2_filter_entry_'+filter_name).each(function(){if(filter_is_selected(this))count++;});return count;}
function filter_clear_filter(filter_name){$('.step2_filter_entry_'+filter_name).each(function(){var checkbox=$(this).find('input');checkbox_toggle_disable(checkbox);});}
function step2_filters_condition_text(){return filter_is_selected($('.step2_filter_entry_style_text'))&&filter_selected_count('style')<2;}
function step2_filters_condition_icon(){return!filter_is_selected($('.step2_filter_entry_style_icon'));}
function step2_filters_set_classes(){if(step2_filters_condition_text()){$('#step2_filters').addClass('filters_text_only');$('.design_filter_form').addClass('filters_text_only');filter_clear_filter('layout');filter_clear_filter('fonts');step2_filters_disable_checkboxes('layout');step2_filters_disable_checkboxes('fonts');}else{$('#step2_filters').removeClass('filters_text_only');$('.design_filter_form').removeClass('filters_text_only');step2_filters_enable_checkboxes('layout');step2_filters_enable_checkboxes('fonts');}
if(step2_filters_condition_icon()){$('#step2_filters').addClass('filters_noicons');$('.design_filter_form').addClass('filters_noicons');filter_clear_filter('layout');step2_filters_disable_checkboxes('layout');}else{$('#step2_filters').removeClass('filters_noicons');$('.design_filter_form').removeClass('filters_noicons');step2_filters_enable_checkboxes('layout');}}
function step2_filters_enable_checkboxes(filter_name){$('.step2_filter_entry_'+filter_name).each(function(){var checkbox=$(this).find('input');$(checkbox).prop('disabled',false);});}
function step2_filters_enable_checkboxes_array(filter_name,arr){$.each(arr,function(k,v){var o=$('.step2_filter_entry_'+filter_name+'_'+v);var checkbox=$(o).find('input');checkbox_toggle_enable(checkbox);});}
function step2_filters_disable_checkboxes(filter_name){$('.step2_filter_entry_'+filter_name).each(function(){var checkbox=$(this).find('input');$(checkbox).prop('disabled',true);});}
function step2_filter_get_values(filter_name,attr_name){attr_name=attr_name?attr_name:'data-filter';var response=[];$('.step2_filter_entry_'+filter_name).each(function(){if(filter_is_selected(this)){response.push($(this).attr(attr_name));}});return response.join(',');}
function step2_filters_submit(){fls_events_add('clicked_apply_filters');$('#edit-logosteps-logo-type').val(step2_filter_get_values('style'));$('#edit-logosteps-logo-font-types').val(step2_filter_get_values('fonts'));$('#edit-logosteps-logo-font').val(step2_filter_get_values('fonts','data-fonts'));$('#edit-logosteps-logo-layout').val(step2_filter_get_values('layout'));$('#logosteps-form').submit();}
function step2_filters_clear(){filter_clear_filter('style');filter_clear_filter('fonts');filter_clear_filter('layout');step2_filters_set_classes();}
function step2_filters_set_initial(filter_name,data){step2_filters_enable_checkboxes_array(filter_name,data);}
function step2_filters_initialize(){step2_filters_set_classes();if($('#whitelabels_lp1_step2').length==0){if($('body').hasClass('mobile_view')&&!$('body').hasClass('step2_gallery_mobile'))return;if(!$('body').hasClass('step2_gallery_mobile'))$('body').addClass('min1280');}
if(typeof Drupal.settings.logosteps=='undefined')return;if(typeof Drupal.settings.logosteps.logo_type!='undefined'){if(Drupal.settings.logosteps.logo_type.length>0){step2_filters_set_initial('style',Drupal.settings.logosteps.logo_type);}}
if(typeof Drupal.settings.logosteps.logo_layout!='undefined'){if(Drupal.settings.logosteps.logo_layout.length>0){step2_filters_set_initial('layout',Drupal.settings.logosteps.logo_layout);}}
if(typeof Drupal.settings.logosteps.logo_fonts_type!='undefined'){if(Drupal.settings.logosteps.logo_fonts_type.length>0){step2_filters_set_initial('fonts',Drupal.settings.logosteps.logo_fonts_type);}}
step2_filters_set_classes();}
function add_domain_to_cart(domain,gotopage){lang="";if(Drupal.settings.lang!=''){lang=Drupal.settings.lang+"/";}
var fields={pid:463,reduce_flow:"1",final_destination:gotopage,website_searched:domain,websites_domain_suggestion:domain};var fields_str='';for(var i in fields){fields_str+='<input type="hidden" name="'+i+'" value="'+fields[i]+'" />';}
fields_str+='<input type="hidden" name="allow_multi_domains_in_cart" value="1" />';$('body').append('<form id="checkoutwebsitebundle_form" style="display:none;" action="'+Drupal.settings.baseUrl+'/'+lang+'websites/domain" method="post">'+fields_str+'</form>');$('#checkoutwebsitebundle_form').submit();return false;}
function add_upsell_to_cart(domain,gotopage){lang="";if(Drupal.settings.lang!=''){lang=Drupal.settings.lang+"/";}
var fields={pid:463,reduce_flow:"1",final_destination:gotopage,website_searched:domain,websites_domain_suggestion:domain,website_upsells:523};var fields_str='';for(var i in fields){fields_str+='<input type="hidden" name="'+i+'" value="'+fields[i]+'" />';}
if(typeof Drupal.settings.add_sel_package!=undefined){fields_str+='<input type="hidden" name="sel_package" value="'+Drupal.settings.add_sel_package+'" />';}
$('body').append('<form id="checkoutwebsitebundle_form" style="display:none;" action="'+Drupal.settings.baseUrl+'/'+lang+'websites/domain" method="post">'+fields_str+'</form>');$('#checkoutwebsitebundle_form').submit();return false;};$(document).ready(function(){setUrlforGuestUsers();Drupal.settings.step4_timer_obj={};Drupal.settings.step4_timer_obj['on_step4_page_start']=Date.now();$(".guestLink").click(function(){fls_events_add('click_continue_as_guest');fls_replace_cookie_with_session("clicked_continue_as_guest",1);});$("#edit-subscribe-newsletters").click(function(){Drupal.settings.email_optin_user_interect=1;if($(this).is(':checked')){fls_events_add('step4_opt_ins');}});if(!Drupal.settings.is_country_gdpr){$("#step4 .non_gdpr_row").show();$("#step4 .gdpr_row").hide();}else{$("#step4 .non_gdpr_row").hide();$("#step4 .gdpr_row").show();}
if($('#user-pass').length&&$('#edit-name').length&&$('#edit-confirm-email').length){if(!$('#edit-name').val()){$('input[name^="confirm_email"]').attr("disabled","disabled");}
$('input[name^="name"]').keyup(function(){if($('input[name^="confirm_email"]').length){if($(this).val()){$('input[name^="confirm_email"]').removeAttr("disabled");}else{$('input[name^="confirm_email"]').attr("disabled","disabled");}}});}
if($('#edit-email').length&&$('#edit-confirm-email').length){if(!$('#edit-email').val()){$('input[name^="confirm_email"]').attr("disabled","disabled");}}
$('input[name^="email"]').keyup(function(){if($('input[name^="confirm_email"]').length){if($(this).val()){$('input[name^="confirm_email"]').removeAttr("disabled");}else{$('input[name^="confirm_email"]').attr("disabled","disabled");}}});$('input[id^="edit-password"]').focus(function(){$('.pass_label').hide();});$('input[id^="edit-password"]').change(function(){$('.pass_label').hide();});$('.pass_label').click(function(){$(this).hide();$(this).prev('div').find('input[id^="edit-password"]').trigger('focus');});$('input[id^="edit-password"]').blur(function(){if($(this).val()===""){$(this).parent().next(".pass_label").show();}});if(Drupal.settings.recomlogoparent!=undefined&&Drupal.settings.recomlogoparent){show_loading_overlay();$("#preview_logo2").hide();recom_start_saving_process();}
var eventFree=0;var eventCoupon=0;if(Drupal.settings.step4_offer_focus!=undefined&&Drupal.settings.step4_offer_focus==1){if(!$.cookie("has_logo"))ga('send','event','Leave Behind Upper Funnel','Open','Popup Opened');else ga('send','event','Leave Behind Logos','Open','Popup Opened');step4_offer_refresh_counter=0;step4_offer_refresh_interval=setInterval(function(){step4_offer_refresh_counter++;var logo_details=$.cookie("leavebehind_logodetails");if(logo_details!==null){clearInterval(step4_offer_refresh_interval);$.cookie('leavebehind_logodetails',null,{path:'/'});if(step4_offer_refresh_counter>1){setTimeout(function(){window.location=window.location},1000);}}},500);$(window).focus(function(){var status=fls_new_page_get_status('step4');if(status!=0){$('#step4_special_offer1').hide();$('#step4_special_offer3').hide();$('#step4_special_offer2').show();if(!eventCoupon){ga('send','event','Leave Behind Logos','Open','10% Off Promo Leave Behind Triggered');fls_events_add('leavebehind_coupon_trigger');eventCoupon=1;}}else{if(!$.cookie("has_logo")){$('#step4_special_offer2').hide();$('#step4_special_offer3').show();$('#step4_special_offer1').hide();fls_events_add('leavebehind_upper_trigger');var temp;temp=$("#step4_special_offer1 #edit-submit");temp.attr("id","other-edit-submit");temp1=$("#step4_special_offer3 #other-edit-submit");temp1.attr("id","edit-submit");}
else{$('#step4_special_offer2').hide();$('#step4_special_offer3').hide();$('#step4_special_offer1').show();fls_events_add('leavebehind_account_trigger');var temp;temp=$("#step4_special_offer3 #edit-submit");temp.attr("id","other-edit-submit");temp1=$("#step4_special_offer1 #other-edit-submit");temp1.attr("id","edit-submit");if(!eventFree){ga('send','event','Leave Behind Logos','Open','Free FB Leave Behind Triggered');eventFree=1;}}}});}
$('.tooltip').tooltip({track:true,delay:0,showURL:false,showBody:" - ",fade:250});if(Drupal.settings.step4_page)
{window.onbeforeunload=function(){return Drupal.settings.leave_page_message_step4};$("a").click(function(){window.onbeforeunload=null;});}
if($('#step4').length>0||Drupal.settings.on_buscards_step4){if(Drupal.settings.step2save_url){$.ajax({url:Drupal.settings.step2save_url,type:'post',data:'json=1&action=save',dataType:'json',success:function(result){if(result['status']=='1'){var lid=result.step2_direct_save||0;}}});}}
$('#step4-savelogo-form #edit-submit').click(function(){additionalErrorHTML="";var emailValid=1;$("#rsvErrors").html("").css('display','none');var errorHTML=Drupal.settings.step4_savelogo_form.form_header_error;if($('#step4-savelogo-form input[name="email"]').val()==""){emailValid=0;additionalErrorHTML+=Drupal.settings.step4_savelogo_form.email.required;$('#step4-savelogo-form input[name="email"]').addClass('errorFieldDemo5');$('#step4-savelogo-form #edit-email-label').addClass('signup_error_label');$('#step4-savelogo-form #edit-email-label-icon').show();fls_events_add('empty_email_from_step4');}else if(!isValidEmail($('#step4-savelogo-form input[name="email"]').val())){emailValid=0;additionalErrorHTML+=Drupal.settings.step4_savelogo_form.email.invalid;$('#step4-savelogo-form input[name="email"]').addClass('errorFieldDemo5');$('#step4-savelogo-form #edit-email-label').addClass('signup_error_label');$('#step4-savelogo-form #edit-email-label-icon').show();fls_events_add('invalid_email_from_step4');}else{$('#step4-savelogo-form input[name="email"]').removeClass('errorFieldDemo5');$('#step4-savelogo-form #edit-email-label').removeClass('signup_error_label');$('#step4-savelogo-form #edit-email-label-icon').hide();}
if($('#step4-savelogo-form input[name="confirm_email"]').val()==""){emailValid=0;additionalErrorHTML+=Drupal.settings.step4_savelogo_form.confirm_email.required;$('#step4-savelogo-form input[name="confirm_email"]').addClass('errorFieldDemo5');$('#step4-savelogo-form #edit-confirm-email-label').addClass('signup_error_label');$('#step4-savelogo-form #edit-confirm-email-label-icon').show();}else if($.trim($('#step4-savelogo-form input[name="confirm_email"]').val().toLowerCase())!=$.trim($('#step4-savelogo-form input[name="email"]').val().toLowerCase())){emailValid=0;additionalErrorHTML+=Drupal.settings.step4_savelogo_form.confirm_email.not_confirm;$('#step4-savelogo-form input[name="confirm_email"]').addClass('errorFieldDemo5');$('#step4-savelogo-form #edit-confirm-email-label').addClass('signup_error_label');$('#step4-savelogo-form #edit-confirm-email-label-icon').show();}else{$('#step4-savelogo-form input[name="confirm_email"]').removeClass('errorFieldDemo5');$('#step4-savelogo-form #edit-confirm-email-label').removeClass('signup_error_label');$('#step4-savelogo-form #edit-confirm-email-label-icon').hide();}
if($('#step4-savelogo-form input[name="password"]').val()==""){additionalErrorHTML+=Drupal.settings.step4_savelogo_form.password.required;$('#step4-savelogo-form input[name="password"]').addClass('errorFieldDemo5');$('#step4-savelogo-form #edit-password-label').addClass('signup_error_label');$('#step4-savelogo-form #edit-password-label-icon').show();fls_events_add('empty_password_from_step4');}else{$('#step4-savelogo-form input[name="password"]').removeClass('errorFieldDemo5');$('#step4-savelogo-form #edit-password-label').removeClass('signup_error_label');$('#step4-savelogo-form #edit-password-label-icon').hide();}
if(Drupal.settings.is_country_gdpr&&!$('#step4-savelogo-form input[name="agree_terms_and_privacy"]').is(':checked')){additionalErrorHTML+=Drupal.settings.step4_savelogo_form.agree_terms_and_privacy.required;$('#step4-savelogo-form input[name="agree_terms_and_privacy"]').addClass('errorFieldDemo5');$('#step4-savelogo-form #edit-agree-terms-and-privacy-wrapper label').addClass('signup_error_label');$('#step4-savelogo-form #terms_and_privacy_error_icon').show();}else{$('#step4-savelogo-form input[name="agree_terms_and_privacy"]').removeClass('errorFieldDemo5');$('#step4-savelogo-form #edit-agree-terms-and-privacy-wrapper label').removeClass('signup_error_label');$('#step4-savelogo-form #terms_and_privacy_error_icon').hide();}
if(additionalErrorHTML||!emailValid){errorHTML+=additionalErrorHTML;$("#rsvErrors").css("display","block");$("#rsvErrors").html(errorHTML);if(!Drupal.settings.is_country_gdpr){$("#step4 .non_gdpr_row").show();$("#step4 .gdpr_row").hide();}else{$("#step4 .gdpr_row").show();$("#step4 .non_gdpr_row").hide();}
return false;}else if(emailValid){$('#step4-savelogo-form').submit();}
return false;});$('#step4-signup-form #edit-submit').click(function(){$('.pass_label').hide();additionalErrorHTML="";$("#rsvErrors").html("").css('display','none');var errorHTML=Drupal.settings.step4_signup_form.form_header_error;var langvs=Drupal.settings.lang;var allowedLang=[];var simple_version=($.inArray(langvs,allowedLang)!=-1)?1:0;if(!simple_version){if(typeof Drupal.settings.notallowedIDs!='undefined'){var notallowedIDs=Drupal.settings.notallowedIDs;}else{var notallowedIDs=["088","88","80"];}
var simple_version=($.inArray($('#edit-country').val(),notallowedIDs)==-1)?1:0;simple_version=($.inArray('all',notallowedIDs)==-1)?simple_version:0;}
if(!simple_version){if(Drupal.settings.simple_version)
simple_version=1;}
if(!simple_version){if($('#step4-signup-form input[name="first_name"]').val()==""||($('#step4-signup-form input[name="first_name"]').val()==$('#step4-signup-form input[name="first_name"]').attr('rel'))){additionalErrorHTML+=Drupal.settings.step4_signup_form.first_name.required;$('#step4-signup-form input[name="first_name"]').addClass('errorFieldDemo5');$('#step4-signup-form #logo_first_name_label').addClass('signup_error_label');$('#step4-signup-form #logo_first_name_error_icon').show();}else{$('#step4-signup-form input[name="first_name"]').removeClass('errorFieldDemo5');$('#step4-signup-form #logo_first_name_label').removeClass('signup_error_label');$('#step4-signup-form #logo_first_name_error_icon').hide();}
if($('#step4-signup-form input[name="last_name"]').val()==""||($('#step4-signup-form input[name="last_name"]').val()==$('#step4-signup-form input[name="last_name"]').attr('rel'))){additionalErrorHTML+=Drupal.settings.step4_signup_form.last_name.required;$('#step4-signup-form input[name="last_name"]').addClass('errorFieldDemo5');$('#step4-signup-form #logo_last_name_label').addClass('signup_error_label');$('#step4-signup-form #logo_last_name_error_icon').show();}else{$('#step4-signup-form input[name="last_name"]').removeClass('errorFieldDemo5');$('#step4-signup-form #logo_last_name_label').removeClass('signup_error_label');$('#step4-signup-form #logo_last_name_error_icon').hide();}}
if(Drupal.settings.is_country_gdpr&&!$('#step4-signup-form input[name="agree_terms_and_privacy"]').is(':checked')){additionalErrorHTML+=Drupal.settings.step4_signup_form.agree_terms_and_privacy.required;$('#step4-signup-form input[name="agree_terms_and_privacy"]').addClass('errorFieldDemo5');$('#step4-signup-form #edit-agree-terms-and-privacy-wrapper label').addClass('signup_error_label');$('#step4-signup-form #terms_and_privacy_error_icon').show();}else{$('#step4-signup-form input[name="agree_terms_and_privacy"]').removeClass('errorFieldDemo5');$('#step4-signup-form #edit-agree-terms-and-privacy-wrapper label').removeClass('signup_error_label');$('#step4-signup-form #terms_and_privacy_error_icon').hide();}
var emailValid=1;if($('#step4-signup-form input[name="email"]').val()==""){emailValid=0;additionalErrorHTML+=Drupal.settings.step4_signup_form.email.required;$('#step4-signup-form input[name="email"]').addClass('errorFieldDemo5');$('#step4-signup-form #edit-email-label').addClass('signup_error_label');$('#step4-signup-form #edit-email-label-icon').show();fls_events_add('empty_email_from_step4');}else if(!isValidEmail($('#step4-signup-form input[name="email"]').val())){emailValid=0;additionalErrorHTML+=Drupal.settings.step4_signup_form.email.invalid;$('#step4-signup-form input[name="email"]').addClass('errorFieldDemo5');$('#step4-signup-form #edit-email-label').addClass('signup_error_label');$('#step4-signup-form #edit-email-label-icon').show();fls_events_add('invalid_email_from_step4');}else if(emailValid){$('#step4-signup-form input[name="email"]').removeClass('errorFieldDemo5');$('#step4-signup-form #edit-email-label').removeClass('signup_error_label');$('#step4-signup-form #edit-email-label-icon').hide();}
if($('#step4-signup-form input[name="confirm_email"]').val()==""){emailValid=0;additionalErrorHTML+=Drupal.settings.step4_signup_form.confirm_email.required;$('#step4-signup-form input[name="confirm_email"]').addClass('errorFieldDemo5');$('#step4-signup-form #edit-confirm-email-label').addClass('signup_error_label');$('#step4-signup-form #edit-confirm-email-label-icon').show();}else if($.trim($('#step4-signup-form input[name="confirm_email"]').val().toLowerCase())!=$.trim($('#step4-signup-form input[name="email"]').val().toLowerCase())){emailValid=0;additionalErrorHTML+=Drupal.settings.step4_signup_form.confirm_email.not_confirm;$('#step4-signup-form input[name="confirm_email"]').addClass('errorFieldDemo5');$('#step4-signup-form #edit-confirm-email-label').addClass('signup_error_label');$('#step4-signup-form #edit-confirm-email-label-icon').show();}else{$('#step4-signup-form input[name="confirm_email"]').removeClass('errorFieldDemo5');$('#step4-signup-form #edit-confirm-email-label').removeClass('signup_error_label');$('#step4-signup-form #edit-confirm-email-label-icon').hide();}
if($('#step4-signup-form input[name="password"]').val()==""){additionalErrorHTML+=Drupal.settings.step4_signup_form.password.required;$('#step4-signup-form input[name="password"]').addClass('errorFieldDemo5');$('#step4-signup-form #edit-password-label').addClass('signup_error_label');$('#step4-signup-form #edit-password-label-icon').show();fls_events_add('empty_password_from_step4');}else{$('#step4-signup-form input[name="password"]').removeClass('errorFieldDemo5');$('#step4-signup-form #edit-password-label').removeClass('signup_error_label');$('#step4-signup-form #edit-password-label-icon').hide();}
if(!simple_version){if($('#step4-signup-form input[name="phone"]').val()==""){additionalErrorHTML+=Drupal.settings.step4_signup_form.phone.required;$('#step4-signup-form input[name="phone"]').addClass('errorFieldDemo5');$('#step4-signup-form #phone_label').addClass('signup_error_label');$('#step4-signup-form #phone_error_icon').show();}else if(!validate_phone_function($('input[name="phone"]').val())){additionalErrorHTML+=Drupal.settings.step4_signup_form.phone.invalid;$('#step4-signup-form input[name="phone"]').addClass('errorFieldDemo5');$('#step4-signup-form #phone_label').addClass('signup_error_label');$('#step4-signup-form #phone_error_icon').show();}else{$('#step4-signup-form input[name="phone"]').removeClass('errorFieldDemo5');$('#step4-signup-form #phone_label').removeClass('signup_error_label');$('#step4-signup-form #phone_error_icon').hide();}}
if(additionalErrorHTML||!emailValid){fls_events_add('error_on_step4');errorHTML+=additionalErrorHTML;$("#rsvErrors").css("display","block");$("#rsvErrors").html(errorHTML);return false;}else if(emailValid){if(typeof(Drupal.settings.step4_timer_obj)!="undefined"){Drupal.settings.step4_timer_obj['on_step4_page_end']=Date.now();fls_events_add('time_spent_on_step4',Math.round((Drupal.settings.step4_timer_obj['on_step4_page_end']-Drupal.settings.step4_timer_obj['on_step4_page_start'])/1000));}
$('#step4-signup-form').submit();}
return false;});$('#step4-savelogo-form,#step4-signup-form').each(function(){if($('#edit-email').val()==""){$('#edit-confirm-email').attr('disabled','disabled');}
var langvs=Drupal.settings.lang;var allowedLang=[];var notallowedCountriesEN=Drupal.settings.notallowedCountriesEN;var simple_version=($.inArray(langvs,allowedLang)!=-1)?1:0;if(!simple_version)
simple_version=Drupal.settings.simple_version;if(!simple_version){simple_version=($.inArray(Drupal.settings.country_geoip,notallowedCountriesEN)==-1)?1:0;simple_version=($.inArray('all',notallowedCountriesEN)==-1)?simple_version:0;if(!simple_version){$('.optionalField').show();}else{$('.optionalField').hide();}}else{$('.optionalField').hide();if(langvs=="cn"){$('.optionalField-zh-hans').show();}}
$('#edit-country').change(function(){var notallowedIDs=Drupal.settings.notallowedIDs;var country_id=parseInt($(this).val());if(Drupal.settings.email_optin_user_interect==undefined){if(country_id==1){$('#edit-subscribe-newsletters').attr('checked',true);}else{$('#edit-subscribe-newsletters').attr('checked',false);}}
$.post(Drupal.settings.baseUrl+"/is-country-gdpr",{country_id:$(this).val(),ajax:1},function(){}).done(function(result){result=JSON.parse(result);if(result){Drupal.settings.is_country_gdpr=1;}else Drupal.settings.is_country_gdpr=0;if(!Drupal.settings.is_country_gdpr){$("#step4 .gdpr_row").hide();$("#step4 .non_gdpr_row").show();}else{$("#step4 .gdpr_row").show();$("#step4 .non_gdpr_row").hide();}});var simple_version=($.inArray($(this).val(),notallowedIDs)==-1)?1:0;simple_version=($.inArray('all',notallowedIDs)==-1)?simple_version:0;if(!simple_version)
simple_version=Drupal.settings.simple_version;if(!simple_version){$('.optionalField').show();}else{$('.optionalField').hide();if($(this).val()=="50"){$('.optionalField-zh-hans').show();}}});});});function switchOfferPages(){var status=fls_new_page_get_status('step4');if(status!=0){$('#step4_special_offer1').hide();$('#step4_special_offer3').hide();$('#step4_special_offer2').show();}else{if(!$.cookie("has_logo")){$('#step4_special_offer2').hide();$('#step4_special_offer3').show();$('#step4_special_offer1').hide();}
else{if($.cookie("signup_begin")){$("#step4_special_offer1 .form_signup_end").hide();$("#step4_special_offer1 .form_signup_begin").show();$("#step4_special_offer1 .form_signup_begin .signupBtn").show();}
else if($.cookie("signup_end")){$("#step4_special_offer1 .form_signup_begin").hide();$("#step4_special_offer1 .form_signup_end").show();$("#step4_special_offer1 .form_signup_end .signupBtn").show();}
$('#step4_special_offer2').hide();$('#step4_special_offer3').hide();$('#step4_special_offer1').show();}}}
function setUrlforGuestUsers(){var getValue=$('#guestLink_url').attr('href');if((typeof getValue=="undefined")||(getValue=='')){$('.continue_as_guest').hide();}else{$('.continue_as_guest_btn').attr('href',getValue);}};;function flash_promo_products_popup(){var lid=$.cookie('step3_ppp');if(!lid){return false;}
Drupal.settings.saved_logo_id=lid;if(fls_show_logowebv2_lightbox()){return true;}
if(typeof Drupal.settings.suggest_pp==='undefined'||!Drupal.settings.suggest_pp){return false;}
flash_promo_products_process_links(lid);flash_promo_products_process_images(lid);$('#TB_overlay').css('opacity','0.7');flash_promo_products_hide_editor();var bc50_value=$.cookie('bc50v7_split_value');if(bc50_value==2&&Drupal.settings.bc_50_free==1){$('#TB_window').html('<div id="TB_load" class="custom_tb_overlay"><p align="center"><img src="'+Drupal.settings.baseUrl+'/sites/all/modules/thickbox/loading_animation.gif" /><br />'+Drupal.settings.step2_texttojs.text2+'</p></div>');$('#TB_window').show();flash_bc50v5_daisy_process_images(lid);$('.bc50v5_popup').css('visibility','hidden');BC_FREE_UL.init();$('.bc50v5_popup .close, .bc50v5_popup .medium-blue-btn-close').click(function(){$('#TB_overlay').show();flash_promo_products_show();});$('.bc50v5_popup .medium-orange-btn').unbind('click');$('.bc50v5_popup .medium-orange-btn').click(function(){fls_events_add('bc_upsell_logo_step3');});$('.bc50v5_popup #daisyImg img').load(function(){$('#TB_window').remove();$('.bc50v5_popup').css('visibility','visible');});return true;}
if(Drupal.settings.step4_url!=undefined&&Drupal.settings.step4_url.indexOf('step4')>-1&&Drupal.settings.show_step4_offer!=undefined&&Drupal.settings.show_step4_offer){if(Drupal.settings.browser_details_name!='ie'){$('#popunder_click, #popunder_click_close').css('display','block');}
$('#logo-creator-step3v2-form #flash_promo_products_popup #ppp_button a').click(function(){if(typeof Drupal.settings.offer_flash_submited=='undefined'&&Drupal.settings.browser_details_name!=='op'&&Drupal.settings.browser_details_name!=='chrome')
fls_new_page(Drupal.settings.step4_url+'?offer=1','width=1000, height=690,scrollbars=yes,resizable=yes, location=yes, toolbar=yes, menubar=yes','step4');});}
flash_promo_products_show();return true;}
function flash_promo_products_process_images(lid){$('#flash_promo_products_popup .ppp_image_container IMG').each(function(){var src=$(this).attr('rel');src=src.replace('logoId',lid);$(this).attr('src',src);});}
function flash_promo_products_process_links(lid){$('#flash_promo_products_popup .ppp_element_container a').each(function(){var href=$(this).attr('href');href=href.replace('logoId',lid);$(this).attr('href',href);});}
function flash_promo_products_hide_editor(){$('#flash_container').css('visibility','hidden');$('#flashContent').css('visibility','hidden');$('#FLSPreviewContainer').css('visibility','hidden');$('#flash_container').css('height','0px');$('.inner_step3').css('padding','0px');}
$(document).ready(function(){$('#ppp_button a').click(flash_promo_products_finish);});function flash_promo_products_finish(){if(Drupal.settings.has_bc_with_no_logo){$("#flash_promo_products_popup").hide();$('#TB_overlay').hide();$('#TB_window').hide();BC_CHECKOUT.init();}
else{flash_redirect_step4(true);}}
function flash_promo_products_show(){$('.FLS-Overlay-Message').hide();$('#FLSPreviewOverlay').hide();$("#flash_promo_products_popup").show();if(typeof(whitelabels_same_size_init)=='function'){whitelabels_same_size_init();}};var oneDom_domain;var oneDom_domain_obj;var currentSuggestedDomPos=0;var alertDisplayed=0;oneDom_domain='';websites_domain_allow_submit=false;$(document).ready(function(){if(Drupal.settings.load_weebly_preview_lightbox){WEEBLYPREVIEW.init(Drupal.settings.domain_in_cart);}
if($('body').hasClass('page-body-websites-domain'))
$(".page-body-websites-domain form").submit(function(){if(!websites_domain_allow_submit)
{var form=$(this);selected_website=$(this).find('.websites_domain_suggestion').attr("value");if(typeof CHECKOUTWEBSITEBUNDLE!='undefined'){CHECKOUTWEBSITEBUNDLE.init(form);CHECKOUTWEBSITEBUNDLE.setSelectedDomain(selected_website);return false;}}});$(".alreadyowndomv2").click(function(){fls_events_add('click_already_own_dom_link',1);if(typeof LOGOWEBV2!="undefined")LOGOWEBV2.hidePopUp();if(typeof BCWEB!="undefined")BCWEB.hidePopUp();DOMAINSERVICE_POPUP.init();});if(typeof Drupal.settings.skip_domains_init=='undefined'){websites_domain_init();websites_search_init();}
if(typeof Drupal.settings.domain_init!='undefined'){websites_domain_init();}
$(".allreadyOwnDomain .ownDomain").click(function(){fls_events_add('click_alreadyowndom_link');});$('#need_domain').click(function(){$('.need_domain_content').show();return false;});});function get_checkout_v2_sections(){var lang="";if(Drupal.settings.lang!=''){lang=Drupal.settings.lang+"/";}
var get_available_upsell_ids=1;$.post(Drupal.settings.baseUrl+"/"+lang+"get_checkout_v2_sections",{available_upsell_ids:get_available_upsell_ids,added_upsell_id:$("#added_upsells").val()},function(){}).done(function(result){result=JSON.parse(result);if(result["checkout_v2_popups"])$("#main_container").after(result["checkout_v2_popups"]);if(typeof result['cart_has_subscription']!='undefined'){Drupal.settings.cart_has_subscription=result['cart_has_subscription'];}
$("#section_products").html(result["mycart"]);$("#section_cart").html(result["cart_total"]);$("#section_added_upgrades").html(result["upgrades"]);if(get_available_upsell_ids){get_available_upsell_ids=result["upsells"];$('.upsells_new_single .add_to_cart').each(function(){var item_id=($(this).attr("id")).replace('add_to_cart_','');var item_id_available=false;for(i=0;i<result["upsells"].length;i++){if(result["upsells"][i]==item_id){item_id_available=true;break;}}
if(item_id_available===false)$(this).css("visibility","hidden");else $(this).css("visibility","visible");});}else $("#section_upsells").html(result["upsells"]);$("#cart_items_order_in_cart").val(result["cart_items_order_in_cart"]);updateCartNumber(result['cart_items_nr']);var shipping_obj_dropdown=$('#shipping-up-js');fls_store_update_price(shipping_obj_dropdown);$("#section_order_review .order_total").html(result['cart_total_price']);alter_upsell_remove_url(result["cart_items_order_in_cart"]);$("#section_upsells .add_to_cart").removeClass("disabled");id=window.location.href.split('#')[1];Drupal.settings.checkout_ajax_response=1;checkout_process_step(id);checkout_v2_redesign_init("section_payment_cart");checkout_v2_redesign_init("section_cart");$("#cart_has_any_google_upsell_product").val(result['cart_has_any_google_upsell_product']);$("#cart_has_uberall").val(result['cart_has_uberall']);showHideGoogleFields();if(Drupal.settings.checkout_v2&&typeof Drupal.settings.cart_has_subscription!='undefined'&&Drupal.settings.cart_has_subscription){$(".subscription_terms_text").show();}else $(".subscription_terms_text").hide();});;}
function alter_upsell_remove_url(cart_items_order_in_cart){if(cart_items_order_in_cart){var cart_items_order=cart_items_order_in_cart.split("|");for(i=0;i<cart_items_order.length;i++){if(cart_items_order[i]){var order=cart_items_order[i].split(":");if($("#upsell_"+order[0]+"_overlay_content").length){prod_rem_link=$("#upsell_"+order[0]+"_overlay_content a").attr("href");var string_part=prod_rem_link.substr(prod_rem_link.indexOf("remove="));var string_remove_part=string_part.substr(0,string_part.indexOf("&"));if(prod_rem_link&&string_remove_part){prod_rem_link=prod_rem_link.replace(string_remove_part,"remove="+order[1]);}
$("#upsell_"+order[0]+"_overlay_content a").attr("href",prod_rem_link);$("#upsell_"+order[0]+"_overlay_content a").show();}}}
var cont_obj=$(".upsell_overlay").not("#upsell_overlay_content");}}
function add_upsell_to_cart(domain,gotopage){lang="";if(Drupal.settings.lang!=''){lang=Drupal.settings.lang+"/";}
if(Drupal.settings.weebly_preview_v2_split_set){WEEBLYPREVIEW.hidePopUp();if(Drupal.settings.workflow!="business-cards"&&Drupal.settings.weebly_preview_v2_split_set){$("#FLSBcSuggestLogoStep2Canvas-BackDesignDlg .selector-title").html("Share your new email address on matching Business Cards");$("#FLSBcSuggestLogoStep2Canvas-BackDesignDlg .fls-orangebutton.selector-action").html("Not Right Now");}
Drupal.settings.websites_add_to_cart_status=0;show_loaded_color_bc_suggestion_lightbox();}
var fields={pid:463,logo_websitesv2:1,google_apps:1,reduce_flow:"1",final_destination:gotopage,website_searched:domain,websites_domain_suggestion:domain,website_upsells:523};if(Drupal.settings.weebly_preview_v2_split_set){fields['json']=1;}
var fields_str='';for(var i in fields){fields_str+='<input type="hidden" name="'+i+'" value="'+fields[i]+'" />';}
if(Drupal.settings.weebly_preview_v2_split_set){Drupal.settings.websites_add_to_cart_status=0;$.post(Drupal.settings.baseUrl+'/'+lang+'websites/domain',fields).done(function(data){Drupal.settings.websites_add_to_cart_status=1;});}else{$('body').append('<form id="checkoutwebsitebundle_form" style="display:none;" action="'+Drupal.settings.baseUrl+'/'+lang+'websites/domain" method="post">'+fields_str+'</form>');$('#checkoutwebsitebundle_form').submit();}
return false;}
function add_email_to_upsell(domain,email,gotopage){lang="";if(Drupal.settings.lang!=''){lang=Drupal.settings.lang+"/";}
if(Drupal.settings.weebly_preview_v2_split_set){BUNDLEEMAIL.hidePopUp();if(Drupal.settings.workflow!="business-cards"){$("#FLSBcSuggestLogoStep2Canvas-BackDesignDlg .selector-title").html("Share your new email address on matching Business Cards");$("#FLSBcSuggestLogoStep2Canvas-BackDesignDlg .fls-orangebutton.selector-action").html("Not Right Now");if(Drupal.settings.workflow!="business-cards"){Drupal.settings.websites_add_to_cart_status=0;show_loaded_color_bc_suggestion_lightbox();}}}
console.log('POST DOMAIN3');var fields={pid:463,logo_websitesv2:1,google_apps:1,final_destination:gotopage,website_searched:domain,websites_domain_suggestion:domain,website_mailbox:1,website_upsells:523,websites_email_input:email};if(Drupal.settings.weebly_preview_v2_split_set){fields['json']=1;}
var fields_str='';for(var i in fields){fields_str+='<input type="hidden" name="'+i+'" value="'+fields[i]+'" />';}
if(Drupal.settings.workflow=="business-cards"&&Drupal.settings.weebly_preview_v2_split_set){bc_data["email"]=email+"@"+domain;bc_data["website"]=domain;FLSProductEditor.Init('FreelogoEditorCanvas',bc_data);}
Drupal.settings.websites_add_to_cart_status=0;$.post(Drupal.settings.baseUrl+'/'+lang+'websites/domain',fields).done(function(data){Drupal.settings.websites_add_to_cart_status=1;if(Drupal.settings.workflow!="business-cards"&&Drupal.settings.weebly_preview_v2_split_set)
return false;});return false;}
function website_select(obj){var selDomPos;if($("body[class*='page-body-step3'] .bcweb_popup.logowebv2").length){if(!Drupal.settings.freedomain_split_set){fls_events_add('accepted_paid_dom_logo_flow_lightbox');}else fls_events_add('accepted_free_dom_logo_flow');}
else if($(".page-body-step2 .bcweb_popup.logowebv2").length){if(!Drupal.settings.freedomain_split_set){fls_events_add('accepted_paid_dom_logo_flow_lightbox');}else fls_events_add('accepted_free_dom_logo_flow');}else if($(".bcweb_popup.bc_dom_lightbox").length){if(!Drupal.settings.freedomain_split_set){fls_events_add('accepted_paid_dom_bc_flow_lightbox');}else fls_events_add('accepted_free_dom_bc_flow');}else if($("#step-checkout1").length){fls_events_add('accept_freedom_from_checkout');}
fls_events_add('accepted_domain_upsell');if(Drupal.settings.domain_search_split_set&&$("input[name=source_split]").length&&!Drupal.settings.claim_domain_btn){parentForm=obj.parent('form').find('input[name=source_split]');parentForm.attr("value","domainsearch");fls_events_add('add_to_cart_from_search');}
selDomPos=$(".domain_available input[type='button']").index(obj);if(selDomPos!==-1){selDomPos=selDomPos*1+1*1;}
else{selDomPos=$(".websites_domain_suggestions_list input[type='button']").index(obj);if(selDomPos!==-1)
if($(".domain_available").css("display")=="none"){selDomPos=selDomPos*1+1*1;}else{selDomPos=selDomPos*1+2*1;}}
if(selDomPos!==-1)fls_events_add('pos_selected_dom',selDomPos);var form=$(obj).parent('form');var data=form.serializeArray();var selected_website=$(obj).parent('form').find('.websites_domain_suggestion').attr("value");if(typeof Drupal.settings.tlds_split_set!='undefined'){if(typeof Drupal.settings.websites_populate_data!='undefined'&&typeof Drupal.settings.websites_populate_data.available_tlds!='undefined'){for(var i in Drupal.settings.websites_populate_data.available_tlds){if(selected_website==Drupal.settings.websites_populate_data.available_tlds[i]['domain']){fls_events_add('last_selected_tld',Drupal.settings.websites_populate_data.available_tlds[i]['tld']);}}}}
if(typeof Drupal.settings.bcweb_latest_search_match!='undefined'){if(Drupal.settings.bcweb_latest_search_match['ga_action']&&Drupal.settings.bcweb_latest_search_match['ga_label']){ga('send','event','Website Select Match Type',Drupal.settings.bcweb_latest_search_match['ga_label']+'|'+Drupal.settings.bcweb_latest_search_match['ga_action'],selected_website);ga('send','event','Website Select Checked By',Drupal.settings.bcweb_latest_search_match['ga_country'],(Drupal.settings.bcweb_latest_search_match['ga_action']=='domainsbot')?'domainsbot':Drupal.settings.bcweb_latest_search_match['ga_checkedby']);}}
$.each(data,function(i,d){if(d.name=='websites_domain_suggestion'){$('.email_label').html('@'+d.value);$('.input_related_text span').each(function(){var text=$(this).text();text=text.replace('customerurl',d.value);$(this).text(text);});}
$('#'+d.name).val(d.value);});var isavailabeselect=$(obj).parents('div.domain_available');if(isavailabeselect.length>0)
ga('send','event','Website Save','search',$('#websites_domain_suggestion').val());else
ga('send','event','Website Save','recomended',$('#websites_domain_suggestion').val());if($('.bcweb_popup').length>0&&($('.overlay').length>0||$('#FLSPreviewOverlay').length)){if($('.logowebv2_popup_content').length>0&&$('.logowebv2_popup_content').html().length>0){}else if($('.gaweb_popup_content').length>0&&$('.gaweb_popup_content').html().length>0){fls_events_add('gaweb_email_lightbox');}else{fls_events_add('bc_web_email_lightbox');}}else{fls_events_add('email_domain_lightbox');}
if(typeof Drupal.settings.weblb_show_popup!='undefined'){fls_events_add('weblb_lightbox_fired');WEBLB.init($(obj).parent('form'));return false;}
if(typeof Drupal.settings.bcweb_popup!='undefined'){$("#bc_popup_right_mail .right_content").append($("#websites_domain_package_form"));$('#submit_mailbox, .submit_mailbox').click(function(){submit_mailbox_on_click();});var d=$('#email_label').text();$(".email_suggestions h4").each(function(){var text=$(this).text();$(this).text(text+d);});if(Drupal.settings.weebly_preview_v2_split_set&&(Drupal.settings.workflow=='business-cards'||Drupal.settings.logo_id)){$(".bcweb_popup").hide();WEEBLYPREVIEW.init(selected_website);}else{$("#bc_popup_right_domain").hide().addClass('right_domain_hide');$('#submit_mailbox, .submit_mailbox').text(Drupal.settings.mail_button);$('.bcweb_header').text(Drupal.settings.mail_header);$(".email_suggestions").show();$(".email_suggestions h3").show();$("#bc_popup_right_mail").show();}
if(bcweb_track_lightbox_data()){fls_events_add('saw_website_email');fls_events_add('business_email_lb_fired_from_all_pages');fls_events_add('lightbox_bcstep3em_views');}
Drupal.settings.onedomv2_google_popup_show=1;if($(".thankYouBox.bcweb_popup").hasClass("onedom_lb")){$(".thankYouBox.bcweb_popup").removeClass("onedom_lb");}
if(currentSuggestedDomPos!==0){alert(Drupal.settings.not_available_domain_msg);fls_events_add('fire_not_available_dom_box');alertDisplayed=1;local_storage_set("onedom_alert_box",0);currentSuggestedDomPos=0;}
$(".allreadyOwnDomain, .ownDomain").hide();$(".website_popup_button").css('margin-top','50px');$("#website_template").val(Drupal.settings.default_template);}else if(typeof Drupal.settings.gaweb_popup_fire!='undefined'){$("#bc_popup_right_mail .right_content").append($("#websites_domain_package_form"));$('#submit_mailbox, .submit_mailbox').click(function(){fls_events_add('clicked_continue_from_gaweb_lightbox');submit_mailbox_on_click();});var d=$('#email_label').text();$(".email_suggestions h4").each(function(){var text=$(this).text();$(this).text(text+d);});$("#bc_popup_right_domain").hide().addClass('right_domain_hide');$('#submit_mailbox, .submit_mailbox').text(Drupal.settings.mail_button);$('.bcweb_header').text(Drupal.settings.mail_header);$(".email_suggestions").show();$(".email_suggestions h3").show();$("#bc_popup_right_mail").show();if(bcweb_track_lightbox_data()){fls_events_add('lightbox_bcstep3em_views');fls_events_add('business_email_lb_fired_from_all_pages');}
Drupal.settings.onedomv2_google_popup_show=1;$('input[name="website_template"]').val(Drupal.settings.default_template);}else{if($('.logowebv2_popup_content').length>0){if(currentSuggestedDomPos!==0&&alertDisplayed!==1){local_storage_set("onedom_alert_box",1);}
if(typeof Drupal.settings.weebly_preview_split_set!='undefined'&&!Drupal.settings.diy_website_pickyourplan_split_set){LOGOWEBV2.hidePopUp();WEEBLYPREVIEW.init(selected_website);return false;}else if(typeof Drupal.settings.weebly_preview_split_set!='undefined'&&Drupal.settings.diy_website_pickyourplan_split_set){$(".website_template").val(Drupal.settings.default_template);$(obj).parent('form').submit();return false;}else
if(typeof Drupal.settings.gaupsell_split_set!='undefined'){fls_events_add('gaupsell_lightbox_fired');fls_events_add('business_email_lightbox_fired');var gaupsell_page_type='step2';if(typeof Drupal.settings.page_is_step2!='undefined'){gaupsell_page_type='step2';}else{gaupsell_page_type='step3';}
fls_events_add('business_email_lb_fired_from_all_pages');fls_events_add('lightbox_'+gaupsell_page_type+'em_views');$('.bcweb_popup.logowebv2 .close').mousedown(function(){fls_events_add('lightbox_'+gaupsell_page_type+'em_close');});$('.bcweb_popup.logowebv2 .orangeButton_close').mousedown(function(){fls_events_add('lightbox_'+gaupsell_page_type+'em_negativecta');});$("#logoweb_popup_right_mail .right_content").append($("#websites_domain_package_form"));$('#submit_mailbox, .submit_mailbox').click(function(){fls_events_add('clicked_continue_from_gaupsell_lightbox');submit_mailbox_on_click();});var d=$('#email_label').text();$(".email_suggestions h4").each(function(){var text=$(this).text();$(this).text(text+d);});$("#logoweb_popup_domain").hide().addClass('right_domain_hide');$(".website_popup_button_container .free_domain_info").hide();$(".website_popup_button").css('display','block').css('margin-top','20px');$(".bcweb_popup h2").text(Drupal.settings.mail_header);$(".email_suggestions").show();$(".email_suggestions h3").show();$("#logoweb_popup_mail").show();Drupal.settings.onedomv2_google_popup_show=1;if(currentSuggestedDomPos!==0){alert(Drupal.settings.not_available_domain_msg);fls_events_add('fire_not_available_dom_box');alertDisplayed=1;local_storage_set("onedom_alert_box",0);currentSuggestedDomPos=0;}
$(".allreadyOwnDomain").hide();$('input[name="website_template"]').val(Drupal.settings.default_template);$(".thankYouBox.bcweb_popup").removeClass("onedom_lb");}else{$(".website_template").val(Drupal.settings.default_template);$(obj).parent('form').submit();}}else{if(Drupal.settings.reduce_flow)
submit_mailbox_on_click(true);else $('.popup_css_mailbox').show();}}
return false;}
function websites_domain_init(){Drupal.settings.website_init_domain={domain:$('#websites_domain_search_input').val(),tld:$('#websites_domain_search_category').val(),event:0};$(".mailbox .closeBtn, .mailbox .close").click(function(e){$('#websites_domain_package_form').submit();});$('.websites_domain_search_button').click(function(e){e.preventDefault();$('#multisearch_domain_not_available').hide();$('#websites_domain_search_input_hidden').val($('#websites_domain_search_input').val());$(".domain_available .websites_domain_suggestions_form input[type='button']").addClass("orangeButton");$(".domain_available .websites_domain_suggestions_form input[type='button']").removeClass("disabled");$(".domain_available .websites_domain_suggestions_form input[type='button']").val(Drupal.settings.msg_select);if(Drupal.settings.domain_search_split_set)Drupal.settings.search_button_clicked=1;websites_domain_search_form();});$('.websites_domain_already_button').click(function(e){e.preventDefault();$(".gapps_unavailable_error").hide();if(!validate_domain($('#websites_domain_already_input').val())){$('.websites_domain_already_results_error').html(Drupal.settings.websites_domain_already_results_error);$('.websites_domain_already_results_error').slideDown();return false;}else $(".websites_domain_already_results_error").slideUp();$('.websites_domain_search_button').hide();$('.websites_domain_already_form').submit();});$('#websites_domain_search_input').keyup(websites_domain_keyup);$('#websites_domain_already_input').keyup(websites_domain_clean);$('#websites_domain_search_input').change(function(){websites_domain_clean(this);});$('#websites_domain_already_input').change(function(){websites_domain_clean(this);$('#websites_domain_search_input_hidden').val($('#websites_domain_search_input').val());});$('input[name="manage_email_input"]').click(function(){if($(this).val()==1){$('.psw').hide();$('#websites_forward_email_input').show();}
else{$('.psw').show();$('#websites_forward_email_input').hide();}});$('input[type="button"]').click(function(){website_select(this)});$(".websites_domain_package_form").submit(function(){window.onbeforeunload=null;});$('#websites_email_input').each(function(){$(this).bind('keypress',function(e){var idform=fls_find_form(this);if(e.keyCode==13&&idform=='websites_domain_package_form'){return submit_mailbox_on_click();}});});$('#submit_mailbox, .submit_mailbox').click(function(){if(typeof Drupal.settings.domain_lightbox_email_submit!='undefined')return false;window.onbeforeunload=null;submit_mailbox_on_click();});}
function submit_mailbox_on_click(skip_mailbox){var is_valid=true;if(skip_mailbox===undefined)skip_mailbox=false;if(!skip_mailbox){is_valid=validate_mailbox();}
if(is_valid){Drupal.settings.domain_lightbox_email_submit=1;if($('.bcweb_popup').length>0&&($('.overlay').length>0||$('#FLSPreviewOverlay').length)){if(!skip_mailbox){if($('.logowebv2_popup_content').length>0&&$('.logowebv2_popup_content').html().length>0){if(typeof Drupal.settings.gaupsell_split_set!='undefined'){fls_events_add('clicked_continue_from_gaupsell_lightbox');var gaupsell_page_type='step2';if(typeof Drupal.settings.page_is_step2!='undefined'){gaupsell_page_type='step2';}else{gaupsell_page_type='step3';}
fls_events_add('lightbox_'+gaupsell_page_type+'em_continue');}else{fls_events_add('logo_web_email_submit');}}else if($('.gaweb_popup_content').length>0&&$('.gaweb_popup_content').html().length>0){fls_events_add('clicked_continue_from_gaweb_lightbox');}else{fls_events_add('bc_web_email_submit');}}}
else{fls_events_add('completed_email_domain');}
$('#websites_domain_package_form').submit();}
return false;}
function websites_get_current_domain(){var domain=$('.websites_domain_search_form #websites_domain_search_input_hidden').val()+'.'+$('#websites_domain_search_category').val();return domain;}
function websites_domain_search_form(init,results){var dom_tld;dom_tld=$('#websites_domain_search_category option:selected').text().substring(1);if(Drupal.settings.domain_search_split_set){if($(".domainsearch_split_cont").length)
dom_tld=$('.domainsearch_split_cont #websites_domain_search_category option:selected').text().substring(1);}
var domain_name=$('.websites_domain_search_form #websites_domain_search_input_hidden').val().trim();if(!domain_name)return false;var domain_clean=domain_name.replace(/[^a-zA-Z0-9-]+/g,'');if(domain_clean!=domain_name){$('.websites_domain_results_error').slideDown();return false;}
var domain=domain_name+'.'+dom_tld;$(".websites_domain_search_button").prop("disabled",true);$(".websites_domain_search_button").addClass("disabled");$('.domain_available').hide();$('#domain_not_available').hide();var domain_text=domain;if(typeof Drupal.settings.bcweb_popup!='undefined'||typeof Drupal.settings.gaweb_popup_fire!='undefined'){domain_text=Drupal.settings.email_name_label+'@'+domain;}
$('.domain_available .websites_domain_suggestion').val(domain);$('.domain_available .websites_domain_suggestion_text').text(domain_text);$('#domain_not_available .websites_domain_suggestion_text').text(domain_text);$('.websites_domain_results').slideUp();$('.other_suggested_domain_names').hide();$('.suggested_domain_names').show();$('.websites_domain_results_error, .websites_domain_already_results_error, .websites_domain_results_error_noavailable').hide();$('.websites_domain_suggestions_loading').slideDown();var data={domain:domain};if(Drupal.settings.bcweb_popup||Drupal.settings.logowebv2_popup){data['source']='popup';}
$.ajax({type:"POST",url:Drupal.settings.websites_domain_search_api,data:data,cache:false,dataType:"json",success:function(response)
{$('.websites_domain_search_button').prop("disabled",false);$('.websites_domain_search_button').removeClass("disabled");if(Drupal.settings.domain_search_split_set)
response["after_search"]=1;domain_text=response["domain"];if(typeof Drupal.settings.bcweb_popup!='undefined'||typeof Drupal.settings.gaweb_popup_fire!='undefined'){domain_text=Drupal.settings.email_name_label+'@'+response["domain"];}
$('.domain_available .websites_domain_suggestion').val(response["domain"]);$('.domain_available .websites_domain_suggestion_text').text(domain_text);$('#domain_not_available .websites_domain_suggestion_text').text(domain_text);websites_domain_parse_search_results(response,init,results);var domain_name=response["domain"].split('.');$("#websites_domain_search_input").val(domain_name[0]);$('#websites_domain_search_input_hidden').val($('#websites_domain_search_input').val());websites_prepare_buttons();}});}
function websites_prepare_buttons(){if(typeof Drupal.settings.websites_populate_data!='undefined'&&typeof Drupal.settings.websites_populate_data['domain_match_type']&&Drupal.settings.websites_populate_data['domain_match_type']){fls_events_add('dom_lightbox_match_type',Drupal.settings.websites_populate_data['domain_match_type']);if(typeof Drupal.settings.websites_populate_data['tlds']!='undefined'){var first_tld_user_see='';if(typeof Drupal.settings.websites_populate_data['available_tlds'][0]!='undefined'){first_tld_user_see=Drupal.settings.websites_populate_data['available_tlds'][0]['tld'];var tld_priority=$.inArray(first_tld_user_see,Drupal.settings.websites_populate_data['tlds']);tld_priority++;fls_events_add('dom_lightbox_first_tld',tld_priority);}}}
if(typeof Drupal.settings.check_domain_cache=='undefined'){Drupal.settings.check_domain_cache={};if(typeof Drupal.settings.websites_populate_data!='undefined'&&typeof Drupal.settings.websites_populate_data['check_db']!='undefined'&&Drupal.settings.websites_populate_data['check_db']){if(typeof Drupal.settings.websites_populate_data['unavailable_tlds_db']!='undefined'&&Drupal.settings.websites_populate_data['unavailable_tlds_db']){for(var x in Drupal.settings.websites_populate_data['unavailable_tlds_db']){Drupal.settings.check_domain_cache[Drupal.settings.websites_populate_data['unavailable_tlds_db'][x]]=false;}}
if(typeof Drupal.settings.websites_populate_data['available']!='undefined'&&typeof Drupal.settings.websites_populate_data['domain']!='undefined'){Drupal.settings.check_domain_cache[Drupal.settings.websites_populate_data['domain']]=Drupal.settings.websites_populate_data['available'];}}}
websites_domain_is_sequential_check_error('init');$('.websites_domain_page input[type="button"]').unbind("click");$('.websites_domain_page input[type="button"]:not(.disabled)').click(function(){websites_domain_is_sequential_check_error('show_loading');if($(".page-body-checkout").length>0){fls_events_add('total_clicks_checkout_upsell_lightbox');}
var suggestedDomain=$(this).parent('form').find('.websites_domain_suggestion').attr("value");$('.websites_domain_results_error_noavailable').hide();if(typeof Drupal.settings.check_domain_on_dropdown_change!='undefined'&&Drupal.settings.check_domain_on_dropdown_change){if(typeof Drupal.settings.check_domain_cache!='undefined'&&typeof Drupal.settings.check_domain_cache[suggestedDomain]!='undefined'){websites_domain_is_sequential_check_error('hide_loading');if(!Drupal.settings.check_domain_cache[suggestedDomain])websites_domain_is_sequential_check_error();return false;}}
var myobj;myobj=$(this);if(myobj.hasClass("claim_domain")){oneDom_domain_obj.trigger('click');return false;}
$(".websites_domain_suggestions_list .fls-bluebutton:not(.disabled), .domain_available .fls-bluebutton:not(.disabled), .top_websites_domain_search_form .fls-bluebutton:not(.disabled)").prop("disabled",true);$('.websites_domain_suggestions_list input[type="button"]:not(.disabled), .domain_available input[type="button"]:not(.disabled), .top_websites_domain_search_form input[type="submit"]:not(.disabled)').removeClass("fls-bluebutton");$('.domain_available input[type="button"]:not(.disabled)').removeClass("orangeButton");$('.websites_domain_suggestions_list input[type="button"]:not(.disabled), .domain_available input[type="button"]:not(.disabled), .top_websites_domain_search_form input[type="submit"]:not(.disabled)').addClass("disabled_btn");$('.websites_domain_suggestions_loading').slideDown();if(typeof Drupal.settings.check_domain_cache!='undefined'&&typeof Drupal.settings.check_domain_cache[suggestedDomain]!='undefined'&&typeof Drupal.settings.websites_populate_data!='undefined'&&typeof Drupal.settings.websites_populate_data['check_db']!='undefined'&&Drupal.settings.websites_populate_data['check_db']){var resultData={available:Drupal.settings.check_domain_cache[suggestedDomain]};websites_domain_check_callback(suggestedDomain,myobj,resultData);}else{var source='';if(typeof Drupal.settings.websites_populate_data!='undefined'&&typeof Drupal.settings.websites_populate_data['check_db']!='undefined'&&Drupal.settings.websites_populate_data['check_db']){source='popup';}
var squential_domain_check='';if(typeof Drupal.settings.websites_populate_data!='undefined'&&typeof Drupal.settings.websites_populate_data['checked-by']!='undefined'){squential_domain_check=Drupal.settings.websites_populate_data['checked-by'];}
$.post(Drupal.settings.websites_domain_search_api,{domain:suggestedDomain,limit:"0",vendor:'gandi',source:source,checked_by:squential_domain_check,website_upsells:Drupal.settings.website_upsells},function res(data){websites_domain_check_callback(suggestedDomain,myobj,data);},"json");}});}
function websites_domain_check_callback(suggestedDomain,myobj,data){if(typeof data['domain']!='undefined'&&suggestedDomain!=data['domain'])data.available=false;if(typeof Drupal.settings.check_domain_cache!='undefined'&&typeof Drupal.settings.check_domain_cache[suggestedDomain]=='undefined')Drupal.settings.check_domain_cache[suggestedDomain]=data.available;if(!data.available){$('.websites_domain_suggestions_loading').slideUp();$('.websites_domain_suggestions_list input[type="button"]:not(.disabled), .domain_available input[type="button"]:not(.disabled), .top_websites_domain_search_form input[type="submit"]:not(.disabled)').prop("disabled",false);$('.websites_domain_suggestions_list input[type="button"]:not(.disabled), .domain_available input[type="button"]:not(.disabled), .top_websites_domain_search_form input[type="submit"]:not(.disabled)').removeClass("disabled_btn");$('.websites_domain_suggestions_list input[type="button"]:not(.disabled), .top_websites_domain_search_form input[type="submit"]:not(.disabled)').addClass("fls-bluebutton");$('.domain_available input[type="button"]:not(.disabled)').addClass("orangeButton");if(!$(".thankYouBox.bcweb_popup").hasClass("onedom_lb")||(typeof Drupal.settings.websites_populate_data!='undefined'&&Drupal.settings.websites_populate_data['domain_match_type']=='domainsbot')){myobj.removeClass("fls-bluebutton");myobj.addClass("disabled");myobj.val(Drupal.settings.msg_not_available);myobj.unbind("click");fls_events_add('onedom_dropdown_error_onchange');}
if(websites_domain_is_sequential_check_error())return false;return false;}else{if(typeof Drupal.settings.websites_populate_data!='undefined'&&typeof Drupal.settings.websites_populate_data['check_db']!='undefined'&&Drupal.settings.websites_populate_data['check_db']){var resultData={available:data.available};websites_domain_db_check_callback(suggestedDomain,myobj,resultData);}else{$.post(Drupal.settings.websites_domain_research_api,{domain:suggestedDomain},function result(resultData){websites_domain_db_check_callback(suggestedDomain,myobj,resultData);},"json");}}}
function websites_domain_db_check_callback(suggestedDomain,myobj,resultData){if(typeof Drupal.settings.check_domain_cache!='undefined')Drupal.settings.check_domain_cache[suggestedDomain]=resultData.available;if(resultData.available){if(typeof Drupal.settings.check_domain_on_dropdown_change=='undefined'||!Drupal.settings.check_domain_on_dropdown_change){website_select(myobj);}
websites_domain_is_sequential_check_error('hide_loading');}
else{$('.websites_domain_suggestions_loading').slideUp();if(typeof Drupal.settings.bc_logoweb_split_set=='undefined'){$('.websites_domain_suggestions_list input[type="button"]:not(.disabled), .domain_available input[type="button"]:not(.disabled), .top_websites_domain_search_form input[type="submit"]:not(.disabled)').prop("disabled",false);$('.websites_domain_suggestions_list input[type="button"]:not(.disabled), .domain_available input[type="button"]:not(.disabled), .top_websites_domain_search_form input[type="submit"]:not(.disabled)').removeClass("disabled_btn");$('.websites_domain_suggestions_list input[type="button"]:not(.disabled), .top_websites_domain_search_form input[type="submit"]:not(.disabled)').addClass("fls-bluebutton");$('.domain_available input[type="button"]:not(.disabled)').addClass("orangeButton");}
else{if(!resultData.available){$('.websites_domain_suggestions_list input[type="button"]:not(.disabled), .domain_available input[type="button"]:not(.disabled), .top_websites_domain_search_form input[type="submit"]:not(.disabled)').prop("disabled",false);$('.websites_domain_suggestions_list input[type="button"]:not(.disabled), .domain_available input[type="button"]:not(.disabled), .top_websites_domain_search_form input[type="submit"]:not(.disabled)').removeClass("disabled_btn");$('.websites_domain_suggestions_list input[type="button"]:not(.disabled), .top_websites_domain_search_form input[type="submit"]:not(.disabled)').addClass("fls-bluebutton");$('.domain_available input[type="button"]:not(.disabled)').addClass("orangeButton");}}
if(typeof Drupal.settings.websites_populate_data!='undefined'&&typeof Drupal.settings.websites_populate_data['sequential']=='undefined'){if($(".thankYouBox.bcweb_popup").hasClass("onedom_lb")&&typeof Drupal.settings.websites_populate_data!='undefined'&&Drupal.settings.websites_populate_data['domain_match_type']!='domainsbot'){currentSuggestedDomPos+=1;oneDom_domain=$('.websites_domain_suggestions_list .websites_domain_suggestions_form:nth-child('+currentSuggestedDomPos+') input[name="websites_domain_suggestion"]').val();oneDom_domain_obj=$('.websites_domain_suggestions_list .websites_domain_suggestions_form:nth-child('+currentSuggestedDomPos+') input[class="fls-bluebutton"]');if(oneDom_domain!==""){oneDom_domain_obj.trigger('click');}}}
if(!$(".thankYouBox.bcweb_popup").hasClass("onedom_lb")||(typeof Drupal.settings.websites_populate_data!='undefined'&&Drupal.settings.websites_populate_data['domain_match_type']=='domainsbot')){myobj.removeClass("fls-bluebutton");myobj.removeClass("orangeButton");myobj.addClass("disabled");myobj.val(Drupal.settings.msg_not_available);myobj.unbind("click");fls_events_add('onedom_dropdown_error_onchange');}
if(websites_domain_is_sequential_check_error())return false;return false;}}
function websites_domain_is_sequential_check_error(op){if(!$(".thankYouBox.bcweb_popup").hasClass("onedom_lb"))return false;if(typeof op=='undefined')op='error';if(typeof Drupal.settings.websites_populate_data!='undefined'&&typeof Drupal.settings.websites_populate_data['sequential']!='undefined'){if($('#one_domain_name .websites_domain_results_error_noavailable').length==0){$('.claim_domain').before($('.websites_domain_results_error_noavailable'));$('.websites_domain_results_error_noavailable').css({padding:'5px',margin:'5px',border:'0px none',color:'#000'});$('.claim_domain').after($('.websites_domain_suggestions_loading'));$('.claim_container').css({height:'37px'});$('.websites_domain_suggestions_loading').css({height:'37px',visibility:'hidden',display:'block'});}
if(op=='show_loading'){$('.claim_domain').hide();$('.websites_domain_suggestions_loading').show().css('visibility','visible');}
if(op!='show_loading'){$('.websites_domain_suggestions_loading').hide();$('.claim_domain').show();}
if(op=='error'){$('.websites_domain_results_error_noavailable').show();$('.claim_domain').hide();fls_events_add('onedom_dropdown_error_onchange');}
return true;}
return false;}
function websites_search_init(){if($("input[name='google_apps']").val()==1&&typeof Drupal.settings.gaweb_popup_fire=='undefined'){$(".website_popup_button .orangeButton").insertAfter(".websites_domain_page .right_content");$(".website_popup_button").css('margin-top','17px');}
if(Drupal.settings.skip_domain_result_population){if($(".thankYouBox.bcweb_popup").hasClass("onedom_lb")){$(".thankYouBox.bcweb_popup").removeClass("onedom_lb");$(".onedom_lb_container").remove();}
return false;}
if(typeof Drupal.settings.websites_populate_data!='undefined'){var domain=Drupal.settings.websites_populate_data["domain"];if(typeof Drupal.settings.websites_populate_data.domain_with_dash!='undefined'){fls_events_add('domain_contain_dash');}
if(typeof Drupal.settings.bcweb_popup!='undefined'||typeof Drupal.settings.gaweb_popup_fire!='undefined'){domain=Drupal.settings.email_name_label+'@'+Drupal.settings.websites_populate_data["domain"];}
$('.domain_available .websites_domain_suggestion').val(Drupal.settings.websites_populate_data["domain"]);$('.domain_available .websites_domain_suggestion_text').text(domain);$('#domain_not_available .websites_domain_suggestion_text').text(domain);websites_domain_parse_search_results(Drupal.settings.websites_populate_data);if(typeof Drupal.settings.tlds_split_set!='undefined'){fls_events_add('last_fired_dom_lightbox',1);onedomv2_close_trigger();}
onedomv2_create_dropdown();websites_prepare_buttons();if(typeof Drupal.settings.tlds_split_set!='undefined'){$('#websites_domain_search_input').val('');}
return;}
var domain=$('#websites_domain_search_input_hidden').val();if(typeof domain!='undefined'){if(domain.length>0){websites_domain_search_form(Drupal.settings.multisearch);return;}}}
function onedomv2_close_trigger(){if(typeof onedomv2_results2_rendered!='undefined')return;onedomv2_results2_rendered=true;$('.thankYouBox .close, .thankYouBox .closeBtn, .thankYouBox .orangeButton_close').click(function(){if(typeof Drupal.settings.onedomv2_google_popup_show=='undefined'){fls_events_add('last_click_close_btn',1);}});}
function onedomv2_create_dropdown(){if(typeof onedomv2_results_rendered!='undefined')return;onedomv2_results_rendered=true;var lightbox_type='list_tld';if(typeof Drupal.settings.tlds_split_set!='undefined'&&Drupal.settings.tlds_split_set==1&&typeof Drupal.settings.fls_onedom_split_set!='undefined'&&Drupal.settings.fls_onedom_split_set==1){lightbox_type='one_ltd';$("#one_domain_name").html(oneDom_domain);$('#one_domain_name').append($('.websites_domain_search_category_outer').not(".domainsearch_split_cont .websites_domain_search_category_outer").clone());$('#websites_domain_search_category').html('');var oneDom_dropdown_tlds='';var pos=0;for(var i in Drupal.settings.onedomv2_results){oneDom_dropdown_tlds+='<option value="'+pos+'">.'+Drupal.settings.onedomv2_results[i]['tld']+'</option>';pos++;}
$('#websites_domain_search_category').html(oneDom_dropdown_tlds);$('#websites_domain_search_category').change(function(){if(typeof Drupal.settings.tlds_split_set!='undefined'){fls_events_add('last_onedom_dropdown_interact',1);}
if(typeof Drupal.settings.websites_populate_data!='undefined'&&typeof Drupal.settings.websites_populate_data['sequential']!='undefined'){websites_domain_check_domain();}});setTimeout(function(){$('.claim_domain').unbind('click');$('.claim_domain').click(function(){Drupal.settings.check_domain_on_dropdown_change=0;$('.websites_domain_results_error_noavailable').hide();Drupal.settings.claim_domain_btn=1;if($(".page-body-checkout").length>0){fls_events_add('total_clicks_checkout_upsell_lightbox');fls_events_add('accept_freedom_from_checkout',1);}
var tld=$('#websites_domain_search_category option:selected').text().substring(1);$('.right_content .websites_domain_suggestions_form').each(function(){var domain_name=$(this).find('input[class="websites_domain_suggestion"]').val();if(domain_name){var domain=domain_name.split('.');domain.shift();var current_tld=domain.join('.');if(current_tld==tld){$(this).find('input[type="button"]').trigger('click');}}});});},500);}
fls_events_add('dom_lightbox_type',lightbox_type);}
function websites_domain_check_domain(){Drupal.settings.check_domain_on_dropdown_change=1;var tld=$('#websites_domain_search_category option:selected').text().substring(1);$('.right_content .websites_domain_suggestions_form').each(function(){var domain_name=$(this).find('input[class="websites_domain_suggestion"]').val();if(domain_name){var domain=domain_name.split('.');domain.shift();var current_tld=domain.join('.');if(current_tld==tld){$(this).find('input[type="button"]').trigger('click');}}});}
function websites_domain_identify_match(data){if(typeof data['domain_match_type']!=='undefined')
return data['domain_match_type'];return false;}
function websites_domain_parse_search_results(data,init,results){var error=false;if(typeof Drupal.settings.twolinesearch=='undefined'||(typeof Drupal.settings.twolinesearch!='undefined'&&!init)){if((error=websites_domain_parse_search_results_validate(data))!=false){websites_domain_search_error(error);if(Drupal.settings.domain_search_split_set&&data["after_search"]&&!$(".domain_search_err_div").length&&$(".onedom_lb_container").css("display")=="block"){var err_div;err_div=($('.websites_domain_results_error').clone()).addClass("domain_search_err_div");err_div.prependTo(".domainsearch_split_cont");}
return;}}
if(Drupal.settings.domain_search_split_set&&!$(".page-body-websites-domain").length&&Drupal.settings.search_button_clicked){fls_events_add('submit_search');}
if(Drupal.settings.domain_search_split_set&&data["after_search"]){var newButtonHref=$(".onedom_lb_container .closeBtn").attr("href");$(".onedom_lb_container .domainsearch_split_cont").remove();$('.onedom_lb_container').hide();$('.onedom_lb.bcweb_popup .right div.right_content .bottom_websites_domain_search_form').wrap('<div class="domainsearch_split_cont"></div>');$('.onedom_lb.bcweb_popup .right div.right_content').show();buttonClassName=$('#logoweb_popup_domain .right_content').next().attr("class");if(!buttonClassName||(buttonClassName&&buttonClassName.indexOf("website_popup_button")==-1)){if(buttonClassName)console.log(buttonClassName+"   "+buttonClassName.indexOf("website_popup_button"));var newButton=$(".website_popup_button:first").clone();$('#logoweb_popup_domain .right_content').after(newButton.addClass("dom_search_btn"));$(".dom_search_btn>a").attr("href",newButtonHref);$(".dom_search_btn").css('display','block').css('margin-top','20px').css("margin","0px auto");}}
if(init){if(!data['available']){if(typeof Drupal.settings.twolinesearch!='undefined'){$('#websites_domain_search_input_hidden').val(Drupal.settings.twolinesearch);var new_results=[];if(typeof data['suggest']!=='undefined'){if(data['suggest']!=null){new_results=data['suggest'].slice(0,5);}}
var domain=$('#websites_domain_search_input').val()+'.'+$('#websites_domain_search_category').val();if(typeof Drupal.settings.bcweb_popup!='undefined'||typeof Drupal.settings.gaweb_popup_fire!='undefined'){domain=Drupal.settings.email_name_label+'@'+domain;}
$('#multisearch_domain_not_available .websites_domain_suggestion_text').text(domain);$('#multisearch_domain_not_available').show();websites_domain_search_form(false,new_results);return;}}}
var ga_action=websites_domain_identify_match(data);var current_href=window.location.href;if(current_href.indexOf('business-cards/step3')>-1){ga_label='bc';}else if(current_href.indexOf('step2')>-1||current_href.indexOf('step3')>-1){ga_label='logo';}else if(current_href.indexOf('websites/domain')>-1){ga_label='DomainSearchLP';}else{var replace_base_url=Drupal.settings.baseUrl+'/';if(Drupal.settings.lang){replace_base_url+=Drupal.settings.lang;}
var current_path=current_href.replace(replace_base_url,'');var arr_current_path=current_path.split('/');ga_label=arr_current_path[0];}
ga('send','event','Website Type Search',ga_action,ga_label);Drupal.settings.bcweb_latest_search_match={ga_action:ga_action,ga_label:ga_label,ga_checkedby:data['checked-by'],ga_country:data['country']};if(typeof Drupal.settings.bcweb_initial_search_track=='undefined'){if(ga_action){ga('send','event','Website Initial Search',ga_action,ga_label);Drupal.settings.bcweb_initial_search_track=true;}}
if(typeof(data['available_tlds'])!='undefined'&&data['available_tlds'].length>0){Drupal.settings.onedomv2_results=data['available_tlds'];oneDom_domain='<span class="onedomv2_domain">'+Drupal.settings.onedomv2_results[0]['name']+'</span>';}else if(typeof(data['suggest'])!='undefined'&&data['suggest'].length>0){Drupal.settings.fls_onedom_split_set=0;$('.onedom_lb_container').hide();$('.onedom_lb.bcweb_popup .right div.right_content').show();$('.website_popup_button').css('display','inline-block');$('.website_popup_button a.orangeButton_close').css('margin-bottom','10px').css('display','block');$('.bcweb_popup_right a.orangeButton_close').css('display','block');if(!$('body').hasClass('mobile_view')){$('.onedom_lb.bcweb_popup:not(.logowebv2) .bcweb_popup_left').css('width','40%');$('.onedom_lb.bcweb_popup:not(.logowebv2) .bcweb_popup_right').css('width','59%');}}
if(typeof data['available']!=='undefined'){if(data['available']){if(Drupal.settings.tlds_split_set==1)
$('.search_header').show();ga('send','event','Website Search','Available',data['domain']);$('.suggested_domain_names').hide();$('.other_suggested_domain_names').show();oneDom_domain_obj=$('.domain_available .websites_domain_suggestions_form:first input[class="orangeButton"]');$('.domain_available').show();}else{if(typeof Drupal.settings.website_init_domain!='undefined'){if(!Drupal.settings.website_init_domain['event']){Drupal.settings.website_init_domain['event']=1;ga('send','event','Website Init Recommendation','Not Available',Drupal.settings.website_init_domain['domain']+'.'+Drupal.settings.website_init_domain['tld']);}}
if(Drupal.settings.tlds_split_set==1){$('#domain_not_available').hide();$('.search_header').hide();$('.other_suggested_domain_names').show();$('.suggested_domain_names').hide();}
else{$('.search_header').show();$('#domain_not_available').show();$('.suggested_domain_names').show();$('.other_suggested_domain_names').hide();}}}
if(typeof data['suggest']!=='undefined'){if(data['suggest']==null){$('.other_suggested_domain_names').hide();$('.suggested_domain_names').hide();}}
$('.websites_domain_results .websites_domain_results_container .websites_domain_suggestions_list').html('');if(typeof results=='undefined')results=[];if(data['suggest']!=null){results=$.merge(results,data['suggest']);results=results.slice(0,10);}
$.each(results,function(index,value){var default_entry=$('.websites_domain_results_container .template').html();$('.websites_domain_results .websites_domain_suggestions_list').append(default_entry);if(typeof Drupal.settings.bcweb_popup!='undefined'||typeof Drupal.settings.gaweb_popup_fire!='undefined'){$('.websites_domain_suggestions_list .websites_domain_suggestions_form:last .websites_domain_suggestion_text').text(Drupal.settings.email_name_label+'@'+value['domain']);}
else{$('.websites_domain_suggestions_list .websites_domain_suggestions_form:last .websites_domain_suggestion_text').text(value['domain']);}
$('.websites_domain_suggestions_list .websites_domain_suggestions_form:last .websites_domain_suggestion').val(value['domain']);$('.websites_domain_suggestions_list .websites_domain_suggestions_form:last').addClass('websites_domain_suggestion_'+index);});if(typeof data['domain']!='undefined'){$('.website_searched').val(data['domain']);}
$('.websites_domain_results').slideDown();$('.websites_domain_suggestions_loading').slideUp();if(oneDom_domain==""){oneDom_domain=$('.websites_domain_suggestions_list .websites_domain_suggestions_form:first input[name="websites_domain_suggestion"]').val();oneDom_domain_obj=$('.websites_domain_suggestions_list .websites_domain_suggestions_form:first input[class="fls-bluebutton"]');}
onedomv2_close_trigger();onedomv2_create_dropdown();}
function websites_domain_parse_search_results_validate(data){if(typeof data=='undefined')
return 101;if(data==false)
return 101;if(typeof data['isOk']=='undefined')
return 102;if(data['isOk']!=true)
return 103;if(typeof data['suggest']==false)
return 104;if((typeof data['available']=='undefined'||!data['available'])&&(typeof data.available_tlds=='undefined'||data.available_tlds.length==0)&&(typeof data.suggest=='undefined'||data.suggest.length==0)){return 105;}
return false;}
function websites_domain_search_error(error){if(error==105){$('.websites_domain_results_error_noavailable').slideDown();}else{$('.websites_domain_results_error').slideDown();}
$('.websites_domain_suggestions_loading').slideUp();}
function websites_domain_keyup(){websites_domain_clean();var domain=$('#websites_domain_search_input_hidden').val();$.each(Drupal.settings.tlds,function(index,value){if(value==domain.slice(domain.length-value.length)){$('#websites_domain_search_category').val(value);domain=domain.slice(0,-value.length);domain=domain.replace(/\./g,"");$('#websites_domain_search_input_hidden').val(domain);}});}
function websites_domain_clean(o){return false;var str=$(o).val();if(str){var str2=str.replace(/[^a-zA-Z0-9-.]+/g,'');if(str!=str2){$(o).val(str2);}}}
function validate_domain_tld(domain){if(!domain)return false;var dom_tld=domain.split(".").pop();if(dom_tld){if($.inArray(dom_tld,Drupal.settings.available_tlds)==-1)return false;return true;}else return false;return true;}
function validate_domain(domain){if(!domain)
return false;var re=new RegExp(/^(([a-zA-Z]{1})|([a-zA-Z]{1}[a-zA-Z]{1})|([a-zA-Z]{1}[0-9]{1})|([0-9]{1}[a-zA-Z]{1})|([a-zA-Z0-9][a-zA-Z0-9-_]{1,61}[a-zA-Z0-9]))\.([a-zA-Z]{2,6}|[a-zA-Z0-9-]{2,30}\.[a-zA-Z]{2,3})$/);return domain.match(re);};$(document).ready(function(){$('#weebly_editor').on('load',function(){$('#weebly_editor').css('visibility','visible');$('#weebly_container').css('visibility','visible');});});function validate_mailbox(){var global_err_messages=JSON.parse(Drupal.settings.global_error_messages);var websites_email_input=$('#websites_email_input').val();if(!websites_email_input){$('#error_msg').html(global_err_messages.email_required);$('#error_msg').show();return false;}
var test=new RegExp("^[a-zA-Z0-9]+([-._][a-zA-Z0-9]+)*$");if(!websites_email_input.match(test)){$('#error_msg').html(global_err_messages.email_restriction);$('#error_msg').show();return false;}
if($('#websites_email_pass_input').length){if($('#manage_email_input_0').is(":checked")&&!$('#websites_email_pass_input').val()){$('#error_msg').html(global_err_messages.pass_required);$('#error_msg').show();return false;}
if($('#manage_email_input_0').is(":checked")&&$('#websites_email_pass_input').val()!=$('#websites_email_pass_conf_input').val()){$('#error_msg').html(global_err_messages.pass_restriction);$('#error_msg').show();return false;}
if($('#manage_email_input_0').is(":checked")){var msg=validate_pass_strength($('#websites_email_pass_input').val());if(msg!=true){$('#error_msg').html(msg);$('#error_msg').show();return false;}}}
if($('#manage_email_input_1').is(":checked")&&!$('#websites_forward_email_input').val()){$('#error_msg').html(global_err_messages.fwd_email_required);$('#error_msg').show();return false;}
if($('#manage_email_input_1').is(":checked")&&!isValidEmail($('#websites_forward_email_input').val())){$('#error_msg').html(global_err_messages.fwd_email_restriction);$('#error_msg').show();return false;}
return true}
function validate_pass_strength(pass){var global_err_messages=JSON.parse(Drupal.settings.global_error_messages);var number_count=pass.replace(/\D/g,"").length;if(number_count&&number_count!=pass.length&&pass.length>=6){return true}
else{return global_err_messages.invalid_pass;}};$(document).ready(function(){$("#addToCartBtn").removeClass("custom");if(Drupal.settings.show_website_upsell_popup==1)
CHECKOUTWEBSITEBUNDLE.init();});var sel_domain;function website_upsell_check(){var types=new Array();if($(".website_upsell .add_to_cart_div>input[upsell_type='upsell_googlebundle']").is(":checked")){types=new Array('upsell_googlebundle');website_upsell_lightbox_disable_enable(types,'disable');}else if($(".website_upsell .add_to_cart_div>input[upsell_type='upsell_google']").is(":checked")){types=new Array('upsell_google','upsell_hosting','upsell_bundle','upsell_googlebundle');website_upsell_lightbox_disable_enable(types,'disable');}
else if($(".website_upsell .add_to_cart_div>input[upsell_type='upsell_bundle']").is(":checked")){types=new Array('upsell_bundle','upsell_google');website_upsell_lightbox_disable_enable(types,'disable');}else{types=new Array();website_upsell_lightbox_disable_enable(types,'enable');}}
function website_upsell_lightbox_disable_enable(not_type_arr,op){if(not_type_arr.length>0){var selected_upsells=new Array();$('.website_upsell .add_to_cart_div>input').each(function(){var type=$(this).attr('upsell_type');if($(this).is(":checked"))selected_upsells.push(type);});var google_upsell_status=$.inArray('upsell_google',selected_upsells);var bundle_upsell_status=$.inArray('upsell_bundle',selected_upsells);if(google_upsell_status>-1&&bundle_upsell_status>-1){var pos=$.inArray('upsell_hosting',not_type_arr);if(pos>-1)not_type_arr.splice(pos,1);}}
if(op=='disable'){$('.website_upsell .add_to_cart_div>input').each(function(){var type=$(this).attr('upsell_type');if(not_type_arr.length==0||$.inArray(type,not_type_arr)==-1){$(this).prop("disabled",true).prop("checked",false);}else{$(this).prop("disabled",false);}});}
if(op=='enable'){$('.website_upsell .add_to_cart_div>input').each(function(){var type=$(this).attr('upsell_type');if(not_type_arr.length==0||$.inArray(type,not_type_arr)==-1){$(this).prop("disabled",false);}});}}
var CHECKOUTWEBSITEBUNDLE={setSelectedDomain:function(selected_dom){sel_domain=selected_dom;},init:function(element){if(!Drupal.settings.custom_version)
fls_events_add('fired_website_checkout_saved_website');if($('.checkoutwebsitebundle_popup').length>0&&($('.overlay').length>0||$('#FLSPreviewOverlay').length)){$('#FLSPreviewOverlay, #FLS_PageLoadingOverlay').hide();$('.checkoutwebsitebundle_popup').addClass('initialized');CHECKOUTWEBSITEBUNDLE.placePopUp(element);if(Drupal.settings.custom_version){$(".checkoutwebsitebundle_popup").addClass("custom");$(".thankYouBox.checkoutwebsitebundle_popup.custom .upsells_new_check_logo.price_row .upsells_new_price").before(Drupal.settings.custom_text);$(".thankYouBox.checkoutwebsitebundle_popup.custom #addToCartBtn").appendTo(".thankYouBox.checkoutwebsitebundle_popup.custom .upsells_new_check_logo.price_row");$(".thankYouBox.checkoutwebsitebundle_popup.custom #noThankYou").appendTo(".thankYouBox.checkoutwebsitebundle_popup.custom .upsells_new_check_logo.price_row");$(".thankYouBox.checkoutwebsitebundle_popup.custom #addToCartBtn").addClass("custom");$("#addToCartBtn.custom").click(function(){lang="";if(Drupal.settings.lang!=''){lang=Drupal.settings.lang+"/";}
var fields={pid:463,reduce_flow:1,final_destination:(Drupal.settings.logged_in?"checkout":"websites/step4"),websites_domain_already_input:sel_domain,website_upsells:523};var fields_str='';for(var i in fields){fields_str+='<input type="hidden" name="'+i+'" value="'+fields[i]+'" />';}
$('body').append('<form id="checkoutwebsitebundle_form" style="display:none;" action="'+Drupal.settings.baseUrl+"/"+lang+'websites/domain" method="post">'+fields_str+'</form>');$('#checkoutwebsitebundle_form').submit();return false;});}
$("#addToCartBtn:not(.custom)").click(function(){console.log("addToCartBtn");oneChecked=0;checkedUpsells="";$('.website_upsell .add_to_cart_div input').each(function(){if($(this).is(":checked")){oneChecked=1;checkedUpsells=checkedUpsells+$(this).attr("id")+"|";}});lang="";if(Drupal.settings.lang!="")lang="/"+Drupal.settings.lang;if(oneChecked)
$.post(Drupal.settings.baseUrl+"/websites/prepareupsell",{site_id:Drupal.settings.site_id,upsell_ids:checkedUpsells},function response(data){if(data==1)
$('.website_upsell .add_to_cart_div input').each(function(){if($(this).is(":checked")){fls_events_add('ty_added_'+$(this).attr("id"));}});window.location=Drupal.settings.baseUrl+lang+"/checkout";});});$(".website_upsell .add_to_cart_div input[upsell_type='upsell_bundle'], .website_upsell .add_to_cart_div input[upsell_type='upsell_google'], .website_upsell .add_to_cart_div input[upsell_type='upsell_googlebundle']").click(function(){website_upsell_check();});$('.checkoutwebsitebundle_popup .close, .checkoutwebsitebundle_popup .no_thanks, #noThankYou, .checkoutwebsitebundle_popup .closeBtn').click(function(e){if(Drupal.settings.custom_version){websites_domain_allow_submit=true;CHECKOUTWEBSITEBUNDLE.hidePopUp();element.submit();}else{e.preventDefault();CHECKOUTWEBSITEBUNDLE.hidePopUp();return false;}});$('html, body').animate({scrollTop:0},'fast');return false;}},placePopUp:function(element){var overlay=$('.overlay:first');var thankYouBox=$('.checkoutwebsitebundle_popup');$('.overlay, .checkoutwebsitebundle_popup').remove();var docH=$(document).height();var docW=$(document).width();overlay.css({"width":docW+"px","height":docH+"px"});thankYouBox.prependTo('body');overlay.prependTo('body');if($('#FLS_PageLoadingOverlay').length){$('#FLS_PageLoadingOverlay').show();$('.overlay').hide();}else{$('.overlay:first').show();}
thankYouBox.show();var bW=$('.checkoutwebsitebundle_popup').width();var bH=$('.checkoutwebsitebundle_popup').height();var wW=$(window).width();var wH=$(window).height();bW=wW/2-bW/2;bH=wH/2-bH/2;$('.checkoutwebsitebundle_popup').css({left:bW,top:bH>40?bH:40});setTimeout(function(){$('.thankYouBox.checkoutwebsitebundle_popup').css('visibility','visible')},1500);},hidePopUp:function(){$('.checkoutwebsitebundle_popup').hide();$(".checkoutwebsitebundle_popup .upsells_new_single").show();$('.overlay').hide();var types=new Array();website_upsell_lightbox_disable_enable(types,'enable');$('.website_upsell .add_to_cart_div>input').each(function(){$(this).prop('checked',false);})
$('.thankYouBox.checkoutwebsitebundle_popup').remove();return false;}};var LOGOWEBV2={logoweb_page_type:'other',init:function(element){if($('body').attr('class').indexOf('page-body-step2')>-1){LOGOWEBV2.logoweb_page_type='step2';}else if($('.inner_step3').length>0){LOGOWEBV2.logoweb_page_type='step3';}
$("#submit_mailbox").click(function(){fls_events_add('clicked_continue_from_logo_lightbox');fls_events_add('took_website_email');});if(Drupal.settings.alreadyowndomv2_split_set){$(".alreadyowndomv2").show();fls_events_add('fired_free_dom_lightbox',1);}
fls_events_add('fired_dom_lightbox');fls_events_add('lightbox_'+LOGOWEBV2.logoweb_page_type+'dom_views');$(".websites_domain_search_button").click(function(){fls_events_add('last_searched_tld',$("#websites_domain_search_category").val());});fls_events_add('fire_onedomain_lb',Drupal.settings.fls_onedom_split_set);if(Drupal.settings.fls_onedom_split_set==1){$(".free_domain_info").insertAfter(".websites_domain_page .left");}
if(Drupal.settings.lbgooglebadge_split_set===true){$(".googleBadge").insertAfter(".websites_domain_page .left");$(".gfwork_partner").hide();$(".googleBadge").show();}
if($('.bcweb_popup').length>0&&($('.overlay').length>0||$('#FLSPreviewOverlay').length)){if($('body').hasClass('mobile_view')){Drupal.settings.old_metaviewport=$('#metaviewport').attr('content');console.log(Drupal.settings.old_metaviewport);$('#metaviewport').attr('content','width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0');$('.centerv2, .flsbottom').css('display','none');}
if($('.websites_domain_page .left img').attr('src')==""){if($('.websites_domain_page .left .descr').length==0)
$('.websites_domain_page .left').hide();else
$('.websites_domain_page .left .img').hide();}
if(Drupal.settings.logowebv2_ajax){Drupal.settings.load_lightbox=true;logowebv2_ajax();}else{load_logowebsitev2();}
$('.domains_view_more_options a').click(function(event){event.preventDefault();var url=$(this).attr('rel');url+=$("#websites_domain_search_input").val()+'.'+$('#websites_domain_search_category').val();window.location=url;return false;});$('html, body').animate({scrollTop:0},'fast');$('.bcweb_popup .close').click(function(){fls_events_add('lightbox_'+LOGOWEBV2.logoweb_page_type+'dom_close');if($("#logoweb_popup_domain").is(":visible")){fls_events_add('closed_domain_upsell_lightbox');}
else if($("#logoweb_popup_mail").is(":visible")){fls_events_add('closed_website_email_lightbox');}});$('.bcweb_popup .orangeButton_close').click(function(){fls_events_add('lightbox_'+LOGOWEBV2.logoweb_page_type+'dom_negativecta');if($("#logoweb_popup_domain").is(":visible")){fls_events_add('closed_domain_upsell_lightbox');}
else if($("#logoweb_popup_mail").is(":visible")){fls_events_add('closed_website_email_lightbox');}});$('.bcweb_popup .close, .bcweb_popup .orangeButton_close').click(function(){if(typeof Drupal.settings.onedomv2_google_popup_show=='undefined'){fls_events_add('click_close_btn');}});$('.bcweb_popup .close, .bcweb_popup .orangeButton_close').click(function(){if(Drupal.settings.weebly_preview_v2_split_set){LOGOWEBV2.hidePopUp();$('#FLS_PageLoadingOverlay').remove();show_loaded_color_bc_suggestion_lightbox();return false;}
if(Drupal.settings.bc_logoweb_split_set||Drupal.settings.logowebpn_split_set||Drupal.settings.tlds_split_set){if(typeof(flash_promo_products_finish)=='function'){if(Drupal.settings.gaweb_popup!=undefined){LOGOWEBV2.hidePopUp();GAWEB.init();return false;}
else{if($('.right_domain_hide').length){fls_events_add('clicked_no_thanks_from_gaupsell_lightbox');if(Drupal.settings.autoadd_diy!=undefined&&Drupal.settings.autoadd_diy==1){$("#extra_google_apps").val(1);$("#extra_autoadd_diy").val(1);}else{$("#extra_google_apps").val(0);$("#extra_autoadd_diy").val(0);}
$("#websites_email_input").val('');submit_mailbox_on_click(true);return false;}else{flash_promo_products_finish();return true;}}}}
LOGOWEBV2.hidePopUp();if(Drupal.settings.gaweb_popup!=undefined){GAWEB.init();return false;}
else{if($('.right_domain_hide').length){fls_events_add('clicked_no_thanks_from_gaupsell_lightbox');$("#websites_email_input").val('');if(Drupal.settings.autoadd_diy!=undefined&&Drupal.settings.autoadd_diy==1){$("#extra_google_apps").val(1);$("#extra_autoadd_diy").val(1);}else{$("#extra_google_apps").val(0);$("#extra_autoadd_diy").val(0);}
submit_mailbox_on_click(true);return false;}else{$('.bcweb_popup').remove();return true;}}});}},changeWebsiteDomain:function(){if($("#websites_domain_search_input").val().trim().length==0)
$(".domains_view_more_options").hide();else $(".domains_view_more_options").show();},trackEvents:function(){if(!Drupal.settings.freedomain_split_set){fls_events_add('paid_dom_lightbox_logo_flow');}else fls_events_add('logo_web_init');$('.websites_domain_search_button').click(function(e){fls_events_add('logo_web_search');});},placePopUp:function(element){var overlay=$('.overlay:first');var thankYouBox=$('.bcweb_popup');$('.overlay, .logoweb_popup').remove();var docH=$(document).height();var docW=$(document).width();overlay.css({"width":docW+"px","height":docH+"px"});thankYouBox.prependTo('body');$('#TB_window').hide();if($('.TB_overlayBG').length==0){overlay.prependTo('body');$('.overlay:first').show();}else{$('.TB_overlayBG').addClass('overlay').removeClass('TB_overlayBG').attr('id','').show();}
thankYouBox.show();thankYouBox.addClass('thankYouBoxVisible');var bW=$('.bcweb_popup').width();var bH=$('.bcweb_popup').height();var wW=$(window).width();var wH=$(window).height();bW=wW/2-bW/2;bH=wH/2-bH/2;$('.bcweb_popup').css({left:bW,top:bH>40?bH:40});$('.thankYouBox.bcweb_popup').addClass('popup-zindex');$('.thankYouBox.bcweb_popup').css('visibility','visible');},hidePopUp:function(){$('.bcweb_popup').hide().removeClass('thankYouBoxVisible');if(Drupal.settings.bc_suggestions_html5_start_loaded==undefined||Drupal.settings.bc_suggestions_html5_completed_loaded!=undefined)$('.overlay').hide();if(typeof Drupal.settings.old_metaviewport!='undefined'){$('#metaviewport').attr('content',Drupal.settings.old_metaviewport);$('.centerv2').css('display','');}
return false;}}
function logowebv2_ajax(){$.ajax({type:"POST",url:Drupal.settings.logowebv2_ajax,data:"",cache:false,dataType:"json",success:function(response)
{if(typeof response['website_popup']!='undefined'){if(response['website_popup']&&$('.logoweb_popup').length){$('.logoweb_popup .logoweb_images').html($(response['website_popup']).find('.logoweb_images'));}}
if(typeof response['website_popup_img']!='undefined'){$('.websites_domain_page .left img').attr('src',response['website_popup_img']);$('.thankYouBox.weeblypreview_popup .popup_content').css('background-image','url('+response['weebly_preview_popup_img']+')');$('.thankYouBox.weeblypreview_popup .popup_content .preview ').attr('logo_id',response['website_logo_id']);$('.website_logo_id').val(response['website_logo_id']);$('#w_logo_id').val(response['website_logo_id']);Drupal.settings.onelinesearch=response['website_onelinesearch'];$('#websites_domain_search_input').val(response['website_onelinesearch']);$('#websites_domain_search_input_hidden').val(response['website_onelinesearch']);if(typeof response['website_twolinesearch']!='undefined'){Drupal.settings.twolinesearch=response['website_twolinesearch'];}
if(typeof response['website_multisearch']!='undefined')
Drupal.settings.multisearch=response['website_multisearch'];}
if(typeof Drupal.settings.load_lightbox!='undefined'&&Drupal.settings.load_lightbox)
load_logowebsitev2();}});}
function load_logowebsitev2(){LOGOWEBV2.trackEvents();$('#FLSPreviewOverlay, #FLS_PageLoadingOverlay').hide();$('.bcweb_popup').addClass('initialized');LOGOWEBV2.placePopUp();websites_domain_init();websites_search_init();if($("#websites_domain_search_input").val().trim().length==0)$(".domains_view_more_options").hide();$('#websites_domain_search_input').keyup(LOGOWEBV2.changeWebsiteDomain);if($('.websites_domain_page .left img').attr('src')!=""){if($('.websites_domain_page .left .descr').length==0)
$('.websites_domain_page .left').show();else
$('.websites_domain_page .left .img').show();}};;var WEEBLYPREVIEW={init:function(website,element){$("#website_preview_domain").attr("value",website);var goto_page='';if(typeof(Drupal.settings.notice_path!='undefined'))
goto_page=Drupal.settings.notice_path;else
goto_page=Drupal.settings.notice_url;$("#page_to_go").attr("value",goto_page);$('.FLS-Overlay-Message').hide();if($('.weeblypreview_popup').length>0&&($('.overlay').length>0||$('#FLSPreviewOverlay').length)){fls_events_add("saw_website_email");if($('body').hasClass('mobile_view')){Drupal.settings.old_metaviewport=$('#metaviewport').attr('content');console.log(Drupal.settings.old_metaviewport);$('#metaviewport').attr('content','width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0');$('.centerv2').css('display','none');$('body').css('position','initial');}
if(typeof bc_data!='undefined'){fls_events_add('fired_weebly_preview_lb_bc_flow');}else{fls_events_add('fired_weebly_preview_lb_logo_flow');}
$('#FLSPreviewOverlay, #FLS_PageLoadingOverlay').hide();$('html, body').animate({scrollTop:0},'fast');$('.weeblypreview_popup').addClass('initialized');if(typeof Drupal.settings.weebly_preview_popup_img!='undefined'){$('.thankYouBox.weeblypreview_popup .popup_content').css('background-image','url('+Drupal.settings.weebly_preview_popup_img+')');}
if(typeof Drupal.settings.last_saved_logo!='undefined'){$('.thankYouBox.weeblypreview_popup .popup_content .preview ').attr('logo_id',Drupal.settings.last_saved_logo);}
WEEBLYPREVIEW.placePopUp(element);$(".weeblypreview_popup .close, .weeblypreview_popup .noThankYou").click(function(){console.log('Close weebly');fls_events_add('closed_website_email_lightbox');if(Drupal.settings.weebly_preview_v2_split_set){if(Drupal.settings.workflow=="business-cards")
FLSProductEditor.Init('FreelogoEditorCanvas',bc_data);else if(Drupal.settings.logo_id)
show_loaded_color_bc_suggestion_lightbox();}
if(typeof bc_data!='undefined'&&(!Drupal.settings.weebly_preview_v2_split_set||!Drupal.settings.logo_id)){window.location.href=Drupal.settings.notice_url;return false;}
if(typeof bc_data=='undefined'&&Drupal.settings.diy_website_pickyourplan_split_set){window.location.href=Drupal.settings.notice_url;return false;}
if($(".website_preview_content").css("display")!=='none'){var goto_page=$("#page_to_go").val();}
if(!goto_page||goto_page=="#")
{goto_page=Drupal.settings.notice_path;}
lang="";if(Drupal.settings.lang!=''){lang=Drupal.settings.lang+"/";}
var fields={website_mailbox:"1",logo_websitesv2:"1",pid:'',reduce_flow:"",final_destination:goto_page,website_searched:website,websites_domain_suggestion:website};if(Drupal.settings.weebly_preview_v2_split_set){WEEBLYPREVIEW.hidePopUp();BUNDLEEMAIL.hidePopUp();Drupal.settings.websites_add_to_cart_status=0;show_loaded_color_bc_suggestion_lightbox();fields['json']=1;$.post(Drupal.settings.baseUrl+'/'+lang+'websites/domain',fields).done(function(data){Drupal.settings.websites_add_to_cart_status=1;});return false;}
var fields_str='';for(var i in fields){fields_str+='<input type="hidden" name="'+i+'" value="'+fields[i]+'" />';}
$('body').append('<form id="weeblypreview_form" style="display:none;" action="'+Drupal.settings.baseUrl+"/"+lang+'websites/domain" method="post">'+fields_str+'</form>');$('#weeblypreview_form').submit();return false;});$(".weeblypreview_popup .preview").click(function(e){fls_events_add("took_website_email");if(typeof bc_data!='undefined'){fls_events_add('click_preview_website_btn_bc_flow');}else{fls_events_add('click_preview_website_btn_logo_flow');}
var goto_page='';if(typeof(Drupal.settings.notice_path!='undefined'))
goto_page=Drupal.settings.notice_path;else
goto_page=Drupal.settings.notice_url;$(".weeblypreview_popup").addClass("preview");$(".marketing_content").hide();$(".website_preview_content").show();$(".thankYouBox.weeblypreview_popup .bar-message").show();var logo='';if($('.weeblypreview_popup .preview').attr('logo_id')!=undefined){logo='&logo_id='+$('.weeblypreview_popup .preview').attr('logo_id');}
$(".website_preview_content iframe").attr("src",$(".website_preview_content iframe").attr("data")+"&dom="+website+logo+"&goto="+encodeURIComponent(goto_page));$("body").css("overflow","hidden");$(".thankYouBox.bcweb_popup.logowebv2.initialized").css("top","0px !important");$(".thankYouBox.bcweb_popup.logowebv2.initialized").css("width","100%");$(".thankYouBox.bcweb_popup.logowebv2.initialized").css("height","100%");$(".thankYouBox.bcweb_popup.logowebv2.initialized").css("max-width","100%");$("body").css("overflow","hidden");if($('body').hasClass('mobile_view')){var position=$('.view_more_link').position();var diyp=$('.diy_box').position();$('.triangle').css('left',position.left+($('.view_more_link').width()/2)+10+'px');$('.diy_box').css('top',position.top+20+'px');}
fls_events_add('saw_weebly_preview');return false;});return false;}},placePopUp:function(element){var overlay=$('.overlay:first');var thankYouBox=$('.weeblypreview_popup');$('.overlay, .weeblypreview_popup').remove();var docH=$(document).height();var docW=$(document).width();overlay.css({"width":docW+"px","height":docH+"px"});thankYouBox.prependTo('body');overlay.prependTo('body');if($('#FLS_PageLoadingOverlay').length){$('#FLS_PageLoadingOverlay').show();$('.overlay').hide();}else{$('.overlay').show();}
thankYouBox.show();thankYouBox.addClass('thankYouBoxVisible');var bW=$('.weeblypreview_popup').width();var bH=$('.weeblypreview_popup').height();var wW=$(window).width();var wH=$(window).height();bW=wW/2-bW/2;bH=wH/2-bH/2;$('.activatedomain_popup').css({left:bW,top:bH>40?bH:40});setTimeout(function(){$('.thankYouBox.weeblypreview_popup').css('visibility','visible')},1500);},hidePopUp:function(){$('.weeblypreview_popup').hide().removeClass('thankYouBoxVisible');if(Drupal.settings.bc_suggestions_html5_start_loaded==undefined||Drupal.settings.bc_suggestions_html5_completed_loaded!=undefined)$('.overlay').hide();return false;}};"use strict";var FLSUtil={objIconStyle:'flat',kbScaleStep:0.05,lineSegementIntersect:function(line1,line2){var x1=line1[0].x;var x2=line1[1].x;var y1=line1[0].y;var y2=line1[1].y;var x3=line2[0].x;var x4=line2[1].x;var y3=line2[0].y;var y4=line2[1].y;var denom=(x4-x3)*(y1-y2)-(x1-x2)*(y4-y3);if(denom!=0){var ta=((y3-y4)*(x1-x3)+(x4-x3)*(y1-y3))/denom;var tb=((y1-y2)*(x1-x3)+(x2-x1)*(y1-y3))/denom;return(ta>=0)&&(ta<=1)&&(tb>=0)&&(tb<=1);}
return false;},selectionIntersect:function(selbox,bbox,vwt_pos){var spoint=selbox.spoint;var epoint=selbox.epoint;var selbox_sides=[[{x:spoint.x,y:spoint.y},{x:epoint.x,y:spoint.y}],[{x:epoint.x,y:spoint.y},{x:epoint.x,y:epoint.y}],[{x:epoint.x,y:epoint.y},{x:spoint.x,y:epoint.y}],[{x:spoint.x,y:epoint.y},{x:spoint.x,y:spoint.y}]];var tl={x:bbox.lt.x+vwt_pos.x,y:bbox.lt.y+vwt_pos.y};var tr={x:bbox.rt.x+vwt_pos.x,y:bbox.rt.y+vwt_pos.y};var br={x:bbox.rb.x+vwt_pos.x,y:bbox.rb.y+vwt_pos.y};var bl={x:bbox.lb.x+vwt_pos.x,y:bbox.lb.y+vwt_pos.y};var bbox_sides=[[tl,tr],[tr,br],[br,bl],[bl,tl]];while(selbox_sides.length){var line=selbox_sides.pop();for(var i=0;i<bbox_sides.length;i++){if(FLSUtil.lineSegementIntersect(line,bbox_sides[i])){return true;}}}
return false;},geFontMetrics:function(font_name,font_size,bold,italic){var canvas=document.createElement("canvas");var ctx=canvas.getContext("2d");ctx.font=font_size+"px "+font_name;var padding=Math.ceil(font_size/2);var cheight=(font_size*2)+padding;var baseline=Math.round(cheight/2);canvas.width=metrics.width+padding;canvas.height=3*fontSize;canvas.style.opacity=1;canvas.style.fontFamily=fontFamily;canvas.style.fontSize=fontSize;var w=canvas.width,h=canvas.height,baseline=h/2;},_path2dAvailable:null,Path2dAvailable:function(){if(typeof(this._path2dAvailable)!='boolean'){if(typeof Path2D=='function'){var ctx=document.createElement('canvas').getContext('2d');ctx.stroke(new Path2D('M0,0H1'));this._path2dAvailable=!!ctx.getImageData(0,0,1,1).data[3];}else{this._path2dAvailable=false}}
return this._path2dAvailable;},tmatrixMultiply:function(tmatr1,tmatr2,invmtr){var a=FLSUtil.tmatrix2matrix(tmatr1),b=FLSUtil.tmatrix2matrix(tmatr2),out=[1,0,0,0,1,0,0,0,1];var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],b00=b[0],b01=b[1],b02=b[2],b10=b[3],b11=b[4],b12=b[5],b20=b[6],b21=b[7],b22=b[8];out[0]=b00*a00+b01*a10+b02*a20;out[1]=b00*a01+b01*a11+b02*a21;out[2]=b00*a02+b01*a12+b02*a22;out[3]=b10*a00+b11*a10+b12*a20;out[4]=b10*a01+b11*a11+b12*a21;out[5]=b10*a02+b11*a12+b12*a22;out[6]=b20*a00+b21*a10+b22*a20;out[7]=b20*a01+b21*a11+b22*a21;out[8]=b20*a02+b21*a12+b22*a22;if(typeof(invmtr)==='boolean'&&invmtr===true){return FLSUtil.inversMtrx(out);}
return FLSUtil.matrix2tmatrix(out);},tmatrixDivide:function(tmatr1,tmatr2,invmtr){var a=FLSUtil.tmatrix2matrix(tmatr1),b=FLSUtil.inversMtrx(FLSUtil.tmatrix2matrix(tmatr2)),out=[1,0,0,0,1,0,0,0,1];var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],b00=b[0],b01=b[1],b02=b[2],b10=b[3],b11=b[4],b12=b[5],b20=b[6],b21=b[7],b22=b[8];out[0]=b00*a00+b01*a10+b02*a20;out[1]=b00*a01+b01*a11+b02*a21;out[2]=b00*a02+b01*a12+b02*a22;out[3]=b10*a00+b11*a10+b12*a20;out[4]=b10*a01+b11*a11+b12*a21;out[5]=b10*a02+b11*a12+b12*a22;out[6]=b20*a00+b21*a10+b22*a20;out[7]=b20*a01+b21*a11+b22*a21;out[8]=b20*a02+b21*a12+b22*a22;if(typeof(invmtr)==='boolean'&&invmtr===true){return FLSUtil.inversMtrx(out);}
return FLSUtil.matrix2tmatrix(out);},tmatrixTranslate:function(tmtrx,dx,dy){tmtrx[4]+=tmtrx[0]*dx+tmtrx[2]*dy;tmtrx[5]+=tmtrx[1]*dx+tmtrx[3]*dy;},tmatrixRotate:function(tmtrx,rads){var c=Math.cos(rads);var s=Math.sin(rads);var m11=tmtrx[0]*c+tmtrx[1]*-s;var m12=tmtrx[0]*s+tmtrx[1]*c;var m21=tmtrx[2]*c+tmtrx[3]*-s;var m22=tmtrx[2]*s+tmtrx[3]*c;tmtrx[0]=m11;tmtrx[1]=m12;tmtrx[2]=m21;tmtrx[3]=m22;},tmatrixScale:function(tmtrx,sx,sy){tmtrx[0]*=sx;tmtrx[1]*=sx;tmtrx[2]*=sy;tmtrx[3]*=sy;},tmatrix2matrix:function(tmtrx){var mtrx=[1,0,0,0,1,0,0,0,1];mtrx[0]=tmtrx[0];mtrx[1]=tmtrx[2];mtrx[2]=tmtrx[4];mtrx[3]=tmtrx[1];mtrx[4]=tmtrx[3];mtrx[5]=tmtrx[5];return mtrx;},matrix2tmatrix:function(mtrx){var tmtrx=[1,0,0,1,0,0];tmtrx[0]=mtrx[0];tmtrx[2]=mtrx[1];tmtrx[4]=mtrx[2];tmtrx[1]=mtrx[3];tmtrx[3]=mtrx[4];tmtrx[5]=mtrx[5];return tmtrx;},inversMtrx:function(mtrx){var a00=mtrx[0],a01=mtrx[1],a02=mtrx[2],a10=mtrx[3],a11=mtrx[4],a12=mtrx[5],a20=mtrx[6],a21=mtrx[7],a22=mtrx[8],b01=a22*a11-a12*a21,b11=-a22*a10+a12*a20,b21=a21*a10-a11*a20,det=a00*b01+a01*b11+a02*b21;if(!det){return null;}
det=1.0/det;var invmtrx=[];invmtrx[0]=b01*det;invmtrx[1]=(-a22*a01+a02*a21)*det;invmtrx[2]=(a12*a01-a02*a11)*det;invmtrx[3]=b11*det;invmtrx[4]=(a22*a00-a02*a20)*det;invmtrx[5]=(-a12*a00+a02*a10)*det;invmtrx[6]=b21*det;invmtrx[7]=(-a21*a00+a01*a20)*det;invmtrx[8]=(a11*a00-a01*a10)*det;return invmtrx;},transformPoint:function(tmtrx,point,_ref){var px=0,py=0;px=tmtrx[0]*point.x+tmtrx[2]*point.y+tmtrx[4];py=tmtrx[1]*point.x+tmtrx[3]*point.y+tmtrx[5];if(typeof(_ref)=='boolean'&&_ref==true){point.x=px;point.y=py;}else{return{x:px,y:py};}},unTransformPoint:function(tmtrx,point,_ref){var invrs=FLSUtil.inversMtrx(FLSUtil.tmatrix2matrix(tmtrx));if(invrs){var newpoint={};newpoint.x=invrs[0]*point.x+invrs[1]*point.y+invrs[2];newpoint.y=invrs[3]*point.x+invrs[4]*point.y+invrs[5];if(typeof(_ref)=='boolean'&&_ref==true){point.x=newpoint.x;point.y=newpoint.y;}else{return newpoint;}}
return point;},isFontAvailable:function(fontname){var baseFonts=['monospace','sans-serif','serif'];var testString="mmmmmmmmmmlwwli";var testSize='72px';var tspan=document.createElement('span');var body=document.getElementsByTagName('body')[0];var detected=false;tspan.style.position='absolute';tspan.style.top='-100px';tspan.style.right='100px';tspan.style.fontSize=testSize;tspan.innerHTML=testString;for(var index in baseFonts){tspan.style.fontFamily=baseFonts[index];body.appendChild(tspan);var testWidth=tspan.offsetWidth;var testHeight=tspan.offsetHeight;tspan.style.fontFamily='"'+fontname+'",'+baseFonts[index];var matched=(tspan.offsetWidth!=testWidth||tspan.offsetHeight!=testHeight);body.removeChild(tspan);detected=detected||matched;}
tspan=null;return detected;},fontSize:function(text,tw,cfsize){text=text.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');var span=jQuery('<span style="position:absolute; right: 100%; display:inline; text-align:center; line-height: 37px;font-size: '+cfsize+'px; white-space: nowrap; font-family:arial,verdana,sans-serif;font-weight:bold;padding:0">'+text+'<\/span>');jQuery('body').append(span);var w=parseInt(span.width(),10);if(w>tw){cfsize=Math.floor((tw/w)*cfsize);}
span.remove();return cfsize;},measureText:function(text,font,size,bold,italic){var hasdescending=/[qgpyj]/g.test(text);text=text.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');var _text=document.createElement('span');_text.innerHTML='Hga';_text.style.fontFamily=font;_text.style.fontSize=size+'px';_text.style.fontWeight=bold?'bold':'normal';_text.style.fontStyle=italic?'italic':'normal';_text.style.padding='0px';_text.style.lineHeight='1em';_text.style.whiteSpace='nowrap';var block=document.createElement("div");block.style['display']='inline-block';block.style['width']='1px';block.style['height']='0px';var div=document.createElement('div');div.appendChild(_text);div.appendChild(block);var body=document.body;body.appendChild(div);var ascent=-1;var descent=-1;var height=-1;var tw=200;try{block.style.verticalAlign='baseline';ascent=block.offsetTop-_text.offsetTop;block.style.verticalAlign='bottom';height=block.offsetTop-_text.offsetTop;descent=height-ascent;if(!hasdescending){height-=descent;descent=0;}}finally{_text.innerHTML=text;tw=_text.offsetWidth;document.body.removeChild(div);}
var top_y=0;var bottom_y=0;if(size>0){var txtcnvs=document.createElement('canvas');txtcnvs.width=tw+1;txtcnvs.height=Math.ceil(size*2.2);var ctx=txtcnvs.getContext('2d');var fontstyle=[];if(bold){fontstyle.push('bold');};if(italic){fontstyle.push('italic');};fontstyle=fontstyle.join(' ');ctx.font=fontstyle+' '+size+'px '+font;var base=Math.floor(size+(size/2))
ctx.fillText(text,0,base);var idata=ctx.getImageData(0,0,txtcnvs.width,txtcnvs.height);var foundcolor=false;for(var y=0;y<idata.height;y++){foundcolor=false;for(var x=0;x<idata.width;x++){if(idata.data[((idata.width*y)+x)*4+3]){top_y=y;foundcolor=true;break;}}
if(foundcolor)break;}
for(var y=idata.height-1;y>0;y--){foundcolor=false;for(var x=0;x<idata.width;x++){if(idata.data[((idata.width*y)+x)*4+3]){bottom_y=y;foundcolor=true;break;}}
if(foundcolor)break;}}
bottom_y=bottom_y<base?base:bottom_y;var measurements={ascent:ascent,descent:descent,height:height,pixel_height:Math.ceil(bottom_y-top_y),pixel_ascent:Math.ceil(base-top_y),pixel_descent:Math.abs(Math.ceil(bottom_y-base))};return measurements;},parseUri:function(str){var o=FLSUtil.parseUriOptions,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--)uri[o.key[i]]=m[i]||"";uri[o.q.name]={};uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){if($1)uri[o.q.name][$1]=$2;});return uri;},parseUriOptions:{strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},pointInCircle:function(center,radius,point){var dx=center.x-point.x;var dy=center.y-point.y;dx*=dx;dy*=dy;var distanceSquared=dx+dy;var radiusSquared=radius*radius;return distanceSquared<=radiusSquared;},pointOnLine:function(start,end,point){var dx=end.x-start.x;if(dx){var a=(end.y-start.y)/dx;var b=start.y-a*start.x;if(Math.abs(point.y-(a*point.x+b))<0.001)
{return true;}}else{return point.x==start.x;}
return false;},pointDistance:function(point1,point2){var dx=point2.x-point1.x;var dy=point2.y-point1.y;return Math.sqrt(dx*dx+dy*dy);},mirrorPoint:function(p1,p2){var dx=p2.x-p1.x;var dy=p2.y-p1.y;var mp={x:p1.x+(2*dx),y:p1.y+(2*dy)};return mp;},lineAngleRad:function(intersection,point1,point2){var dx1=point1.x-intersection.x;var dy1=point1.y-intersection.y;var dx2=point2.x-intersection.x;var dy2=point2.y-intersection.y;var rad1=Math.atan2(dy1,dx1);var rad2=Math.atan2(dy2,dx2);return rad2-rad1;},colorLuma:function(color){return(0.2126*color[0]+0.7152*color[1]+0.0722*color[2]);},hexdec2rgb:function(hexdec){var R=(hexdec&0xFF0000)>>16;var G=(hexdec&0x00FF00)>>8;var B=(hexdec&0x0000FF);return[R,G,B];},normalizeCssColor:function(csscolorstr){var colorint=0;if(!csscolorstr){return{css:"rgb(0,0,0)","uint":0};}
csscolorstr=csscolorstr.toString().replace(/\s/ig,'');var newcssclsstr='';if(/#/ig.test(csscolorstr)){csscolorstr=csscolorstr.replace('#','');if(csscolorstr.length==3){newcssclsstr+=csscolorstr[0]+csscolorstr[0];newcssclsstr+=(csscolorstr[1]+csscolorstr[1]);newcssclsstr+=(csscolorstr[2]+csscolorstr[2]);colorint=parseInt(newcssclsstr,16);}else{colorint=parseInt(csscolorstr,16);}
newcssclsstr='rgb('+FLSUtil.hexdec2rgb(colorint).join(',')+')';}else{var colors=csscolorstr.replace(/rgb(a?)\(/ig,'').replace(')','').split(',');for(var i=0;i<colors.length;i++){colors[i]=/%/i.test(colors[i])?Math.round(parseFloat(colors[i],10)*255/100):(i<3?parseInt(colors[i],10):parseFloat(colors[i],10));}
colorint=colors[0]<<16;colorint+=colors[1]<<8;colorint+=colors[2];newcssclsstr=colors.length==4?'rgba(':'rgb(';newcssclsstr+=FLSUtil.hexdec2rgb(colorint).join(',')+(colors.length==4?','+colors[3]:'')+')';}
var css_hex='#'+(0x1000000|colorint).toString(16).substring(1);return{css:newcssclsstr,uint:colorint,css_hex:css_hex};},Point:function(x,y){this.x=x||0;this.y=y||0;},mobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|PlayBook|BB10|IEMobile|Windows Phone/i.test(navigator.userAgent);},wp_mobile:function(){return/IEMobile/i.test(navigator.userAgent);},invertImage:function(canvas){if(canvas){var context=canvas.getContext('2d');var imageData=context.getImageData(0,0,canvas.width,canvas.height);var data=imageData.data;for(var i=0;i<data.length;i+=4){data[i]=255-data[i];data[i+1]=255-data[i+1];data[i+2]=255-data[i+2];}
context.putImageData(imageData,0,0);}},grayscaleAlphaImage:function(editor_objects,svg_size,raster_size){var svg_aspect=svg_size.width/svg_size.height;var zoom;if(svg_aspect>=1){zoom=raster_size.width/svg_size.width;raster_size.height=Math.round(svg_size.height*zoom);}else{zoom=raster_size.height/svg_size.height;raster_size.width=Math.round(svg_size.width*zoom);}
var canvas=document.createElement('canvas');canvas.width=raster_size.width;canvas.height=raster_size.height;var ctx=canvas.getContext('2d');ctx.setTransform(zoom,0,0,zoom,0,0);for(var i=0;i<editor_objects.length;i++){if(editor_objects[i]instanceof FLSEditorCore.CLayoutZone)continue;if(editor_objects[i]instanceof FLSEditorCore.CObject){editor_objects[i].render(ctx);}}
var pixeldata=ctx.getImageData(0,0,canvas.width,canvas.height);for(var px_idx=0;px_idx<pixeldata.data.length;px_idx+=4){var r=pixeldata.data[px_idx];var g=pixeldata.data[px_idx+1];var b=pixeldata.data[px_idx+2];var a=pixeldata.data[px_idx+3];if(a>0){var luminosity=Math.round(FLSUtil.colorLuma([r,g,b]));pixeldata.data[px_idx]=pixeldata.data[px_idx+1]=pixeldata.data[px_idx+2]=luminosity;if(luminosity>0){pixeldata.data[px_idx]=pixeldata.data[px_idx+1]=pixeldata.data[px_idx+2]=0;pixeldata.data[px_idx+3]=255-luminosity;}}}
ctx.putImageData(pixeldata,0,0);},rgb2hsl:function(color){var R=color[0]/255;var G=color[1]/255;var B=color[2]/255;var Min=Math.min(R,G,B);var Max=Math.max(R,G,B);var del_Max=Max-Min;var H=0,S,L=(Max+Min)/2;if(del_Max==0){H=0;S=0;}else{if(L<0.5){S=del_Max/(Max+Min);}else{S=del_Max/(2-Max-Min);}
var del_R=(((Max-R)/6)+(del_Max/2))/del_Max;var del_G=(((Max-G)/6)+(del_Max/2))/del_Max;var del_B=(((Max-B)/6)+(del_Max/2))/del_Max;if(R==Max){H=del_B-del_G;}else if(G==Max){H=(1/3)+del_R-del_B;}else if(B==Max){H=(2/3)+del_G-del_R;}
if(H<0){H+=1;}
if(H>1){H-=1;}}
return{H:H,S:S,L:L};},hsl2rgb:function(h,s,l){var r,g,b;if(s==0){r=g=b=l;}else{var q=l<0.5?l*(1+s):l+s-l*s;var p=2*l-q;r=hue2rgb(p,q,h+1/3);g=hue2rgb(p,q,h);b=hue2rgb(p,q,h-1/3);}
return[Math.round(r*255),Math.round(g*255),Math.round(b*255)];},hue2rgb:function(p,q,t){if(t<0)t+=1;if(t>1)t-=1;if(t<1/6)return p+(q-p)*6*t;if(t<1/2)return q;if(t<2/3)return p+(q-p)*(2/3-t)*6;return p;},roundToNumber:function(num){var _num=parseFloat(num,10);if(!isNaN(_num)){return+(Math.round(_num+"e+5")+"e-5");}
return num;},pSize:function(data){var dlength=0;for(var key in data){if((data[key]instanceof Array)||(data[key]instanceof Object)){dlength+=FLSUtil.pSize(data[key]);}else if((data[key]!='undefined')&&(data[key]!=undefined)){if(data[key].length){dlength+=data[key].length;}else{dlength+=data[key].toString().length;}}}
return dlength;},pSizeNew:function(data){var check_keys=['img_file','layout','log','logoside_svg_file','logoside_svg_file_ai','svg_file','svg_file_ai','xml_file'];var check_keys_multi=['side_images','product_images'];var dlength={};var key;for(var key_idx in check_keys){key=check_keys[key_idx];if(data[key]){dlength[key]=data[key].length;}}
for(var key_idx in check_keys_multi){key=check_keys_multi[key_idx];if(data[key]&&data[key].length){key=data[key].split('|');for(var skey_idx in key){var skey=key[skey_idx].replace('.','_');dlength[skey]=data[skey].length;}}}
return dlength;},fixLocalCommaFormattedNumbers:function(subject){var result_path=subject.match(/(d="M.*?[^"]")/g);if(result_path&&result_path[0]&&(/\d\,\d/g.test(result_path[0])===true)&&(/\d\.\d/g.test(result_path[0])===false)){for(var i in result_path){var tmp=result_path[i].replace(/(\d)[,](\d)/g,'$1.$2');subject=subject.replace(result_path[i],tmp);}
var result_matrix=subject.match(/(matrix[(].*[^)][)])/g);if(result_matrix&&result_matrix[0]&&(/\./g.test(result_matrix[0])===false)){for(var i in result_matrix){if(['matrix(1 0 0 1 0 0)','matrix(1,0,0,1,0,0)'].indexOf(result_matrix[i])==-1){var tmp=result_matrix[i].replace(/(\d)[,](\d)/g,'$1.$2');subject=subject.replace(result_matrix[i],tmp);}}}}
return subject;},getExtendedCharsFromString:function(str){return str.match(/[^\u0000-\u007F]/g)},setMulticfgText:function(multicfg,txt){if(multicfg.length>1){var words=txt.split(' ');var replacement_txt=[];if(multicfg.length<=words.length){var cfg_idx=0;do{if(cfg_idx<(multicfg.length-1)){replacement_txt.push(words.shift()+' ');}else{replacement_txt.push(words.join(' '));words.length=0;}
cfg_idx++;}while(words.length)}else{var substr_ln=Math.ceil(txt.length/multicfg.length);var used_ln=0;while(used_ln<txt.length){var substr=txt.substr(used_ln,substr_ln);replacement_txt.push(substr);used_ln+=substr.length;}}
for(var cfg_idx=0;cfg_idx<multicfg.length;cfg_idx++){multicfg[cfg_idx]['text']=replacement_txt[cfg_idx]||'';}}},setMultilineAttribs:function(to,tn){function getMultistyleCfg(){var tspans=tn.childNodes;var styl_cfg=[];for(var i=0;i<tspans.length;i++){var _cfg={text:tspans[i].textContent||tspans[i].innerText||''}
for(var j=0;j<tspans[i].attributes.length;j++){switch(tspans[i].attributes[j].name){case'font-family':_cfg['font_family']=tspans[i].attributes[j].value;break;}}
var clr=tspans[i].style.fill||'';if(clr.length){_cfg['color']=clr;}
styl_cfg.push(_cfg);}
to.multistyle_cfg(styl_cfg);}
var attrbs=tn.attributes;for(var attr in attrbs){var attr_val=attrbs[attr].value;switch(attrbs[attr].name){case'data-fill_zone_width':to.fill_zone_width(!!attr_val);break;case'data-multiline_on':to.multiline_on(!!attr_val);break;case'data-multistyle_on':to.multistyle_on(!!attr_val);getMultistyleCfg();break;case'data-max_lines':attr_val=parseInt(attr_val,10);if(!isNaN(attr_val)){to.max_lines(Math.abs(attr_val));}
break;case'data-align_point':if(['left','right','center'].indexOf(attr_val)>-1){to.align_point=attr_val;}
break;}}
to.updateMeasurements();},isLetter:function(_char){return/[^\u0000-\u007F]|\w/.test(_char)},getFirstLetter:function(_str){if(typeof _str=='string'){return _str.search(/[^\u0000-\u007F]|\w/);}
return-1;},removeSpecialCharacters:function(subject){return subject.toString().replace(/[*&^%$#@!?\/\\^)(:;.>,<+="'~`\}\{_\]\[\|-]/g,"").replace(/\s+/g,' ').trim();},removeEmojiCharacters:function(subject){if(typeof subject==='string'){return subject.replace(/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|[\ud83c\ude32-\ude3a]|[\ud83c\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g,'');}
return subject}};if(!Math.hypot)Math.hypot=function(x,y){var max=0;var s=0;for(var i=0;i<arguments.length;i+=1){var arg=Math.abs(Number(arguments[i]));if(arg>max){s*=(max/arg)*(max/arg);max=arg;}
s+=arg===0&&max===0?0:(arg/max)*(arg/max);}
return max===1/0?1/0:max*Math.sqrt(s);};var FLSEditorCore=function(canvasId,_settings){var cmd_prefix={1:'CNTRL_',2:'ALT_',3:'CNTRL_ALT_',4:'SHIFT_',5:'CNTRL_SHIFT_',6:'ALT_SHIFT_',7:'CNTRL_ALT_SHIFT_'};var ctx_transform=[1,0,0,1,0,0];var canvas=null,ctx=null,ccanvas=null,cctx=null,ghostcvs=null,viewframecvs=null,viewframecvstrim=null,overlaymask=null,eventslayer=null,view_topleft={x:0,y:0},elements=[],layout_elements=[],layout_visible=false,disable_layout_element_select=false,targetFps=60,settings={width:840,height:431,zoom:1,viewFrame:{image_border:false,offcenter:0,offheight:0,width:480,height:290,fill:'rgba(255,255,255, 0.5)',paper_color:'rgb(255,255,255)',lcolor:'#666',lwidth:2,dash:[11.1,8],shrink:[0,0],paper:false,message:'',message_color:'rgb(255,0,0)',message_font:'arial,verdana,sans-serif',paper_checker:false,shrink_offset_x:0},pluginparams:{},kb_tip_msg:'',layout_zones:false,watermark_str:false,image_background:false},animPrevframeTime=0,animId=null,curFps=0,doAnimation=true,animCallback=function(){},eventCallback=function(){},plugin_names=[],plugins=[],KEYS={LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS:107,MINUS:109,SCALE_DOWN:219,SCALE_UP:221},img_border_div=null;var path2d_supported=FLSUtil.Path2dAvailable();if(typeof(_settings)=='object'){jQuery.extend(true,settings,_settings);}
var mobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|PlayBook|BB10|IEMobile|Windows Phone/i.test(navigator.userAgent);var wp_mobile=/IEMobile/i.test(navigator.userAgent);var macos_safari=/Safari/i.test(navigator.userAgent)&&/Macintosh/i.test(navigator.userAgent)&&!(/Chrome/i.test(navigator.userAgent));var canvasWrapper=null;var edit_operation='op:none',dragstart=null;var canvasbgimg='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNXG14zYAAAAnSURBVCiRY/z//z8DseDNmzf/mYhWDQWjGoaoBpY3b94QnzYYGBgAmewKnSmh86IAAAAASUVORK5CYII=';var watermark='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAH0AAAASCAYAAAB2ItGqAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNXG14zYAAAUPSURBVGiB7Zlpb1tVEIafsePEWR2nzdamCFIoIMT//yEIgSoKFV1C7MRxnNjxPnyY9/je3jh8aBENikey7vWcc2Z5ZzuWzd1Z0MOi0uc2YEH/PS2C/gBpEfQHSEtFhplVgSOgDEwBAwbAG3effowSMysBz4Chu598vLn/qANgC3gKVAnffgfOP+XeYma7wCHwq7sPP93Sz0+3gi7eNtAGzvV9AriZlQEnEmGiZ1nnJp5DV3vRPoC13N4PyCJiSfY0ySnwk468fNP+KbAKHAMd4D2wB+wDF8C0IGvi7pjZUk62FdaM6IRtoA+MpJecH1N395zsxJsWbLyFT05WioG7+6Tg90xegZfH9QOf5uBKUe+8oCNnb4BrfR/LuedAyvYG8IioLgcuzey91rYI0EvACXB1hx7MbEVyNrW/BZyaWYUI2joB+Crwysz6QA3YEe/GzF7rbFl7+8Cfcniq4O4TiWfAX0RyfCMzBuJXgD/0/UD4dIAvpHuQ87kCtM3sVHtrwmEoe5aIjpmSp0UUUfIbyTqUvWUzewt0gV2grnNJ3hrwXHFB+/qypQy8za1hZsuKwcTMGimh4O6ZPpJBXwIv5BBSvC4gNoAnUnQl4zdk8FfiTYh2C1lFFelIuloE2Idmti7Ze0BT9mwKwE3Z1dOZGrDr7l05vg/8KICqAvdIdp3L50NVwQhYJpL7nd63c4B1ZeOGdB8RY6qtM5vS/1S2d+RLneiWa0SnueR2ga1I3gB4rec2WcFcyL8tYTsmgnshW/e09o6IyUZB/mMiDs+IcTejuyp9SY41iYzuiT8BGu7eMrNkyEj8Gxn1iOgGfSLQWwITCoEX8OvAqbs3zeyMCNiB9CZdV3LCBMzQ3U8low7UzOycDOAtfV4AP8npgfzqy84KqkB3b0hWlwhYsrMlf0Y6WwU67n6W82GHuPuM9byW7K54qZJbZlbK3YuWZUfD3cdE4DGzY/mXbFohkqsnXHvufm1mQ+DS3Qdm5mTtPlEqxtloSjQv6Glmd939urBmufeJjO7LIJPDUzk91aejvU60sCWyDjNOdqgi13SmSyRDTSNjhWx2OVDSvExybrT/GHjp7g0zuySqsCr9Fe2znG2lgk8N4Dvx2prtZQLsmW+6mJaJ7pGSyIVDWc8BUYUVoiq/Bn5WgCAbkxvEaEzJdQkcqNuMdX5EVunJ51LufSqMZuTuFxpH4+IFdF7QZxekOWuV3JlLIpNSG1slZmWLaFs18a/IAK6TBbBCVOF7ogUlGQMC/CrwLfBDzmG0Vteai98kS4jvzexC+tO9JP162CFA7pAFftZ93P3KzHqy8XUOo1XtOyHuAS/I7g8NosNs61wVOCOqc49IgNQBRsTYWnL3V2bWJEbNGtFR3gjDx8R4Spj/lvMv2Zu3/YZCC5c/vSIPwObc+JYFatvdB4W1feBa8zO1ngMB0HL3tviPicobA6d61sVLlVUGTtSedgXsGDhz96Euco+074aY4y/V2jYkD6LFdaR3NXdmCjTdva+1HaLlj6RjYGabRCXkL0CrQCUnc50IYNPdJ2aW5q4TY2mobvAEXfzc/Vydq66zTvx07Mn2krt3tGdPuPSFR/rZvE2MgAslY4UojK67j82sBvTlx3rEeH6Qi3Qr6PeF1O4OiKqsEJX7Swrigj6e7rrI3QfqkLXLKfCKaP0L+kS6t5WeyMy47zb+3+jeB31B/z4t/nB5gGTE7XFBD4eu/wb0hTQSf2IcvwAAAABJRU5ErkJggg==';var checker_pattern_img='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAK6wAACusBgosNWgAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNXG14zYAAAAWdEVYdENyZWF0aW9uIFRpbWUAMDMvMTMvMTgXIMLQAAAANklEQVQ4jWP8//8/AzFgwaI5vsSoYyLKNBLAqIGjBg4GA1mIzQEJcSmbiVE3+L08auCogWQAACIVCVIjyDgpAAAAAElFTkSuQmCC';var checker_pattern=null;var watermarkimg=new Image();if((typeof(settings.watermark_str)=='string')&&settings.watermark_str.length){var wtrmtxtfsz=10;var wmcvs_height=18;var cvsfont='bold '+wtrmtxtfsz+'px arial,verdana,sans-serif';settings.watermark_str+='  \u2022  ';var twrmeheights=FLSUtil.measureText(settings.watermark_str,'sans-serif',wtrmtxtfsz,true);var wmcnvs=document.createElement('canvas');var wmctx=wmcnvs.getContext('2d');wmctx.font=cvsfont;var wtrtxtmetrics=wmctx.measureText(settings.watermark_str);var wtrtwdth=Math.round(wtrtxtmetrics.width);wmcnvs.width=wtrtwdth;wmcnvs.height=wmcvs_height;wmctx.setTransform(1,0,0,1,0,0);wmctx.save();wmctx.font=cvsfont;wmctx.fillStyle='rgba(0,0,0,0.2)';var wty=twrmeheights.height+((wmcvs_height-twrmeheights.height)/2);if(twrmeheights.descent){wty=wtrmtxtfsz+((wmcvs_height-twrmeheights.height)/2);}
wty-=1;wmctx.fillText(settings.watermark_str,0,wty);wmctx.restore();wmctx.strokeStyle='rgba(0,0,0,0.2)';wmctx.lineWidth=1;wmctx.beginPath();wmctx.moveTo(0,wmcnvs.height)
wmctx.lineTo(wtrtwdth,wmcnvs.height)
wmctx.stroke();watermark=wmcnvs.toDataURL();}
watermarkimg.src=watermark;var _this=this;var mouseCoords={x:0,y:0,clickColor:[0,0,0,0]};var mouseCoords2={x:0,y:0,active:false};var currentObj=null;var undoStack=[];var redoStack=[];var undoSteps=40;var dblt_timer=0;var doubletapdelay=250;var doubletaptolerance=10;var prevMouseCoords={x:0,y:0};var editiconscss='@font-face {\n'+'font-family: "FlsObjectEditIcons";\n'+'src: url(data:font/truetype;charset=utf-8;base64,'+'AAEAAAANAIAAAwBQRkZUTYWVvXYAACVUAAAAHEdERUYAJwBZAAAlLAAAACZPUy8yT+JMGwAAAVgAAABWY21hcNveSYIAAAJ0AAABamdhc3D//wADAAAlJAAAA'+'AhnbHlmfrmlNAAABEgAAB04aGVhZAz5m7MAAADcAAAANmhoZWEDnwHvAAABFAAAACRobXR4V/0CnQAAAbAAAADCbG9jYbqKwHIAAAPgAAAAaG1heHAAgAHvAA'+'ABOAAAACBuYW1lHasuZgAAIYAAAAIHcG9zdLMXM5oAACOIAAABmgABAAAAAQAAZ3c7c18PPPUACwIAAAAAANFBVpoAAAAA2uwEpv9O/7QCXwHCAAAACAACAAA'+'AAAAAAAEAAAHB/8AALgKy/07/TgJfAAEAAAAAAAAAAAAAAAAAAAAuAAEAAAAzAewACwAAAAAAAgAAAAEAAQAAAEAAAAAAAAAAAQIVAZAABQAAAUwBZgAAAEcB'+'TAFmAAAA9QAZAIQAAAIABQkAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUGZFZABAADDgIAHA/8AALgHBAEAAAAABAAAAAAAAAgAAAAAAAAACAAAAAgAABgIAABUCA'+'AALAgAAAAIAAEYCAABGAgAAAAIA//8CAAAAAgD//QIAAAABBAAEAfMAHwAA/4wAAP9OAgAAAgIAABgCAAAJAgAAAAIAAEYCAABGAgAAAAIA//8CAAABAgD//Q'+'IAAAACAAAAAgAAAAIAAAACAABMAgAAAAIAAAECAAAAAgAAAQIAAAECAAAAAgAAAAIAAAACAAAAAgAAAwJmAC8CZgB7ArIAWgCgAJ0AYgBTAIAAAAAAAAMAAAA'+'DAAAAHAABAAAAAABkAAMAAQAAABwABABIAAAADgAIAAIABgAAADoAaQBtAHfgIP//AAAAAAAwAGkAbAB34AD//wAA/9P/pf+j/5ogEgABAAAAAAAAAAAAAAAA'+'AAAAAAEGAAABAAAAAAAAAAECAAAAAgAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAADBAUGBwgJCgsMDQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'+'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAPEAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'+'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'+'AAABsAKgA3gD2AToBhAGiAdIB7AIeAoQCrgVoBbAGDAZ4BrQG6gcCB0YHkAesB9wH9ggoCI4I1gk8CVQJjAnMCiwLEAtSC4wLxgwADDwMeAysDMoNHA02DXwN'+'xg4CDmYOnAAKAAb/7QH6AZAAAwAHAAsADwAbAB8AIwAnACsASwAAJTMVIzcVIzUzFSM1FzMVIwMzFTMVIxUjNSM1MwMzFSMzNTMVJzMVIzczFSMFNyEXIycmJ'+'yYrARUUFxYfARUjNTc2NzY9ASMiBwYPAQFENDROGlAcHDIyNho0NBo0NBoaGjQchDQ0hDIy/j4EATAEIgIICgwmEAQGHgioDBoGBBAoCgoIAggbNhsbGxsbGw'+'Fv7BozMxoBBhoaGjQaGhqUbGwJJAoI8hYEBQIBICABAwQFG+wKCCQJAAABABX/6gHrAaAAJgAAJSYnJiMiBwYVFBcWFzYzMhYUBiMiJyYnJicmNTQ3NjMyFxY'+'XMwcnAUsMHR4mLiEhERAcFBwgLCwgGBMTCTgjJDs7U0s4OAxGdnj6IhUWISEvIRsbDhEsQCwODRYXMTQ/Uzw7MDBGeHgAAAABAAv/0AH1AboAIwAANycmNTQ2'+'MzIfATc2MzIWFRQPARcWFRQGIi8BBwYjIicmNTQ3jGkYLyMhGGprFyMhLxdqahcvRRdraRYkIxYYGMRrGCEjLxhpaRgvIyEYa2kYIyEvF2pqFxcYISMYAAABA'+'AD/wQIAAcAACQAABSE3JwcRIQcXNwIA/qxqqmwBVGqqbD9rq2sBVGurawAAAAADAEb/4QG6AZ8AFwAfADEAABM0NjIWHQEzMhYdARQGIyEiJj0BNDY7AzU0Ji'+'IGFRcUFwcUFjsBMjY1JzY1NCYiBodHZEccDxYWD/7WDxYWDxwvlCs+KyURCAgGHAYICBEWHhYBJjJHRzJBFg+6DxYWD7oPFkEfLCwfpxQLMAYICAYwCxQPFhY'+'AAgBG/+EBugGfACMANQAANzU0NjsBNTQ2MhYdARQGIiY9ATQmIgYdATMyFh0BFAYjISImNxQXBxQWOwEyNjUnNjU0JiIGRhYPHEdkRw4TDis+K98PFhYP/tYP'+'FpURCAgGHAYICBEWHhYGug8WQTJHRzIECg4OCgQfLCwfQRYPug8WFogUCzAGCAgGMAsUDxYWAAAAAAIAAP/OAgABwAAGAA0AABEXBxcHJwcFFzcXJzcn0kt7P'+'HpIATZ6SATSS3sBwAFMb0N4RiZ5R80BTG8AAAH///+0AfQBwQAaAAABHgEXNwcjNy4BDgEeARcWNjcXDgEuAjY3NgEGNWAjNgGpQyhybkECRTc3cSY0NJqXXg'+'JZSjEBwAEsKDajQSsbK2J2XxQUHy0sPSo2gqCFHRMAAAEAAAABAgABigALAAATFzcXBxcHJw8BNyenWVmnp6enWFqnp6cBinZ2AcPEAWxqAcPEAAAB//3/twH'+'zAcAAGwAAAQcjNy4BDgEeAjY3Fw4BJy4CJyY2NzY3NhcB8wHfSCJZTCQRQFdPFWQmjk40WDsKEEJEOD9gSgHA6E8cCC1RVz0NJyc1RkgMCDdVNE6RKCECAz0A'+'AAAACwAA//YCAAHAAB0AIQAlACkALQAxADUAOQA9AEEARQAAEyEXIyYnJisBERQXFhcVIzUyNzY1ESMiBwYHBhUjJTMVIzczFSM3FSM1IzMVIxEzFSM3MxUjF'+'yM1MyczFSMnMxUjEzMRIwQBHAQOCwsQKh0LDRuUIgYHHSkRCQoCCwFwHR05HR1XOpA6Ojo6Oh0dkDo6Vx0dVpCQOhwcAU1XKwsL/vweBgYECwsKCCABAAsGKQ'+'QDrR0dHTodHR3+cB06HR0dHR1zHQEd/qoAAgAE/+ABAQGZAA8AFwAANzM2NzEWFxYHBgcVJzcVNjcGByMmJzUW6wEJBQUBARElNJOLQSoFCQEse5rUETQmMUQ'+'XNxE/WpJFHXU0EUYUaxIAAAAABgAfABEB1AGJAJsAowFIAVAB4wHrAAAlHgEdARQHBgciDgEHBgcGFhceAR8BDgEPAQYHJicuAQciBw4CFQcOASsBIicmJzQu'+'AScmJyYGBw4BIwcuAS8BJic2Nz4BJyYnLgIjJy4BPQE0NzY3PgI3Njc2JicuATUnPgE/ATY3FhceATc2Nz4CNTcyNjsBMhcWFxQeARcWFxY2Nz4BPwEeAR8BF'+'hcGBw4BFxYXHgIXBjI2NCYiBhQlHgEVFzAWFBUGBw4CBxQVFB4BFx4BHwEUBg8BBgcmJyYGBwYHDgEfAQ4BByMGIgYjJicuAiciIw4CBw4BDwEiJicjJic2Nz'+'YmJyYnLgEPAS4BNSc0JjQ1Njc+Ajc0NS4CJy4BLwE+AT8BNjcyFxY2NzY3PgEvAT4BMzcyNjIzFhceAhcyFz4CNz4BPwEyFjMXFhcGBwYWFzEWFx4BNwY+AS4'+'BDgEWFxYUHQEGDwEiDgEHBgcGFh8BDgEPAQYHJicuAiMGIw4CDwEiBisBJi8BNi4BJyYnJgYPAS4BLwEmJzY3PgI1JicxLgIvASY0PQE2NzMyPgE3Njc2Ji8B'+'PgE/ATY3FhceAjcxMjc+Aj8BNjI7ARYXFRQeARcxFhcWNj8BHgEfARYXBgcOARQVFhUeAhcGFj4BLgEOAQEHAQECBQwHCgQDAQECAwYEBAEBAQMBAQUFBAkID'+'gUDAgUEBQMCBgECBgUCAQUEBQIDBQ4IBAcBAgIEAQIEAgIIBgMCAQEDBAoHEQEBAgQNBwoEAwEBAgMGBAUBAQMBAQUEBQkIDgUDAgUEBQMCBgECBgUBAgUEBQ'+'IDBQ4IBAcBAQMEAQIEAgIIBgMCAQEDBAoHeS4gIC4gATQCAwEBAwwGCAMCAgcGBQYBAQEBAQMEBAsMCgcBAwUCAQMCBQECAQIGAgMFAggFBQMDBQYJAwMFAQE'+'DBQIBBgMBBAQBBAIBBwkMEQEDAQEDDAYIAwIBAQcGBQYCAQEBAQEDAwULDAkIAQMEAwEDAgUBAgECBgIDBQIIBQUDAwUGCQMDBQEBAwUBAgYDAQQEAQQBAgcJ'+'DF4rFA0pKxQN2QEBAxAHCwUDAgECAQUIAQQBAQUFBAgFCgYFAwMEBQYCBAIGAgEHBAEBBAQEAgIFDwgPAgQBAQQBAgkFBQEBAQIECQcQAQECEQcKBQQBAgIBB'+'QgBAwIBBQUECAUKBgUDAgUFBgEFAgYBAgYFAwQEAwIFDgkPAgQBAQQBAgkFBgEDBAkHgC0jBhwtJAWyAgUBAgUEAgEEBAQDAgUMBwQGAQECBAEBBAICBwYCAg'+'EDBAkGDwEBAgQLBgkEAwEBAQIGAwUBAQMBAQQEBAgHDAUCAwQEBAMBBQIBBgQBAQEEBAQCAgUNBwMGAgECBAEBBAICBwYCAQEBAwQJBg8BAQQLBgkEAwEBAQI'+'GAwQBAQEDAQEEBAQIBw0FAgIEBAQBPBwpHBwpuQEFAQICBQIDBAMGBQUCAwQGBwQCBQEBAgQCAQUDAQQDAQMCAQYICw8BAgEBAQQKBQgCAgEBBgYEBgEBAgED'+'AwQKCwgHAQIEAwICAgQCAQECBQICBQIHBQQDAgUFCAMDBAEBAgUBAQUDBAQBBAECBQgLDwEDAQEDCgYHAwEBAQIGBQQGAQECAQIEBAoLCAYCAgQCAVsMJCcSD'+'CQmjQIFAQIFBAEDAwQCAgUMCA0CAwEBBAECCAUEAQEDAwgHDgEBAg8HCQQEAQECAQUHAQMCAQQEBAcFCAYFAgIEBQUBBQEFAgEGBAMEAwICBQ0HDQIEAQEDAQ'+'IIBAUBAQECBAgGDgEBAg8GCQUDAQEDAQUHAQMBAQUEAwgECQUFAgMEBQUBLwUZKCAEGCgAAAL/jAADAHQBiQAiAC8AABMUBwYHFSM1Njc2NTQnJiMiBgcXFhU'+'UBwYiJyY1NDYzMhcWAjYzMhYVFAcGIicmNXQiIjoWJBQUDg4YChIGBgQMDCgIDEIsNiIiuBwUFBwODigODgEcNSEhBSRnAxUUJR4QEQQFFg4KEwoKDQwTHioe'+'Hv76Hh4UEw8ODg8TAAAAAAb/TgAEALIA/gANABkAIQApADEAOQAAJwUyPQExJyMHJwcnJg8BNxcWPwEXFj8BFxUFNxc3FzcfASY0JiIGFBYyNhQGIiY0NjIWF'+'AYiJjQ2MrIBYwFXAzcfWx4CATM1HQIBWSABATZW/qE3IFohN1cB7BwoHBwoGRslGholHBsmHBwmBwMCUY9NHnUhAgJbVyACAnQeAQJMjE8BXCJ2H06OUbAqHh'+'4qHkcoHBwoHBwoHR0oHQAAAAAKAAL/7QH3AZAAAwAHAAsADwAbAB8AIwAnACsASwAAJTMVIzcVIzUzFSM1FzMVIwMzFTMVIxUjNSM1MwMzFSMzNTMVJzMVIzc'+'zFSMFNyEXIycmJyYrARUUFxYfARUjNTc2NzY9ASMiBwYPAQFANTVPGk8bGzMzNRo0NBo1NRoaGjQbhDU1hDMz/j4EATEEIwIICgwlEAQGHQmpDBoGBBAnCgsH'+'AggbNhsbGxsbGwFv7BozMxoBBhoaGjQaGhqUbGwJJAoI8hYEBQIBICABAwQFG+wKCCQJAAABABj/6gHuAaAAJgAAJSYnJiMiBwYVFBcWFzYzMhYUBiMiJyYnJ'+'icmNTQ3NjMyFxYXMwcnAU4MHR4mLiEhERAcFBwgLCwgGBMTCTgjJDs7U0s4OAxGdnj6IhUWISEvIRsbDhEsQCwODRYXMTQ/Uzw7MDBGeHgAAAABAAn/0AHzAb'+'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'+'AEZsc09iamVjdEVkaXRJY29ucwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMwAAAAEAAgATABQAFQAWABcAGAAZABoAGwAcAB0ATABPAFAAW'+'gECAQMBBAEFAQYBBwEIAQkBCgELAQwBDQEOAQ8BEAERARIBEwEUARUBFgEXARgBGQEaARsBHAEdAR4BHwEgASEBIgtjaXJjdWxhcjI2NQpjbG9ja3dpc2UyBm'+'Nsb3NlMwtjcm9zcy1tYXJrMQd1bmlFMDA0B3VuaUUwMDUHdW5pRTAwNgd1bmlFMDA3B3VuaUUwMDgHdW5pRTAwOQd1bmlFMDBBB3VuaUUwMEIHdW5pRTAwQwd'+'1bmlFMDBEB3VuaUUwMEUHdW5pRTAwRgd1bmlFMDEwB3VuaUUwMTEHdW5pRTAxMgd1bmlFMDEzB3VuaUUwMTQHdW5pRTAxNQd1bmlFMDE2B3VuaUUwMTcHdW5p'+'RTAxOAd1bmlFMDE5B3VuaUUwMUEHdW5pRTAxQgd1bmlFMDFDB3VuaUUwMUQHdW5pRTAxRQd1bmlFMDFGB3VuaUUwMjAAAAAAAAH//wACAAEAAAAMAAAAFgAeA'+'AIAAQABADIAAQAEAAAAAgAAAAEAAAABAAAAAAAAAAEAAAAA2WhiNQAAAADRQVaaAAAAANrsBKY=) format("truetype");\n'+'font-weight: normal;\n'+'font-style: normal;\n'+'}\n';jQuery('style#FlsObjectEditIconsFont').remove();jQuery('<style type="text/css" id="FlsObjectEditIconsFont">\n'+
editiconscss+'.FlsObjectEditIconsFontLoader{'+'font-family:FlsObjectEditIcons;'+'position:absolute;'+'right:110%;'+'top:-100px;'+'}\n'+'.FlsObjectEditIconsFontLoader:after{'+'font-family:FlsObjectEditIcons;'+'content: "\\e009 \\e00a \\e00b \\e00c";'+'}'+'</style>').appendTo('head');var iconloader=document.createElement('span');iconloader.className='FlsObjectEditIconsFontLoader';document.body.appendChild(iconloader);canvas=document.getElementById(canvasId);if(!canvas)throw"Unable to find the specified canvas element";ctx=canvas.getContext('2d');if(!ctx)throw"Unable to get the context of canvas element";window.requestAnimationFrame=(function()
{return window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){return window.setTimeout(function(){callback(new Date());},1000/targetFps);};})();window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||function(requestId){clearTimeout(requestId);};canvas.width=settings['width'];canvas.height=settings['height'];canvas.style.position='relative';canvas.style.display='block';canvas.style.zIndex='1';if(settings.viewFrame.image_border!==true){canvas.style.backgroundImage='url('+canvasbgimg+')';canvas.style.backgroundColor='#FFF';}
canvasWrapper=document.createElement('div');canvasWrapper.style.position='relative';canvasWrapper.style.overflow='hidden';canvasWrapper.style.overflowX='visible';canvas.parentNode.insertBefore(canvasWrapper,canvas);canvasWrapper.appendChild(canvas);canvasWrapper.id=canvasId+'-CWrapper';ghostcvs=document.createElement('canvas');ghostcvs.width=canvas.width;ghostcvs.height=canvas.height;_initOverlay();function isDoubleTap(){var doubletap=(dblt_timer!=0)&&(Math.abs(prevMouseCoords.x-mouseCoords.x)<doubletaptolerance)&&(Math.abs(prevMouseCoords.y-mouseCoords.y)<doubletaptolerance);if(doubletap){clearTimeout(dblt_timer);dblt_timer=0}else{dblt_timer=setTimeout(function(){dblt_timer=0;},doubletapdelay);}
return doubletap;}
function objectNearEdges(editor_obj,dragstart,mouseCoords){if(_this.skip_near_edge_test===true){return false;}
if(editor_obj instanceof FLSEditorCore.CObject){var corners=[];editor_obj.objCenter(corners);var dx=mouseCoords.x-dragstart.x;var dy=mouseCoords.y-dragstart.y;var wievfarame_top=_this.viewtopleft();var ed_zoom=_this.zoom();var canvas_width=Math.floor(settings.width/ed_zoom);var canvas_height=Math.floor(settings.height/ed_zoom);var top_corner_x=corners[0].x+wievfarame_top.x;var top_corner_y=corners[0].y+wievfarame_top.y;var bottom_corner_x=settings.width-corners[1].x-wievfarame_top.x;var bottom_corner_y=settings.height-corners[1].y-wievfarame_top.y;if(((top_corner_x<2)&&(dx<0))||((top_corner_y<2)&&(dy<0))||((bottom_corner_x<2)&&(dx>0))||((bottom_corner_y<2)&&(dy>0))){return true;}}
return false;}
function getKeyboardCommand(evt){if(evt&&(evt.type=='keydown')){var _char=String.fromCharCode(evt.which);if(/[a-z]/i.test(_char)){var keycombo=(evt.ctrlKey||evt.metaKey)?1:0;keycombo|=evt.altKey?2:0;keycombo|=evt.shiftKey?4:0;return cmd_prefix[keycombo]?(cmd_prefix[keycombo]+_char.toUpperCase()):false;}}
return false;}
function handleKeyADACommands(evt){return false;var cmd=getKeyboardCommand(evt);switch(cmd){case'ALT_T':edit_operation='op:kb_add_text';break;case'ALT_E':edit_operation='op:kb_edit_text';break;case'ALT_L':edit_operation='op:kb_open_add_logo_image';break;case'ALT_C':edit_operation='op:kb_open_advanced_color_options';break;case'ALT_R':case'CNTRL_Y':edit_operation='op:kb_redo';break;case'ALT_U':case'CNTRL_Z':edit_operation='op:kb_undo';break;case'ALT_X':edit_operation='op:kb_reset';break;case'ALT_A':case'CNTRL_A':edit_operation='op:kb_select_all';break;default:return false;}
evt.stopPropagation();evt.preventDefault();return true;}
function handleEvents(evt){var doevt=true;if(['keydown','keyup'].indexOf(evt.type)==-1){getMousePos(evt);}else{if([document.body,overlaymask].indexOf(evt.target)==-1){doevt=false;}}
var dorender=false;var clear_op=false;var kb_op=false;if(doevt){switch(evt.type){case'mousedown':case'touchstart':case'pointerdown':var do_detect=true;if(currentObj){edit_operation=currentObj.whichControl(mouseCoords,mouseCoords2);do_detect=['op:none','op:translate'].indexOf(edit_operation)>-1;if(do_detect&&edit_operation=='op:translate'){if(isDoubleTap()){edit_operation='op:doubletap';do_detect=false;}else if(currentObj.fixed()){currentObj.setActive(false);currentObj=null;}}}
if(do_detect){var clickobj=_detectObject(mouseCoords,mouseCoords2);if(clickobj!==currentObj){if(clickobj){clickobj.setActive();if(currentObj)currentObj.setActive(false);}else{if(currentObj)currentObj.setActive(false);}
currentObj=clickobj;dorender=true;}
edit_operation=currentObj?'op:translate':'op:none';}
dragstart={x:mouseCoords.x,y:mouseCoords.y};prevMouseCoords.x=dragstart.x;prevMouseCoords.y=dragstart.y;if(evt.type=='mousedown'&&!mobile){}
break;case'mousemove':case'touchmove':case'pointermove':if(currentObj&&edit_operation!='op:none'){switch(edit_operation){case'op:translate':case'op:doubletap':if(!objectNearEdges(currentObj,dragstart,mouseCoords)){currentObj.move(dragstart,mouseCoords);dragstart.x=mouseCoords.x;dragstart.y=mouseCoords.y;}
dorender=true;break;case'op:rotate':currentObj.use_pivot(currentObj.hide!==true);currentObj.mrotate(dragstart,mouseCoords,{x:view_topleft.x,y:view_topleft.y});dragstart.x=mouseCoords.x;dragstart.y=mouseCoords.y;dorender=true;break;case'op:scale':currentObj.use_pivot(currentObj.hide!==true);currentObj.mscale(dragstart,mouseCoords,{x:view_topleft.x,y:view_topleft.y});dragstart.x=mouseCoords.x;dragstart.y=mouseCoords.y;dorender=true;break;case'op:resize_x':case'op:resize_y':case'op:resize_xs':var edit_funcs={'op:resize_x':currentObj.mresize_x,'op:resize_y':currentObj.mresize_y,'op:resize_xs':currentObj.mresize_xs};var resizefunc=edit_funcs[edit_operation];resizefunc.apply(currentObj,[dragstart,mouseCoords,{x:view_topleft.x,y:view_topleft.y}]);dragstart.x=mouseCoords.x;dragstart.y=mouseCoords.y;dorender=true;break;case'op:vertex_move':currentObj.mvertex_move(dragstart,mouseCoords,{x:view_topleft.x,y:view_topleft.y});dragstart.x=mouseCoords.x;dragstart.y=mouseCoords.y;dorender=true;break;case'op:path_scale':case'op:path_scale_top':case'op:path_scale_bottom':currentObj.mpath_scale(dragstart,mouseCoords,{x:view_topleft.x,y:view_topleft.y},edit_operation.replace('op:',''));dragstart.x=mouseCoords.x;dragstart.y=mouseCoords.y;dorender=true;break;}}else{if(currentObj&&!mobile){currentObj.whichControl(mouseCoords,mouseCoords2,true);}}
break;case'keydown':kb_op=handleKeyADACommands(evt);if(!kb_op&&currentObj&&!currentObj.fixed()){if([KEYS.LEFT,KEYS.UP,KEYS.RIGHT,KEYS.DOWN].indexOf(evt.keyCode)>-1){var cntrl_shift=evt.shiftKey&&(evt.ctrlKey||evt.metaKey);var cntrl_shift_alt=cntrl_shift&&evt.altKey;var point={x:0,y:0};edit_operation=cntrl_shift?'op:kb_resize':'op:translate';clear_op=true;switch(evt.keyCode){case KEYS.LEFT:point.x=-1*settings.zoom;break;case KEYS.UP:point.y=-1*settings.zoom;break;case KEYS.RIGHT:point.x=1*settings.zoom;break;case KEYS.DOWN:point.y=1*settings.zoom;break;}
var pointmtrx=[settings.zoom,0,0,settings.zoom,0,0];FLSUtil.unTransformPoint(pointmtrx,point,true);if(!cntrl_shift){if(!objectNearEdges(currentObj,{x:0,y:0},point)){if((currentObj instanceof FLSEditorCore.CSelectionGroup)||(currentObj instanceof FLSEditorCore.CTextCollection)){currentObj.stranslate(point.x,point.y);}
pointmtrx=[1,0,0,1,0,0];FLSUtil.tmatrixRotate(pointmtrx,currentObj.getRotation());FLSUtil.transformPoint(pointmtrx,point,true);currentObj.translate(point.x,point.y);}}else{currentObj.kbresize(point.x,point.y,cntrl_shift_alt);}}else if([KEYS.PLUS,KEYS.MINUS,KEYS.SCALE_DOWN,KEYS.SCALE_UP].indexOf(evt.keyCode)>-1){edit_operation='op:kb_scale';var scale_dir=0;switch(evt.keyCode){case KEYS.PLUS:case KEYS.SCALE_UP:scale_dir=1;break;case KEYS.MINUS:case KEYS.SCALE_DOWN:scale_dir=-1;break;}
currentObj.kbscale(scale_dir);}}else{if(kb_op)clear_op=true;}
break;case'mouseup':case'touchend':case'touchcancel':case'mouseout':case'keyup':case'pointerup':case'pointercancel':if(currentObj){currentObj.use_pivot(false);currentObj.unsetCurrentControl();if(['mouseup','touchend','pointerup'].includes(evt.type)&&(dblt_timer==0)){isDoubleTap();}}
edit_operation='op:none';dragstart=null;break;}}
if(typeof(eventCallback)=='function'){eventCallback(evt,mouseCoords,edit_operation);}
for(var i in plugins){plugins[i]['eventCallback'].apply(plugins[i],[evt,mouseCoords,edit_operation]);}
if(dorender&&!doAnimation)_this.render();if((currentObj||kb_op)&&doevt){if(typeof(evt.preventDefault)=='function'){evt.stopPropagation();evt.preventDefault();}else{evt.returnValue=false;};}
if(clear_op){edit_operation='op:none';return!doevt;}}
function _initOverlay(evnts){ctx_transform[0]=1;ctx_transform[1]=0;ctx_transform[2]=0;ctx_transform[3]=1;ctx_transform[4]=0;ctx_transform[5]=0;var framesize=settings.viewFrame;framesize.width*=settings.zoom;framesize.height*=settings.zoom;if(typeof(evnts)!='boolean'){evnts=true;}
if(overlaymask==null){overlaymask=document.createElement('canvas');eventslayer=document.createElement('canvas');viewframecvs=document.createElement('canvas');viewframecvstrim=document.createElement('canvas');ccanvas=document.createElement('canvas');canvas.parentNode.insertBefore(overlaymask,canvas);canvas.parentNode.insertBefore(ccanvas,canvas);canvas.parentNode.insertBefore(eventslayer,canvas);overlaymask.tabIndex=100;overlaymask.id='FLSEditorEventCollectorOverlay'}
viewframecvs.width=framesize.width;viewframecvs.height=framesize.height;viewframecvstrim.width=framesize.width-framesize.shrink[0];viewframecvstrim.height=framesize.height-framesize.shrink[1];overlaymask.width=canvas.width;overlaymask.height=canvas.height;overlaymask.style.position='absolute';overlaymask.style.display='block';overlaymask.style.zIndex='3';eventslayer.width=canvas.width;eventslayer.height=canvas.height;eventslayer.style.position='absolute';eventslayer.style.display='block';eventslayer.style.zIndex='30';ccanvas.width=canvas.width;ccanvas.height=canvas.height;ccanvas.style.position='absolute';ccanvas.style.display='block';ccanvas.style.zIndex='4';cctx=ccanvas.getContext('2d');var frametopX=(overlaymask.width-framesize.width)/2;var frametopY=(overlaymask.height-framesize.height)/2;frametopX+=framesize.offcenter;frametopY+=framesize.offheight;var octx=overlaymask.getContext('2d');var evtctx=eventslayer.getContext('2d');if(!octx.setLineDash){octx.setLineDash=function(){};}
octx.save();octx.setTransform(1,0,0,1,0,0);if(framesize.image_border===false){octx.fillStyle=settings.viewFrame.fill;octx.strokeStyle=null
octx.beginPath();octx.moveTo(-2,-2);octx.lineTo(overlaymask.width+2,-2);octx.lineTo(overlaymask.width+2,overlaymask.height+2);octx.lineTo(-2,overlaymask.height+2);octx.lineTo(-2,-2);octx.moveTo(frametopX+(framesize.shrink[0]+framesize.shrink_offset_x),frametopY+(framesize.shrink[1]));octx.lineTo(frametopX+(framesize.shrink[0]+framesize.shrink_offset_x),framesize.height+frametopY-(framesize.shrink[1]));octx.lineTo(framesize.width+frametopX-(framesize.shrink[0]-framesize.shrink_offset_x),framesize.height+frametopY-(framesize.shrink[1]));octx.lineTo(framesize.width+frametopX-(framesize.shrink[0]-framesize.shrink_offset_x),frametopY+(framesize.shrink[1]));octx.closePath();octx.fill();octx.lineWidth=settings.viewFrame.lwidth;octx.setLineDash(settings.viewFrame.dash);octx.mozDash=settings.viewFrame.dash;octx.webkitLineDash=settings.viewFrame.dash;octx.strokeStyle=settings.viewFrame.lcolor;octx.stroke();}else{var corners={tl:{x:frametopX+(framesize.shrink[0]+framesize.shrink_offset_x),y:frametopY+(framesize.shrink[1])},bl:{x:frametopX+(framesize.shrink[0]+framesize.shrink_offset_x),y:framesize.height+frametopY-(framesize.shrink[1])},br:{x:framesize.width+frametopX-(framesize.shrink[0]-framesize.shrink_offset_x),y:framesize.height+frametopY-(framesize.shrink[1])},tr:{x:framesize.width+frametopX-(framesize.shrink[0]-framesize.shrink_offset_x),y:frametopY+(framesize.shrink[1])},};octx.save();octx.lineWidth=settings.viewFrame.lwidth;octx.beginPath();octx.moveTo(corners.tl.x,corners.tl.y+10);octx.lineTo(corners.tl.x,corners.tl.y);octx.lineTo(corners.tl.x+10,corners.tl.y);octx.moveTo(corners.tr.x-10,corners.tr.y);octx.lineTo(corners.tr.x,corners.tr.y);octx.lineTo(corners.tr.x,corners.tr.y+10);octx.moveTo(corners.br.x,corners.br.y-10);octx.lineTo(corners.br.x,corners.br.y);octx.lineTo(corners.br.x-10,corners.br.y);octx.moveTo(corners.bl.x+10,corners.bl.y);octx.lineTo(corners.bl.x,corners.bl.y);octx.lineTo(corners.bl.x,corners.bl.y-10);octx.moveTo(corners.tl.x,corners.tl.y+10);octx.lineTo(corners.tl.x,corners.tl.y);octx.closePath();octx.strokeStyle=settings.viewFrame.lcolor;octx.stroke();octx.restore();var dot_radius=settings.viewFrame.lwidth/2;var x_dots_count=Math.round((corners.tr.x-corners.tl.x)/23);var x_dx=(corners.tr.x-corners.tl.x)/x_dots_count;var start_x=corners.tl.x+x_dx;var y_dots_count=Math.round((corners.bl.y-corners.tl.y)/23);var y_dy=(corners.bl.y-corners.tl.y)/y_dots_count;var start_y=corners.tl.y+y_dy;octx.save()
octx.fillStyle=settings.viewFrame.lcolor;octx.beginPath();for(var xi=0;xi<x_dots_count-1;xi++){octx.moveTo(start_x+(xi*x_dx),corners.tl.y);octx.arc(start_x+(xi*x_dx),corners.tl.y,dot_radius,0,2*Math.PI);octx.moveTo(start_x+(xi*x_dx),corners.bl.y);octx.arc(start_x+(xi*x_dx),corners.bl.y,dot_radius,0,2*Math.PI);}
for(var yi=0;yi<y_dots_count-1;yi++){octx.moveTo(corners.tl.x,start_y+(yi*y_dy));octx.arc(corners.tl.x,start_y+(yi*y_dy),dot_radius,0,2*Math.PI);octx.moveTo(corners.tr.x,start_y+(yi*y_dy));octx.arc(corners.tr.x,start_y+(yi*y_dy),dot_radius,0,2*Math.PI);}
octx.closePath();octx.fill();octx.restore();if(!macos_safari){var bg_tile_cnvs=document.createElement('canvas');bg_tile_cnvs.width=x_dx;bg_tile_cnvs.height=y_dy;var dot_clr=FLSUtil.normalizeCssColor(settings.viewFrame.lcolor)['css_hex']+'4D';var bg_ctx=bg_tile_cnvs.getContext('2d');bg_ctx.fillStyle=dot_clr;bg_ctx.beginPath();bg_ctx.moveTo(0,0);bg_ctx.arc(0,0,dot_radius,0,2*Math.PI);bg_ctx.moveTo(bg_tile_cnvs.width,0);bg_ctx.arc(bg_tile_cnvs.width,0,dot_radius,0,2*Math.PI);bg_ctx.moveTo(bg_tile_cnvs.width,bg_tile_cnvs.height);bg_ctx.arc(bg_tile_cnvs.width,bg_tile_cnvs.height,dot_radius,0,2*Math.PI);bg_ctx.moveTo(0,bg_tile_cnvs.height);bg_ctx.arc(0,bg_tile_cnvs.height,dot_radius,0,2*Math.PI);bg_ctx.closePath();bg_ctx.fill();_this.bg_tile_img_info={img_src:bg_tile_cnvs.toDataURL(),x_dx:x_dx,y_dy:y_dy,left:corners.tl.x,top:corners.tl.y};}else{var bg_canvas=document.querySelector('canvas#FLSEditorBackgroundCanvas');if(bg_canvas){var bg_start_y=(canvas.parentNode.offsetTop+corners.tl.y)%y_dy;var bg_start_x=corners.tl.x%x_dx;var bg_ctx=bg_canvas.getContext('2d');var dot_clr=FLSUtil.normalizeCssColor(settings.viewFrame.lcolor)['css_hex']+'7f';bg_ctx.fillStyle=dot_clr;bg_ctx.clearRect(0,0,bg_canvas.width,bg_canvas.height);bg_ctx.beginPath();for(var bx=bg_start_x;bx<=bg_canvas.width;bx+=x_dx){for(var by=bg_start_y;by<=bg_canvas.height;by+=y_dy){bg_ctx.moveTo(bx,by);bg_ctx.arc(bx,by,dot_radius,0,2*Math.PI);}}
bg_ctx.closePath();bg_ctx.fill();}}}
octx.restore();if(framesize.message.length){octx.save();var msgfsz=(settings.flat_design?13:18);octx.font=msgfsz+'px '+framesize.message_font;octx.fillStyle=framesize.message_color;var texts=framesize.message.split('|');var filltextargs=[];var xmin=overlaymask.width;var wmax=0;var ymin=overlaymask.height;var ymax=0;if(_this.mobile_product===true){var extra_tw=0;if(framesize.message_tip&&settings.flat_design){octx.font='bold '+octx.font;var tipm=octx.measureText(framesize.message_tip);extra_tw=tipm.width+5;}
for(var ti=0;ti<texts.length;ti++){var tline=texts[ti].trim();var tw=octx.measureText(tline);if((tw.width+extra_tw)>=overlaymask.width){var f_scl=(overlaymask.width-10)/(tw.width+extra_tw);msgfsz=Math.floor(f_scl*msgfsz);octx.font=msgfsz+'px '+framesize.message_font;}}}
for(var ti=0;ti<texts.length;ti++){var tline=texts[ti].trim();var tw=octx.measureText(tline);var mx=(overlaymask.width-tw.width)/2;mx+=framesize.offcenter;var my=frametopY-((msgfsz+4)*(texts.length-ti)-ti);xmin=(xmin>mx)?mx:xmin;ymin=(ymin>my)?my:ymin;ymax=(ymax<my)?my:ymax;wmax=(wmax<tw.width)?tw.width:wmax;filltextargs.push([tline,mx,my]);}
if(settings.flat_design){var tipstr=[];var tipw=0;var fontsave=octx.font;if(framesize.message_tip){octx.font='bold '+octx.font;var tipm=octx.measureText(framesize.message_tip);tipw=tipm.width+5;var tw_half=tipw/2;var tipx=xmin-tw_half;xmin+=tw_half;wmax+=tipw;tipstr.push(framesize.message_tip);tipstr.push(tipx);tipstr.push(ymin);octx.font=fontsave;}
for(var argi=0;argi<filltextargs.length;argi++){filltextargs[argi][1]=xmin;filltextargs[argi][2]-=15;}
if(settings.image_background){var distance_from_top=12;var diff=Math.round(filltextargs[0][2]-(msgfsz+distance_from_top));for(var ftxt_idx=0;ftxt_idx<filltextargs.length;ftxt_idx++){filltextargs[ftxt_idx][2]-=diff;}
ymin-=diff;ymax-=diff;}
octx.save();octx.fillStyle='#FFFFFF';octx.lineWidth=0.5;octx.strokeStyle='#999';ymin-=(20+msgfsz);xmin-=5+tipw;octx.fillRect(xmin,ymin,wmax+10,(ymax-ymin)-5);octx.strokeRect(xmin,ymin,wmax+10,(ymax-ymin)-5);octx.restore();if(tipw&&tipstr.length){fontsave=octx.font;octx.font='bold '+octx.font;tipstr[2]=filltextargs[0][2];octx.fillText.apply(octx,tipstr);octx.font=fontsave;}}
while(filltextargs.length){octx.fillText.apply(octx,filltextargs.shift());}
octx.restore();}
if(!mobile&&settings.kb_tip_msg){var splitmsg=[];var tipwidth=185;var tf_sz=10;octx.save();octx.font=tf_sz+'px arial,verdana';var tw=octx.measureText(settings.kb_tip_msg).width;if(tw>tipwidth){var words=settings.kb_tip_msg.split(' ');var line=words[0];var _line=line;for(var wi=1;wi<words.length;wi++){var cur_w=octx.measureText(_line).width;if(cur_w<tipwidth){line=_line;_line+=' '+words[wi];}else{_line=words[wi-1]+' '+words[wi];splitmsg.push(line);}}
splitmsg.push(_line);}else{splitmsg.push(settings.kb_tip_msg);}
var lineheight=13;var tipheight=splitmsg.length*(lineheight+10);var ty=overlaymask.height-tipheight-15.5;var box_x=19.5;var box_pad=10;octx.fillStyle='#FFF';octx.lineWidth=0.5;octx.strokeStyle='#999';octx.fillRect(box_x,ty,tipwidth+(box_pad*2),tipheight);octx.strokeRect(box_x,ty,tipwidth+(box_pad*2),tipheight);octx.restore();octx.save();octx.font=tf_sz+'px arial,verdana';octx.fillStyle='#666';ty+=Math.ceil(lineheight-(tf_sz/2))+box_pad;for(var si=0;si<splitmsg.length;si++){octx.fillText(splitmsg[si],box_x+10,ty);ty+=lineheight;}
octx.restore();}
view_topleft.x=frametopX;view_topleft.y=frametopY;if(framesize.paper_checker===true){var ptrn_img=new Image();ptrn_img.src=checker_pattern_img;ptrn_img.onload=function(){checker_pattern=ctx.createPattern(ptrn_img,'repeat');}}
FLSUtil.tmatrixTranslate(ctx_transform,frametopX,frametopY);FLSUtil.tmatrixScale(ctx_transform,settings.zoom,settings.zoom);ctx.setTransform.apply(ctx,ctx_transform);cctx.setTransform(1,0,0,1,0,0);cctx.translate(frametopX,frametopY);_applyImageBackground(settings.image_background);if(evnts){var mob_evtnts=wp_mobile?['pointerdown','pointermove','pointerup','pointercancel']:['touchstart','touchmove','touchend','touchcancel'];var events=mobile?mob_evtnts:['mousedown','mousemove','mouseup','mouseout','keydown','keyup'];for(var i in events){var where=['keydown','keyup'].indexOf(events[i])>-1?document.body:eventslayer;if(document.addEventListener){where.addEventListener(events[i],handleEvents,false);}else if(document.attachEvent){where.attachEvent("on"+events[i],handleEvents);}}}}
function _render(timedelta){if(typeof(timedelta)=='undefined'){timedelta=animPrevframeTime;}
if(timedelta!=animPrevframeTime){curFps=Math.floor(1/((timedelta-animPrevframeTime)/1000));animPrevframeTime=timedelta;}
if(curFps<=targetFps){ctx.setTransform(1,0,0,1,0,0);ctx.clearRect(0,0,canvas.width,canvas.height);ctx.setTransform.apply(ctx,ctx_transform);for(var i=0;i<plugins.length;i++){plugins[i]['onBeforeRender'].apply(plugins[i],[ctx]);}
if(settings.viewFrame.paper){ctx.save();ctx.beginPath();ctx.rect(0.5,0.5,(settings.viewFrame.width/settings.zoom)-1,(settings.viewFrame.height/settings.zoom)-1);ctx.fillStyle=settings.viewFrame.paper_color;ctx.shadowColor='rgba(0,0,0,0.5)';ctx.shadowBlur=20;ctx.shadowOffsetX=0;ctx.shadowOffsetY=0;ctx.closePath();ctx.fill();ctx.restore();}
if((settings.viewFrame.paper_checker===true)&&(checker_pattern)){ctx.save();ctx.beginPath();ctx.rect(0.5,0.5,(settings.viewFrame.width/settings.zoom)-1,(settings.viewFrame.height/settings.zoom)-1);ctx.fillStyle=checker_pattern;ctx.fill();ctx.restore();}
cctx.save();cctx.setTransform(1,0,0,1,0,0);cctx.clearRect(0,0,ccanvas.width,ccanvas.height);cctx.restore();if(doAnimation&&typeof(animCallback)=='function')animCallback(timedelta);for(var i=0;i<elements.length;i++){elements[i].render(ctx,cctx,timedelta);}
if(layout_visible){for(var i=0;i<layout_elements.length;i++){layout_elements[i].render(ctx,cctx,timedelta);}}}
if(doAnimation){animId=requestAnimationFrame(_render);}}
function _detectObject(point,point2){if(layout_visible&&!disable_layout_element_select){for(var i=layout_elements.length-1;i>=0;i--){if(layout_elements[i].containsPoint(point,point2)&&!layout_elements[i].in_selection){return layout_elements[i];}}}
for(var i=elements.length-1;i>=0;i--){if(elements[i].containsPoint(point,point2)){return elements[i];}}
return null;}
function getMousePos(evt){var rect=canvas.getBoundingClientRect();if(evt.type=='touchend')return mouseCoords;if(evt.touches){mouseCoords.x=evt.touches[0].clientX-rect.left;mouseCoords.y=evt.touches[0].clientY-rect.top;if(evt.touches.length>1){mouseCoords2.x=evt.touches[1].clientX-rect.left;mouseCoords2.y=evt.touches[1].clientY-rect.top;mouseCoords2.active=true;}else{mouseCoords2.x=0;mouseCoords2.y=0;mouseCoords2.active=false;}}else{mouseCoords.x=evt.clientX-rect.left;mouseCoords.y=evt.clientY-rect.top;}
mouseCoords.clickColor=ctx.getImageData(mouseCoords.x,mouseCoords.y,1,1).data;return mouseCoords;}
function cloneSettings(stngs){if(!stngs||typeof stngs!=='object'){return stngs;}
var st_cpy=stngs.constructor();for(var i in stngs){if(typeof(stngs[i])==='object'){st_cpy[i]=cloneSettings(stngs[i]);}else{st_cpy[i]=stngs[i];}}
return st_cpy;}
function _applyImageBackground(){if(settings.image_background!==false){var tmp_img=new Image();tmp_img.onload=function(){canvas.style.backgroundImage='url('+settings.image_background+')';canvas.style.backgroundRepeat='no-repeat';canvas.style.backgroundPosition='center center';settings.viewFrame.paper=false;};tmp_img.src=settings.image_background;}}
this.path2d_supported=function(){return path2d_supported;};this.setImageBackground=function(new_img_url){if((typeof(new_img_url)!='undefined')&&(new_img_url!=settings.image_background)){if(new_img_url!==false){var tmp_img=new Image();tmp_img.onload=function(){settings.image_background=new_img_url;canvas.style.backgroundImage='url('+new_img_url+')';canvas.style.backgroundRepeat='no-repeat';canvas.style.backgroundPosition='center center';settings.viewFrame.paper=false;};tmp_img.src=new_img_url;}else{if(settings.viewFrame.image_border===true){canvas.style.backgroundImage='none';canvas.style.backgroundColor='transparent';}else{canvas.style.backgroundRepeat='repeat';canvas.style.backgroundImage='url('+canvasbgimg+')';}}}};this.layout_visible=function(_ly_visible){if(typeof(_ly_visible)=='boolean'){layout_visible=_ly_visible;}
return layout_visible;};this.undoPush=function(obj,clearRedo,op){if(!obj)return false;if(typeof(clearRedo)!='boolean'){clearRedo=true;}
if(clearRedo){redoStack.length=0;redoStack=null;redoStack=[];}
if(undoStack.length>=undoSteps){undoStack.shift();}
if(typeof(op)=='undefined'){op=edit_operation;}
var FLSobj=[];var proprts=[];if(obj instanceof FLSEditorCore.CSelectionGroup){var sobjects=obj.getElements();for(var i=0;i<sobjects.length;i++){var sobj=sobjects[i];FLSobj.push(elements.indexOf(sobj));proprts.push(sobj.getProperties());}
undoStack.push({FLSobj:FLSobj,properties:proprts,operation:op});}else if(obj instanceof Array){for(var j=0;j<obj.length;j++){var sobj=elements[obj[j]];proprts.push(sobj.getProperties());}
undoStack.push({FLSobj:obj.slice(0),properties:proprts,operation:op});}else{undoStack.push({FLSobj:elements.indexOf(obj),properties:obj.getProperties(),operation:op});}};this.redoPush=function(obj,op){if(!obj)return false;if(redoStack.length>=undoSteps){redoStack.shift();}
var FLSobj=[];var proprts=[];if(obj instanceof FLSEditorCore.CSelectionGroup){var sobjects=obj.getElements();for(var i=0;i<sobjects.length;i++){var sobj=sobjects[i];FLSobj.push(elements.indexOf(sobj));proprts.push(sobj.getProperties());}
redoStack.push({FLSobj:FLSobj,properties:proprts,operation:op});}else if(obj instanceof Array){for(var j=0;j<obj.length;j++){var sobj=elements[obj[j]];proprts.push(sobj.getProperties());}
redoStack.push({FLSobj:obj.slice(0),properties:proprts,operation:op});}else{redoStack.push({FLSobj:elements.indexOf(obj),properties:obj.getProperties(),operation:op});}};this.undo=function(){if(undoStack.length){var _top=undoStack.pop();if(_top.operation=='op:delete'){var to=new FLSEditorCore.CPathText();to.editor(this);to.removable(true);to.setProperties(_top.properties);elements.splice(_top.FLSobj,0,to);}
if(_top.FLSobj instanceof Array){this.redoPush(_top.FLSobj,_top.operation);}else{this.redoPush(elements[_top.FLSobj],_top.operation);}
if(_top.operation=='op:addtext'){this.removeObject(elements[_top.FLSobj]);}else{if(_top.FLSobj instanceof Array){for(var i=0;i<_top.FLSobj.length;i++){elements[_top.FLSobj[i]]['setProperties'](_top.properties[i]);}}else{elements[_top.FLSobj]['setProperties'](_top.properties);}}
return true;}
return false;};this.redo=function(){if(redoStack.length){var _top=redoStack.pop();if(_top.operation=="op:addtext"){var to=new FLSEditorCore.CPathText();to.editor(this);to.removable(true);to.setProperties(_top.properties);elements.splice(_top.FLSobj,0,to);}
if(_top.FLSobj instanceof Array){this.undoPush(_top.FLSobj,false,_top.operation);}else{this.undoPush(elements[_top.FLSobj],false,_top.operation);}
if(_top.FLSobj instanceof Array){for(var i=0;i<_top.FLSobj.length;i++){elements[_top.FLSobj[i]]['setProperties'](_top.properties[i]);}}else{elements[_top.FLSobj]['setProperties'](_top.properties);}
if(_top.operation=="op:delete"){this.removeObject(elements[_top.FLSobj]);}
return true;}
return false;};this.clearUndoStacks=function(){undoStack.length=0;redoStack.length=0;undoStack=[];redoStack=[];return true;};this.undoStats=function(){return{undo:undoStack.length,redo:redoStack.length};};this.redrawViewFrame=function(width,height){width=parseInt(width,10);height=parseInt(height,10);width=isNaN(width)?settings.viewFrame.width:width;height=isNaN(height)?settings.viewFrame.height:height;settings.viewFrame.width=width;settings.viewFrame.height=height;_initOverlay(false);for(var i in plugins){plugins[i]['onViewframeChange'].apply(plugins[i],[settings]);}
return false;};this.updateOnResize=function(){if(settings.viewFrame.image_border===true){var top_offset=canvasWrapper.offsetTop;var parentWidth=canvasWrapper.parentNode.clientWidth;parentWidth=parentWidth<=window.innerWidth?parentWidth:window.innerWidth;settings.width=parentWidth>settings.min_width?parentWidth:settings.min_width;canvas.width=ghostcvs.width=settings.width;canvasWrapper.style.width=settings.width+'px';settings.viewFrame.width/=settings.zoom;settings.viewFrame.height/=settings.zoom;_initOverlay(false);for(var i in plugins){plugins[i]['onViewframeChange'].apply(plugins[i],[settings]);}
if(!macos_safari){canvasWrapper.parentNode.style.backgroundImage='url("'+this.bg_tile_img_info.img_src+'")';canvasWrapper.parentNode.style.backgroundSize=this.bg_tile_img_info.x_dx+'px '+this.bg_tile_img_info.y_dy+'px';canvasWrapper.parentNode.style.backgroundPosition=this.bg_tile_img_info.left+'px '+(this.bg_tile_img_info.top+top_offset)+'px';}}}
this.addObject=function(obj){if(obj instanceof FLSEditorCore.CObject){obj.editor(this);if(obj instanceof FLSEditorCore.CLayoutZone){layout_elements.push(obj);}else{elements.push(obj);obj.fonticons(FLSUtil.isFontAvailable('FlsObjectEditIcons'));}
return obj;}
return false;};this.removeObject=function(obj){if(obj instanceof FLSEditorCore.CObject){if(currentObj==obj){currentObj=null;}
var idx=elements.indexOf(obj);if(idx==-1){idx=layout_elements.indexOf(obj);return idx>-1?layout_elements.splice(idx,1):false;}
return idx>-1?elements.splice(idx,1):false;}
return false;};this.getObjects=function(){return elements;};this.getLayoutObjects=function(force){if(typeof(force)!='boolean'){force=false;}
if((layout_visible&&!disable_layout_element_select)||force){return layout_elements;}
return[];};this.disable_layout_element_select=function(disable){if(typeof(disable)=='boolean'){disable_layout_element_select=disable;}
return disable_layout_element_select;};this.setObjects=function(_elements){if(_elements instanceof Array){for(var i=0;i<_elements.length;i++){if(!(_elements[i]instanceof FLSEditorCore.CObject)){return false;}
if(!_elements[i].editor()){_elements[i].editor(this);}
_elements[i].fonticons(FLSUtil.isFontAvailable('FlsObjectEditIcons'));}
this.deselect();elements=_elements;}
return true;};this.setLayoutObjects=function(_elements){if(_elements instanceof Array){for(var i=0;i<_elements.length;i++){if(!(_elements[i]instanceof FLSEditorCore.CLayoutZone)){return false;}
if(!_elements[i].editor()){_elements[i].editor(this);}}
layout_elements=_elements;}
return true;};this.clearObjects=function(){elements.length=0;elements=null;elements=[];layout_elements.length=0;layout_elements=null;layout_elements=[];currentObj=null;};this.clearLayoutObjects=function(){while(layout_elements.length){layout_elements.pop();}
if(currentObj instanceof FLSEditorCore.CLayoutZone){currentObj=null;}};this.render=function(){_render(new Date());};this.setAnimate=function(callback,animate){if(typeof(animate)!='boolean'){animate=true;}
if(!animate&&animId){cancelAnimationFrame(animId);animId=null;}
if(typeof(callback)=='function'){animCallback=callback;}
if(doAnimation!=animate){doAnimation=animate;this.render();}};this.setEventCallback=function(callback){if(typeof(callback)=='function'){eventCallback=callback;}};this.getContext=function(){return ctx;};this.getControlContext=function(){return cctx;};this.generateSVG=function(){};this.ghostcanvas=function(){return ghostcvs;};this.viewtopleft=function(){return view_topleft;};this.viewsize=function(){return settings.viewFrame;};this.getCurrentObject=function(){return currentObj;};this.toSVG=function(){var svg=document.createElementNS('http://www.w3.org/2000/svg','svg');var logolayer=document.createElementNS('http://www.w3.org/2000/svg','g');var textlayer=document.createElementNS('http://www.w3.org/2000/svg','g');logolayer.setAttribute('id','surface2');textlayer.setAttribute('id','surface4');svg.setAttribute('width',settings.viewFrame.width+'pt');svg.setAttribute('height',settings.viewFrame.height+'pt');svg.setAttribute('viewBox','0 0 '+settings.viewFrame.width+' '+settings.viewFrame.height);svg.setAttribute('version','1.1');svg.setAttribute('xmlns','http://www.w3.org/2000/svg');svg.setAttribute('xmlns:xlink','http://www.w3.org/1999/xlink');svg.appendChild(document.createTextNode('\n  '));svg.appendChild(logolayer);svg.appendChild(document.createTextNode('\n  '));svg.appendChild(textlayer);svg.appendChild(document.createTextNode('\n'));for(var i in elements){if(elements[i]instanceof FLSEditorCore.CPathGroup){elements[i].toSVG(logolayer);}
if(elements[i]instanceof FLSEditorCore.CText){elements[i].toSVG(textlayer);}}
return new XMLSerializer().serializeToString(svg);};this.getCanvasWrapper=function(){return canvasWrapper;};this.getViewFrameData=function(_watermark,as_data_url,as_canvas,force_white_bg,force_def_txt,_watermark_bg_color,invert_colors){if(typeof(as_data_url)!='boolean'){as_data_url=false;}
if(typeof(as_canvas)!='boolean'){as_canvas=false;}
if(typeof(_watermark)!='boolean'){_watermark=false;}
if(typeof(force_white_bg)!='boolean'){force_white_bg=false;}
if(typeof(force_def_txt)!='boolean'){force_def_txt=false;}
if(typeof(invert_colors)!='boolean'){invert_colors=false;}
var vfdatacvs=this.trimdata?viewframecvstrim:viewframecvs;var vfctx=vfdatacvs.getContext('2d');vfctx.clearRect(0,0,settings.viewFrame.width,settings.viewFrame.height);if(_watermark){vfctx.fillStyle=_watermark_bg_color?_watermark_bg_color:'#FFF';vfctx.fillRect(0,0,settings.viewFrame.width,settings.viewFrame.height);}
var trpos=[0,0];if(this.trimdata){trpos[0]=-settings.viewFrame.shrink[0]/2;trpos[1]=-settings.viewFrame.shrink[1]/2;}
vfctx.setTransform(settings.zoom,0,0,settings.zoom,trpos[0],trpos[1]);vfctx.save();for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CLayoutZone)continue;if(!_watermark&&!force_white_bg&&elements[i]instanceof FLSEditorCore.CRect&&elements[i].id&&elements[i].id=='backgroundColor'&&/rgb\(\s*?(100(\.\d+)?%|255)\s*?,\s*?(100(\.\d+)?%|255)\s*?,\s*?(100(\.\d+)?%|255)\s*?\)|rgba\(\s*?(0)s*?,\s*?(0)\s*?,\s*?(0)\s*?,\s*?(0)\s*?\)/i.test(elements[i].getColor())){continue;}
elements[i].for_preview=!force_def_txt;elements[i].render(vfctx);elements[i].for_preview=false;}
vfctx.restore();vfctx.setTransform(1,0,0,1,0,0);if(_watermark){var ptrn=vfctx.createPattern(watermarkimg,'repeat');vfctx.beginPath();vfctx.moveTo(0,0);vfctx.lineTo(settings.viewFrame.width,0);vfctx.lineTo(settings.viewFrame.width,settings.viewFrame.height);vfctx.lineTo(0,settings.viewFrame.height);vfctx.closePath();vfctx.save();vfctx.rotate(-0.2);vfctx.fillStyle=ptrn;vfctx.fill();vfctx.restore();}
this.trimdata=false;if(invert_colors){FLSUtil.invertImage(vfdatacvs);}
if(as_data_url){var data_url_args=[];if(this.jpeg_raster){data_url_args.push('image/jpeg');data_url_args.push(1);}
return vfdatacvs.toDataURL.apply(vfdatacvs,data_url_args);}else if(as_canvas){return vfdatacvs;}
return vfctx.getImageData(0,0,settings.viewFrame.width,settings.viewFrame.height);};this.centerResizeTexts=function(anchor1){if(typeof(anchor1)=='undefined'||['left','center','right'].indexOf(anchor1)==-1){anchor1='center';}
var gctx=ghostcvs.getContext('2d');var need_resize=false;var corners=[];var _ed_zoom=this.zoom();var center=elements[0].objCenter(corners);var test_width=settings.viewFrame.width/_ed_zoom;var alignx=test_width/2;test_width-=40;switch(anchor1){case'left':test_width-=(corners[1]['x']/_ed_zoom);alignx=(corners[1]['x']/_ed_zoom);break;case'right':test_width=(corners[0]['x']/_ed_zoom);alignx=(corners[0]['x']/_ed_zoom);break;}
for(var i in elements){if(elements[i]instanceof FLSEditorCore.CText){if((elements[i]instanceof FLSEditorCore.CPathText)&&elements[i].has_path()){continue;}
var fsize=elements[i].getFontSize();elements[i].align_point=anchor1;if(elements[i]instanceof FLSEditorCore.CMultiLineText){var sz=elements[i].getSize();need_resize=need_resize?need_resize:sz.width>test_width;if(need_resize){fsize=Math.ceil(fsize*(test_width/sz.width));}}else{var text=elements[i].getText();var font=elements[i].getFontFamily();gctx.font=fsize+'px '+font;var txtmetrics=gctx.measureText(text);need_resize=need_resize?need_resize:txtmetrics.width>test_width;if(need_resize){var done_resize=false;while(!done_resize){fsize-=1;gctx.font=fsize+'px '+font;txtmetrics=gctx.measureText(text);done_resize=txtmetrics.width<test_width;}}}
elements[i].setFontSize(fsize);center=elements[i].objCenter(corners);if(anchor1=='center'){elements[i].translateX(alignx-(center.x/_ed_zoom));}else if(anchor1=='right'){elements[i].translateX(alignx-(corners[1].x/_ed_zoom));}else{elements[i].translateX(alignx-(corners[0].x/_ed_zoom));}}}};this.debug=function(data){jQuery('#debug').html(JSON.stringify(data));};this.registerPlugin=function(_plugin){var pinstance=_plugin;if(typeof(_plugin)=='function'){pinstance=new _plugin();}else if(typeof(_plugin)=='string'&&typeof(window[_plugin])=='function'){pinstance=new window[_plugin];if(pinstance.name()=='BasePlugin'){pinstance.name(_plugin);}}
if(pinstance instanceof FLSPlugin){var pname=pinstance.name();if(pname=='BasePlugin'){console.warn('Please set a valid name for your plugin using this.name("YourPluginName") in the constructor');}else{if(plugin_names.indexOf(pname)==-1){pinstance.init(this,settings,canvas);plugins.push(pinstance);plugin_names.push(pname);}else{console.warn("Plugin already registered: "+pname);}
return pinstance;}}
return false;};this.setCurrentObject=function(obj){if(obj instanceof FLSEditorCore.CObject&&elements.indexOf(obj)!=-1){if(currentObj){currentObj.setActive(false);}
currentObj=obj;currentObj.setActive(true);}};this.getSettings=function(){return JSON.parse(JSON.stringify(settings));};this.zoom=function(zoom){zoom=parseFloat(zoom,10);var current_zoom=settings.zoom
if(!isNaN(zoom)){settings.zoom=zoom;}
return settings.zoom;};this.overlayMessage=function(msg){settings.viewFrame.message=msg.trim();};this.deselect=function(){if(currentObj){currentObj.use_pivot(false);currentObj.unsetCurrentControl();}
currentObj=null;edit_operation='op:none';dragstart=null;};this.layerMove=function(obj,npos){npos=parseInt(npos,10);var o_idx=elements.indexOf(obj);if(o_idx>-1&&!isNaN(npos)&&(npos>=0&&npos<elements.length)&&npos!=o_idx){elements.splice(npos,0,elements.splice(o_idx,1)[0]);return true;}
return false;};this.mobile=function(){return mobile?true:false;};this.wp_mobile=function(){return wp_mobile?true:false;};this.contentInsideSafeLine=function(is_logo){var framesize={width:settings.viewFrame.width,height:settings.viewFrame.height}
var safe_margins=settings.viewFrame.shrink.slice(0);var trim_offset_x=settings.viewFrame.shrink_offset_x;var trimsize={width:framesize.width-(safe_margins[0]*2),height:framesize.height-(safe_margins[1]*2)}
var left_margin=safe_margins[0]+trim_offset_x;var top_margin=safe_margins[1];var right_margin=left_margin+trimsize.width;var bottom_margin=top_margin+trimsize.height;var check=true;var corners=[];var all_inside=true;for(var i=0;i<elements.length;i++){if(((elements[i]instanceof FLSEditorCore.CImage)&&elements[i].xlinktype=='templateBackground')||(elements[i]instanceof FLSEditorCore.CRect)||((elements[i]instanceof FLSEditorCore.CPathGroup)&&(is_logo===false))||((elements[i]instanceof FLSEditorCore.CText)&&(elements[i].getText().trim().length==0))){check=false;}
if(check){var box_padding=elements[i].bboxpad();elements[i].bboxpad(0);var center=elements[i].objCenter(corners);elements[i].bboxpad(box_padding);all_inside=all_inside&&((corners[0]['x']>left_margin)&&(corners[0]['y']>top_margin)&&(corners[1]['x']<right_margin)&&(corners[1]['y']<bottom_margin));if(!all_inside)break;}
check=true;}
return all_inside;};this.getGradientIds=function(){var grd_ids=[];for(var e_idx=0;e_idx<elements.length;e_idx++){var pths=[];if(elements[e_idx]instanceof FLSEditorCore.CPathGroup){pths=elements[e_idx].getPaths();}else if(elements[e_idx]instanceof FLSEditorCore.CLogoObjectGroup){var lgo_elmnts=elements[e_idx].getElements();for(var el_idx=0;el_idx<lgo_elmnts.length;el_idx++){if(lgo_elmnts[el_idx]instanceof FLSEditorCore.CPathGroup){pths=lgo_elmnts[el_idx].getPaths();}}}
if(pths.length){for(var pidx=0;pidx<pths.length;pidx++){if(pths[pidx]['gradientId']&&(grd_ids.indexOf(pths[pidx]['gradientId'])==-1)){grd_ids.push(pths[pidx]['gradientId']);}}}}
return grd_ids;};this.edit_operation=function(){return edit_operation;}};FLSEditorCore.CObject=function(){var editor=null;var obj_shadow={};var use_shadow=false;var position={x:0,y:0};var size={width:100,height:100};var controls={'scale':{x:0,y:0},'rotate':{x:0,y:0},'delete':{x:0,y:0}};var showControls=true;var current_control='none';var pivot={x:0,y:0};var center={x:0,y:0};var use_pivot=false;var isActive=false;var bboxpad=5;var bboxpos={x:0,y:0};var DEG_TO_RAD=Math.PI/180;var inGroup=false;var removable=false;var hasrotate=true;var scalable=true;var selectable=true;var highlight=false;var editable=true;var fixed=false;var hastextedit=false;var unlockable=false;var unlocked=false;var colorEditable=true;var fonticons=true;var controlSize={def:18,flat:15,imgbg:15};var default_control_border_color="#000000";var default_control_active_fill_color='rgba(64, 125, 181,0.95)';var fonticontextpos={def:{'scale':{x:-11,y:8},'rotate':{x:-14.5,y:13.5},'delete':{x:-12.5,y:9.5},'textedit':{x:-12.5,y:10},'lock_unlock':{x:-12.5,y:10}},flat:{'scale':{x:-5.5,y:5.5},'rotate':{x:-8,y:6},'delete':{x:-5,y:4},'textedit':{x:-7,y:6},'lock_unlock':{x:-10,y:7}},imgbg:{'scale':{x:-7,y:4.5},'rotate':{x:-9,y:6},'delete':{x:-7,y:4},'textedit':{x:-8,y:5},'lock_unlock':{x:-9,y:4}}};var iconstyle=fonticontextpos[FLSUtil.objIconStyle]?FLSUtil.objIconStyle:'flat';controlSize=controlSize[iconstyle];fonticontextpos=fonticontextpos[iconstyle];var recalc_icon_tpos=false;var fonticonprops={def:{'scale':{size:22,glyph:'\uE003',adj_y:-3,adj_x:0,bg_color:'rgba(255, 255, 255,0.8)',color:'rgb(64, 125, 181)'},'rotate':{size:33,glyph:'\uE001',adj_y:-3,adj_x:2,bg_color:'rgba(255, 255, 255,0.8)',color:'rgb(64, 125, 181)'},'delete':{size:25,glyph:'\uE002',adj_y:-3,adj_x:0,bg_color:'rgba(255, 255, 255,0.8)',color:'rgb(231, 35, 28)'},'textedit':{size:25,glyph:'\uE000',adj_y:-2,adj_x:0,bg_color:'rgba(255, 255, 255,0.8)',color:'rgb(64, 125, 181)'},'lock_unlock':{size:25,glyph:'\uE004',adj_y:-3,adj_x:0,bg_color:'rgba(255, 255, 255,0.8)',color:'rgb(64, 125, 181)'},'lock':{size:25,glyph:'\uE004',adj_y:0,adj_x:0,bg_color:'rgba(255, 255, 255,0.8)',color:'rgb(64, 125, 181)'},'unlock':{size:25,glyph:'\uE005',adj_y:0,adj_x:0,bg_color:'rgba(255, 255, 255,0.8)',color:'rgb(63, 146, 62)'}},flat:{'scale':{size:13,glyph:'\uE00B',adj_y:-1,adj_x:1,bg_color:'rgb(226, 228, 228)',color:'rgb(0, 69, 121)'},'rotate':{size:16,glyph:'\uE00C',adj_y:-2,adj_x:0,bg_color:'rgb(226, 228, 228)',color:'rgb(0, 69, 121)'},'delete':{size:10,glyph:'\uE00D',adj_y:-1,adj_x:0,bg_color:'rgb(226, 228, 228)',color:'rgb(231, 35, 28)'},'textedit':{size:14,glyph:'\uE00A',adj_y:-1,adj_x:0,bg_color:'rgb(226, 228, 228)',color:'rgb(0, 69, 121)'},'lock_unlock':{size:20,glyph:'\uE00E',adj_y:-3,adj_x:0,bg_color:'rgb(226, 228, 228)',color:'rgb(0, 69, 121)'},'lock':{size:20,glyph:'\uE00E',adj_y:-3,adj_x:0,bg_color:'rgb(226, 228, 228)',color:'rgb(0, 69, 121)'},'unlock':{size:20,glyph:'\uE00F',adj_y:-3,adj_x:0,bg_color:'rgb(226, 228, 228)',color:'rgb(63, 146, 62)'}},imgbg:{'scale':{size:12,glyph:'\uE019',adj_y:-1,adj_x:1,bg_color:'rgb(255, 255, 255)',color:'#666666',active_color:'#005596',control_border_color:'#2ba4f0',control_active_fill_color:"#FFFFFF",control_active_border_color:'#005596',active_shadow:true},'rotate':{size:15,glyph:'\uE01A',adj_y:-2,adj_x:0,bg_color:'rgb(255, 255, 255)',color:'#666666',active_color:'#005596',control_border_color:'#2ba4f0',control_active_fill_color:"#FFFFFF",control_active_border_color:'#005596',active_shadow:true},'delete':{size:10,glyph:'\uE01B',adj_y:-1,adj_x:0,bg_color:'rgb(255, 255, 255)',color:'#666666',active_color:'#db1c2f',control_border_color:'#2ba4f0',control_active_fill_color:"#FFFFFF",control_active_border_color:'#db1c2f',active_shadow:true},'textedit':{size:12,glyph:'\uE01E',adj_y:-1,adj_x:0,bg_color:'rgb(255, 255, 255)',color:'#666666',active_color:'#005596',control_border_color:'#2ba4f0',control_active_fill_color:"#FFFFFF",control_active_border_color:'#005596',active_shadow:true},'lock_unlock':{size:13,glyph:'\uE01C',adj_y:-3,adj_x:0,bg_color:'rgb(255, 255, 255)',color:'#666666',active_color:'#005596',control_border_color:'#2ba4f0',control_active_fill_color:"#FFFFFF",control_active_border_color:'#005596',active_shadow:true},'lock':{size:13,glyph:'\uE01C',adj_y:-3,adj_x:0,bg_color:'rgb(255, 255, 255)',color:'#666666',active_color:'#005596',control_border_color:'#2ba4f0',control_active_fill_color:"#FFFFFF",control_active_border_color:'#005596',active_shadow:true},'unlock':{size:13,glyph:'\uE01D',adj_y:-3,adj_x:0,bg_color:'rgb(255, 255, 255)',color:'#3CBF3C',active_color:'#3CBF3C',control_border_color:'#3CBF3C',control_active_fill_color:"#FFFFFF",control_active_border_color:'#3CBF3C',active_shadow:true}}};fonticonprops=fonticonprops[iconstyle];var flat_contol_paths={'rb':'M 7.3838083,21.480863 C -0.90046275,21.480863 -7.6161917,14.765134 -7.6161917,6.4808632 C -7.6107717,4.2635034 -7.1138217,2.0749238 -6.1611137,0.07265982 L 0.05177722,0.07265982 L 0.05177722,-6.5972622 C 2.2909593,-7.8550032 4.8155709,-8.5167562 7.3838083,-8.5191372 C 15.541834,-8.4749422 22.383807,-1.8034082 22.383807,6.4808632 C 22.383807,14.765134 15.668078,21.480863 7.3838083,21.480863 Z','lb':'M -7.4169736,21.516019 C 0.86729748,21.516019 7.5830264,14.80029 7.5830264,6.5160195 C 7.5776064,4.2986597 7.0806564,2.1100801 6.1279484,0.10781607 L -0.08494252,0.10781607 L -0.08494252,-6.5621059 C -2.3241246,-7.8198469 -4.8487362,-8.4815999 -7.4169736,-8.4839809 C -15.575,-8.4397859 -22.416973,-1.7682519 -22.416973,6.5160195 C -22.416973,14.80029 -15.701244,21.516019 -7.4169736,21.516019 Z','lt':'M -7.3437503,-21.445312 C 0.94052078,-21.445312 7.6562497,-14.729583 7.6562497,-6.4453125 C 7.6508297,-4.2279527 7.1538797,-2.039373 6.2011717,-0.03710938 L -0.01171922,-0.03710938 L -0.01171922,6.6328125 C -2.2509013,7.8905541 -4.7755129,8.5523064 -7.3437503,8.5546876 C -15.501777,8.5104933 -22.34375,1.8389587 -22.34375,-6.4453125 C -22.34375,-14.729583 -15.628021,-21.445312 -7.3437503,-21.445312 Z','rt':'M 7.3320312,-21.410156 C -0.95223997,-21.410156 -7.6679687,-14.694427 -7.6679688,-6.4101562 C -7.662549,-4.1927965 -7.1655993,-2.0042167 -6.2128906,-0.00195313 L 0,-0.00195313 L 0,6.6679688 C 2.2391818,7.9257103 4.7637938,8.5874626 7.3320312,8.5898438 C 15.490058,8.5456495 22.332031,1.874115 22.332031,-6.4101562 C 22.332031,-14.694427 15.616302,-21.410156 7.3320312,-21.410156 Z'}
var flat_contol_paths_dims={};var bboxCalculated=false;var tmatrix=[1,0,0,1,0,0];var matrix=[1,0,0,0,1,0,0,0,1];var inverse=[];var _this=this;inverseMatrix();function calculatePivotTransform(reverse){if(typeof(reverse)!='boolean'){reverse=false;}
var pivotmatrix=[1,0,0,1,0,0];if(reverse){FLSUtil.tmatrixTranslate(pivotmatrix,-pivot.x,-pivot.y);}else{FLSUtil.tmatrixTranslate(pivotmatrix,pivot.x,pivot.y);}
var pos=_this.getPosition();FLSUtil.tmatrixTranslate(pivotmatrix,pos.x,pos.y);FLSUtil.tmatrixRotate(pivotmatrix,-_this.getRotation());var sclx=_this.getScaleX();var scly=_this.getScaleY();FLSUtil.tmatrixScale(pivotmatrix,sclx,scly);if(reverse){FLSUtil.tmatrixTranslate(pivotmatrix,pivot.x,pivot.y);}else{FLSUtil.tmatrixTranslate(pivotmatrix,-pivot.x,-pivot.y);}
_this.setMatrix(pivotmatrix);}
function updateMatrix(){matrix[0]=tmatrix[0];matrix[1]=tmatrix[2];matrix[2]=tmatrix[4];matrix[3]=tmatrix[1];matrix[4]=tmatrix[3];matrix[5]=tmatrix[5];inverseMatrix();}
function _transformPoint(point){var newpoint={};newpoint.x=inverse[0]*point.x+inverse[1]*point.y+inverse[2];newpoint.y=inverse[3]*point.x+inverse[4]*point.y+inverse[5];return newpoint;}
function _applyTransformMatrixToPoint(point){var px=0,py=0;px=matrix[0]*point.x+matrix[1]*point.y+matrix[2];py=matrix[3]*point.x+matrix[4]*point.y+matrix[5];point.x=Math.floor(px);point.y=Math.floor(py);}
function inverseMatrix(){var a00=matrix[0],a01=matrix[1],a02=matrix[2],a10=matrix[3],a11=matrix[4],a12=matrix[5],a20=matrix[6],a21=matrix[7],a22=matrix[8],b01=a22*a11-a12*a21,b11=-a22*a10+a12*a20,b21=a21*a10-a11*a20,det=a00*b01+a01*b11+a02*b21;if(!det){return null;}
det=1.0/det;inverse[0]=b01*det;inverse[1]=(-a22*a01+a02*a21)*det;inverse[2]=(a12*a01-a02*a11)*det;inverse[3]=b11*det;inverse[4]=(a22*a00-a02*a20)*det;inverse[5]=(-a12*a00+a02*a10)*det;inverse[6]=b21*det;inverse[7]=(-a21*a00+a01*a20)*det;inverse[8]=(a11*a00-a01*a10)*det;}
function calculateBoundingBox(){var ghostcvs=_this.editor().ghostcanvas();var gctx=ghostcvs.getContext('2d');gctx.setTransform(1,0,0,1,0,0);gctx.clearRect(0,0,ghostcvs.width,ghostcvs.height);_this.render(gctx,gctx,null,true);var idata=gctx.getImageData(0,0,ghostcvs.width,ghostcvs.height);var extremities={tx:0,ty:0,rx:0,ry:0,bx:0,by:0,lx:0,ly:0};var foundcolor=false;for(var y=0;y<idata.height;y++){foundcolor=false;for(var x=0;x<idata.width;x++){if(idata.data[((idata.width*y)+x)*4+3]){extremities.tx=x;extremities.ty=y;foundcolor=true;break;}}
if(foundcolor)break;}
for(var y=idata.height-1;y>0;y--){foundcolor=false;for(var x=0;x<idata.width;x++){if(idata.data[((idata.width*y)+x)*4+3]){extremities.bx=x;extremities.by=y;foundcolor=true;break;}}
if(foundcolor)break;}
for(var x=0;x<idata.width;x++){foundcolor=false;for(var y=0;y<idata.height;y++){if(idata.data[((idata.width*y)+x)*4+3]){extremities.lx=x;extremities.ly=y;foundcolor=true;break;}}
if(foundcolor)break;}
for(var x=idata.width-1;x>0;x--){foundcolor=false;for(var y=0;y<idata.height;y++){if(idata.data[((idata.width*y)+x)*4+3]){extremities.rx=x;extremities.ry=y;foundcolor=true;break;}}
if(foundcolor)break;}
size.width=extremities.rx-extremities.lx;size.height=extremities.by-extremities.ty;bboxpos.x=extremities.lx;bboxpos.y=extremities.ty;pivot.x=Math.floor(bboxpos.x+size.width/2);pivot.y=Math.floor(bboxpos.y+size.height/2);center.x=pivot.x;center.y=pivot.y;bboxCalculated=true;};this.highlight=function(_highlight){if(typeof(_highlight)=='boolean'){highlight=_highlight;}
return highlight;};this.fonticons=function(_fonticons){_fonticons=true;if(typeof(_fonticons)=='boolean'){fonticons=_fonticons;if(editor&&recalc_icon_tpos){var ctx=editor.getControlContext();if(fonticons){for(var i in fonticontextpos){ctx.save();var tw=0;var text='';switch(i){case'scale':ctx.font=fonticonprops[i]['size']+'px FlsObjectEditIcons';text=fonticonprops[i]['glyph'];tw=ctx.measureText(text);var mw=tw.width/2;fonticontextpos[i]['x']=-mw+fonticonprops[i]['adj_x'];fonticontextpos[i]['y']=mw+fonticonprops[i]['adj_y'];break;case'rotate':ctx.font=fonticonprops[i]['size']+'px FlsObjectEditIcons';text=fonticonprops[i]['glyph'];tw=ctx.measureText(text);var mw=tw.width/2;fonticontextpos[i]['x']=-mw+fonticonprops[i]['adj_x'];fonticontextpos[i]['y']=mw+fonticonprops[i]['adj_y'];break;case'delete':ctx.font=fonticonprops[i]['size']+'px FlsObjectEditIcons';text=fonticonprops[i]['glyph'];tw=ctx.measureText(text);var mw=tw.width/2;fonticontextpos[i]['x']=-mw+fonticonprops[i]['adj_x'];fonticontextpos[i]['y']=mw+fonticonprops[i]['adj_y'];break;case'textedit':ctx.font=fonticonprops[i]['size']+'px FlsObjectEditIcons';text=fonticonprops[i]['glyph'];tw=ctx.measureText(text);var mw=tw.width/2;fonticontextpos[i]['x']=-mw+fonticonprops[i]['adj_x'];fonticontextpos[i]['y']=mw+fonticonprops[i]['adj_y'];case'lock_unlock':ctx.font=fonticonprops[i]['size']+'px FlsObjectEditIcons';text=fonticonprops[i]['glyph'];tw=ctx.measureText(text);var mw=tw.width/2;fonticontextpos[i]['x']=-mw+fonticonprops[i]['adj_x'];fonticontextpos[i]['y']=mw+fonticonprops[i]['adj_y'];break;}
ctx.restore();}}else{ctx.save();ctx.font='25px Georgia,serif';var tw=ctx.measureText('T');var mw=tw.width/2;fonticontextpos['textedit']['x']=fonticontextpos['lock_unlock']['x']=-mw+fonticonprops['textedit']['adj_x']
fonticontextpos['textedit']['y']=fonticontextpos['lock_unlock']['y']=mw+fonticonprops['textedit']['adj_y'];ctx.restore();}
console.log(fonticontextpos)}}
return fonticons;};this.showControls=function(show){if(typeof(show)=='boolean'){showControls=show;}
return showControls;};this.editor=function(_editor){if(_editor instanceof FLSEditorCore){editor=_editor;if(this.calcbbox()){this.calculateBoundingBox();}}
return editor;};this.getScaleX=function(){return Math.sqrt(matrix[0]*matrix[0]+matrix[1]*matrix[1]);};this.getScaleY=function(){return Math.sqrt(matrix[3]*matrix[3]+matrix[4]*matrix[4]);};this.getRotation=function(){return Math.atan2(tmatrix[2],tmatrix[3]);};this.unsetCurrentControl=function(){current_control='none';};this.drawControls=function(ctx){function draw_control_circle(ccenter,obj_rot,corner,ci){var iconpos={x:0,y:0};var arcparam={start:0,end:2*Math.PI}
switch(iconstyle){case'flat':switch(corner){case'rb':arcparam.start=1.5*Math.PI;arcparam.end=Math.PI;break;case'lb':arcparam.end=1.5*Math.PI;break;case'rt':arcparam.start=Math.PI;arcparam.end=0.5*Math.PI;break;case'lt':arcparam.start=0.5*Math.PI;arcparam.end=0;break;}
if(flat_contol_paths[corner]){if(typeof(flat_contol_paths[corner])==='string'){flat_contol_paths[corner]=SVGPath2Cnvs.parse(flat_contol_paths[corner]);flat_contol_paths_dims[corner]=SVGPath2Cnvs.bbox(flat_contol_paths[corner]);flat_contol_paths_dims[corner]['width']=flat_contol_paths_dims[corner]['x1']-flat_contol_paths_dims[corner]['x0'];flat_contol_paths_dims[corner]['height']=flat_contol_paths_dims[corner]['y1']-flat_contol_paths_dims[corner]['y0'];flat_contol_paths_dims[corner]['c_dx']=(flat_contol_paths_dims[corner]['width']/2)+flat_contol_paths_dims[corner]['x0'];flat_contol_paths_dims[corner]['c_dy']=(flat_contol_paths_dims[corner]['height']/2)+flat_contol_paths_dims[corner]['y0'];controlSize=flat_contol_paths_dims[corner]['width']/2;}
var p_diff={x:flat_contol_paths_dims[corner]['c_dx'],y:flat_contol_paths_dims[corner]['c_dy']};var dif_mtrx=[1,0,0,1,0,0];FLSUtil.tmatrixRotate(dif_mtrx,objrotation);FLSUtil.transformPoint(dif_mtrx,p_diff,true);ctx.translate(ccenter.x,ccenter.y);ctx.rotate(objrotation);ctx.beginPath();for(var cmdi=0;cmdi<flat_contol_paths[corner].length;cmdi++){ctx[flat_contol_paths[corner][cmdi]['func']].apply(ctx,flat_contol_paths[corner][cmdi]['args']);}
if(ci&&(current_control==ci)&&fonticonprops[ci]['active_shadow']){ctx.shadowColor='rgba(0,0,0,0.3)';ctx.shadowBlur=4;}
ctx.fill();ctx.stroke();ctx.shadowColor='transparent';ctx.translate(-ccenter.x,-ccenter.y);iconpos.x=ccenter.x+flat_contol_paths_dims[corner]['c_dx'];iconpos.y=ccenter.y+flat_contol_paths_dims[corner]['c_dy'];ccenter.x+=p_diff.x;ccenter.y+=p_diff.y;}else{if(ci&&(current_control==ci)&&fonticonprops[ci]['active_shadow']){ctx.shadowColor='rgba(0,0,0,0.3)';ctx.shadowBlur=4;}
ctx.beginPath();ctx.moveTo(ccenter.x,ccenter.y);ctx.arc(ccenter.x,ccenter.y,controlSize,arcparam.start+objrotation,arcparam.end+objrotation);ctx.closePath();ctx.fill();ctx.stroke();ctx.shadowColor='transparent';ctx.translate(ccenter.x,ccenter.y);ctx.rotate(objrotation);ctx.translate(-ccenter.x,-ccenter.y);iconpos.x=ccenter.x;iconpos.y=ccenter.y;}
break;default:if(ci&&(current_control==ci)&&fonticonprops[ci]['active_shadow']){ctx.shadowColor='rgba(0,0,0,0.3)';ctx.shadowBlur=4;}
ctx.translate(ccenter.x,ccenter.y);ctx.rotate(objrotation);ctx.beginPath();ctx.arc(0,0,controlSize,0,2*Math.PI);ctx.closePath();ctx.fill();ctx.stroke();ctx.shadowColor='transparent';}
return iconpos;}
if(ctx&&(isActive||highlight)){var px=use_pivot?pivot.x:0,py=use_pivot?pivot.y:0,zoom=this.editor().zoom();var _bboxpad=bboxpad;var lt={x:(bboxpos.x-_bboxpad-px),y:(bboxpos.y-_bboxpad-py)};var rt={x:size.width+bboxpos.x-px+_bboxpad,y:bboxpos.y-py-_bboxpad};var rb={x:(size.width)+(bboxpos.x-px)+_bboxpad,y:(bboxpos.y-py)+(size.height)+_bboxpad};var lb={x:(bboxpos.x-px-_bboxpad),y:(bboxpos.y-py)+(size.height)+_bboxpad};_applyTransformMatrixToPoint(lt);_applyTransformMatrixToPoint(rt);_applyTransformMatrixToPoint(rb);_applyTransformMatrixToPoint(lb);lt.x+=px;lt.y+=py;rt.x+=px;rt.y+=py;rb.x+=px;rb.y+=py;lb.x+=px;lb.y+=py;if(this.inGroup()){var parent_mtrx=this.parentGroup.getMatrix().slice(0);FLSUtil.transformPoint(parent_mtrx,lt,true);FLSUtil.transformPoint(parent_mtrx,rt,true);FLSUtil.transformPoint(parent_mtrx,rb,true);FLSUtil.transformPoint(parent_mtrx,lb,true);}
if(zoom!=1){FLSUtil.transformPoint([zoom,0,0,zoom,0,0],lt,true);FLSUtil.transformPoint([zoom,0,0,zoom,0,0],rt,true);FLSUtil.transformPoint([zoom,0,0,zoom,0,0],rb,true);FLSUtil.transformPoint([zoom,0,0,zoom,0,0],lb,true);}
if(highlight){ctx.strokeStyle='#006696';ctx.fillStyle='rgba(0,0,100,0.2)';}else{ctx.strokeStyle=current_control=='translate'?'#006696':'#000';}
ctx.lineWidth=0.5;ctx.beginPath();ctx.moveTo(lt.x,lt.y);ctx.lineTo(rt.x,rt.y);ctx.lineTo(rb.x,rb.y);ctx.lineTo(lb.x,lb.y);ctx.closePath();ctx.stroke();if(highlight){ctx.fill();}
if(showControls&&highlight===false){var ilinewidth=4.5;var strokeStyle=this.default_control_border_color();var activeFillStyle=this.default_control_active_fill_color();var activeIconColor='rgb(255,255,255)';var cicon_size=(controlSize/2)-1;var objrotation=-_this.getRotation();ctx.lineCap='round';for(var ci in controls){strokeStyle=(fonticons&&fonticonprops[ci]['control_border_color'])?fonticonprops[ci]['control_border_color']:this.default_control_border_color();strokeStyle=((current_control==ci)&&fonticonprops[ci]['control_active_border_color'])?fonticonprops[ci]['control_active_border_color']:strokeStyle;activeFillStyle=(fonticons&&fonticonprops[ci]['control_active_fill_color'])?fonticonprops[ci]['control_active_fill_color']:this.default_control_active_fill_color();activeIconColor=(fonticons&&fonticonprops[ci]['active_color'])?fonticonprops[ci]['active_color']:'rgb(255,255,255)';switch(ci){case'scale':if(!fixed&&scalable){ctx.save();ctx.fillStyle=current_control==ci?activeFillStyle:fonticonprops[ci]['bg_color'];ctx.strokeStyle=strokeStyle;var ioffset=draw_control_circle(rb,objrotation,'rb',ci);if(fonticons){ctx.font=fonticonprops[ci]['size']+'px FlsObjectEditIcons';ctx.fillStyle=current_control==ci?activeIconColor:fonticonprops[ci]['color'];var text=fonticonprops[ci]['glyph'];ctx.fillText(text,fonticontextpos[ci]['x']+ioffset.x,fonticontextpos[ci]['y']+ioffset.y);}else{ctx.translate(ioffset.x,ioffset.y);ctx.beginPath();ctx.lineWidth=ilinewidth;ctx.strokeStyle=current_control==ci?activeIconColor:fonticonprops[ci]['color'];ctx.moveTo(-cicon_size,-cicon_size);ctx.lineTo(cicon_size,cicon_size);ctx.moveTo(-cicon_size,-cicon_size);ctx.lineTo(-cicon_size,0);ctx.moveTo(-cicon_size,-cicon_size);ctx.lineTo(0,-cicon_size);ctx.moveTo(cicon_size,cicon_size);ctx.lineTo(cicon_size,0);ctx.moveTo(cicon_size,cicon_size);ctx.lineTo(0,cicon_size);ctx.stroke();}
ctx.restore();}
controls[ci]=rb;break;case'rotate':if(hasrotate&&!fixed){ctx.save();ctx.fillStyle=current_control==ci?activeFillStyle:fonticonprops[ci]['bg_color'];ctx.strokeStyle=strokeStyle;var ioffset=draw_control_circle(rt,objrotation,'rt',ci);if(fonticons){ctx.font=fonticonprops[ci]['size']+'px FlsObjectEditIcons';ctx.fillStyle=current_control==ci?activeIconColor:fonticonprops[ci]['color'];var text=fonticonprops[ci]['glyph'];ctx.fillText(text,fonticontextpos[ci]['x']+ioffset.x,fonticontextpos[ci]['y']+ioffset.y);}else{ctx.translate(ioffset.x,ioffset.y);ctx.beginPath();ctx.lineWidth=ilinewidth;ctx.strokeStyle=current_control==ci?activeIconColor:fonticonprops[ci]['color'];ctx.arc(0,0,controlSize-7.5,0.35*Math.PI,0);ctx.stroke();ctx.moveTo(controlSize-7.5,0);ctx.lineTo(controlSize-5,-9);ctx.moveTo(controlSize-7.5,0);ctx.lineTo(controlSize-16,-4);ctx.stroke();}
ctx.restore();}
controls[ci]=rt;break;case'delete':if(removable){ctx.save();ctx.fillStyle=current_control==ci?(fonticons&&fonticonprops[ci]['control_active_fill_color'])?activeFillStyle:'rgba(231, 35, 28,0.95)':fonticonprops[ci]['bg_color'];ctx.strokeStyle=strokeStyle;var ioffset=draw_control_circle(lt,objrotation,'lt',ci);if(fonticons){ctx.font=fonticonprops[ci]['size']+'px FlsObjectEditIcons';ctx.fillStyle=current_control==ci?activeIconColor:fonticonprops[ci]['color'];var text=fonticonprops[ci]['glyph'];ctx.fillText(text,fonticontextpos[ci]['x']+ioffset.x,fonticontextpos[ci]['y']+ioffset.y);}else{ctx.translate(ioffset.x,ioffset.y);ctx.beginPath();ctx.lineWidth=ilinewidth;ctx.strokeStyle=current_control==ci?activeIconColor:fonticonprops[ci]['color'];ctx.moveTo(-cicon_size,-cicon_size);ctx.lineTo(cicon_size,cicon_size);ctx.moveTo(cicon_size,-cicon_size);ctx.lineTo(-cicon_size,cicon_size);ctx.stroke();}
ctx.restore();}
controls[ci]=lt;break;case'textedit':if(hastextedit&&editable){ctx.save();ctx.fillStyle=current_control==ci?activeFillStyle:fonticonprops[ci]['bg_color'];ctx.strokeStyle=strokeStyle;var ioffset=draw_control_circle(lb,objrotation,'lb',ci);ctx.font=fonticons?fonticonprops[ci]['size']+'px FlsObjectEditIcons':'25px Georgia,serif';ctx.fillStyle=current_control==ci?activeIconColor:fonticonprops[ci]['color'];var text=fonticons?fonticonprops[ci]['glyph']:'T';ctx.fillText(text,fonticontextpos[ci]['x']+ioffset.x,fonticontextpos[ci]['y']+ioffset.y);ctx.restore();}
controls[ci]=lb;break;case'lock_unlock':if((!fixed||this.unlocked())&&unlockable){ctx.save();ctx.fillStyle=current_control==ci?activeFillStyle:fonticonprops[ci]['bg_color'];ctx.strokeStyle=(unlocked&&fonticonprops['unlock']['control_border_color'])?fonticonprops['unlock']['control_border_color']:strokeStyle;var ioffset=draw_control_circle(lb,objrotation,'lb',ci);if(fonticons){if(unlocked&&fonticonprops['unlock']['active_color']){activeIconColor=fonticonprops['unlock']['active_color'];}}
var icon=unlocked?fonticonprops['unlock']['glyph']:fonticonprops['lock']['glyph'];var alticon=unlocked?'U':'L';ctx.font=fonticons?fonticonprops[ci]['size']+'px FlsObjectEditIcons':'25px Georgia,serif';ctx.fillStyle=current_control==ci?activeIconColor:(unlocked?fonticonprops['unlock']['color']:fonticonprops[ci]['color']);var text=fonticons?icon:alticon;ctx.fillText(text,fonticontextpos[ci]['x']+ioffset.x,fonticontextpos[ci]['y']+ioffset.y);ctx.restore();}
controls[ci]=lb;break;}}
ctx.lineCap='butt';}}};this.setActive=function(active){if(typeof(active)!=='boolean'){active=true;}
isActive=active;if(!isActive){current_control='none';highlight=false;}};this.getActive=function(){return isActive;};this.pointInBbox=function(point){var extrpxl=isActive?bboxpad:0;var vpoint=this.editor().viewtopleft();var zoom=this.editor().zoom();extrpxl/=zoom;var istext=(this instanceof FLSEditorCore.CText)||this.stringdata;var _point={x:(point.x-vpoint.x)/zoom,y:(point.y-vpoint.y)/zoom};if(istext||isActive||(this.select_by_bbox===true)){_point=_transformPoint(_point);return(bboxpos.x-extrpxl<=_point.x)&&(size.width+bboxpos.x+extrpxl>=_point.x)&&(bboxpos.y-extrpxl<=_point.y)&&(size.height+bboxpos.y+extrpxl>=_point.y);}
return false;};this.containsPoint=function(point){if(!selectable)return false;var extrpxl=isActive?bboxpad:0;var vpoint=this.editor().viewtopleft();var zoom=this.editor().zoom();var _point={x:point.x-vpoint.x,y:point.y-vpoint.y};extrpxl/=zoom;var istext=this instanceof FLSEditorCore.CText;var isimg=this instanceof FLSEditorCore.CImage;if(istext||isActive){_point=_transformPoint(zoom!=1?FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],_point):_point);return(bboxpos.x-extrpxl<=_point.x)&&(size.width+bboxpos.x+extrpxl>=_point.x)&&(bboxpos.y-extrpxl<=_point.y)&&(size.height+bboxpos.y+extrpxl>=_point.y);}else{if(point.clickColor[3]>0){var ghostcvs=this.editor().ghostcanvas();var gctx=ghostcvs.getContext('2d');gctx.save();gctx.setTransform(1,0,0,1,0,0);gctx.clearRect(0,0,ghostcvs.width,ghostcvs.height);gctx.setTransform(zoom,0,0,zoom,vpoint.x,vpoint.y);this.render(gctx,gctx);var clr=gctx.getImageData(point.x,point.y,1,1).data;gctx.restore();var samecolor=(clr[0]==point.clickColor[0]&&clr[1]==point.clickColor[1]&&clr[2]==point.clickColor[2]&&clr[3]==point.clickColor[3]);return samecolor||(isimg?clr[3]>0:samecolor);}}};this.render=function(ctx,cctx,timedelta){console.log('this is the superclass of all objects. Nothing renders here.');};this.setPosition=function(x,y){x=parseFloat(x);y=parseFloat(y);if(!isNaN(x)&&!isNaN(y)){position.x=x;position.y=y;tmatrix[4]=x;tmatrix[5]=y;}else{console.log("Invald coordinates");}
updateMatrix();return position;};this.setPositionX=function(x){x=parseFloat(x);if(!isNaN(x)){position.x=x;tmatrix[4]=x;}else{console.log("Invald coordinates");}
updateMatrix();return position;};this.setPositionY=function(y){y=parseFloat(y);if(!isNaN(y)){position.y=y;tmatrix[5]=y;}else{console.log("Invald coordinates");}
updateMatrix();return position;};this.getPosition=function(){return{x:tmatrix[4],y:tmatrix[5]};};this.getSize=function(){return size;};this.setSize=function(width,height){width=parseFloat(width);height=parseFloat(height);if(!isNaN(width)&&!isNaN(height)){size.width=width;size.height=height;}else{console.log("Invald sizes");}
return size;};this.rotate=function(angle,deg){if(typeof(deg)!=='boolean'){deg=false;}
if(deg){angle=angle*DEG_TO_RAD;}
var c=Math.cos(angle);var s=Math.sin(angle);var m11=tmatrix[0]*c+tmatrix[1]*-s;var m12=tmatrix[0]*s+tmatrix[1]*c;var m21=tmatrix[2]*c+tmatrix[3]*-s;var m22=tmatrix[2]*s+tmatrix[3]*c;tmatrix[0]=m11;tmatrix[1]=m12;tmatrix[2]=m21;tmatrix[3]=m22;updateMatrix();};this.mrotate=function(from,to,origin){if(fixed||!hasrotate)return false;var pos=this.getPosition();var zoom=this.editor().zoom();FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],origin,true);origin.x+=pos.x;origin.y+=pos.y;var _pivot=use_pivot?{x:pivot.x+origin.x,y:pivot.y+origin.y}:origin;var angle=FLSUtil.lineAngleRad(_pivot,FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],from),FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],to));this.rotate(angle);};this.translate=function(dx,dy){tmatrix[4]+=tmatrix[0]*dx+tmatrix[2]*dy;tmatrix[5]+=tmatrix[1]*dx+tmatrix[3]*dy;position.x=tmatrix[4];position.y=tmatrix[5];updateMatrix();return tmatrix;};this.translateX=function(dx){return _this.translate(dx,0);};this.translateY=function(dy){return _this.translate(0,dy);};this.move=function(from,to){if(fixed)return false;var zoom=this.editor().zoom();var _from,_to,cfrom={x:from.x,y:from.y},cto={x:to.x,y:to.y};if(zoom!=1){FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],cfrom,true);FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],cto,true);}
_from=_transformPoint(cfrom);_to=_transformPoint(cto);if(this.stringdata&&this.parentGroup){var gmtrx=[1,0,0,1,0,0];FLSUtil.tmatrixScale(gmtrx,this.parentGroup.getScaleX(),this.parentGroup.getScaleY());FLSUtil.tmatrixRotate(gmtrx,-this.parentGroup.getRotation());FLSUtil.unTransformPoint(gmtrx,_from,true);FLSUtil.unTransformPoint(gmtrx,_to,true);}
var dx=_to.x-_from.x;var dy=_to.y-_from.y;this.translate(dx,dy);};this.scale=function(sx,sy){tmatrix[0]*=sx;tmatrix[1]*=sx;tmatrix[2]*=sy;tmatrix[3]*=sy;updateMatrix();return tmatrix;};this.scaleUniform=function(d){return _this.scale(d,d);};this.resetScale=function(){var tmpmtrx=[1,0,0,1,tmatrix[4],tmatrix[5]];FLSUtil.tmatrixRotate(tmpmtrx,-this.getRotation());this.setMatrix(tmpmtrx);};this.mscale=function(from,to,origin,restrict,up){if(fixed||!scalable)return false;if(typeof(restrict)!=='boolean')restrict=false;if(typeof(up)!=='boolean')up=true;var pos=this.getPosition();var zoom=this.editor().zoom();FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],origin,true);origin.x+=pos.x;origin.y+=pos.y;var _pivot=use_pivot?{x:pivot.x+origin.x,y:pivot.y+origin.y}:origin;var sizeold=FLSUtil.pointDistance(_pivot,FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],from));var sizenew=FLSUtil.pointDistance(_pivot,FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],to));var s=Math.abs(sizenew/sizeold);if(restrict&&((up&&s>1)||(!up&&s<1))){return false;}
this.scaleUniform(s);};this.getMatrix=function(){return tmatrix;};this.setMatrix=function(m){if(typeof(m)=='object'&&m.length==6){tmatrix[0]=m[0];tmatrix[1]=m[1];tmatrix[2]=m[2];tmatrix[3]=m[3];tmatrix[4]=m[4];tmatrix[5]=m[5];}
updateMatrix();return tmatrix;};this.inGroup=function(_ingroup){if(typeof(_ingroup)=='boolean'){inGroup=_ingroup;}
return inGroup;};this.removable=function(_removable){if(typeof(_removable)=='boolean'){removable=_removable;}
return removable;};this.hasrotate=function(_hasrotate){if(typeof(_hasrotate)=='boolean'){hasrotate=_hasrotate;}
return hasrotate;};this.scalable=function(_scalable){if(typeof(_scalable)=='boolean'){scalable=_scalable;}
return scalable;};this.selectable=function(_selectable){if(typeof(_selectable)=='boolean'){selectable=_selectable;}
return selectable;};this.fixed=function(_fixed){if(typeof(_fixed)=='boolean'){fixed=_fixed;}
return fixed;};this.editable=function(_editable){if(typeof(_editable)=='boolean'){editable=_editable;}
return editable;};this.hastextedit=function(_hastextedit){if(typeof(_hastextedit)=='boolean'){hastextedit=_hastextedit;if(hastextedit){controls['textedit']={x:0,y:0};}else{if(controls['textedit']){delete controls['textedit'];}}}
return hastextedit;};this.unlockable=function(_unlockable){if(typeof(_unlockable)=='boolean'){unlockable=_unlockable&&((this.hasStringPath==true)||(this instanceof FLSEditorCore.CTextCollection));if(unlockable){controls['lock_unlock']={x:0,y:0};}else{if(controls['lock_unlock']){delete controls['lock_unlock'];}}}
return unlockable;};this.unlocked=function(_unlocked){if(unlockable&&(typeof(_unlocked)=='boolean')){unlocked=_unlocked;}
return unlocked;};this.size=function(){return size;};this.calculateBoundingBox=function(){calculateBoundingBox();};this.use_pivot=function(set){if(typeof(set)!='boolean'){set=use_pivot;}
if(use_pivot===true){if(set===false){calculatePivotTransform(false);}else{}}else{if(set==true){calculatePivotTransform(true);}}
use_pivot=set;return use_pivot;};this.get_use_pivot=function(){return use_pivot;};this.whichControl=function(mousepos,mousepos2,only_corner_controls){var op='op:none';if(isActive){if(showControls){var tmp=editor.viewtopleft();for(var ci in controls){var cpos={x:controls[ci].x+tmp.x,y:controls[ci].y+tmp.y};if(FLSUtil.pointInCircle(cpos,controlSize,mousepos)){op='op:'+ci;break;}}}
if(typeof(only_corner_controls)!='boolean'){only_corner_controls=false;}
if(op=='op:none'){var check=only_corner_controls?this.pointInBbox(mousepos):this.containsPoint(mousepos);if(check){op='op:translate';}}}
current_control=op.replace('op:','');return op;};this.pivot=function(point){if(typeof(point)=='object'&&point!=null){pivot.x=point.x;pivot.y=point.y;}
return pivot;};this.center=function(point){if(typeof(point)=='object'&&point!=null){center.x=point.x;center.y=point.y;}
return center;};this.transformsApply=function(ctx){if(use_pivot===true){ctx.translate(pivot.x,pivot.y);ctx['transform'].apply(ctx,this.getMatrix());ctx.translate(-pivot.x,-pivot.y);}else{ctx['transform'].apply(ctx,this.getMatrix());}};this.getProperties=function(){var _tmatrix=[];_tmatrix[0]=tmatrix[0];_tmatrix[1]=tmatrix[1];_tmatrix[2]=tmatrix[2];_tmatrix[3]=tmatrix[3];_tmatrix[4]=tmatrix[4];_tmatrix[5]=tmatrix[5];return{tmatrix:_tmatrix};};this.setProperties=function(props){if(typeof(props.tmatrix)!='undefined'){this.setMatrix(props.tmatrix);}};this.objCenterReal=function(){var zoom=this.editor().zoom();var _pivot={x:center.x,y:center.y};_applyTransformMatrixToPoint(_pivot);if(zoom!=1){FLSUtil.transformPoint([zoom,0,0,zoom,0,0],_pivot,true);}
return _pivot;}
this.objCenter=function(corners){var zoom=this.editor().zoom();var _pivot={x:center.x,y:center.y};_applyTransformMatrixToPoint(_pivot);if(zoom!=1){FLSUtil.transformPoint([zoom,0,0,zoom,0,0],_pivot,true);}
_pivot.x=Math.round(_pivot.x);_pivot.y=Math.round(_pivot.y);var _bboxpad=bboxpad;if(corners instanceof Array){corners.length=0;var px=use_pivot?pivot.x:0,py=use_pivot?pivot.y:0;corners.push({x:(bboxpos.x-_bboxpad-px),y:(bboxpos.y-_bboxpad-py)});corners.push({x:(size.width+(bboxpos.x-px)+_bboxpad),y:(bboxpos.y-py)+(size.height)+_bboxpad});for(var i=0;i<corners.length;i++){_applyTransformMatrixToPoint(corners[i]);if(zoom!=1){FLSUtil.transformPoint([zoom,0,0,zoom,0,0],corners[i],true);}
corners[i]['x']=Math.round(corners[i]['x']);corners[i]['y']=Math.round(corners[i]['y']);}}
return _pivot;};this.bboxpad=function(padpx){if(!isNaN(padpx=parseFloat(padpx))){bboxpad=padpx;}
return bboxpad;};this.bboxpos=function(x,y){x=parseFloat(x);y=parseFloat(y);if(!isNaN(x)&&!isNaN(y)){bboxpos.x=x;bboxpos.y=y;}
return{x:bboxpos.x,y:bboxpos.y};};this.calcbbox=function(){return false;};this.transformPoint=function(point){return _transformPoint(point);};this.colorEditable=function(c_editable){if(typeof(c_editable)=='boolean'){colorEditable=c_editable;}
return colorEditable;};this.bboxCalculated=function(_calced){if(typeof(_calced)=='boolean'){bboxCalculated=_calced;}
return bboxCalculated;};this.applyDropShadow=function(ctx){if(use_shadow&&ctx){ctx.shadowColor=obj_shadow.color?obj_shadow.color:'rgb(0,0,0)';ctx.shadowBlur=obj_shadow.blur?obj_shadow.blur:0;ctx.shadowOffsetX=obj_shadow.offset_x?obj_shadow.offset_x:0;ctx.shadowOffsetY=obj_shadow.offset_y?obj_shadow.offset_y:0;}};this.setDropShadow=function(shadow_settings){if(typeof(shadow_settings)==='object'){var skip_color=false;for(var ss in shadow_settings){switch(ss){case'color':case'opacity':if(skip_color)break;var clr=shadow_settings.color?shadow_settings.color:(obj_shadow.color?obj_shadow.color:'rgb(0,0,0)');clr=FLSUtil.normalizeCssColor(clr);var sh_opacity=parseFloat(shadow_settings.opacity,10);sh_opacity=isNaN(sh_opacity)?1:(sh_opacity<0?0:sh_opacity);var rgb=FLSUtil.hexdec2rgb(clr.uint);obj_shadow.opacity=sh_opacity;if(sh_opacity<1){rgb.push(sh_opacity);clr='rgba('+rgb.join(',')+')';}else{clr='rgb('+rgb.join(',')+')';}
obj_shadow.color=clr;skip_color=true;break;case'offset':if(shadow_settings.offset instanceof Object){shadow_settings.offset.x=parseInt(shadow_settings.offset.x,10);shadow_settings.offset.y=parseInt(shadow_settings.offset.y,10);}else{var offset=parseInt(shadow_settings.offset.x,10);offset=isNaN(offset)?0:offset;shadow_settings.offset={x:offset,y:offset};}
obj_shadow.offset_x=isNaN(shadow_settings.offset.x)?0:shadow_settings.offset.x;obj_shadow.offset_y=isNaN(shadow_settings.offset.y)?0:shadow_settings.offset.y;break;case'blur':shadow_settings.blur=parseInt(shadow_settings.blur,10);obj_shadow.blur=isNaN(shadow_settings.blur)?0:shadow_settings.blur;break;}}}
return obj_shadow;};this.getDropShadow=function(){return obj_shadow;};this.use_shadow=function(use_sh){if(typeof(use_sh)==='boolean'){use_sh=(obj_shadow.blur||obj_shadow.offset_x||obj_shadow.offset_y)?use_sh:false;use_shadow=use_sh;}
return use_shadow;};this.applyTransformMatrixToPoint=function(point){_applyTransformMatrixToPoint(point);};this.kbscale=function(dir){if(fixed||!scalable)return false;var new_scale=1;switch(dir){case 1:new_scale+=FLSUtil.kbScaleStep;break;case-1:new_scale-=FLSUtil.kbScaleStep;break;default:dir=typeof dir==='number'?dir:0;new_scale+=FLSUtil.kbScaleStep*dir;}
this.use_pivot(true);this.scaleUniform(new_scale);this.use_pivot(false);};this.default_control_border_color=function(){return default_control_border_color;}
this.default_control_active_fill_color=function(){return default_control_active_fill_color;}
this.toSVG=function(svgparent){};this.setColor=function(){};this.getColor=function(){};this.setFillOpacity=function(){};this.getFillOpacity=function(){};this.setColorAllChild=function(){};this.setStroke=function(){};this.setStrokeWidth=function(){};this.getStroke=function(){return null;};this.getStrokeWidth=function(){return 0};this.mresize_x=function(){};this.mresize_y=function(){};this.mresize_xs=function(){};this.kbresize=function(){};this.mvertex_move=function(){};this.mpath_scale=function(){};};FLSEditorCore.CRect=function(x,y,w,h,brdr,fill){FLSEditorCore.CObject.apply(this,arguments);var border=brdr||null;var color=fill||'rgb(255,0,0)';var stroke_width=0;this.setPosition(x,y);this.setSize(w,h);this.pivot({x:w/2,y:h/2});this.center(this.pivot());this.render=function(ctx,cctx,timedelta){var sze=this.getSize();ctx.save();if(color){ctx.fillStyle=color;}
if(border){ctx.strokeStyle=border;}
ctx.lineWidth=stroke_width;this.transformsApply(ctx);ctx.fillRect(0,0,sze.width,sze.height);if(border){ctx.strokeRect(0,0,sze.width,sze.height);}
ctx.restore();this.drawControls(cctx);};this.getColor=function(){if(color=='rgba(0,0,0,0)'){return'rgb(255,255,255)';}
return color;};this.setColor=function(_color){if(typeof(_color)!='undefined'){color=['none','rgb(255,255,255)','rgb(100%,100%,100%)'].indexOf(_color)>-1&&this.id=='backgroundColor'?'rgba(0,0,0,0)':_color.toString().trim();if(color!='rgba(0,0,0,0)'){var _fill=FLSUtil.normalizeCssColor(_color);var rgb=FLSUtil.hexdec2rgb(_fill.uint);this.colorluma=Math.floor(FLSUtil.colorLuma(rgb));}else{this.colorluma=0;}}};this.setColorAllChild=function(){this.setColor.apply(this,arguments);}
this.toSVG=function(svgparent){var rn=document.createElementNS('http://www.w3.org/2000/svg','rect');var a=0;if(color&&color.indexOf('%')==-1){var rgb=color.replace(/rgb(a?)\(/,'').replace(')','').split(',');var r=(parseInt(rgb[0],10)*100/255).toFixed(6);var g=(parseInt(rgb[1],10)*100/255).toFixed(6);var b=(parseInt(rgb[2],10)*100/255).toFixed(6);if(rgb[3]){a=parseInt(rgb[3],10);if(!a)return'';}
color=a?color:'rgb('+r+'%,'+g+'%,'+b+'%)';}
var sze=this.getSize();rn.setAttribute('style','fill:'+(a?'none':color));rn.setAttribute('transform','matrix('+this.getMatrix().join(',')+')');rn.setAttribute('x',0);rn.setAttribute('y',0);rn.setAttribute('width',sze.width+'px');rn.setAttribute('height',sze.height+'px');if(typeof(this.id)!='undefined'&&this.id){rn.setAttribute('id',this.id);}
if(typeof(svgparent)!='undefined'){svgparent.appendChild(document.createTextNode('\n    '));svgparent.appendChild(rn);}
return rn;};this.setStroke=function(_borderclr){if(_borderclr){_borderclr=FLSUtil.normalizeCssColor(_borderclr);border=_borderclr.css;}};this.setStrokeWidth=function(_strkwidth){_strkwidth=parseInt(_strkwidth,10)
if(!isNaN(_strkwidth)){stroke_width=_strkwidth;}else{stroke_width=0;}};this.getProperties=function(){var _tmatrix=this.getMatrix().slice(0);var sz=this.getSize();return{tmatrix:_tmatrix,width:sz.width,height:sz.height,color:this.getColor()};};this.setProperties=function(props){if(typeof(props.tmatrix)!='undefined'){this.setMatrix(props.tmatrix);}
if(typeof(props.color)!='undefined'){this.setColor(props.color);}
if((typeof(props.width)!='undefined')&&(typeof(props.height)!='undefined')){var w=parseFloat(props.width,10);var h=parseFloat(props.height,10);if(!isNaN(w)&&!isNaN(h)){this.setSize(w,h);}}};};FLSEditorCore.CRect.prototype=new FLSEditorCore.CObject;FLSEditorCore.CLayoutZone=function(){FLSEditorCore.CRect.apply(this,arguments);var controls={'resize_x':{x:0,y:0},'resize_y':{x:0,y:0},'delete':{x:0,y:0},'resize_xs':{x:0,y:0}};var current_control='none';var controlSize=10;var min_zone_width=20;var min_zone_height=10;var _this=this;var setSize_org=this.setSize;this.align='left';this.vAlign='middle';this.setColor('rgba(255,0,0,0.5)');this.setStrokeWidth(1);this.bboxpad(0);this.hasrotate(false);this.colorEditable(false);this.removable(true);this.containsPoint=function(point){var extrpxl=this.getActive()?this.bboxpad():0;var vpoint=this.editor().viewtopleft();var zoom=this.editor().zoom();var _point={x:point.x-vpoint.x,y:point.y-vpoint.y};extrpxl/=zoom;var bboxpos=this.bboxpos();var size=this.getSize();if(this.getActive()){_point=this.transformPoint(zoom!=1?FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],_point):_point);return(bboxpos.x-extrpxl<=_point.x)&&(size.width+bboxpos.x+extrpxl>=_point.x)&&(bboxpos.y-extrpxl<=_point.y)&&(size.height+bboxpos.y+extrpxl>=_point.y);}else{if(point.clickColor[3]>0){var ghostcvs=this.editor().ghostcanvas();var gctx=ghostcvs.getContext('2d');gctx.save();gctx.setTransform(1,0,0,1,0,0);gctx.clearRect(0,0,ghostcvs.width,ghostcvs.height);gctx.setTransform(zoom,0,0,zoom,vpoint.x,vpoint.y);this.render(gctx,gctx);var clr=gctx.getImageData(point.x,point.y,1,1).data;gctx.restore();return clr[3]>0;}}};this.setSize=function(w,h){this.pivot({x:w/2,y:h/2});this.center(this.pivot());return setSize_org.apply(this,arguments);};this.drawControls=function(ctx){var highlight=this.highlight();var showControls=this.showControls();if(ctx){var use_pivot=this.use_pivot();var pivot=this.pivot();var bboxpad=this.bboxpad();var bboxpos=this.bboxpos();var size=this.getSize();var px=use_pivot?pivot.x:0,py=use_pivot?pivot.y:0,zoom=this.editor().zoom();var _bboxpad=bboxpad;var lt={x:(bboxpos.x-_bboxpad-px),y:(bboxpos.y-_bboxpad-py)};var rt={x:size.width+bboxpos.x-px+_bboxpad,y:bboxpos.y-py-_bboxpad};var rb={x:(size.width)+(bboxpos.x-px)+_bboxpad,y:(bboxpos.y-py)+(size.height)+_bboxpad};var lb={x:(bboxpos.x-px-_bboxpad),y:(bboxpos.y-py)+(size.height)+_bboxpad};this.applyTransformMatrixToPoint(lt);this.applyTransformMatrixToPoint(rt);this.applyTransformMatrixToPoint(rb);this.applyTransformMatrixToPoint(lb);lt.x+=px;lt.y+=py;rt.x+=px;rt.y+=py;rb.x+=px;rb.y+=py;lb.x+=px;lb.y+=py;if(zoom!=1){FLSUtil.transformPoint([zoom,0,0,zoom,0,0],lt,true);FLSUtil.transformPoint([zoom,0,0,zoom,0,0],rt,true);FLSUtil.transformPoint([zoom,0,0,zoom,0,0],rb,true);FLSUtil.transformPoint([zoom,0,0,zoom,0,0],lb,true);}
if(this.getActive()||highlight){if(highlight){ctx.strokeStyle='#006696';ctx.fillStyle='rgba(0,0,100,0.2)';}else{ctx.strokeStyle=current_control=='translate'?'#006696':'#000';}
ctx.lineWidth=0.5;ctx.beginPath();ctx.moveTo(lt.x,lt.y);ctx.lineTo(rt.x,rt.y);ctx.lineTo(rb.x,rb.y);ctx.lineTo(lb.x,lb.y);ctx.closePath();ctx.stroke();if(highlight){ctx.fill();}
if(showControls&&highlight===false){var cntrl_radius=controlSize/2;var ilinewidth=4.5;ctx.save();ctx.strokeStyle='rgb(255,255,255)';ctx.shadowColor='rgba(0,0,0,0.8)';ctx.shadowBlur=3;ctx.shadowOffsetX=1;ctx.shadowOffsetY=1;var objrotation=-_this.getRotation();ctx.lineCap='round';for(var ci in controls){switch(ci){case'resize_x':controls[ci]={x:rt.x,y:(rt.y+rb.y)/2};ctx.fillStyle=current_control==ci?'rgb(255,255,255)':'rgb(101,152,19)';break;case'resize_y':controls[ci]={x:(lb.x+rb.x)/2,y:rb.y};ctx.fillStyle=current_control==ci?'rgb(255,255,255)':'rgb(101,152,19)';break;case'delete':controls[ci]={x:lt.x+10,y:lt.y};ctx.fillStyle='rgb(255,0,0)';break;case'resize_xs':controls[ci]={x:lt.x,y:(rt.y+rb.y)/2};ctx.fillStyle=current_control==ci?'rgb(255,255,255)':'rgb(101,152,19)';break;}
ctx.beginPath();ctx.arc(controls[ci].x,controls[ci].y,cntrl_radius,0,2*Math.PI);ctx.closePath();ctx.fill();ctx.stroke();}
ctx.restore();}}else{ctx.save();ctx.strokeStyle='#000';ctx.lineWidth=0.5;ctx.beginPath();ctx.moveTo(lt.x,lt.y);ctx.lineTo(rt.x,rt.y);ctx.lineTo(rb.x,rb.y);ctx.lineTo(lb.x,lb.y);ctx.closePath();ctx.stroke();ctx.restore();}}};this.whichControl=function(mousepos,mousepos2){var op='op:none';if(this.getActive()){if(this.showControls()){var tmp=this.editor().viewtopleft();for(var ci in controls){var cpos={x:controls[ci].x+tmp.x,y:controls[ci].y+tmp.y};if(FLSUtil.pointInCircle(cpos,controlSize,mousepos)){op='op:'+ci;break;}}}
if(op=='op:none'){var check=this.containsPoint(mousepos);if(check){op='op:translate';}}}
current_control=op.replace('op:','');return op;};this.mresize_x=function(from,to,origin){var zoom=this.editor().zoom();var _to=FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],to);var _from=FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],from);var dx=_to.x-_from.x;var csize=_this.getSize();var new_width=csize.width+dx;new_width=new_width<min_zone_width?min_zone_width:new_width;this.setSize(new_width,csize.height);};this.mresize_xs=function(from,to,origin){var zoom=this.editor().zoom();var _to=FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],to);var _from=FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],from);var dx=_to.x-_from.x;var csize=_this.getSize();var new_width=csize.width-dx;if(new_width<=min_zone_width){new_width=min_zone_width;dx=0;}
this.setSize(new_width,csize.height);this.translateX(dx);};this.mresize_y=function(from,to,origin){var zoom=this.editor().zoom();var _to=FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],to);var _from=FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],from);var dy=_to.y-_from.y;var csize=_this.getSize();var new_height=csize.height+dy;new_height=new_height<min_zone_height?min_zone_height:new_height;this.setSize(csize.width,new_height);};this.kbresize=function(x,y,keep_right){if(typeof(keep_right)!=='boolean'){keep_right=false;}
x=parseFloat(x);y=parseFloat(y);x=isNaN(x)?0:x;y=isNaN(y)?0:y;var _x=keep_right?x*-1:x;var _y=keep_right?y*-1:y;var sz=this.getSize();var w=sz.width+_x;var h=sz.height+_y;if(w<min_zone_width){w=min_zone_width}
if(h<min_zone_height){h=min_zone_height}
if((keep_right==true)&&(w!=sz.width)){this.translateX(x);}
if((keep_right==true)&&(h!=sz.height)){this.translateY(y);}
this.setSize(w,h);};}
FLSEditorCore.CLayoutZone.prototype=new FLSEditorCore.CRect;FLSEditorCore.CText=function(str){FLSEditorCore.CObject.apply(this,arguments);var font_family='Helvetica';var fontsize=25;var fontstyle='';var color='rgb(0,0,0)';var stroke=null;var stroke_width=0;var text=str;var default_text='Enter Text';var _this=this;var mscale_org=this.mscale;var kbscale_org=this.kbscale;var minscale=7;var bold_font=false;var italic_font=false;updateMeasurements();this.xmlspace='preserve';this.applyScaleToFontSize=function(){var cscale=this.getScaleX();var fs=this.getFontSize();var new_fs=Math.round(fs*cscale);var mscl=this.minscale();if(new_fs<mscl){new_fs=mscl}
this.setFontSize(new_fs);this.scaleUniform(1/cscale);}
this.mscale=function(){if(this.restrict){var is_downscale=Math.min(arguments[1].x-arguments[0].x,arguments[1].y-arguments[0].y)<=0;var cscale=this.getScaleX()*fontsize;if(cscale<=minscale&&is_downscale){this.scaleUniform(minscale/cscale);return false;}}
return mscale_org.apply(this,arguments);};this.kbscale=function(dir){if(this.restrict){var is_downscale=dir<0
var cscale=this.getScaleX()*fontsize;if(cscale<=minscale&&is_downscale){this.scaleUniform(minscale/cscale);return false;}}
return kbscale_org.apply(this,arguments);};this.default_text=function(dstr){if(typeof(dstr)=='string'){default_text=dstr;}
return default_text;};this.editTextInline=function(){var vrtxt=document.createElement('input');vrtxt.type='text';vrtxt.style.position='absolute';vrtxt.style.visibility='none';var tp=this.getPosition();vrtxt.style.top=tp.y+'px';vrtxt.style.left=0;vrtxt.style.width=0;vrtxt.style.padding=0;vrtxt.value=text;var canvas=this.editor().getCanvasWrapper();canvas.appendChild(vrtxt);if(document.addEventListener){vrtxt.addEventListener('keypress',keyUpHandler,false);vrtxt.addEventListener('blur',function(){this.parentNode.removeChild(this);},false);}else if(document.attachEvent){vrtxt.attachEvent("onkeypress",keyUpHandler);vrtxt.addEventListener('onblur',function(){this.parentNode.removeChild(this);});}
vrtxt.focus();function keyUpHandler(event){var key=event.which;if(key==13){this.parentNode.removeChild(this);}else{text=this.value;updateMeasurements();}
return false;}};function updateMeasurements(){if(text){var tcvs=document.createElement('canvas');var ctx=tcvs.getContext('2d');ctx.font=fontstyle+' '+fontsize+'px '+font_family;ctx.fillStyle='#000';var txtmetrics=ctx.measureText(text);var twdth=Math.round(txtmetrics.width);var domtxtmetrics=FLSUtil.measureText(text,font_family,fontsize,bold_font,italic_font);_this.setSize(twdth,domtxtmetrics.pixel_height);_this.bboxpos(0,-domtxtmetrics.pixel_ascent);var pivot_y=-(domtxtmetrics['pixel_ascent']/2)+(domtxtmetrics.pixel_descent/2);_this.pivot({x:Math.floor((twdth)/2),y:Math.floor(pivot_y)});_this.center(_this.pivot());_this.pixel_height=domtxtmetrics.pixel_height;_this.pixel_ascent=domtxtmetrics.pixel_ascent;_this.descent=domtxtmetrics.pixel_descent;_this.ascent=domtxtmetrics.ascent;}else{_this.setSize(0,0);_this.pivot({x:0,y:0});_this.center(_this.pivot());_this.pixel_height=0;_this.pixel_ascent=0;_this.descent=0}}
this.render=function(ctx,cctx,timedelta){if(this.hide!==true){ctx.save();ctx.font=fontstyle+' '+fontsize+'px '+font_family;ctx.fillStyle=color;if(stroke){ctx.strokeStyle=stroke;if(stroke_width)ctx.lineWidth=stroke_width;}
this.applyDropShadow(ctx);this.transformsApply(ctx);ctx.fillText(this.for_preview&&text==default_text?'':text,0,0);if(stroke){ctx.strokeText(this.for_preview&&text==default_text?'':text,0,0);}
ctx.restore();}
if(text.length&&fontsize&&(this.draw_cntrl!==false)){this.drawControls(cctx);}};this.setText=function(str){text=str.replace(/[\x00-\x1f]/g,'');text=text.replace(/[\xAD]/g,'');if(this.alluppercase&&this.alllowercase){this.alllowercase=false;}
if(this.alluppercase){text=text.toUpperCase()}
if(this.alllowercase){text=text.toLowerCase()}
updateMeasurements();};this.getText=function(test_def){if(test_def){return text!=default_text?text:'';}
return text;};this.setFontFamily=function(ff){if(typeof(ff)=='string'&&this.editable()){font_family='"'+ff+'"';updateMeasurements();}};this.getFontFamily=function(){return font_family.replace(/"/ig,'');};this.setFontSize=function(fs){fs=parseFloat(fs);if(!isNaN(fs)&&this.editable()){fontsize=fs;updateMeasurements();}
return fontsize;};this.getFontSize=function(){return fontsize;};this.setFontStyle=function(){var fstyles=[];if(bold_font)fstyles.push('bold');if(italic_font)fstyles.push('italic');fontstyle=fstyles.join(' ');updateMeasurements();};this.getFontStyle=function(){var fstyles=[];if(bold_font)fstyles.push('bold');if(italic_font)fstyles.push('italic');fontstyle=fstyles.join(' ');return fontstyle;};this.bold=function(bold){if(typeof(bold)=='boolean'){bold_font=bold;this.setFontStyle();}
return bold_font;};this.italic=function(italic){if(typeof(italic)=='boolean'){italic_font=italic;this.setFontStyle();}
return italic_font;};this.setColor=function(_color){if(this.editable()&&_color){color=_color.toString().trim();var _fill=FLSUtil.normalizeCssColor(color);var rgb=FLSUtil.hexdec2rgb(_fill.uint);this.colorluma=Math.floor(FLSUtil.colorLuma(rgb));}};this.setColorAllChild=function(){this.setColor.apply(this,arguments)};this.getColor=function(){return color;};this.toSVG=function(svgparent){var tn=document.createElementNS('http://www.w3.org/2000/svg','text');if(color.indexOf('%')!=-1){var rgb=color.replace('rgb(','').replace(')','').replace(/%/ig,'').split(',');var r=(parseFloat(rgb[0],10)*2.55).toFixed(0);var g=(parseFloat(rgb[1],10)*2.55).toFixed(0);var b=(parseFloat(rgb[2],10)*2.55).toFixed(0);color='rgb('+r+','+g+','+b+')';}
var stroke_style=[];if(stroke){stroke_style.push('stroke:'+stroke);if(stroke_width)stroke_style.push('stroke-width:'+stroke_width);}
tn.setAttribute('style','fill:'+color+(stroke_style.length?';'+stroke_style.join(';'):''));tn.setAttribute('font-family',font_family.replace(/"/gi,''));tn.setAttribute('font-size',fontsize);tn.setAttribute('transform','matrix('+this.getMatrix().join(',')+')');if(this.bold()){tn.setAttribute('font-weight','bold');}
if(this.italic()){tn.setAttribute('font-style','italic');}
if(typeof(this.id)!='undefined'&&this.id){tn.setAttribute('id',this.id);}
tn.setAttribute('xml:space','preserve');if(typeof(this.logochild)!='undefined'&&this.logochild){tn.setAttribute('logochild',this.logochild);tn.setAttribute('type','logo');}
if(typeof(this.bcchild)!='undefined'&&this.bcchild){tn.setAttribute('type','bc');}
if(typeof(this.alluppercase)!='undefined'&&this.alluppercase){tn.setAttribute('data-alluppercase','1');}
if(typeof(this.alllowercase)!='undefined'&&this.alllowercase){tn.setAttribute('data-alllowercase','1');}
tn.appendChild(new DOMParser().parseFromString('<xml></xml>','application/xml').createCDATASection((text!=default_text||this.for_bc_tpl)?text:''));if(typeof(svgparent)!='undefined'){svgparent.appendChild(document.createTextNode('\n    '));svgparent.appendChild(tn);}
return tn;};this.getProperties=function(){var _tmatrix=[];var mtrx=_this.getMatrix();_tmatrix[0]=mtrx[0];_tmatrix[1]=mtrx[1];_tmatrix[2]=mtrx[2];_tmatrix[3]=mtrx[3];_tmatrix[4]=mtrx[4];_tmatrix[5]=mtrx[5];return{tmatrix:_tmatrix,color:color,text:text,default_text:default_text,fontsize:fontsize,stroke:stroke,stroke_width:stroke_width,font_family:_this.getFontFamily(),hastextedit:_this.hastextedit(),fonticons:_this.fonticons(),bold:_this.bold(),italic:_this.italic(),id:_this.id};};this.setProperties=function(props){var call_measurements=true;if(typeof(props.tmatrix)!='undefined'){this.setMatrix(props.tmatrix);}
if(typeof(props.color)!='undefined'){color=props.color;}
if(typeof(props.stroke)!='undefined'){stroke=props.stroke;}
if(typeof(props.stroke_width)!='undefined'){stroke_width=props.stroke_width;}
if(typeof(props.text)!='undefined'){text=props.text;}
if(typeof(props.fontsize)!='undefined'){fontsize=props.fontsize;}
if(typeof(props.bold)!='undefined'){bold_font=props.bold;}
if(typeof(props.italic)!='undefined'){italic_font=props.italic;}
if(typeof(props.hastextedit)!='undefined'){this.hastextedit(props.hastextedit);}
if(typeof(props.fonticons)!='undefined'){this.fonticons(props.fonticons);}
this.getFontStyle();if(typeof(props.font_family)!='undefined'){_this.setFontFamily(props.font_family);call_measurements=false;}
if(typeof(props.default_text)!='undefined'){_this.default_text(props.default_text);call_measurements=false;}
if(typeof(props.id)!='undefined'){_this.id=props.id;}
if(call_measurements)updateMeasurements();};this.minscale=function(newminscale){newminscale=parseFloat(newminscale);if(!isNaN(newminscale)){minscale=newminscale;}
return minscale;};this.updateMeasurements=function(){updateMeasurements();};this.setStroke=function(_borderclr){if(_borderclr){_borderclr=FLSUtil.normalizeCssColor(_borderclr);stroke=_borderclr.css;}else{stroke=null;}};this.setStrokeWidth=function(_strkwidth){_strkwidth=parseInt(_strkwidth,10)
if(!isNaN(_strkwidth)){stroke_width=_strkwidth;}else{stroke_width=0;}};this.getStroke=function(){return stroke;};this.getStrokeWidth=function(_strkwidth){return stroke_width=0;};this.has_path=function(){return false;};};FLSEditorCore.CText.prototype=new FLSEditorCore.CObject;FLSEditorCore.CMultiLineText=function(str){FLSEditorCore.CText.apply(this,arguments);var _this=this;var text_lines=[];var text_lines_props=[];var multiline_on=true;var multistyle_on=false;var multistyle_cfg=[];var max_lines=2;var line_spaceing=5;var fill_zone_width=false;var font_family='"'+this.getFontFamily()+'"';var fontsize=this.getFontSize();var fontstyle='';var color=this.getColor();var text=this.getText();var default_text=this.default_text();var stroke=null;var stroke_width=0;var setText_org=this.setText;var setFontFamily_org=this.setFontFamily;var setFontSize_org=this.setFontSize;var setFontStyle_org=this.setFontStyle;var setColor_org=this.setColor;var setStroke_org=this.setStroke;var setStrokeWidth_org=this.setStrokeWidth;var default_text_org=this.default_text;var updateMeasurements_org=this.updateMeasurements;var render_org=this.render;_fitText();function _fitText(){while(text_lines.length){text_lines.pop();text_lines_props.pop();}
if(multiline_on&&text){var words=_this.getText().split(' ');var full_line_words_cnt=Math.ceil(words.length/max_lines);var last_line_words_cnt=Math.floor(words.length/max_lines);var lidx=0;var ml_width=0;var ml_height=0;var ml_pixel_height=0;var extra_line_height=0;var last_line_descent=0;var tcvs=document.createElement('canvas');var tctx=tcvs.getContext('2d');tctx.font=fontstyle+' '+fontsize+'px '+font_family;tctx.fillStyle='#000';while(words.length){var wmax=words.length>=full_line_words_cnt?full_line_words_cnt:last_line_words_cnt;if(!(text_lines[lidx]instanceof Array)){text_lines[lidx]=[];}
for(var widx=0;widx<wmax;widx++){text_lines[lidx].push(words.shift());}
text_lines[lidx]=text_lines[lidx].join(' ').trim();if(text_lines[lidx].length){text_lines_props[lidx]=FLSUtil.measureText(text_lines[lidx],font_family,fontsize,_this.bold(),_this.italic());var txtmetrics=tctx.measureText(text_lines[lidx]);text_lines_props[lidx]['width']=Math.round(txtmetrics.width);text_lines_props[lidx]['dy']=lidx>0?(text_lines_props[lidx]['pixel_ascent']+text_lines_props[lidx-1]['pixel_descent']+line_spaceing):0;text_lines_props[lidx]['dx']=0;extra_line_height+=text_lines_props[lidx]['dy'];ml_width=ml_width<text_lines_props[lidx]['width']?text_lines_props[lidx]['width']:ml_width;last_line_descent=text_lines_props[lidx]['pixel_descent'];lidx++;}else{text_lines.pop();}}
if(fill_zone_width){extra_line_height=0;for(var m_idx=0;m_idx<text_lines_props.length;m_idx++){if(text_lines_props[m_idx].width<ml_width){text_lines_props[m_idx]['font_size']=fontsize*(ml_width/text_lines_props[m_idx].width);var new_props=FLSUtil.measureText(text_lines[m_idx],font_family,text_lines_props[m_idx]['font_size'],_this.bold(),_this.italic());for(var nprp_idx in new_props){text_lines_props[m_idx][nprp_idx]=new_props[nprp_idx];}}
text_lines_props[m_idx]['dy']=m_idx>0?(text_lines_props[m_idx]['pixel_ascent']+text_lines_props[m_idx-1]['pixel_descent']+line_spaceing):0;extra_line_height+=text_lines_props[m_idx]['dy'];last_line_descent=text_lines_props[m_idx]['pixel_descent'];}
for(var m_idx=0;m_idx<text_lines_props.length;m_idx++){ml_height+=text_lines_props[m_idx]['height'];ml_pixel_height+=text_lines_props[m_idx]['pixel_height'];}}else{for(var m_idx=0;m_idx<text_lines_props.length;m_idx++){ml_height+=text_lines_props[m_idx]['height'];ml_pixel_height+=text_lines_props[m_idx]['pixel_height'];if(text_lines_props[m_idx]['width']<ml_width){switch(_this.align_point){case'center':text_lines_props[m_idx]['dx']=text_lines_props[m_idx]['_dx']=(ml_width-text_lines_props[m_idx]['width'])/2;break;case'right':text_lines_props[m_idx]['dx']=text_lines_props[m_idx]['_dx']=ml_width-text_lines_props[m_idx]['width'];break;default:}}}}
ml_pixel_height+=(text_lines.length-1)*line_spaceing;extra_line_height+=last_line_descent;_this.setSize(ml_width,ml_pixel_height);_this.bboxpos(0,-text_lines_props[0].pixel_ascent);var pivot_y=-(text_lines_props[0]['pixel_ascent']/2)+(extra_line_height/2);_this.pivot({x:Math.floor((ml_width)/2),y:Math.floor(pivot_y)});_this.center(_this.pivot());_this.pixel_height=ml_pixel_height;_this.descent=text_lines_props[0].pixel_descent;_this.ascent=text_lines_props[0].ascent;_this.line1_fs=text_lines_props[0]['font_size']?text_lines_props[0]['font_size']:fontsize;_this.line1_pxh=text_lines_props[0]['pixel_height'];_this.line1_px_ascent=_this.pixel_ascent=text_lines_props[0]['pixel_ascent'];_this.extra_line_height=extra_line_height;_this.last_line_descent=last_line_descent;}else if(multistyle_on&&text&&multistyle_cfg.length){var ms_width=0;var ms_height=0;var ms_pixel_height=0;var ms_pixel_ascent=0;var ms_pixel_descent=0;var dx=0;var tcvs=document.createElement('canvas');var tctx=tcvs.getContext('2d');tctx.fillStyle='#000';for(var lidx=0;lidx<multistyle_cfg.length;lidx++){var _mcfg=multistyle_cfg[lidx];text_lines.push(_mcfg.text);var ff=_mcfg['font_family']?_mcfg['font_family']:font_family;var fs=_mcfg['font_size']?_mcfg['font_size']:fontsize;var bld=_mcfg['bold']?_mcfg['bold']:_this.bold();var itl=_mcfg['italic']?_mcfg['italic']:_this.italic();var _fstyl=[];if(bld){_fstyl.push('bold');}
if(itl){_fstyl.push('italic');}
text_lines_props[lidx]=FLSUtil.measureText(text_lines[lidx],ff,fontsize,bld,itl);text_lines_props[lidx]['fontstyle']=_fstyl.join(' ');text_lines_props[lidx]['dy']=0;text_lines_props[lidx]['dx']=0;text_lines_props[lidx]['font_family']=ff;tctx.font=text_lines_props[lidx]['fontstyle']+' '+fs+'px '+ff;var txtmetrics=tctx.measureText(text_lines[lidx]);text_lines_props[lidx]['width']=txtmetrics.width;if(_mcfg['color']){text_lines_props[lidx]['color']=_mcfg['color'];}
ms_width+=txtmetrics.width;text_lines_props[lidx]['dx']=dx;ms_height=Math.max(text_lines_props[lidx]['height'],ms_height);ms_pixel_height=Math.max(text_lines_props[lidx]['pixel_height'],ms_pixel_height);ms_pixel_ascent=Math.max(text_lines_props[lidx]['pixel_ascent'],ms_pixel_ascent);ms_pixel_descent=Math.max(text_lines_props[lidx]['pixel_descent'],ms_pixel_descent);dx+=text_lines_props[lidx]['width'];}
_this.setSize(ms_width,ms_pixel_height);_this.bboxpos(0,-ms_pixel_ascent);var pivot_y=-(ms_pixel_ascent/2)+(ms_pixel_descent/2);_this.pivot({x:Math.floor((ms_width)/2),y:Math.floor(pivot_y)});_this.center(_this.pivot());_this.pixel_height=ms_pixel_height;_this.descent=ms_pixel_descent;}else{updateMeasurements_org.apply(this,[]);}}
this.multiline_on=function(ml_on){if(typeof(ml_on)=='boolean'){multiline_on=ml_on;if(multiline_on==true){multistyle_on=false;}
_fitText();}
return multiline_on;};this.multistyle_on=function(ms_on){if(typeof(ms_on)=='boolean'){multistyle_on=ms_on;if(multistyle_on==true){multiline_on=false;}
_fitText();}
return multistyle_on;};this.fill_zone_width=function(fillw){if(typeof(fillw)=='boolean'){fill_zone_width=fillw;_fitText();}
return fill_zone_width;};this.max_lines=function(lncnt){lncnt=parseInt(lncnt,10);if(!isNaN(lncnt)&&(lncnt>0)&&(lncnt!=max_lines)){max_lines=lncnt;_fitText();}
return max_lines;};this.setText=function(){setText_org.apply(this,arguments);if((text!=this.getText())&&multistyle_on&&multistyle_cfg.length){while(text_lines.length){text_lines.pop()
text_lines_props.pop()}
while(multistyle_cfg.length){multistyle_cfg.pop()}
setFontFamily_org.apply(this,[font_family]);}
text=this.getText();_fitText();};this.setFontFamily=function(){setFontFamily_org.apply(this,arguments);font_family='"'+this.getFontFamily()+'"';if(multistyle_on&&multistyle_cfg.length){multistyle_cfg[0]['font_family']=font_family;}
_fitText();};this.setFontSize=function(){fontsize=setFontSize_org.apply(this,arguments);if(multistyle_on&&multistyle_cfg.length){multistyle_cfg[0]['font_size']=fontsize;}
_fitText();return fontsize};this.setColor=function(){setColor_org.apply(this,arguments);color=this.getColor();if(multistyle_on&&multistyle_cfg.length){multistyle_cfg[0]['color']=color;text_lines_props[0]['color']=color;}};this.setStroke=function(){setStroke_org.apply(this,arguments);stroke=this.getStroke();};this.setStrokeWidth=function(){setStrokeWidth_org.apply(this,arguments);stroke_width=this.getStrokeWidth();};this.setColorAllChild=function(){this.setColor.apply(this,arguments)};this.setFontStyle=function(){setFontStyle_org.apply(this,arguments);fontstyle=this.getFontStyle();_fitText();};this.default_text=function(dstr){default_text=default_text_org.apply(this,arguments);return default_text;};this.render=function(ctx,cctx,timedelta){if(multiline_on||(multistyle_on&&multistyle_cfg.length)){ctx.save();ctx.font=fontstyle+' '+fontsize+'px '+font_family;ctx.fillStyle=color;if(stroke){ctx.strokeStyle=stroke;if(stroke_width)ctx.lineWidth=stroke_width;}
this.applyDropShadow(ctx);this.transformsApply(ctx);for(var tlidx=0;tlidx<text_lines.length;tlidx++){ctx.translate(0,text_lines_props[tlidx]['dy']);ctx.save();ctx.translate(text_lines_props[tlidx]['dx'],0);if(multistyle_on){var fs=text_lines_props[tlidx]['font_size']?text_lines_props[tlidx]['font_size']:fontsize
var ff=text_lines_props[tlidx]['font_family']?text_lines_props[tlidx]['font_family']:font_family
ctx.font=text_lines_props[tlidx]['fontstyle']+' '+fs+'px '+ff;}else{if(text_lines_props[tlidx]['font_size']){ctx.font=fontstyle+' '+text_lines_props[tlidx]['font_size']+'px '+font_family;}}
if(text_lines_props[tlidx]['color']){ctx.fillStyle=text_lines_props[tlidx]['color'];}
ctx.fillText(this.for_preview&&text==default_text?'':text_lines[tlidx],0,0);if(stroke){ctx.strokeText(this.for_preview&&text==default_text?'':text_lines[tlidx],0,0);}
ctx.restore();}
ctx.restore();if(text.length&&fontsize){this.drawControls(cctx);}}else{render_org.apply(this,arguments);}};this.getProperties=function(){return{tmatrix:this.getMatrix().slice(0),color:color,text:this.getText(),default_text:default_text,fontsize:fontsize,font_family:this.getFontFamily(),hastextedit:this.hastextedit(),fonticons:this.fonticons(),bold:this.bold(),italic:this.italic(),multiline_on:multiline_on,multistyle_on:multistyle_on,max_lines:max_lines,fill_zone_width:fill_zone_width,align_point:this.align_point,line_spaceing:line_spaceing,id:this.id};};this.setProperties=function(props){var call_measurements=true;if(typeof(props.align_point)!='undefined'){this.align_point=props.align_point;}
if(typeof(props.tmatrix)!='undefined'){this.setMatrix(props.tmatrix);}
if(typeof(props.default_text)!='undefined'){this.default_text(props.default_text);}
if(typeof(props.text)!='undefined'){this.setText(props.text);call_measurements=false;}
if(typeof(props.fontsize)!='undefined'){this.setFontSize(props.fontsize);call_measurements=false;}
if(typeof(props.font_family)!='undefined'){this.setFontFamily(props.font_family);call_measurements=false;}
if(typeof(props.color)!='undefined'){this.setColor(props.color);}
if(typeof(props.hastextedit)!='undefined'){this.hastextedit(props.hastextedit);}
if(typeof(props.fonticons)!='undefined'){this.fonticons(props.fonticons);}
if(typeof(props.multiline_on)!='undefined'){this.multiline_on(props.multiline_on);}
if(typeof(props.max_lines)!='undefined'){this.max_lines(props.max_lines);}
if(typeof(props.fill_zone_width)!='undefined'){this.fill_zone_width(props.fill_zone_width);}
if(typeof(props.line_spaceing)!='undefined'){this.line_spaceing(props.line_spaceing);}
if(typeof(props.id)!='undefined'){_this.id=props.id;}
if(call_measurements)_fitText();};this.toSVG=function(svgparent){var tn=document.createElementNS('http://www.w3.org/2000/svg','text');if(color.indexOf('%')!=-1){var rgb=color.replace('rgb(','').replace(')','').replace(/%/ig,'').split(',');var r=(parseFloat(rgb[0],10)*2.55).toFixed(0);var g=(parseFloat(rgb[1],10)*2.55).toFixed(0);var b=(parseFloat(rgb[2],10)*2.55).toFixed(0);color='rgb('+r+','+g+','+b+')';}
var stroke_style=[];if(stroke){stroke_style.push('stroke:'+stroke);if(stroke_width)stroke_style.push('stroke-width:'+stroke_width);}
tn.setAttribute('style','fill:'+color+(stroke_style.length?';'+stroke_style.join(';'):''));tn.setAttribute('font-family',font_family.replace(/"/gi,''));tn.setAttribute('font-size',fontsize);tn.setAttribute('transform','matrix('+this.getMatrix().join(',')+')');if(this.bold()){tn.setAttribute('font-weight','bold');}
if(this.italic()){tn.setAttribute('font-style','italic');}
if(typeof(this.id)!='undefined'&&this.id){tn.setAttribute('id',this.id);}
tn.setAttribute('xml:space','preserve');if(typeof(this.logochild)!='undefined'&&this.logochild){tn.setAttribute('logochild',this.logochild);tn.setAttribute('type','logo');}
if(typeof(this.bcchild)!='undefined'&&this.bcchild){tn.setAttribute('type','bc');}
if(typeof(this.alluppercase)!='undefined'&&this.alluppercase){tn.setAttribute('data-alluppercase','1');}
if(typeof(this.alllowercase)!='undefined'&&this.alllowercase){tn.setAttribute('data-alllowercase','1');}
if(multiline_on||multistyle_on){if(text_lines.length){for(var ti=0;ti<text_lines.length;ti++){var tspn=document.createElementNS('http://www.w3.org/2000/svg','tspan');if(multiline_on){tspn.setAttribute('x',0);tspn.setAttribute('dx',text_lines_props[ti]['dx']);tspn.setAttribute('dy',text_lines_props[ti]['dy']);}
if(text_lines_props[ti]['font_size']){tspn.setAttribute('font-size',text_lines_props[ti]['font_size']);}
if(text_lines_props[ti]['font_family']){tspn.setAttribute('font-family',text_lines_props[ti]['font_family']);}
if(text_lines_props[ti]['color']){tspn.setAttribute('style','fill:'+text_lines_props[ti]['color']);}
tspn.appendChild(new DOMParser().parseFromString('<xml></xml>','application/xml').createCDATASection((text!=default_text||this.for_bc_tpl)?text_lines[ti]:''));tn.appendChild(tspn);}}else{tn.appendChild(new DOMParser().parseFromString('<xml></xml>','application/xml').createCDATASection((text!=default_text||this.for_bc_tpl)?text:''));}
if(multiline_on){tn.setAttribute('data-multiline_on','1');tn.setAttribute('data-original_string',this.getText());tn.setAttribute('data-max_lines',max_lines);}else if(multistyle_on&&multistyle_cfg.length){tn.setAttribute('data-multistyle_on','1');}
if(fill_zone_width){tn.setAttribute('data-fill_zone_width','1');}
if(this.align_point){tn.setAttribute('data-align_point',this.align_point);}}else{tn.appendChild(new DOMParser().parseFromString('<xml></xml>','application/xml').createCDATASection((text!=default_text||this.for_bc_tpl)?text:''));}
if(typeof(svgparent)!='undefined'){svgparent.appendChild(document.createTextNode('\n    '));svgparent.appendChild(tn);}
return tn;};this.updateMeasurements=function(){_fitText();};this.getTextLines=function(){var retval=[];if(multiline_on){for(var i=0;i<text_lines.length;i++){retval.push({text:text_lines[i],font_family:font_family,fontsize:text_lines_props[i]['font_size']?text_lines_props[i]['font_size']:fontsize,dy:text_lines_props[i]['dy'],dx:text_lines_props[i]['dx']});}}else{retval.push({text:this.getText(),font_family:font_family,fontsize:fontsize,dy:0,dx:0});}
return retval;};this.multistyle_cfg=function(ms_cfg){if(ms_cfg&&(ms_cfg instanceof Array)){while(multistyle_cfg.length){multistyle_cfg.pop();}
var _txt='';while(ms_cfg.length){var stly_row=ms_cfg.shift();_txt+=stly_row.text;multistyle_cfg.push(stly_row);}
text=_txt;setText_org.apply(this,[text]);setFontFamily_org.apply(this,[multistyle_cfg[0]['font_family']]);if(multistyle_cfg[0]['color']){setColor_org.apply(this,[multistyle_cfg[0]['color']]);color=this.getColor();}
_fitText();}
return multistyle_cfg.slice(0);};this.line_spaceing=function(n_ls){if(multiline_on){n_ls=parseInt(n_ls,10);if(!isNaN(n_ls)&&(n_ls>=5)&&(n_ls!=line_spaceing)){line_spaceing=n_ls;_fitText();}}
return line_spaceing;}};FLSEditorCore.CMultiLineText.prototype=new FLSEditorCore.CText;FLSEditorCore.CPath=function(){FLSEditorCore.CObject.apply(this,arguments);var fill=null;var fill_opacity=1;var stroke=null;var stroke_width=0;var stroke_cap=null;var stroke_miter=null;var stroke_join=null;var data='';var stroke_selected=false;var commands=[];var _this=this;function parseSvgPath(){if(!_this.stringdata&&(FLSUtil.Path2dAvailable()===true)){commands=new Path2D(data);commands.data=data;}else{SVGPath2Cnvs.parse(data,commands);}}
this.containsPoint=function(point){stroke_selected=false;if(!this.selectable())return false;var ghostcvs=this.editor().ghostcanvas();var gctx=ghostcvs.getContext('2d');var ingrp=this.inGroup();gctx.save();if(!ingrp){var vpoint=this.editor().viewtopleft();var zoom=this.editor().zoom();gctx.setTransform(zoom,0,0,zoom,vpoint.x,vpoint.y);}
this.transformsApply(gctx);var gotit=false;if(commands instanceof Path2D){gotit=gctx.isPointInPath(commands,point.x,point.y);if(stroke){if(!fill&&gotit){stroke_selected=true;}else if(!gotit){gotit=stroke_selected=gctx.isPointInStroke(commands,point.x,point.y);}}}else{gctx.beginPath();for(var i=0;i<commands.length;i++){gctx[commands[i]['func']].apply(gctx,commands[i]['args']);}
gotit=gctx.isPointInPath(point.x,point.y);if(stroke){if(!fill&&gotit){stroke_selected=true;}else if(!gotit){gotit=stroke_selected=gctx.isPointInStroke(point.x,point.y);}}}
gctx.restore();gotit=gotit?gotit:(this.stringdata?this.pointInBbox(point):gotit);var in_box=this.getActive()?this.pointInBbox(point):false;return ingrp?gotit:(gotit?gotit:in_box);};this.setFill=function(_fill){if(this.no_fill===true){return false;}
if(typeof(_fill)=='undefined'){_fill=null;}
if(_fill){if((_fill instanceof CanvasGradient)){this.fillIsGradient=true;fill=_fill;}else{if(!this.fillIsGradient){this.fillIsGradient=false;_fill=FLSUtil.normalizeCssColor(_fill);var rgb=FLSUtil.hexdec2rgb(_fill.uint);this.colorluma=Math.floor(FLSUtil.colorLuma(rgb));if(fill_opacity<1){rgb.push(fill_opacity);_fill='rgba('+rgb.join(',')+')';}else{_fill=_fill.css;}}}}
if(!this.fillIsGradient){if(stroke&&stroke_selected){stroke=_fill?_fill.toString().trim():stroke;}else{fill=_fill?_fill.toString().trim():null;}}};this.setFillOpacity=function(_fill_opacity){_fill_opacity=parseFloat(_fill_opacity,10);var opacity_from_param=false;if(!isNaN(_fill_opacity)){if((_fill_opacity>=0)&&(_fill_opacity<=1)){opacity_from_param=true;}else{_fill_opacity=1;}}else{_fill_opacity=0;}
fill_opacity=(_fill_opacity||opacity_from_param)?_fill_opacity:fill_opacity;if(fill){var color_info=FLSUtil.normalizeCssColor(fill);var rgb=FLSUtil.hexdec2rgb(color_info.uint);if(fill_opacity<1){rgb.push(fill_opacity);}
fill=(fill_opacity<1?'rgba(':'rgb(')+rgb.join(',')+')';}};this.getFillOpacity=function(){return fill_opacity;};this.setColor=function(_fill){this.setFill(_fill);};this.setColorAllChild=function(_fill){this.setFill(_fill);};this.getFill=function(){if(fill&&!(fill instanceof CanvasGradient)){var color_info=FLSUtil.normalizeCssColor(fill);var rgb=FLSUtil.hexdec2rgb(color_info.uint);return'rgb('+rgb.join(',')+')';}
return fill;};this.getColor=function(){return this.getFill();};this.setStroke=function(_storke){if(typeof(_storke)=='undefined'){_storke=null;}
stroke=_storke;};this.setStrokeWidth=function(_storke_width){if(typeof(_storke_width)=='undefined'){_storke_width=0;}
stroke_width=_storke_width;};this.setStrokeCap=function(_storke_cap){if(typeof(_storke_cap)=='undefined'){_storke_cap=null;}
stroke_cap=_storke_cap;};this.setStrokeMieter=function(_stroke_miter){if(typeof(_stroke_miter)=='undefined'){_stroke_miter=null;}
stroke_miter=_stroke_miter;};this.setStrokeJoin=function(_stroke_join){if(typeof(_stroke_join)=='undefined'){_stroke_join=null;}
stroke_join=_stroke_join;};this.setPathStr=function(svgpath){data=svgpath;parseSvgPath();};this.render=function(ctx,cctx,timedelta){if(!commands.length&&!(commands instanceof Path2d))return false;ctx.save();if(fill)ctx.fillStyle=fill;if(stroke)ctx.strokeStyle=stroke;if(stroke_width)ctx.lineWidth=stroke_width;if(stroke_cap)ctx.lineCap=stroke_cap;if(stroke_miter)ctx.miterLimit=stroke_miter;if(stroke_join)ctx.lineJoin=stroke_join;this.transformsApply(ctx);if(commands instanceof Path2D){if(fill)ctx.fill(commands,'evenodd');if(stroke)ctx.stroke(commands);}else{ctx.beginPath();for(var i=0;i<commands.length;i++){try{ctx[commands[i]['func']].apply(ctx,commands[i]['args']);}catch(e){}}
if(fill)ctx.fill('evenodd');if(stroke)ctx.stroke();}
ctx.restore();if(!this.inGroup()||this.parentGroup.unlocked()){this.drawControls(cctx);}};this.getRenderData=function(){return{commands:commands,fill:fill,stroke:stroke,stroke_width:stroke_width,stroke_cap:stroke_cap,stroke_miter:stroke_miter,stroke_join:stroke_join};};this.toSVG=function(svgparent){var pn=document.createElementNS('http://www.w3.org/2000/svg','path');var color=fill;if(fill instanceof CanvasGradient){color='url(#'+this.gradientId+')';}else{if(fill&&fill.indexOf('%')==-1){var color_info=FLSUtil.normalizeCssColor(fill);var rgb=FLSUtil.hexdec2rgb(color_info.uint);var r=(rgb[0]*100/255).toFixed(6);var g=(rgb[1]*100/255).toFixed(6);var b=(rgb[2]*100/255).toFixed(6);color='rgb('+r+'%,'+g+'%,'+b+'%)';}}
var stroke_style=[];if(stroke_width)stroke_style.push('stroke-width:'+stroke_width);if(stroke_width)stroke_style.push('stroke-opacity:1');if(stroke_cap)stroke_style.push('stroke-linecap:'+stroke_cap);if(stroke_join)stroke_style.push('stroke-linejoin:'+stroke_join);if(stroke_miter)stroke_style.push('stroke-miterlimit:'+stroke_miter);pn.setAttribute('style','stroke:'+(stroke?stroke:'none')+';fill-rule:evenodd;fill:'+(color?color:'none')+';fill-opacity:'+fill_opacity+(stroke_style.length?';'+stroke_style.join(';'):''));pn.setAttribute('d',data);if(typeof(svgparent)!='undefined'){svgparent.appendChild(document.createTextNode('\n    '));svgparent.appendChild(pn);}
var mtrx=this.getMatrix();var identity=(mtrx[0]==1&&mtrx[1]==0&&mtrx[2]==0&&mtrx[3]==1&&mtrx[4]==0&&mtrx[5]==0);if(!identity){pn.setAttribute('transform','matrix('+mtrx.join(',')+')');}
if(this.stringdata){if((typeof(this.stringdata.color)!='undefined')&&!this.fillIsGradient){this.stringdata.color=color;}
for(var sdidx in this.stringdata){pn.setAttribute('data-str-'+sdidx,this.stringdata[sdidx]);}}
if(this.lyt_name){pn.setAttribute('data-lyt_name',this.lyt_name.toString());}
return pn;};this.getProperties=function(){return{fill:this.getFill(),fill_opacity:fill_opacity,stroke:stroke,stroke_width:stroke_width,stroke_cap:stroke_cap,stroke_miter:stroke_miter,stroke_join:stroke_join,data:data,tmatrix:JSON.parse(JSON.stringify(this.getMatrix())),stringdata:this.stringdata?this.stringdata:false};};this.setProperties=function(props){if(props){this.setFillOpacity(props.fill_opacity);this.setFill(props.fill);this.setStroke(props.stroke);this.setStrokeWidth(props.stroke_width);this.setStrokeCap(props.stroke_cap);this.setStrokeMieter(props.stroke_miter);this.setStrokeJoin(props.stroke_join);this.setPathStr(props.data);if(typeof(props.tmatrix)!='undefined'){this.setMatrix(props.tmatrix);}
if(typeof(props.stringdata)!='undefined'){this.stringdata=props.stringdata;}}};this.calcbbox=function(){if(!this.inGroup()){return true;}
return false;};this.calculateBoundingBox=function(){if(data.length&&commands.length){var lb_corners=SVGPath2Cnvs.bbox(commands);var width=lb_corners.x1-lb_corners.x0;var height=lb_corners.y1-lb_corners.y0;this.setSize(width,height);this.bboxpos(lb_corners.x0,lb_corners.y0);var pvt={x:Math.floor(lb_corners.x0+width/2),y:Math.floor(lb_corners.y0+height/2)};this.pivot(pvt);this.center(this.pivot());}};this.isEmpty=function(){return commands.length==0;}};FLSEditorCore.CPath.prototype=new FLSEditorCore.CObject;FLSEditorCore.CPathGroup=function(){FLSEditorCore.CObject.apply(this,arguments);var _this=this;var curpath=null;var move_org=this.move;var translate_org=this.translate;var paths=[];this.calculateBoundingBox=function(){if(paths.length&&!this.bboxCalculated()){var gmtrx=this.inGroup()?this.getMatrix().slice(0):[1,0,0,1,0,0];var pmtrx=paths[0].getMatrix().slice(0);var rd=paths[0].getRenderData();var bb=SVGPath2Cnvs.bbox(rd.commands,pmtrx);var lt={x:bb.x0,y:bb.y0};var rb={x:bb.x1,y:bb.y1};var gbb={x0:Math.min(lt.x,rb.x),y0:Math.min(lt.y,rb.y),x1:Math.max(lt.x,rb.x),y1:Math.max(lt.y,rb.y)};for(var i=1;i<paths.length;i++){pmtrx=paths[i].getMatrix().slice(0);rd=paths[i].getRenderData();bb=SVGPath2Cnvs.bbox(rd.commands,pmtrx);lt={x:bb.x0,y:bb.y0};rb={x:bb.x1,y:bb.y1};if((bb.x0!=bb.x1)||(bb.y0!=bb.y1)){gbb.x0=Math.min(gbb.x0,lt.x,rb.x);gbb.y0=Math.min(gbb.y0,lt.y,rb.y);gbb.x1=Math.max(gbb.x1,lt.x,rb.x);gbb.y1=Math.max(gbb.y1,lt.y,rb.y);}}
var tmp_coord={x:gbb.x0,y:gbb.y0};FLSUtil.transformPoint(gmtrx,tmp_coord,true);gbb.x0=tmp_coord.x;gbb.y0=tmp_coord.y;tmp_coord={x:gbb.x1,y:gbb.y1};FLSUtil.transformPoint(gmtrx,tmp_coord,true);gbb.x1=tmp_coord.x;gbb.y1=tmp_coord.y;var width=gbb.x1-gbb.x0;var height=gbb.y1-gbb.y0;this.setSize(width,height);this.bboxpos(gbb.x0,gbb.y0);var pvt={x:Math.floor(gbb.x0+width/2),y:Math.floor(gbb.y0+height/2)};this.pivot(pvt);this.center(this.pivot());}
if(!paths.length){this.setSize(0,0);}};this.containsPoint=function(point){if(!this.selectable())return false;var candidates=[];var found=false;if((point.clickColor[3]>0)||this.hasStringPath){var ghostcvs=this.editor().ghostcanvas();var gctx=ghostcvs.getContext('2d');var vpoint=this.editor().viewtopleft();var zoom=this.editor().zoom();gctx.save();gctx.setTransform(zoom,0,0,zoom,vpoint.x,vpoint.y);this.transformsApply(gctx);for(var i=paths.length-1;i>=0;i--){if(paths[i].containsPoint(point)){candidates.push(paths[i]);break;}}
gctx.restore();}
if(candidates.length){found=true;curpath=candidates[candidates.length-1];}
return found===true?true:_this.pointInBbox(point);};this.addPath=function(CpathObj,force_parent){if(typeof(force_parent)!=='boolean'){force_parent=false;}
if(CpathObj instanceof FLSEditorCore.CPath){paths.push(CpathObj);CpathObj.inGroup(true);if(!CpathObj.parentGroup||force_parent){CpathObj.parentGroup=this;}
curpath=curpath?curpath:CpathObj;}
return CpathObj;};this.render=function(ctx,cctx,timedelta,notransform){if(typeof(notransform)!=='boolean'){notransform=false;}
ctx.save();if(notransform){ctx.setTransform(1,0,0,1,0,0);}else{this.transformsApply(ctx);this.applyDropShadow(ctx);}
for(var pi=0;pi<paths.length;pi++){var rdata=paths[pi].getRenderData();ctx.save();ctx['transform'].apply(ctx,paths[pi].getMatrix());if(rdata.fill)ctx.fillStyle=rdata.fill;if(rdata.stroke)ctx.strokeStyle=rdata.stroke;if(rdata.stroke_width)ctx.lineWidth=rdata.stroke_width;if(rdata.stroke_cap)ctx.lineCap=rdata.stroke_cap;if(rdata.stroke_miter)ctx.miterLimit=rdata.stroke_miter;if(rdata.stroke_join)ctx.lineJoin=rdata.stroke_join;if(rdata.commands instanceof Path2D){if(rdata.fill)ctx.fill(rdata.commands,'evenodd');if(rdata.stroke)ctx.stroke(rdata.commands);}else{ctx.beginPath();for(var i=0;i<rdata.commands.length;i++){try{ctx[rdata.commands[i]['func']].apply(ctx,rdata.commands[i]['args']);}catch(e){}}
if(rdata.fill)ctx.fill('evenodd');if(rdata.stroke)ctx.stroke();}
ctx.restore();if(paths[pi].getActive()){paths[pi].drawControls(cctx);}}
ctx.restore();if(!notransform){this.drawControls(cctx);}};this.toSVG=function(svgparent){svgparent.setAttribute('transform','matrix('+this.getMatrix().join(',')+')');if(this.tpl_matrix&&(this.tpl_matrix instanceof Array)&&(this.tpl_matrix.length==6)){svgparent.setAttribute('data-tpl_matrix',this.tpl_matrix.join(','));}
if(typeof(this.bcchild)!='undefined'&&this.bcchild){svgparent.setAttribute('type','bc');}
if(typeof(this.datachoice)!='undefined'&&this.datachoice){svgparent.setAttribute('data-choice',this.datachoice.toString());}
for(var i in paths){paths[i].toSVG(svgparent);}
var _size=this.getSize();var _bbpos=this.bboxpos();var _cntr=this.center();var _pvt=this.pivot();svgparent.setAttribute('data-size',_size.width+' '+_size.height);svgparent.setAttribute('data-bboxpos',_bbpos.x+' '+_bbpos.y);svgparent.setAttribute('data-center',_cntr.x+' '+_cntr.y);svgparent.setAttribute('data-pivot',_pvt.x+' '+_pvt.y);return svgparent;};this.setColor=function(fill){if(curpath instanceof FLSEditorCore.CPath){curpath.setFill(fill);}};this.setColorAllChild=function(color){if(this.colorEditable()){for(var i=0;i<paths.length;i++)
paths[i].setColor(color);}};this.getColor=function(){if(curpath instanceof FLSEditorCore.CPath){return curpath.getFill();}};this.getCurrentPath=function(){return curpath?curpath:paths[0];};this.setCurrentPath=function(path){var i=paths.indexOf(path);if(i>-1)curpath=paths[i];};this.getPaths=function(){return paths;};this.getProperties=function(){var _tmatrix=[];var mtrx=_this.getMatrix();_tmatrix[0]=mtrx[0];_tmatrix[1]=mtrx[1];_tmatrix[2]=mtrx[2];_tmatrix[3]=mtrx[3];_tmatrix[4]=mtrx[4];_tmatrix[5]=mtrx[5];return{tmatrix:_tmatrix,color:_this.getColor(),path_idx:paths.indexOf(curpath)};};this.setProperties=function(props){if(typeof(props.tmatrix)!='undefined'){this.setMatrix(props.tmatrix);}
if(typeof(props.color)!='undefined'&&typeof(props.path_idx)!='undefined'){paths[props.path_idx].setFill(props.color);}};this.calcbbox=function(){return true;};this.move=function(){if(this.unlocked()&&curpath.stringdata){curpath.move.apply(curpath,arguments);}else{move_org.apply(this,arguments);}};this.translate=function(){if(this.unlocked()&&curpath.stringdata){curpath.translate.apply(curpath,arguments);}else{translate_org.apply(this,arguments);}}};FLSEditorCore.CPathGroup.prototype=new FLSEditorCore.CObject;FLSEditorCore.CLogoObjectGroup=function(){FLSEditorCore.CObject.apply(this,arguments);var _this=this;var curobj=null;var elements=[];var mscale_org=this.mscale;var minscale=0;this.calculateBoundingBox=function(){if(elements.length&&!this.bboxCalculated()){var found_first_valid_obj=false;var gbb={x0:0,y0:0,x1:0,y1:0};var trnsfrm_applyed,el_tl,el_sz,lt,rb,rt,lb,emtrx;for(var i=0;i<elements.length;i++){trnsfrm_applyed=false;if(elements[i]instanceof FLSEditorCore.CPathGroup){elements[i].calculateBoundingBox();trnsfrm_applyed=true;}
el_tl=elements[i].bboxpos();el_sz=elements[i].getSize();if((el_sz.width==0)||(el_sz.height==0))continue;lt={x:el_tl.x,y:el_tl.y};rb={x:lt.x+el_sz.width,y:lt.y+el_sz.height};rt={x:rb.x,y:lt.y};lb={x:lt.x,y:rb.y};if(!trnsfrm_applyed){emtrx=elements[i].getMatrix();FLSUtil.transformPoint(emtrx,lt,true);FLSUtil.transformPoint(emtrx,rb,true);FLSUtil.transformPoint(emtrx,rt,true);FLSUtil.transformPoint(emtrx,lb,true);}
var xs=[lt.x,rb.x,rt.x,lb.x];var ys=[lt.y,rb.y,rt.y,lb.y];gbb.x0=Math.min.apply(null,(found_first_valid_obj?[gbb.x0]:[]).concat(xs));gbb.y0=Math.min.apply(null,(found_first_valid_obj?[gbb.y0]:[]).concat(ys));gbb.x1=Math.max.apply(null,(found_first_valid_obj?[gbb.x1]:[]).concat(xs));gbb.y1=Math.max.apply(null,(found_first_valid_obj?[gbb.y1]:[]).concat(ys));found_first_valid_obj=true;}
var bbpos={x:Math.round(gbb.x0),y:Math.round(gbb.y0)};var width=Math.round(gbb.x1)-bbpos.x;var height=Math.round(gbb.y1)-bbpos.y;this.setSize(width,height);this.bboxpos(bbpos.x,bbpos.y);var pvt={x:Math.floor(bbpos.x+width/2),y:Math.floor(bbpos.y+height/2)};this.pivot(pvt);this.center(_this.pivot());}};this.addElement=function(_element){if(_element instanceof FLSEditorCore.CObject){elements.push(_element);_element.inGroup(true);return _element;}
return false;};this.clearElements=function(){var mymtrx=this.getMatrix();while(elements.length){var element=elements.pop();var elm_matrix=element.getMatrix();element.inGroup(false);element.setMatrix(FLSUtil.tmatrixMultiply(elm_matrix,mymtrx.slice(0)));element.calculateBoundingBox();}}
this.containsPoint=function(point){if(!this.selectable())return false;var found=false;var zoom=this.editor().zoom();var vpoint=this.editor().viewtopleft();var _point={x:point.x-vpoint.x,y:point.y-vpoint.y};FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],_point,true);FLSUtil.unTransformPoint(this.getMatrix(),_point,true);for(var i=elements.length-1;i>=0;i--){if(elements[i]instanceof FLSEditorCore.CText){var __point=FLSUtil.unTransformPoint(elements[i].getMatrix(),_point);var ts=elements[i].getSize();var bbps=elements[i].bboxpos();var lt={x:bbps.x,y:bbps.y};var rb={x:bbps.x+ts.width,y:bbps.y+ts.height};if((lt.x<=__point.x)&&((rb.x)>=__point.x)&&(lt.y<=__point.y)&&(rb.y>=__point.y)){curobj=elements[i];found=true;break;}}else{if(elements[i]instanceof FLSEditorCore.CPathGroup&&point.clickColor[3]>0){var candidates=[];var ghostcvs=this.editor().ghostcanvas();var gctx=ghostcvs.getContext('2d');gctx.save();gctx.setTransform(zoom,0,0,zoom,vpoint.x,vpoint.y);this.transformsApply(gctx);elements[i].transformsApply(gctx);var paths=elements[i].getPaths();for(var pi=paths.length-1;pi>=0;pi--){if(paths[pi].containsPoint(point)){candidates.push(paths[pi]);break;}}
gctx.restore();if(candidates.length){found=true;curobj=elements[i];curobj.setCurrentPath(candidates[candidates.length-1]);break;}}}}
return found===true?true:this.pointInBbox(point);};this.pointInBbox=function(point){var actv=this.getActive();if(actv||(this.select_by_bbox===true)){var sz=this.getSize();var bbpos=this.bboxpos();var zoom=this.editor().zoom();var extrapx=this.bboxpad();var vpoint=this.editor().viewtopleft();var _point={x:point.x-vpoint.x,y:point.y-vpoint.y};FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],_point,true);FLSUtil.unTransformPoint(this.getMatrix(),_point,true);return(_point.x>=(bbpos.x-extrapx))&&(_point.x<=(bbpos.x+sz.width+extrapx))&&(_point.y>=(bbpos.y-extrapx))&&(_point.y<=(bbpos.y+sz.height+extrapx));}
return false;};this.render=function(ctx,cctx,timedelta,notransform){if(typeof(notransform)!=='boolean'){notransform=false;}
ctx.save();if(notransform){ctx.setTransform(1,0,0,1,0,0);}else{this.transformsApply(ctx);}
for(var pi=0;pi<elements.length;pi++){elements[pi].render(ctx,cctx,timedelta);}
ctx.restore();if(!notransform){this.drawControls(cctx);}};this.toSVG=function(svgparent){svgparent.setAttribute('transform','matrix('+this.getMatrix().join(',')+')');if(typeof(this.id)!=='undefined'){svgparent.setAttribute('id',this.id);}
if(typeof(this.bcchild)!='undefined'&&this.bcchild){svgparent.setAttribute('type','bc');}
if(typeof(this.logoid)!='undefined'&&this.logoid){svgparent.setAttribute('data-logoid',this.logoid);}
var textlayer=document.createElementNS('http://www.w3.org/2000/svg','g');var logolayer=document.createElementNS('http://www.w3.org/2000/svg','g');logolayer.setAttribute('id','surface2');textlayer.setAttribute('id','surface4');for(var i in elements){if(elements[i]instanceof FLSEditorCore.CPathGroup){elements[i].toSVG(logolayer);}
if(elements[i]instanceof FLSEditorCore.CText){if(elements[i].getText().trim().length){elements[i].toSVG(textlayer);}}}
svgparent.appendChild(logolayer);svgparent.appendChild(document.createTextNode('\n  '));svgparent.appendChild(textlayer);svgparent.appendChild(document.createTextNode('\n'));return svgparent;};this.calcbbox=function(){return true;};this.getElements=function(){return elements;};this.mscale=function(){if(this.fixed())return false;if(minscale){var cscale=this.getScaleX();var is_downscale=Math.min(arguments[1].x-arguments[0].x,arguments[1].y-arguments[0].y)<=0;if(cscale<=minscale&&is_downscale){this.scaleUniform(minscale/cscale);return false;}}
return mscale_org.apply(this,arguments);};this.minscale=function(newminscale){newminscale=parseFloat(newminscale);if(!isNaN(newminscale)){minscale=newminscale;}
return minscale;};this.getColor=function(){if(curobj)return curobj.getColor();};this.setColor=function(color){if(curobj)return curobj.setColor(color);};this.setColorAllChild=function(color){if(this.colorEditable()){for(var i=0;i<elements.length;i++)
elements[i].setColorAllChild(color);}};this.getCurrentPath=function(){if(curobj instanceof FLSEditorCore.CPathGroup){return curobj.getCurrentPath();}
return curobj;};this.strokeTexts=function(_stroke){for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CText){elements[i].setStroke(_stroke);elements[i].setStrokeWidth(_stroke?1:0);}else if((elements[i]instanceof FLSEditorCore.CPathGroup)&&elements[i].hasStringPath){var pg_paths=elements[i].getPaths();for(var j=0;j<pg_paths.length;j++){if(pg_paths[j].stringdata){pg_paths[j].setStroke(_stroke);pg_paths[j].setStrokeWidth(_stroke?1:0);}}}}};this.strokePaths=function(_stroke){for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CPathGroup){var pg_paths=elements[i].getPaths();for(var j=0;j<pg_paths.length;j++){pg_paths[j].setStroke(_stroke);pg_paths[j].setStrokeWidth(_stroke?1:0);}}}};};FLSEditorCore.CLogoObjectGroup.prototype=new FLSEditorCore.CObject;FLSEditorCore.CImage=function(src){FLSEditorCore.CObject.apply(this,arguments);var loadingstr='.';var loadingstridx=0;var is_new=false;var is_asset=false;var asset_info={lid:0,file:''};var targetdpi=300;this.colorEditable(false);this.bboxpad(0);var _this=this;var loaded=false;this.setSize(57,40);var img=new Image();var def_src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADcAAAAmCAYAAABgUQN4AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAANiAAADYgBgtNgwQAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNXG14zYAAAUJSURBVGiB3ZhNaBxlGMd/87G7szO7m1gDER6ltBCNRVA0puLB9pRTrGlqQRBbFfGivWj1ECrGg3jxELD11oIJGms2H02lCgVrwYKlB8V4EkUovBehIcluEpJsZjxMdpls9mMmySahfxh2eZ/3+fjP88zzPjOapxTlyIlo1+GUDqeBdg9adPjPgykXBnuVGt6gtAehlZMbFXnWgCEDJAkpA9ABF1gFFiDvwj8unOpV6o9diDk01pEbF3lEg6kUNMVqKC2Dl4fcKhx6WVVI/R6BXvwzKGJocNUGpxYxgDhoNiQNGO8T0ets3zImRJzN6JUCS8PzOhxIgBlG0YKYDu3PwQubcRwWwyLNwG9jIo9F1S2R06AjBokoyglIrEBHVKdhkRPRkjBmwAEdvo6qHyR31IxIzoS4AUeiOg2Ln6DfgM4MmDq0j4u8EUW/RM4FR4voXPOvhyKqhcKoSJcH76fAAUj7vwPfibSEtRHM3M8FKEQJoADeKvwSRScMvhfZr8NIGpxigDqQBCsOF8LaCXa628uwECWIFcjrcCuKTj2MiiRW4UcHnPLOZkFch+5JkaNhbJXIrcAtD3Ir4IVRLACrUDDgRujIQ8CAizHYnwCjXKYBNtguDA2JxOvZKpE7qdTCMnTnYcGto+QCeZh34cSLSt0LG/iEyDO15GMib+nQ40Cy2p6Yf+1Lw0f1/K07gE8q9fsqvD4Ls/OwWE7SBRZhZRYWPDh3XKnQWRsTeQW4MylytpJ8XORpHQbWGkdN2GBr8N5VkUdr7dswXZxQKqvD/iW4NAv3pmF5BuamYWkGcouQ1aCtR6mBsMTWAr+Y9ivrk3KCEyL7NPghFWgg9YK2wCrAUK19GwbncoyKZFw4GIO7PUpNh/C9DpdFWhPwZwpaYvjZz8E80H9Mqc/7RPROuGnB4aRfdaExC/kCvNur1FeV5HXJbQVDIvE03EnC41YgcBeYg3kN+l1oMeFMGuyo9l1gBuY0OFDpxjd06E3BoAltVllGdCADjgf9OpxxNkGsaMeChAfnq8kbglGRswZ0p6t0viLBNNhbCSIJCQ2OZUU2DPANKctRkS4TxjNbDDwsVoA83M1B22tKLRfXt933FZE2A7KpHSIGfs2b8GAT9AXXtzVzkyJNLkw58HDcb/s7BhdYO3+fPK7U37CNmesT0V2YjEPrThMDn4jtP3+DwbVtQScMmNDhQN2Zr1FIgGHAExMir8I2leUVkdMafJnxx6JdxdrZN+PAwbrkxkR6DTBeUmqkkjwrctiAG82Q3KkGUg8LsLgE2ZrkhkWaLfhXAwt4p0epS0F5VkRifgN5oHhKH1GqYvJuilR8lSruryavpVPNvgfMgFfzS5cNF2JgJyE+C+cnRTLH1gbmayKWCdeTkKk0EEYJNgqq3YwjSmnFNQ3wQKtaSZMiRzXosf23X5r8SePTMZGPAZZhOOZ/CtzwUrkbqHQzK5K7JmK58I0TaBA6kAbbhA8nRH41oCvll+uuoFr5B1GxLAvwWRyay4VFgvN+y6+ZsXLn21WmN0W8ou2gj0r2N5AbEXkqDm8nawy86RCl2Khnrtx2kGi5z3VlOShixOCys4faej3UuonrOGTgAxMktgvjU1iEedaKKJVlVuSgCeecEB9oGoF6Z1dwLeze0iE+LnLbhg6rwW/nO4Vp1ohMiLxpwqH7hVgR2rfQmoC/miBzPzGbBswEfOFBZma3o2kA/geJ8XsL39LaPAAAAABJRU5ErkJggg==';img.src=typeof(src)=='string'?src:def_src;img.onload=function(){var _sz=_this.getSize();if(_sz.width==0){_sz=_this.setSize(img.width,img.height);}
_sz.height=Math.round((img.height/img.width)*_sz.width);if(_sz.width>img.width){_sz.width=img.width;_sz.height=img.height;}
_sz=_this.setSize(_sz.width,_sz.height);_this.pivot({x:Math.floor(_sz.width/2),y:Math.floor(_sz.height/2)});_this.center(_this.pivot());var curdpi=(img.width/_sz.width)*72;curdpi/=_this.getScaleX();if(curdpi<targetdpi){_this.scaleUniform(curdpi/targetdpi);}
loaded=true;if(typeof(_this.onload)=='function'){_this.onload(_this);}};img.onerror=function(err){loaded=false;img.src=def_src;if(typeof(_this.onerror)=='function'){_this.onerror(_this);}};var mscale_org=this.mscale;var kbscale_org=this.kbscale;function _showLoading(ctx){var _sz=_this.getSize();ctx.strokeStyle='#265c92';ctx.strokeWidth=1;ctx.beginPath();var fw=(_sz.width>57?_sz.width:57);var fh=(_sz.height>40?_sz.height:40);ctx.moveTo(0,0);ctx.lineTo(fw,0);ctx.lineTo(fw,fh);ctx.lineTo(0,fh);ctx.closePath();ctx.fillStyle='rgba(255,255,255,0.5)';ctx.fill();ctx.stroke();ctx.save();ctx.scale(0.5,0.5);ctx.fillStyle='rgba(38,92,146,1)';ctx.beginPath();ctx.moveTo(1.875,38.415359);ctx.lineTo(10,25.707026);ctx.lineTo(14.583333,30.082026);ctx.lineTo(28.541667,12.998693);ctx.lineTo(33.125,17.582026);ctx.lineTo(42.708333,5.2903593);ctx.lineTo(55.625,26.123693);ctx.lineTo(55.625,38.415359);ctx.closePath();ctx.fill();ctx.beginPath();ctx.moveTo(3.7196764,7.791188);ctx.bezierCurveTo(3.7196764,-1.1234551,17.309384,-1.0563661,17.309384,7.938502);ctx.bezierCurveTo(17.309384,16.698654,3.7196764,16.635624,3.7196764,7.791188);ctx.closePath();ctx.fill();ctx.restore();ctx.fillStyle='rgba(38,92,146,1)';ctx.font='12px arial,verdana,sans-serif';ctx.textAlign='right';ctx.fillText(loadingstr,fw-5,fh-5);loadingstridx++;if(!(loadingstridx%5)){loadingstr+=loadingstr;if(loadingstr.length>9){loadingstr='.';}}}
this.src=function(_src){img.src=_src;loaded=false;};this.render=function(ctx,cctx,timedelta,notransform){if(typeof(notransform)!=='boolean'){notransform=false;}
ctx.save();if(notransform){ctx.setTransform(1,0,0,1,0,0);}else{this.transformsApply(ctx);}
if(loaded){var _sz=_this.getSize();ctx.drawImage(img,0,0,img.width,img.height,0,0,_sz.width,_sz.height);}else{_showLoading(ctx);}
ctx.restore();if(!notransform){this.drawControls(cctx);}};this.toSVG=function(svgparent){var svgimgnode=document.createElementNS('http://www.w3.org/2000/svg','image');var _sz=this.getSize();svgimgnode.setAttribute('transform','matrix('+this.getMatrix().join(',')+')');svgimgnode.setAttribute('width',_sz.width);svgimgnode.setAttribute('height',_sz.height);svgimgnode.setAttribute('externalResourcesRequired','false');svgimgnode.setAttribute('preserveAspectRatio','xMidYMid');svgimgnode.setAttribute('xlink:href',this.xlinkhref?this.xlinkhref:this.imageData());if(typeof(this.xlinktype)!='undefined'&&this.xlinktype){svgimgnode.setAttribute('xlink:type',this.xlinktype);}
if(typeof(this.bcchild)!='undefined'&&this.bcchild){svgimgnode.setAttribute('type','bc');}
if(typeof(this.datachoice)!='undefined'&&this.datachoice){svgimgnode.setAttribute('data-choice',this.datachoice.toString());}
svgparent.appendChild(document.createTextNode('\n    '));svgparent.appendChild(svgimgnode);return svgimgnode;};this.loaded=function(){return loaded;};this.imageData=function(dataonly){if((typeof(this.mimetype)=='undefined'||!this.mimetype)&&this.xlinkhref){var ext=this.xlinkhref.substring(this.xlinkhref.lastIndexOf('.'));switch(ext.toLowerCase()){case'.jpg':case'.jpeg':this.mimetype='image/jpeg';break;case'.png':default:this.mimetype='image/png';}}else{this.mimetype=this.mimetype?this.mimetype:'image/png';}
if(is_new&&typeof(this.base64src)==='boolean'&&this.base64src){return dataonly?img.src.split('base64,')[1]:img.src;}else{var tcvs=document.createElement('canvas');tcvs.width=img.width;tcvs.height=img.height;var ctx=tcvs.getContext('2d');ctx.drawImage(img,0,0,img.width,img.height);if(typeof(dataonly)!=='boolean'){dataonly=false;}
return dataonly?tcvs.toDataURL(this.mimetype,1).split('base64,')[1]:tcvs.toDataURL(this.mimetype,1);}};this.is_new=function(isnew){if(typeof(isnew)==='boolean'){is_new=isnew;}
return is_new;};this.is_asset=function(isast){if(typeof(isast)==='boolean'){is_asset=isast;}
return is_asset;};this.asset_info=function(_asset_info){if((typeof(_asset_info)!='undefined')&&(typeof(_asset_info.lid)!='undefined')&&(typeof(_asset_info.file)!='undefined')){asset_info.lid=_asset_info.lid;asset_info.file=_asset_info.file;}
return asset_info;};this.mscale=function(){var _sz=this.getSize();var curdpi=(img.width/_sz.width)*72;curdpi/=this.getScaleX();var args=Array.prototype.slice.call(arguments,0);args.push(curdpi<=targetdpi);mscale_org.apply(this,args);_sz=this.getSize();curdpi=(img.width/_sz.width)*72;curdpi/=this.getScaleX();if(curdpi<targetdpi){this.scaleUniform(curdpi/targetdpi);}};this.kbscale=function(dir){var _sz=this.getSize();var curdpi=(img.width/_sz.width)*72;curdpi/=this.getScaleX();kbscale_org.apply(this,arguments);_sz=this.getSize();curdpi=(img.width/_sz.width)*72;curdpi/=this.getScaleX();if(curdpi<targetdpi){this.use_pivot(true);this.scaleUniform(curdpi/targetdpi);this.use_pivot(false);}};this.targetdpi=function(newdpi){if(typeof(newdpi)==='number'){targetdpi=newdpi;}
return targetdpi;};this.getImgSize=function(){if(loaded){return{width:img.width,height:img.height};}
return{width:0,height:0};};this.getImageTag=function(){return img;};this.is_placeholder=function(){return loaded&&(img.src==def_src);};this.getProperties=function(){var _tmatrix=[];var mtrx=_this.getMatrix();_tmatrix[0]=mtrx[0];_tmatrix[1]=mtrx[1];_tmatrix[2]=mtrx[2];_tmatrix[3]=mtrx[3];_tmatrix[4]=mtrx[4];_tmatrix[5]=mtrx[5];return{tmatrix:_tmatrix,img_src:img.src,targetdpi:targetdpi,xlinkhref:this.xlinkhref?this.xlinkhref:this.imageData,xlinktype:this.xlinktype,is_new:is_new};};this.set_img=function(_img){img=_img;loaded=true;}};FLSEditorCore.CImage.prototype=new FLSEditorCore.CObject;FLSEditorCore.CDIFMLogoSVGImg=function(xml,server_url,logoid,is_copy){is_copy=typeof(is_copy)=='boolean'?is_copy:false;FLSEditorCore.CObject.apply(this,arguments);var _this=this;var loadingstr='.';var loadingstridx=0;var cnvsImg=document.createElement('canvas');var svgSrc='';var targetdpi=12;var base_matrix=[1,0,0,1,0,0];var clientSize={width:0,height:0};var src;var colors=[];var mm2pixel=3.7795275591;var cm2pixel=mm2pixel*10;var inch2pixel=96;var point2pixel=1.3333333333;var units=['mm','cm','inch','pt'];this.colorEditable(false);_getSvgBounds();_populateColorsArray();this.bboxpad(0);var loaded=false;var img=new Image();img.crossOrigin='anonymous';var def_src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADcAAAAmCAYAAABgUQN4AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAANiAAADYgBgtNgwQAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNXG14zYAAAUJSURBVGiB3ZhNaBxlGMd/87G7szO7m1gDER6ltBCNRVA0puLB9pRTrGlqQRBbFfGivWj1ECrGg3jxELD11oIJGms2H02lCgVrwYKlB8V4EkUovBehIcluEpJsZjxMdpls9mMmySahfxh2eZ/3+fjP88zzPjOapxTlyIlo1+GUDqeBdg9adPjPgykXBnuVGt6gtAehlZMbFXnWgCEDJAkpA9ABF1gFFiDvwj8unOpV6o9diDk01pEbF3lEg6kUNMVqKC2Dl4fcKhx6WVVI/R6BXvwzKGJocNUGpxYxgDhoNiQNGO8T0ets3zImRJzN6JUCS8PzOhxIgBlG0YKYDu3PwQubcRwWwyLNwG9jIo9F1S2R06AjBokoyglIrEBHVKdhkRPRkjBmwAEdvo6qHyR31IxIzoS4AUeiOg2Ln6DfgM4MmDq0j4u8EUW/RM4FR4voXPOvhyKqhcKoSJcH76fAAUj7vwPfibSEtRHM3M8FKEQJoADeKvwSRScMvhfZr8NIGpxigDqQBCsOF8LaCXa628uwECWIFcjrcCuKTj2MiiRW4UcHnPLOZkFch+5JkaNhbJXIrcAtD3Ir4IVRLACrUDDgRujIQ8CAizHYnwCjXKYBNtguDA2JxOvZKpE7qdTCMnTnYcGto+QCeZh34cSLSt0LG/iEyDO15GMib+nQ40Cy2p6Yf+1Lw0f1/K07gE8q9fsqvD4Ls/OwWE7SBRZhZRYWPDh3XKnQWRsTeQW4MylytpJ8XORpHQbWGkdN2GBr8N5VkUdr7dswXZxQKqvD/iW4NAv3pmF5BuamYWkGcouQ1aCtR6mBsMTWAr+Y9ivrk3KCEyL7NPghFWgg9YK2wCrAUK19GwbncoyKZFw4GIO7PUpNh/C9DpdFWhPwZwpaYvjZz8E80H9Mqc/7RPROuGnB4aRfdaExC/kCvNur1FeV5HXJbQVDIvE03EnC41YgcBeYg3kN+l1oMeFMGuyo9l1gBuY0OFDpxjd06E3BoAltVllGdCADjgf9OpxxNkGsaMeChAfnq8kbglGRswZ0p6t0viLBNNhbCSIJCQ2OZUU2DPANKctRkS4TxjNbDDwsVoA83M1B22tKLRfXt933FZE2A7KpHSIGfs2b8GAT9AXXtzVzkyJNLkw58HDcb/s7BhdYO3+fPK7U37CNmesT0V2YjEPrThMDn4jtP3+DwbVtQScMmNDhQN2Zr1FIgGHAExMir8I2leUVkdMafJnxx6JdxdrZN+PAwbrkxkR6DTBeUmqkkjwrctiAG82Q3KkGUg8LsLgE2ZrkhkWaLfhXAwt4p0epS0F5VkRifgN5oHhKH1GqYvJuilR8lSruryavpVPNvgfMgFfzS5cNF2JgJyE+C+cnRTLH1gbmayKWCdeTkKk0EEYJNgqq3YwjSmnFNQ3wQKtaSZMiRzXosf23X5r8SePTMZGPAZZhOOZ/CtzwUrkbqHQzK5K7JmK58I0TaBA6kAbbhA8nRH41oCvll+uuoFr5B1GxLAvwWRyay4VFgvN+y6+ZsXLn21WmN0W8ou2gj0r2N5AbEXkqDm8nawy86RCl2Khnrtx2kGi5z3VlOShixOCys4faej3UuonrOGTgAxMktgvjU1iEedaKKJVlVuSgCeecEB9oGoF6Z1dwLeze0iE+LnLbhg6rwW/nO4Vp1ohMiLxpwqH7hVgR2rfQmoC/miBzPzGbBswEfOFBZma3o2kA/geJ8XsL39LaPAAAAABJRU5ErkJggg==';img.src=src;img.onload=function(){if(is_copy===false){_getRasterBBox();var svgctx=cnvsImg.getContext('2d');if(svgctx.drawSvg){console.log('drawSvg');svgctx.drawSvg(_getSvgString(),0,0);}else{svgctx.drawImage(img,0,0);}
URL.revokeObjectURL(src);loaded=true;if(typeof(_this.onload)=='function'){_this.onload(_this);}}};img.onerror=function(err){loaded=false;img.src=def_src;if(typeof(_this.onerror)=='function'){_this.onerror(_this);}};function _getSvgString(){var serialize=new XMLSerializer();var _svgstr=serialize.serializeToString(svgSrc)
if(/xmlns:NS1=""/.test(_svgstr)){_svgstr=_svgstr.replace(/xmlns:NS1=""/,'').replace(/NS1:/g,'');}
if(_svgstr.match(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g).length>1){_svgstr=_svgstr.replace(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g,'').replace(/<svg/,'<svg xmlns="http://www.w3.org/2000/svg"');}
return _svgstr;}
function _populateColorsArray(){while(colors.length){colors.pop();}
var pths=svgSrc.querySelectorAll('path[style*="fill:"]');for(var pidx=0;pidx<pths.length;pidx++){var styles=pths[pidx].getAttribute('style');styles=styles.trim().split(';');var stopswitch=false;for(var i=0;i<styles.length;i++){var stmp=styles[i].split(':');if(stmp.length==2){switch(stmp[0]){case'fill':if((stmp[1]!='none')&&(/url\(/.test(stmp[1])==false)&&(colors.indexOf(stmp[1])==-1)){colors.push(stmp[1]);}
stopswitch=true;break;}}
if(stopswitch)break;}}}
function _getRasterBBox(){try{var tmpCnvs=document.createElement('canvas');tmpCnvs.width=clientSize.width;tmpCnvs.height=clientSize.height;var tmpCtx=tmpCnvs.getContext('2d');if(tmpCtx.drawSvg){tmpCtx.drawSvg(_getSvgString(),0,0);}else{tmpCtx.drawImage(img,0,0,clientSize.width,clientSize.height);}
var idata=tmpCtx.getImageData(0,0,clientSize.width,clientSize.height);var extremities={tx:0,ty:0,rx:0,ry:0,bx:0,by:0,lx:0,ly:0};var foundcolor=false;for(var y=0;y<idata.height;y++){foundcolor=false;for(var x=0;x<idata.width;x++){if(idata.data[((idata.width*y)+x)*4+3]){extremities.tx=x;extremities.ty=y;foundcolor=true;break;}}
if(foundcolor)break;}
for(var y=idata.height-1;y>0;y--){foundcolor=false;for(var x=0;x<idata.width;x++){if(idata.data[((idata.width*y)+x)*4+3]){extremities.bx=x;extremities.by=y;foundcolor=true;break;}}
if(foundcolor)break;}
for(var x=0;x<idata.width;x++){foundcolor=false;for(var y=0;y<idata.height;y++){if(idata.data[((idata.width*y)+x)*4+3]){extremities.lx=x;extremities.ly=y;foundcolor=true;break;}}
if(foundcolor)break;}
for(var x=idata.width-1;x>0;x--){foundcolor=false;for(var y=0;y<idata.height;y++){if(idata.data[((idata.width*y)+x)*4+3]){extremities.rx=x;extremities.ry=y;foundcolor=true;break;}}
if(foundcolor)break;}
var _width=extremities.rx-extremities.lx;var _height=extremities.by-extremities.ty;var _x=extremities.lx;var _y=extremities.ty;var _px=Math.floor(_width/2);var _py=Math.floor(_height/2);if(_width&&_height){base_matrix[4]=-_x;base_matrix[5]=-_y;var svgctx=cnvsImg.getContext('2d');cnvsImg.width=_width;cnvsImg.height=_height;svgctx.setTransform.apply(svgctx,base_matrix);_this.setSize(_width,_height);_this.pivot({x:Math.floor(_px),y:Math.floor(_py)});_this.center(_this.pivot());}}catch(e){console.log(e)}}
function _getSvgBounds(){var svgbbox;var parser=new DOMParser();var serialize=new XMLSerializer();if((xml instanceof jQuery)&&(xml.length==1)){var domXML=xml.get(0)
if(domXML.nodeName=='g'){var svgroot=document.createElementNS('http://www.w3.org/2000/svg','svg');svgroot.setAttribute('version','1.1');svgroot.setAttribute('xmlns','http://www.w3.org/2000/svg');svgroot.setAttribute('xmlns:xlink','http://www.w3.org/1999/xlink');var _sz=xml.attr('data-size');if(_sz){_sz=_sz.replace(/,/,' ').replace(/\s+/,' ').split(' ');}else{_sz=[100,100];}
svgbbox={width:parseFloat(_sz[0],10),height:parseFloat(_sz[1],10)};var svg_sz=xml.attr('data-svgsize');if(svg_sz){svg_sz=svg_sz.replace(/,/,' ').replace(/\s+/,' ').split(' ');}else{svg_sz=[svgbbox.width,svgbbox.height];}
var _logoid=xml.attr('data-logoid');if(_logoid){_this.logoid=_logoid;}else if(logoid){_this.logoid=logoid;}
clientSize.width=parseFloat(svg_sz[0],10);clientSize.height=parseFloat(svg_sz[1],10);svgroot.setAttribute('width',clientSize.width);svgroot.setAttribute('height',clientSize.height);var cr_mtrx=xml.attr('data-current_matrix');if(cr_mtrx){cr_mtrx=cr_mtrx.replace(/,/,' ').replace(/\s+/,' ').split(' ');for(var cridx=0;cridx<cr_mtrx.length;cridx++){cr_mtrx[cridx]=parseFloat(cr_mtrx[cridx],10);}
_this.setMatrix(cr_mtrx);}
var bs_mtrx=xml.attr('data-base_matrix');if(bs_mtrx){bs_mtrx=bs_mtrx.replace(/,/,' ').replace(/\s+/,' ').split(' ');for(var cridx=0;cridx<bs_mtrx.length;cridx++){bs_mtrx[cridx]=parseFloat(bs_mtrx[cridx],10);}
base_matrix[0]=bs_mtrx[0];base_matrix[1]=bs_mtrx[1];base_matrix[2]=bs_mtrx[2];base_matrix[3]=bs_mtrx[3];base_matrix[4]=bs_mtrx[4];base_matrix[5]=bs_mtrx[5];}
for(var chn_idx=0;chn_idx<domXML.childNodes.length;chn_idx++){var cn_str=serialize.serializeToString(domXML.childNodes[chn_idx]);svgroot.appendChild(parser.parseFromString(cn_str,"image/svg+xml").childNodes[0]);}
var svgstr=serialize.serializeToString(svgroot);if(/xmlns:NS1=""/.test(svgstr)){svgstr=svgstr.replace(/xmlns:NS1=""/,'').replace(/NS1:/g,'');}
if(svgstr.match(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g).length>1){svgstr=svgstr.replace(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g,'').replace(/<svg/,'<svg xmlns="http://www.w3.org/2000/svg"');}
var svgBlob=new Blob([svgstr],{type:"image/svg+xml"});src=URL.createObjectURL(svgBlob);svgSrc=svgroot;}}else{var tmpdiv=document.createElement('div');tmpdiv.style.width=tmpdiv.style.height='1px';tmpdiv.style.position='absolute';tmpdiv.style.top='-1px';tmpdiv.style.left='-1px';tmpdiv.style.overflow='hidden';document.body.appendChild(tmpdiv);var svg=xml instanceof XMLDocument?xml.querySelector('svg'):xml;if(svg instanceof SVGElement){var svg_width=svg.getAttribute('width');var svg_height=svg.getAttribute('height');var v_x=0,v_y=0,v_w,v_h;var viewBox=svg.getAttribute('viewBox');if(typeof viewBox=='string'&&viewBox.length){[v_x,v_y,v_w,v_h]=viewBox.split(/\s/).map(v=>parseFloat(v));}
if(!svg_width&&!svg_height){let svg_x=svg.getAttribute('x')
let unit='px';if(svg_x&&svg_x.length){svg_x=svg_x.replace(/\d|\s/,'');if(svg_x.length){unit=svg_x;}}
if((v_w>0)&&(v_h>0)){svg.setAttribute('width',v_w.toString()+unit);svg.setAttribute('height',v_h.toString()+unit);}else{svg.setAttribute('width','100'+unit);}}
if(v_x!=0||v_y!=0){var fix_group=document.createElementNS('http://www.w3.org/2000/svg','g');fix_group.setAttribute('transform','matrix(1,0,0,1,'+(-v_x)+','+(-v_y)+')');while(svg.childNodes.length){fix_group.appendChild(svg.childNodes[0]);}
fix_group.setAttribute('data-viewbox',viewBox);svg.setAttribute('viewBox','0 0 '+v_w+' '+v_h);svg.appendChild(fix_group);}}
var svgstr=serialize.serializeToString(xml);var svgBlob=new Blob([svgstr],{type:"image/svg+xml"});src=URL.createObjectURL(svgBlob);svgSrc=parser.parseFromString(svgstr,"image/svg+xml");tmpdiv.appendChild(svgSrc.childNodes[0]);svgSrc=tmpdiv.childNodes[0];var clientrect=svgSrc.getBoundingClientRect();clientSize.width=clientrect.width;clientSize.height=clientrect.height;svgbbox=svgSrc.getBBox();base_matrix[4]=-svgbbox.x;base_matrix[5]=-svgbbox.y;document.body.removeChild(tmpdiv);}
cnvsImg.width=Math.ceil(svgbbox.width);cnvsImg.height=Math.ceil(svgbbox.height);var svgctx=cnvsImg.getContext('2d');svgctx.setTransform.apply(svgctx,base_matrix);_this.setSize(svgbbox.width,svgbbox.height);_this.pivot({x:Math.floor(svgbbox.width/2),y:Math.floor(svgbbox.height/2)});_this.center(_this.pivot());if(/blob:/.test(src)&&!(/blob:http?s:\/\//.test(src))){}}
function _showLoading(ctx){var _sz=_this.getSize();ctx.strokeStyle='#265c92';ctx.strokeWidth=1;ctx.beginPath();var fw=(_sz.width>57?_sz.width:57);var fh=(_sz.height>40?_sz.height:40);ctx.moveTo(0,0);ctx.lineTo(fw,0);ctx.lineTo(fw,fh);ctx.lineTo(0,fh);ctx.closePath();ctx.fillStyle='rgba(255,255,255,0.5)';ctx.fill();ctx.stroke();ctx.save();ctx.scale(0.5,0.5);ctx.fillStyle='rgba(38,92,146,1)';ctx.beginPath();ctx.moveTo(1.875,38.415359);ctx.lineTo(10,25.707026);ctx.lineTo(14.583333,30.082026);ctx.lineTo(28.541667,12.998693);ctx.lineTo(33.125,17.582026);ctx.lineTo(42.708333,5.2903593);ctx.lineTo(55.625,26.123693);ctx.lineTo(55.625,38.415359);ctx.closePath();ctx.fill();ctx.beginPath();ctx.moveTo(3.7196764,7.791188);ctx.bezierCurveTo(3.7196764,-1.1234551,17.309384,-1.0563661,17.309384,7.938502);ctx.bezierCurveTo(17.309384,16.698654,3.7196764,16.635624,3.7196764,7.791188);ctx.closePath();ctx.fill();ctx.restore();ctx.fillStyle='rgba(38,92,146,1)';ctx.font='12px arial,verdana,sans-serif';ctx.textAlign='right';ctx.fillText(loadingstr,fw-5,fh-5);loadingstridx++;if(!(loadingstridx%5)){loadingstr+=loadingstr;if(loadingstr.length>9){loadingstr='.';}}}
this.getColors=function(){return colors.slice(0);}
this.src=function(_src){img.src=_src;loaded=false;};this.render=function(ctx,cctx,timedelta,notransform){if(typeof(notransform)!=='boolean'){notransform=false;}
ctx.save();if(notransform){ctx.setTransform(1,0,0,1,0,0);}else{this.transformsApply(ctx);}
if(loaded){var _sz=_this.getSize();ctx.drawImage(cnvsImg,0,0,cnvsImg.width,cnvsImg.height,0,0,_sz.width,_sz.height);}else{_showLoading(ctx);}
ctx.restore();if(!notransform){this.drawControls(cctx);}};this.toSVG=function(svgparent){var svgimgnode=document.createElementNS('http://www.w3.org/2000/svg','g');var _sz=this.getSize();var mtrx_cpy=this.getMatrix().slice(0);svgimgnode.setAttribute('transform','matrix('+FLSUtil.tmatrixMultiply(base_matrix,mtrx_cpy).join(',')+')');if(typeof(this.xlinktype)!='undefined'&&this.xlinktype){svgimgnode.setAttribute('xlink:type',this.xlinktype);}
if(typeof(this.id)!='undefined'&&this.id){svgimgnode.setAttribute('id',this.id);}
if(typeof(this.logoid)!='undefined'&&this.logoid){svgimgnode.setAttribute('data-logoid',this.logoid);}
svgimgnode.setAttribute('data-base_matrix',base_matrix.join(' '));svgimgnode.setAttribute('data-current_matrix',mtrx_cpy.join(' '));svgimgnode.setAttribute('data-size',_sz.width+' '+_sz.height);svgimgnode.setAttribute('data-svgsize',clientSize.width+' '+clientSize.height);var parser=new DOMParser();var serializer=new XMLSerializer();for(var cn_idx=0;cn_idx<svgSrc.childNodes.length;cn_idx++){var cn_str=serializer.serializeToString(svgSrc.childNodes[cn_idx]);if(cn_str.trim().length){var t=parser.parseFromString(cn_str,"image/svg+xml").childNodes[0]
if(!['xml-stylesheet'].includes(t.nodeName)){svgimgnode.appendChild(t);}}}
if(svgparent){svgparent.appendChild(document.createTextNode('\n    '));svgparent.appendChild(svgimgnode);}
return svgimgnode;};this.loaded=function(){return loaded;};this.getImgSize=function(){if(loaded){return{width:cnvsImg.width,height:cnvsImg.height};}
return{width:0,height:0};};this.targetdpi=function(newdpi){if(typeof(newdpi)==='number'){targetdpi=newdpi;}
return targetdpi;};this.getImageTag=function(){return cnvsImg;};this.getProperties=function(){var _tmatrix=_this.getMatrix().slice(0);var _pvt=_this.pivot();var _cntr=_this.center();return{tmatrix:_tmatrix,img_src:img.src,targetdpi:targetdpi,xlinktype:this.xlinktype,cnvsImg:cnvsImg,base_matrix:base_matrix.slice(0),size:this.getSize(),svgSrc:svgSrc,logoid:this.logoid,svgSize:clientSize,pivot:{x:_pvt.x,y:_pvt.y},center:{x:_cntr.x,y:_cntr.y},};};this.set_imgcnvs=function(_cnvs){if(_cnvs instanceof HTMLCanvasElement){cnvsImg=_cnvs;loaded=true;}};this.set_base_matrix=function(_mtrx){if((_mtrx instanceof Array)&&(_mtrx.length==6)){base_matrix[0]=_mtrx[0];base_matrix[1]=_mtrx[1];base_matrix[2]=_mtrx[2];base_matrix[3]=_mtrx[3];base_matrix[4]=_mtrx[4];base_matrix[5]=_mtrx[5];}}};FLSEditorCore.CDIFMLogoSVGImg.prototype=new FLSEditorCore.CObject;FLSEditorCore.CPathText=function(str){FLSEditorCore.CText.apply(this,arguments);var _this=this;var setFontFamily_org=this.setFontFamily;var setFontSize_org=this.setFontSize;var setFontStyle_org=this.setFontStyle;var setColor_org=this.setColor;var setText_org=this.setText;var setStroke_org=this.setStroke;var setStrokeWidth_org=this.setStrokeWidth;var default_text_org=this.default_text;var whichControl_org=this.whichControl;var drawControls_org=this.drawControls;var applyScaleToFontSize_org=this.applyScaleToFontSize;var font_family='"'+this.getFontFamily()+'"';var fontsize=this.getFontSize();var fontstyle='';var color=this.getColor();var text=this.getText();var default_text=this.default_text();var stroke=null;var stroke_width=0;var data='';var path_pixel_lenght=0;var path_segments_pixel_lenght=[];var use_path=false;var enable_path_edit=false;var center_text_on_path=true;var letter_spacing=0;var txt_dy=0;var scale_fontsize_if_short_path=true;var letters=[];var commands=[];var path_vertexes=[];var cp_lines=[];var controlSize=10;var otherControlSize={def:15,flat:15,imgbg:15};var vertex_cntrl_radius=controlSize/2;var current_control=false;var current_other_control='none';var other_vertex=[{x:0,y:0},{x:0,y:0},{x:0,y:0}];var other_controls={normal:{'path_scale_bottom':{x:0,y:0}},path_edit:{'path_scale':{x:0,y:0}}};var fonticonprops={def:{'path_scale':{size:23,glyph:'\uE013',adj_y:0,adj_x:0,bg_color:'rgb(226, 228, 228)',color:'rgb(0, 69, 121)'},'path_scale_top':{size:23,glyph:'\uE016',adj_y:0,adj_x:0,bg_color:'rgb(226, 228, 228)',color:'rgb(0, 69, 121)'},'path_scale_bottom':{size:26,glyph:'\uE018',adj_y:0,adj_x:0,bg_color:'rgb(226, 228, 228)',color:'rgb(0, 69, 121)'}},flat:{'path_scale':{size:23,glyph:'\uE013',adj_y:0,adj_x:0,bg_color:'rgb(226, 228, 228)',color:'rgb(0, 69, 121)'},'path_scale_top':{size:23,glyph:'\uE016',adj_y:0,adj_x:0,bg_color:'rgb(226, 228, 228)',color:'rgb(0, 69, 121)'},'path_scale_bottom':{size:26,glyph:'\uE018',adj_y:0,adj_x:0,bg_color:'rgb(226, 228, 228)',color:'rgb(0, 69, 121)'}},imgbg:{'path_scale':{size:23,glyph:'\uE013',adj_y:0,adj_x:0,bg_color:'#FFFFFF',color:'#666666',active_color:'#005596',control_border_color:'#2ba4f0',control_active_fill_color:"#FFFFFF",control_active_border_color:'#005596',active_shadow:true},'path_scale_top':{size:23,glyph:'\uE016',adj_y:0,adj_x:0,bg_color:'#FFFFFF',color:'#666666',active_color:'#005596',control_border_color:'#2ba4f0',control_active_fill_color:"#FFFFFF",control_active_border_color:'#005596',active_shadow:true},'path_scale_bottom':{size:21,glyph:'\uE018',adj_y:0,adj_x:0,bg_color:'#FFFFFF',color:'#666666',active_color:'#005596',control_border_color:'#2ba4f0',control_active_fill_color:"#FFFFFF",control_active_border_color:'#005596',active_shadow:true}},};var fonticontextpos={def:{'path_scale':{x:-12,y:8.5},'path_scale_top':{x:-12,y:8.5},'path_scale_bottom':{x:-13,y:9.5},},flat:{'path_scale':{x:-12,y:8.5},'path_scale_top':{x:-12,y:8.5},'path_scale_bottom':{x:-13,y:9.5},},imgbg:{'path_scale':{x:-12,y:8.5},'path_scale_top':{x:-12,y:8.5},'path_scale_bottom':{x:-10.5,y:8},},};var iconstyle=fonticonprops[FLSUtil.objIconStyle]?FLSUtil.objIconStyle:'flat';fonticonprops=fonticonprops[iconstyle];fonticontextpos=fonticontextpos[iconstyle];otherControlSize=otherControlSize[iconstyle];var Tvalues=0||[[],[],[-0.5773502691896257645091487805019574556476,0.5773502691896257645091487805019574556476],[0,-0.7745966692414833770358530799564799221665,0.7745966692414833770358530799564799221665],[-0.3399810435848562648026657591032446872005,0.3399810435848562648026657591032446872005,-0.8611363115940525752239464888928095050957,0.8611363115940525752239464888928095050957],[0,-0.5384693101056830910363144207002088049672,0.5384693101056830910363144207002088049672,-0.9061798459386639927976268782993929651256,0.9061798459386639927976268782993929651256],[0.6612093864662645136613995950199053470064,-0.6612093864662645136613995950199053470064,-0.2386191860831969086305017216807119354186,0.2386191860831969086305017216807119354186,-0.9324695142031520278123015544939946091347,0.9324695142031520278123015544939946091347],[0,0.4058451513773971669066064120769614633473,-0.4058451513773971669066064120769614633473,-0.7415311855993944398638647732807884070741,0.7415311855993944398638647732807884070741,-0.9491079123427585245261896840478512624007,0.9491079123427585245261896840478512624007],[-0.1834346424956498049394761423601839806667,0.1834346424956498049394761423601839806667,-0.5255324099163289858177390491892463490419,0.5255324099163289858177390491892463490419,-0.7966664774136267395915539364758304368371,0.7966664774136267395915539364758304368371,-0.9602898564975362316835608685694729904282,0.9602898564975362316835608685694729904282],[0,-0.8360311073266357942994297880697348765441,0.8360311073266357942994297880697348765441,-0.9681602395076260898355762029036728700494,0.9681602395076260898355762029036728700494,-0.3242534234038089290385380146433366085719,0.3242534234038089290385380146433366085719,-0.6133714327005903973087020393414741847857,0.6133714327005903973087020393414741847857],[-0.1488743389816312108848260011297199846175,0.1488743389816312108848260011297199846175,-0.4333953941292471907992659431657841622000,0.4333953941292471907992659431657841622000,-0.6794095682990244062343273651148735757692,0.6794095682990244062343273651148735757692,-0.8650633666889845107320966884234930485275,0.8650633666889845107320966884234930485275,-0.9739065285171717200779640120844520534282,0.9739065285171717200779640120844520534282],[0,-0.2695431559523449723315319854008615246796,0.2695431559523449723315319854008615246796,-0.5190961292068118159257256694586095544802,0.5190961292068118159257256694586095544802,-0.7301520055740493240934162520311534580496,0.7301520055740493240934162520311534580496,-0.8870625997680952990751577693039272666316,0.8870625997680952990751577693039272666316,-0.9782286581460569928039380011228573907714,0.9782286581460569928039380011228573907714],[-0.1252334085114689154724413694638531299833,0.1252334085114689154724413694638531299833,-0.3678314989981801937526915366437175612563,0.3678314989981801937526915366437175612563,-0.5873179542866174472967024189405342803690,0.5873179542866174472967024189405342803690,-0.7699026741943046870368938332128180759849,0.7699026741943046870368938332128180759849,-0.9041172563704748566784658661190961925375,0.9041172563704748566784658661190961925375,-0.9815606342467192506905490901492808229601,0.9815606342467192506905490901492808229601],[0,-0.2304583159551347940655281210979888352115,0.2304583159551347940655281210979888352115,-0.4484927510364468528779128521276398678019,0.4484927510364468528779128521276398678019,-0.6423493394403402206439846069955156500716,0.6423493394403402206439846069955156500716,-0.8015780907333099127942064895828598903056,0.8015780907333099127942064895828598903056,-0.9175983992229779652065478365007195123904,0.9175983992229779652065478365007195123904,-0.9841830547185881494728294488071096110649,0.9841830547185881494728294488071096110649],[-0.1080549487073436620662446502198347476119,0.1080549487073436620662446502198347476119,-0.3191123689278897604356718241684754668342,0.3191123689278897604356718241684754668342,-0.5152486363581540919652907185511886623088,0.5152486363581540919652907185511886623088,-0.6872929048116854701480198030193341375384,0.6872929048116854701480198030193341375384,-0.8272013150697649931897947426503949610397,0.8272013150697649931897947426503949610397,-0.9284348836635735173363911393778742644770,0.9284348836635735173363911393778742644770,-0.9862838086968123388415972667040528016760,0.9862838086968123388415972667040528016760],[0,-0.2011940939974345223006283033945962078128,0.2011940939974345223006283033945962078128,-0.3941513470775633698972073709810454683627,0.3941513470775633698972073709810454683627,-0.5709721726085388475372267372539106412383,0.5709721726085388475372267372539106412383,-0.7244177313601700474161860546139380096308,0.7244177313601700474161860546139380096308,-0.8482065834104272162006483207742168513662,0.8482065834104272162006483207742168513662,-0.9372733924007059043077589477102094712439,0.9372733924007059043077589477102094712439,-0.9879925180204854284895657185866125811469,0.9879925180204854284895657185866125811469],[-0.0950125098376374401853193354249580631303,0.0950125098376374401853193354249580631303,-0.2816035507792589132304605014604961064860,0.2816035507792589132304605014604961064860,-0.4580167776572273863424194429835775735400,0.4580167776572273863424194429835775735400,-0.6178762444026437484466717640487910189918,0.6178762444026437484466717640487910189918,-0.7554044083550030338951011948474422683538,0.7554044083550030338951011948474422683538,-0.8656312023878317438804678977123931323873,0.8656312023878317438804678977123931323873,-0.9445750230732325760779884155346083450911,0.9445750230732325760779884155346083450911,-0.9894009349916499325961541734503326274262,0.9894009349916499325961541734503326274262],[0,-0.1784841814958478558506774936540655574754,0.1784841814958478558506774936540655574754,-0.3512317634538763152971855170953460050405,0.3512317634538763152971855170953460050405,-0.5126905370864769678862465686295518745829,0.5126905370864769678862465686295518745829,-0.6576711592166907658503022166430023351478,0.6576711592166907658503022166430023351478,-0.7815140038968014069252300555204760502239,0.7815140038968014069252300555204760502239,-0.8802391537269859021229556944881556926234,0.8802391537269859021229556944881556926234,-0.9506755217687677612227169578958030214433,0.9506755217687677612227169578958030214433,-0.9905754753144173356754340199406652765077,0.9905754753144173356754340199406652765077],[-0.0847750130417353012422618529357838117333,0.0847750130417353012422618529357838117333,-0.2518862256915055095889728548779112301628,0.2518862256915055095889728548779112301628,-0.4117511614628426460359317938330516370789,0.4117511614628426460359317938330516370789,-0.5597708310739475346078715485253291369276,0.5597708310739475346078715485253291369276,-0.6916870430603532078748910812888483894522,0.6916870430603532078748910812888483894522,-0.8037049589725231156824174550145907971032,0.8037049589725231156824174550145907971032,-0.8926024664975557392060605911271455154078,0.8926024664975557392060605911271455154078,-0.9558239495713977551811958929297763099728,0.9558239495713977551811958929297763099728,-0.9915651684209309467300160047061507702525,0.9915651684209309467300160047061507702525],[0,-0.1603586456402253758680961157407435495048,0.1603586456402253758680961157407435495048,-0.3165640999636298319901173288498449178922,0.3165640999636298319901173288498449178922,-0.4645707413759609457172671481041023679762,0.4645707413759609457172671481041023679762,-0.6005453046616810234696381649462392798683,0.6005453046616810234696381649462392798683,-0.7209661773352293786170958608237816296571,0.7209661773352293786170958608237816296571,-0.8227146565371428249789224867127139017745,0.8227146565371428249789224867127139017745,-0.9031559036148179016426609285323124878093,0.9031559036148179016426609285323124878093,-0.9602081521348300308527788406876515266150,0.9602081521348300308527788406876515266150,-0.9924068438435844031890176702532604935893,0.9924068438435844031890176702532604935893],[-0.0765265211334973337546404093988382110047,0.0765265211334973337546404093988382110047,-0.2277858511416450780804961953685746247430,0.2277858511416450780804961953685746247430,-0.3737060887154195606725481770249272373957,0.3737060887154195606725481770249272373957,-0.5108670019508270980043640509552509984254,0.5108670019508270980043640509552509984254,-0.6360536807265150254528366962262859367433,0.6360536807265150254528366962262859367433,-0.7463319064601507926143050703556415903107,0.7463319064601507926143050703556415903107,-0.8391169718222188233945290617015206853296,0.8391169718222188233945290617015206853296,-0.9122344282513259058677524412032981130491,0.9122344282513259058677524412032981130491,-0.9639719272779137912676661311972772219120,0.9639719272779137912676661311972772219120,-0.9931285991850949247861223884713202782226,0.9931285991850949247861223884713202782226],[0,-0.1455618541608950909370309823386863301163,0.1455618541608950909370309823386863301163,-0.2880213168024010966007925160646003199090,0.2880213168024010966007925160646003199090,-0.4243421202074387835736688885437880520964,0.4243421202074387835736688885437880520964,-0.5516188358872198070590187967243132866220,0.5516188358872198070590187967243132866220,-0.6671388041974123193059666699903391625970,0.6671388041974123193059666699903391625970,-0.7684399634756779086158778513062280348209,0.7684399634756779086158778513062280348209,-0.8533633645833172836472506385875676702761,0.8533633645833172836472506385875676702761,-0.9200993341504008287901871337149688941591,0.9200993341504008287901871337149688941591,-0.9672268385663062943166222149076951614246,0.9672268385663062943166222149076951614246,-0.9937521706203895002602420359379409291933,0.9937521706203895002602420359379409291933],[-0.0697392733197222212138417961186280818222,0.0697392733197222212138417961186280818222,-0.2078604266882212854788465339195457342156,0.2078604266882212854788465339195457342156,-0.3419358208920842251581474204273796195591,0.3419358208920842251581474204273796195591,-0.4693558379867570264063307109664063460953,0.4693558379867570264063307109664063460953,-0.5876404035069115929588769276386473488776,0.5876404035069115929588769276386473488776,-0.6944872631866827800506898357622567712673,0.6944872631866827800506898357622567712673,-0.7878168059792081620042779554083515213881,0.7878168059792081620042779554083515213881,-0.8658125777203001365364256370193787290847,0.8658125777203001365364256370193787290847,-0.9269567721871740005206929392590531966353,0.9269567721871740005206929392590531966353,-0.9700604978354287271239509867652687108059,0.9700604978354287271239509867652687108059,-0.9942945854823992920730314211612989803930,0.9942945854823992920730314211612989803930],[0,-0.1332568242984661109317426822417661370104,0.1332568242984661109317426822417661370104,-0.2641356809703449305338695382833096029790,0.2641356809703449305338695382833096029790,-0.3903010380302908314214888728806054585780,0.3903010380302908314214888728806054585780,-0.5095014778460075496897930478668464305448,0.5095014778460075496897930478668464305448,-0.6196098757636461563850973116495956533871,0.6196098757636461563850973116495956533871,-0.7186613631319501944616244837486188483299,0.7186613631319501944616244837486188483299,-0.8048884016188398921511184069967785579414,0.8048884016188398921511184069967785579414,-0.8767523582704416673781568859341456716389,0.8767523582704416673781568859341456716389,-0.9329710868260161023491969890384229782357,0.9329710868260161023491969890384229782357,-0.9725424712181152319560240768207773751816,0.9725424712181152319560240768207773751816,-0.9947693349975521235239257154455743605736,0.9947693349975521235239257154455743605736],[-0.0640568928626056260850430826247450385909,0.0640568928626056260850430826247450385909,-0.1911188674736163091586398207570696318404,0.1911188674736163091586398207570696318404,-0.3150426796961633743867932913198102407864,0.3150426796961633743867932913198102407864,-0.4337935076260451384870842319133497124524,0.4337935076260451384870842319133497124524,-0.5454214713888395356583756172183723700107,0.5454214713888395356583756172183723700107,-0.6480936519369755692524957869107476266696,0.6480936519369755692524957869107476266696,-0.7401241915785543642438281030999784255232,0.7401241915785543642438281030999784255232,-0.8200019859739029219539498726697452080761,0.8200019859739029219539498726697452080761,-0.8864155270044010342131543419821967550873,0.8864155270044010342131543419821967550873,-0.9382745520027327585236490017087214496548,0.9382745520027327585236490017087214496548,-0.9747285559713094981983919930081690617411,0.9747285559713094981983919930081690617411,-0.9951872199970213601799974097007368118745,0.9951872199970213601799974097007368118745]];var Cvalues=0||[[],[],[1.0,1.0],[0.8888888888888888888888888888888888888888,0.5555555555555555555555555555555555555555,0.5555555555555555555555555555555555555555],[0.6521451548625461426269360507780005927646,0.6521451548625461426269360507780005927646,0.3478548451374538573730639492219994072353,0.3478548451374538573730639492219994072353],[0.5688888888888888888888888888888888888888,0.4786286704993664680412915148356381929122,0.4786286704993664680412915148356381929122,0.2369268850561890875142640407199173626432,0.2369268850561890875142640407199173626432],[0.3607615730481386075698335138377161116615,0.3607615730481386075698335138377161116615,0.4679139345726910473898703439895509948116,0.4679139345726910473898703439895509948116,0.1713244923791703450402961421727328935268,0.1713244923791703450402961421727328935268],[0.4179591836734693877551020408163265306122,0.3818300505051189449503697754889751338783,0.3818300505051189449503697754889751338783,0.2797053914892766679014677714237795824869,0.2797053914892766679014677714237795824869,0.1294849661688696932706114326790820183285,0.1294849661688696932706114326790820183285],[0.3626837833783619829651504492771956121941,0.3626837833783619829651504492771956121941,0.3137066458778872873379622019866013132603,0.3137066458778872873379622019866013132603,0.2223810344533744705443559944262408844301,0.2223810344533744705443559944262408844301,0.1012285362903762591525313543099621901153,0.1012285362903762591525313543099621901153],[0.3302393550012597631645250692869740488788,0.1806481606948574040584720312429128095143,0.1806481606948574040584720312429128095143,0.0812743883615744119718921581105236506756,0.0812743883615744119718921581105236506756,0.3123470770400028400686304065844436655987,0.3123470770400028400686304065844436655987,0.2606106964029354623187428694186328497718,0.2606106964029354623187428694186328497718],[0.2955242247147528701738929946513383294210,0.2955242247147528701738929946513383294210,0.2692667193099963550912269215694693528597,0.2692667193099963550912269215694693528597,0.2190863625159820439955349342281631924587,0.2190863625159820439955349342281631924587,0.1494513491505805931457763396576973324025,0.1494513491505805931457763396576973324025,0.0666713443086881375935688098933317928578,0.0666713443086881375935688098933317928578],[0.2729250867779006307144835283363421891560,0.2628045445102466621806888698905091953727,0.2628045445102466621806888698905091953727,0.2331937645919904799185237048431751394317,0.2331937645919904799185237048431751394317,0.1862902109277342514260976414316558916912,0.1862902109277342514260976414316558916912,0.1255803694649046246346942992239401001976,0.1255803694649046246346942992239401001976,0.0556685671161736664827537204425485787285,0.0556685671161736664827537204425485787285],[0.2491470458134027850005624360429512108304,0.2491470458134027850005624360429512108304,0.2334925365383548087608498989248780562594,0.2334925365383548087608498989248780562594,0.2031674267230659217490644558097983765065,0.2031674267230659217490644558097983765065,0.1600783285433462263346525295433590718720,0.1600783285433462263346525295433590718720,0.1069393259953184309602547181939962242145,0.1069393259953184309602547181939962242145,0.0471753363865118271946159614850170603170,0.0471753363865118271946159614850170603170],[0.2325515532308739101945895152688359481566,0.2262831802628972384120901860397766184347,0.2262831802628972384120901860397766184347,0.2078160475368885023125232193060527633865,0.2078160475368885023125232193060527633865,0.1781459807619457382800466919960979955128,0.1781459807619457382800466919960979955128,0.1388735102197872384636017768688714676218,0.1388735102197872384636017768688714676218,0.0921214998377284479144217759537971209236,0.0921214998377284479144217759537971209236,0.0404840047653158795200215922009860600419,0.0404840047653158795200215922009860600419],[0.2152638534631577901958764433162600352749,0.2152638534631577901958764433162600352749,0.2051984637212956039659240656612180557103,0.2051984637212956039659240656612180557103,0.1855383974779378137417165901251570362489,0.1855383974779378137417165901251570362489,0.1572031671581935345696019386238421566056,0.1572031671581935345696019386238421566056,0.1215185706879031846894148090724766259566,0.1215185706879031846894148090724766259566,0.0801580871597602098056332770628543095836,0.0801580871597602098056332770628543095836,0.0351194603317518630318328761381917806197,0.0351194603317518630318328761381917806197],[0.2025782419255612728806201999675193148386,0.1984314853271115764561183264438393248186,0.1984314853271115764561183264438393248186,0.1861610000155622110268005618664228245062,0.1861610000155622110268005618664228245062,0.1662692058169939335532008604812088111309,0.1662692058169939335532008604812088111309,0.1395706779261543144478047945110283225208,0.1395706779261543144478047945110283225208,0.1071592204671719350118695466858693034155,0.1071592204671719350118695466858693034155,0.0703660474881081247092674164506673384667,0.0703660474881081247092674164506673384667,0.0307532419961172683546283935772044177217,0.0307532419961172683546283935772044177217],[0.1894506104550684962853967232082831051469,0.1894506104550684962853967232082831051469,0.1826034150449235888667636679692199393835,0.1826034150449235888667636679692199393835,0.1691565193950025381893120790303599622116,0.1691565193950025381893120790303599622116,0.1495959888165767320815017305474785489704,0.1495959888165767320815017305474785489704,0.1246289712555338720524762821920164201448,0.1246289712555338720524762821920164201448,0.0951585116824927848099251076022462263552,0.0951585116824927848099251076022462263552,0.0622535239386478928628438369943776942749,0.0622535239386478928628438369943776942749,0.0271524594117540948517805724560181035122,0.0271524594117540948517805724560181035122],[0.1794464703562065254582656442618856214487,0.1765627053669926463252709901131972391509,0.1765627053669926463252709901131972391509,0.1680041021564500445099706637883231550211,0.1680041021564500445099706637883231550211,0.1540457610768102880814315948019586119404,0.1540457610768102880814315948019586119404,0.1351363684685254732863199817023501973721,0.1351363684685254732863199817023501973721,0.1118838471934039710947883856263559267358,0.1118838471934039710947883856263559267358,0.0850361483171791808835353701910620738504,0.0850361483171791808835353701910620738504,0.0554595293739872011294401653582446605128,0.0554595293739872011294401653582446605128,0.0241483028685479319601100262875653246916,0.0241483028685479319601100262875653246916],[0.1691423829631435918406564701349866103341,0.1691423829631435918406564701349866103341,0.1642764837458327229860537764659275904123,0.1642764837458327229860537764659275904123,0.1546846751262652449254180038363747721932,0.1546846751262652449254180038363747721932,0.1406429146706506512047313037519472280955,0.1406429146706506512047313037519472280955,0.1225552067114784601845191268002015552281,0.1225552067114784601845191268002015552281,0.1009420441062871655628139849248346070628,0.1009420441062871655628139849248346070628,0.0764257302548890565291296776166365256053,0.0764257302548890565291296776166365256053,0.0497145488949697964533349462026386416808,0.0497145488949697964533349462026386416808,0.0216160135264833103133427102664524693876,0.0216160135264833103133427102664524693876],[0.1610544498487836959791636253209167350399,0.1589688433939543476499564394650472016787,0.1589688433939543476499564394650472016787,0.1527660420658596667788554008976629984610,0.1527660420658596667788554008976629984610,0.1426067021736066117757461094419029724756,0.1426067021736066117757461094419029724756,0.1287539625393362276755157848568771170558,0.1287539625393362276755157848568771170558,0.1115666455473339947160239016817659974813,0.1115666455473339947160239016817659974813,0.0914900216224499994644620941238396526609,0.0914900216224499994644620941238396526609,0.0690445427376412265807082580060130449618,0.0690445427376412265807082580060130449618,0.0448142267656996003328381574019942119517,0.0448142267656996003328381574019942119517,0.0194617882297264770363120414644384357529,0.0194617882297264770363120414644384357529],[0.1527533871307258506980843319550975934919,0.1527533871307258506980843319550975934919,0.1491729864726037467878287370019694366926,0.1491729864726037467878287370019694366926,0.1420961093183820513292983250671649330345,0.1420961093183820513292983250671649330345,0.1316886384491766268984944997481631349161,0.1316886384491766268984944997481631349161,0.1181945319615184173123773777113822870050,0.1181945319615184173123773777113822870050,0.1019301198172404350367501354803498761666,0.1019301198172404350367501354803498761666,0.0832767415767047487247581432220462061001,0.0832767415767047487247581432220462061001,0.0626720483341090635695065351870416063516,0.0626720483341090635695065351870416063516,0.0406014298003869413310399522749321098790,0.0406014298003869413310399522749321098790,0.0176140071391521183118619623518528163621,0.0176140071391521183118619623518528163621],[0.1460811336496904271919851476833711882448,0.1445244039899700590638271665537525436099,0.1445244039899700590638271665537525436099,0.1398873947910731547221334238675831108927,0.1398873947910731547221334238675831108927,0.1322689386333374617810525744967756043290,0.1322689386333374617810525744967756043290,0.1218314160537285341953671771257335983563,0.1218314160537285341953671771257335983563,0.1087972991671483776634745780701056420336,0.1087972991671483776634745780701056420336,0.0934444234560338615532897411139320884835,0.0934444234560338615532897411139320884835,0.0761001136283793020170516533001831792261,0.0761001136283793020170516533001831792261,0.0571344254268572082836358264724479574912,0.0571344254268572082836358264724479574912,0.0369537897708524937999506682993296661889,0.0369537897708524937999506682993296661889,0.0160172282577743333242246168584710152658,0.0160172282577743333242246168584710152658],[0.1392518728556319933754102483418099578739,0.1392518728556319933754102483418099578739,0.1365414983460151713525738312315173965863,0.1365414983460151713525738312315173965863,0.1311735047870623707329649925303074458757,0.1311735047870623707329649925303074458757,0.1232523768105124242855609861548144719594,0.1232523768105124242855609861548144719594,0.1129322960805392183934006074217843191142,0.1129322960805392183934006074217843191142,0.1004141444428809649320788378305362823508,0.1004141444428809649320788378305362823508,0.0859416062170677274144436813727028661891,0.0859416062170677274144436813727028661891,0.0697964684245204880949614189302176573987,0.0697964684245204880949614189302176573987,0.0522933351526832859403120512732112561121,0.0522933351526832859403120512732112561121,0.0337749015848141547933022468659129013491,0.0337749015848141547933022468659129013491,0.0146279952982722006849910980471854451902,0.0146279952982722006849910980471854451902],[0.1336545721861061753514571105458443385831,0.1324620394046966173716424647033169258050,0.1324620394046966173716424647033169258050,0.1289057221880821499785953393997936532597,0.1289057221880821499785953393997936532597,0.1230490843067295304675784006720096548158,0.1230490843067295304675784006720096548158,0.1149966402224113649416435129339613014914,0.1149966402224113649416435129339613014914,0.1048920914645414100740861850147438548584,0.1048920914645414100740861850147438548584,0.0929157660600351474770186173697646486034,0.0929157660600351474770186173697646486034,0.0792814117767189549228925247420432269137,0.0792814117767189549228925247420432269137,0.0642324214085258521271696151589109980391,0.0642324214085258521271696151589109980391,0.0480376717310846685716410716320339965612,0.0480376717310846685716410716320339965612,0.0309880058569794443106942196418845053837,0.0309880058569794443106942196418845053837,0.0134118594871417720813094934586150649766,0.0134118594871417720813094934586150649766],[0.1279381953467521569740561652246953718517,0.1279381953467521569740561652246953718517,0.1258374563468282961213753825111836887264,0.1258374563468282961213753825111836887264,0.1216704729278033912044631534762624256070,0.1216704729278033912044631534762624256070,0.1155056680537256013533444839067835598622,0.1155056680537256013533444839067835598622,0.1074442701159656347825773424466062227946,0.1074442701159656347825773424466062227946,0.0976186521041138882698806644642471544279,0.0976186521041138882698806644642471544279,0.0861901615319532759171852029837426671850,0.0861901615319532759171852029837426671850,0.0733464814110803057340336152531165181193,0.0733464814110803057340336152531165181193,0.0592985849154367807463677585001085845412,0.0592985849154367807463677585001085845412,0.0442774388174198061686027482113382288593,0.0442774388174198061686027482113382288593,0.0285313886289336631813078159518782864491,0.0285313886289336631813078159518782864491,0.0123412297999871995468056670700372915759,0.0123412297999871995468056670700372915759]];function updateLetters(){while(letters.length){letters.shift();}
if(commands.length&&use_path){var ctx=document.createElement('canvas').getContext('2d');ctx.font=fontstyle+' '+fontsize+'px '+font_family;var subpath_ln_idx=0;var pathinfo=path_segments_pixel_lenght[subpath_ln_idx];var tm=0;var pbb={x0:0,y0:-fontsize,x1:1,y1:0};var offset=0;var do_break=false;var display_text=text;if(center_text_on_path){var path_total_length=0;for(var ps_idx=0;ps_idx<path_segments_pixel_lenght.length;ps_idx++){path_total_length+=path_segments_pixel_lenght[ps_idx].plen;}
var text_width=ctx.measureText(display_text).width+(letter_spacing*(display_text.length-1));var trimside=true;var _thisminscale=_this.minscale();while(text_width>path_total_length){if(scale_fontsize_if_short_path){var fontscale=path_total_length/text_width;var new_font_size=Math.floor(fontsize*fontscale);fontsize=new_font_size>_thisminscale?new_font_size:_thisminscale;ctx.font=fontstyle+' '+fontsize+'px '+font_family;text_width=ctx.measureText(display_text).width+(letter_spacing*(display_text.length-1));pbb.yo=-fontsize;setFontSize_org.apply(_this,[fontsize]);if((new_font_size<_thisminscale)&&(fontsize<=_thisminscale)&&(text_width>path_total_length)){if(_this.force_path_scale===true){_this.scalePath(_thisminscale/new_font_size);path_total_length=0;for(var ps_idx=0;ps_idx<path_segments_pixel_lenght.length;ps_idx++){path_total_length+=path_segments_pixel_lenght[ps_idx].plen;}}else{}
break;}}else{if(trimside){display_text=display_text.substring(1);}else{display_text=display_text.substring(0,display_text.length-1);}
trimside=!trimside;text_width=ctx.measureText(display_text).width+(letter_spacing*(display_text.length-1));}}
var extra_path_lengt=(path_total_length-text_width)/2;path_total_length=0;for(var ps_idx=0;ps_idx<path_segments_pixel_lenght.length;ps_idx++){path_total_length+=path_segments_pixel_lenght[ps_idx].plen;if(path_total_length>=extra_path_lengt){subpath_ln_idx=ps_idx;offset=extra_path_lengt-(path_total_length-path_segments_pixel_lenght[ps_idx].plen);pathinfo=path_segments_pixel_lenght[subpath_ln_idx];break;}}}
for(var lidx=0;lidx<display_text.length;lidx++){var letter_info=[];var metrics=ctx.measureText(display_text[lidx]);var ltl={x:0,y:-fontsize+txt_dy};var ltr={x:metrics.width,y:-fontsize+txt_dy};var lrb={x:metrics.width,y:0+txt_dy};var llb={x:0,y:0+txt_dy};var letter_h_half=metrics.width*0.5;var lettertransform=[1,0,0,1,0,0];var middletransform=[1,0,0,1,0,0];var t_offset=offset+letter_h_half;if(t_offset>pathinfo.plen){subpath_ln_idx++;if(path_segments_pixel_lenght[subpath_ln_idx]){offset-=pathinfo.plen;pathinfo=path_segments_pixel_lenght[subpath_ln_idx];}else{break;}}
tm=getTforDistLUT(offset+letter_h_half,pathinfo);var tgnm=getTangentAndNormal(tm,pathinfo.start,pathinfo.end,pathinfo.cpoints);FLSUtil.tmatrixTranslate(lettertransform,tgnm['point'][0],tgnm['point'][1]);FLSUtil.tmatrixRotate(lettertransform,Math.atan2(tgnm['normalized_tangent'][1],tgnm['normalized_tangent'][0]));FLSUtil.tmatrixTranslate(lettertransform,-letter_h_half,0);offset+=(metrics.width);FLSUtil.transformPoint(lettertransform,ltl,true);FLSUtil.transformPoint(lettertransform,ltr,true);FLSUtil.transformPoint(lettertransform,lrb,true);FLSUtil.transformPoint(lettertransform,llb,true);pbb.x0=lidx==0?Math.min(ltl.x,lrb.x,ltr.x,llb.x):Math.min(pbb.x0,ltl.x,lrb.x,ltr.x,llb.x);pbb.y0=lidx==0?Math.min(ltl.y,lrb.y,ltr.y,llb.y):Math.min(pbb.y0,ltl.y,lrb.y,ltr.y,llb.y);pbb.x1=lidx==0?Math.max(ltl.x,lrb.x,ltr.x,llb.x):Math.max(pbb.x1,ltl.x,lrb.x,ltr.x,llb.x);pbb.y1=lidx==0?Math.max(ltl.y,lrb.y,ltr.y,llb.y):Math.max(pbb.y1,ltl.y,lrb.y,ltr.y,llb.y);letter_info.push(lettertransform);letter_info.push(display_text[lidx]);letter_info.push(metrics.width);if(offset>=pathinfo.plen){subpath_ln_idx+=1;if(subpath_ln_idx>=path_segments_pixel_lenght.length){if((offset-letter_h_half)<pathinfo.plen){letters.push(letter_info);}
break;}
offset=offset-pathinfo.plen;pathinfo=path_segments_pixel_lenght[subpath_ln_idx];}
letters.push(letter_info);offset+=letter_spacing;}
var width=pbb.x1-pbb.x0;var height=pbb.y1-pbb.y0;_this.setSize(width,height);_this.bboxpos(pbb.x0,pbb.y0);var pvt={x:Math.floor(pbb.x0+width/2),y:Math.floor(pbb.y0+height/2)};_this.pivot(pvt);_this.center(pvt);}}
function calcPathLength(){path_pixel_lenght=0;path_segments_pixel_lenght.length=0;if(commands.length){var start=[0,0];var first=[0,0];for(var i=0;i<commands.length;i++){if(commands[i]['func']=='moveTo'){start=[commands[i]['args'][0],commands[i]['args'][1]];i++;first[0]=start[0];first[1]=start[1];}
var end=[start[0],start[1]];var cpoints=[];switch(commands[i]['func']){case'lineTo':end[0]=commands[i]['args'][0];end[1]=commands[i]['args'][1];break;case'quadraticCurveTo':end[0]=commands[i]['args'][2];end[1]=commands[i]['args'][3];cpoints.push([commands[i]['args'][0],commands[i]['args'][1]]);break;case'bezierCurveTo':end[0]=commands[i]['args'][4];end[1]=commands[i]['args'][5];cpoints.push([commands[i]['args'][0],commands[i]['args'][1]]);cpoints.push([commands[i]['args'][2],commands[i]['args'][3]]);break;case'closePath':end[0]=first[0];end[1]=first[1];break;}
var sum=0;var t=1;var z=t/2;var n=20;for(var xi=0;xi<n;xi++){var corrected_t=z*Tvalues[n][xi]+z;var derivp=getDerivPathPoint(corrected_t,start,end,cpoints);var combined=Math.sqrt(derivp[0]*derivp[0]+derivp[1]*derivp[1]);sum+=Cvalues[n][xi]*combined;}
sum*=z;var order=2+cpoints.length-1;var LUT_resolution=1+parseInt(400*Math.log(order)/Math.log(4));var LUT=[];var t_lut,r=parseFloat(LUT_resolution-1);if(r!=0){for(var idx=0;idx<LUT_resolution;idx++){t_lut=idx/r;LUT.push({t:t_lut,d:getPathPartialLength(t_lut,start,end,cpoints)});}}
path_segments_pixel_lenght.push({plen:sum,start:start,end:end,cpoints:cpoints,LUT:LUT});path_pixel_lenght+=sum;start=[end[0],end[1]];}}
return path_pixel_lenght;}
function getPathPartialLength(t,start,end,cpoints){var sum=0;var z=t/2;var n=20;for(var xi=0;xi<n;xi++){var corrected_t=z*Tvalues[n][xi]+z;var derivp=getDerivPathPoint(corrected_t,start,end,cpoints);var combined=Math.sqrt(derivp[0]*derivp[0]+derivp[1]*derivp[1]);sum+=Cvalues[n][xi]*combined;}
sum*=z;return sum;}
function getPathPoint(t,start,end,control_points){var point=[0,0];if(!(control_points instanceof Array)){control_points=[];}
var points=[start];for(var cpi=0;cpi<control_points.length;cpi++){points.push(control_points[cpi]);}
points.push(end);if(t){t=t>1?1:(t<0?0:t);}else{t=0;}
var n=points.length-1;var t1=1-t;var coefs=[1];for(var ni=0;ni<n;ni++){coefs.push(coefs[ni]*(n-ni)/(ni+1));}
for(var ci=0;ci<=n;ci++){var tmp_term=Math.pow(t1,n-ci)*Math.pow(t,ci)*coefs[ci];point[0]+=points[ci][0]*tmp_term;point[1]+=points[ci][1]*tmp_term;}
return point;}
function getDerivPathPoint(t,start,end,control_points){var point=[0,0];if(!(control_points instanceof Array)){control_points=[];}
var points=[start];for(var cpi=0;cpi<control_points.length;cpi++){points.push(control_points[cpi]);}
points.push(end);if(t){t=t>1?1:(t<0?0:t);}else{t=0;}
var n=points.length-1;var k=n-1;var t1=1-t;var coefs=[1];for(var ni=0;ni<k;ni++){coefs.push(coefs[ni]*(k-ni)/(ni+1));}
for(var ci=0;ci<=k;ci++){var tmp_term=Math.pow(t1,k-ci)*Math.pow(t,ci)*coefs[ci]*n;point[0]+=(points[ci+1][0]-points[ci][0])*tmp_term;point[1]+=(points[ci+1][1]-points[ci][1])*tmp_term;}
return point;}
function getTangentAndNormal(t,start,end,control_points){var point=getPathPoint.apply(null,arguments);var dpoint=getDerivPathPoint.apply(null,arguments);var d=Math.sqrt(dpoint[0]*dpoint[0]+dpoint[1]*dpoint[1]);var normalize_tangent=[dpoint[0]/d,dpoint[1]/d];var normal=[-normalize_tangent[1],normalize_tangent[0]];return{point:point,tangent:dpoint,normalized_tangent:normalize_tangent,normal:normal};}
function parseSvgPath(){SVGPath2Cnvs.parse(data,commands);updatePathVertexCache();}
function getTforDistLUT(offset,pathinfo){var t=offset/pathinfo.plen;for(var i=0;i<pathinfo.LUT.length;i++){if(offset<=pathinfo.LUT[i]['d']){if(offset==pathinfo.LUT[i]['d']){return pathinfo.LUT[i]['t'];}
return(pathinfo.LUT[i]['t']+pathinfo.LUT[i-1]['t'])/2;}}
return t;}
function updatePathVertexCache(){if(commands.length){while(path_vertexes.length){path_vertexes.pop();}
while(cp_lines.length){cp_lines.pop();}
var control_points=[];for(var i=0;i<commands.length;i++){var pvertex={x:0,y:0,links:[],type:'v'};var vertex_ok=false;switch(commands[i]['func']){case'moveTo':case'lineTo':vertex_ok=true;pvertex.x=commands[i]['args'][0];pvertex.y=commands[i]['args'][1];pvertex.cmd_p_idx=0;break;case'bezierCurveTo':var c1={x:commands[i]['args'][0],y:commands[i]['args'][1],links:[path_vertexes.length-1],type:'c',cmd_p_idx:0,cmd_idx:i};var c2={x:commands[i]['args'][2],y:commands[i]['args'][3],links:[path_vertexes.length],type:'c',cmd_p_idx:2,cmd_idx:i};control_points.push(c1);control_points.push(c2);pvertex.x=commands[i]['args'][4];pvertex.y=commands[i]['args'][5];pvertex.cmd_p_idx=4;vertex_ok=true;break;case'quadraticCurveTo':vertex_ok=true;var c={x:commands[i]['args'][0],y:commands[i]['args'][1],links:[path_vertexes.length-1,path_vertexes.length],type:'c',cmd_p_idx:0,cmd_idx:i};control_points.push(c);pvertex.x=commands[i]['args'][2];pvertex.y=commands[i]['args'][3];pvertex.cmd_p_idx=2;break;case'closePath':}
if(vertex_ok){pvertex.cmd_idx=i;path_vertexes.push(pvertex);}}
while(control_points.length){var tmp_cp=control_points.shift();for(var link_idx=0;link_idx<tmp_cp.links.length;link_idx++){cp_lines.push([path_vertexes.length,tmp_cp.links[link_idx]]);}
path_vertexes.push(tmp_cp);}}}
this.applyScaleToFontSize=function(){if(this.has_path()){this.use_pivot(true);this.scalePath(this.getScaleX());this.use_pivot(false);}
applyScaleToFontSize_org.apply(this,arguments);}
this.setPathStr=function(svgpath){data=svgpath;parseSvgPath();calcPathLength();updateLetters();};this.setText=function(){setText_org.apply(this,arguments);text=this.getText();updateLetters();};this.setFontFamily=function(){setFontFamily_org.apply(this,arguments);font_family='"'+this.getFontFamily()+'"';if(txt_dy){txt_dy=Math.ceil(this.getFontSize()*0.75);}
updateLetters();};this.setFontSize=function(){fontsize=setFontSize_org.apply(this,arguments);if(txt_dy){txt_dy=Math.ceil(this.getFontSize()*0.75);}
updateLetters();return fontsize};this.setColor=function(){setColor_org.apply(this,arguments);color=this.getColor();};this.setStroke=function(){setStroke_org.apply(this,arguments);stroke=this.getStroke();};this.setStrokeWidth=function(){setStrokeWidth_org.apply(this,arguments);stroke_width=this.getStrokeWidth();};this.setColorAllChild=function(){this.setColor.apply(this,arguments)};this.setFontStyle=function(){setFontStyle_org.apply(this,arguments);fontstyle=this.getFontStyle();updateLetters();};this.default_text=function(dstr){default_text=default_text_org.apply(this,arguments);return default_text;};this.letter_spacing=function(ltrsp){ltrsp=parseInt(ltrsp,10);if(!isNaN(ltrsp)){letter_spacing=ltrsp;updateLetters();}
return letter_spacing;};this.get_letters=function(){return letters.slice(0);};this.render=function(ctx,cctx,timedelta){if(this.hide!==true){ctx.save();ctx.font=fontstyle+' '+fontsize+'px '+font_family;ctx.fillStyle=color;if(stroke){ctx.strokeStyle=stroke;if(stroke_width)ctx.lineWidth=stroke_width;}
this.transformsApply(ctx);if(commands.length&&use_path){if(!(this.for_preview&&(text==default_text))){for(var lidx=0;lidx<letters.length;lidx++){ctx.save();ctx.transform.apply(ctx,letters[lidx][0]);if(txt_dy){ctx.translate(0,txt_dy);}
ctx.fillText(letters[lidx][1],0,0);if(stroke){ctx.strokeText(letters[lidx][1],0,0);}
ctx.restore();}}}else{ctx.fillText(this.for_preview&&text==default_text?'':text,0,0);if(stroke){ctx.strokeText(this.for_preview&&text==default_text?'':text,0,0);}}
ctx.restore();}
if((this.draw_cntrl!==false)){if((this.hide===true)){if(!this.has_path()){this.drawControls(cctx);}}else{this.drawControls(cctx);}}};this.pointInBbox=function(point){var actv=this.getActive();var extrapx=actv?this.bboxpad():0;var sz=this.getSize();var bbpos=this.bboxpos();var zoom=this.editor().zoom();var vpoint=this.editor().viewtopleft();var _point={x:point.x-vpoint.x,y:point.y-vpoint.y};FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],_point,true);FLSUtil.unTransformPoint(this.getMatrix(),_point,true);return(_point.x>=(bbpos.x-extrapx))&&(_point.x<=(bbpos.x+sz.width+extrapx))&&(_point.y>=(bbpos.y-extrapx))&&(_point.y<=(bbpos.y+sz.height+extrapx));};this.containsPoint=function(point){if(!this.selectable())return false;if((!commands.length||this.getActive())&&(enable_path_edit===false)||!use_path){return this.pointInBbox(point);}else{var zoom=this.editor().zoom();var vpoint=this.editor().viewtopleft();var _point={x:point.x-vpoint.x,y:(point.y-vpoint.y)};FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],_point,true);FLSUtil.unTransformPoint(this.getMatrix(),_point,true);for(var i=0;i<letters.length;i++){var tpoint=FLSUtil.unTransformPoint(letters[i][0],_point);tpoint.y-=txt_dy;var ltl={x:0,y:-fontsize};var lrb={x:letters[i][2],y:0};if((tpoint.x>=ltl.x)&&(tpoint.x<=lrb.x)&&(tpoint.y>=ltl.y)&&(tpoint.y<=lrb.y)){return true;}}
return false;}};this.getProperties=function(){var props={tmatrix:this.getMatrix().slice(0),color:color,text:text,default_text:default_text,fontsize:fontsize,font_family:this.getFontFamily(),hastextedit:this.hastextedit(),fonticons:this.fonticons(),bold:this.bold(),italic:this.italic(),data:SVGPath2Cnvs.commandsDataStr(commands),letter_spacing:letter_spacing,use_path:use_path,txt_dy:txt_dy,alluppercase:this.alluppercase?true:false,alllowercase:this.alllowercase?true:false,id:this.id};if(this.align_point){props.align_point=this.align_point;}
return props;};this.setProperties=function(props){var call_measurements=true;if(typeof(props.alllowercase)!='undefined'){this.alllowercase=props.alllowercase;}
if(typeof(props.alluppercase)!='undefined'){this.alluppercase=props.alluppercase;}
if(typeof(props.align_point)!='undefined'){this.align_point=props.align_point;}
if(typeof(props.txt_dy)!='undefined'){txt_dy=props.txt_dy;}
if(typeof(props.tmatrix)!='undefined'){this.setMatrix(props.tmatrix);}
if(typeof(props.default_text)!='undefined'){this.default_text(props.default_text);}
if(typeof(props.text)!='undefined'){this.setText(props.text);call_measurements=false;}
if(typeof(props.fontsize)!='undefined'){this.setFontSize(props.fontsize);call_measurements=false;}
if(typeof(props.font_family)!='undefined'){this.setFontFamily(props.font_family);call_measurements=false;}
if(typeof(props.letter_spacing)!='undefined'){this.letter_spacing(props.letter_spacing);call_measurements=false;}
if(typeof(props.data)!='undefined'){this.setPathStr(props.data);call_measurements=false;}
if(typeof(props.color)!='undefined'){this.setColor(props.color);}
if(typeof(props.hastextedit)!='undefined'){this.hastextedit(props.hastextedit);}
if(typeof(props.fonticons)!='undefined'){this.fonticons(props.fonticons);}
if(typeof(props.use_path)!='undefined'){this.use_path(props.use_path);call_measurements=false;}
if(typeof(props.id)!='undefined'){_this.id=props.id;}
if(call_measurements)this.updateMeasurements();};this.use_path=function(_use_pth){if((typeof(_use_pth)=='boolean')&&commands.length){use_path=_use_pth;if(use_path){updateLetters();}else{this.updateMeasurements();}}
return use_path;};this.has_path=function(){return use_path&&(commands.length>0);};this.enable_path_edit=function(enable_pth_ed){if(typeof(enable_pth_ed)=='boolean'){enable_path_edit=enable_pth_ed;}
return enable_path_edit;};this.drawControls=function(ctx){if(ctx&&(!enable_path_edit||!use_path||!commands.length)){drawControls_org.apply(this,arguments);if(this.getActive()&&this.has_path()){var use_pivot=this.use_pivot();var pivot=this.pivot();var px=use_pivot?pivot.x:0,py=use_pivot?pivot.y:0,zoom=this.editor().zoom();var _bboxpad=this.bboxpad();var bboxpos=this.bboxpos();var objrotation=-_this.getRotation();var size=this.getSize();var rb={x:(size.width)+(bboxpos.x-px)+_bboxpad,y:(bboxpos.y-py)+(size.height)+_bboxpad};var lb={x:(bboxpos.x-px-_bboxpad),y:(bboxpos.y-py)+(size.height)+_bboxpad};var lt={x:(bboxpos.x-_bboxpad-px),y:(bboxpos.y-_bboxpad-py)};var rt={x:size.width+bboxpos.x-px+_bboxpad,y:bboxpos.y-py-_bboxpad};var sb={x:(rb.x+lb.x)/2,y:((rb.y+lb.y)/2)};var sb_top={x:(rt.x+lt.x)/2,y:((rt.y+lt.y)/2)};this.applyTransformMatrixToPoint(sb);this.applyTransformMatrixToPoint(sb_top);sb.x+=px;sb.y+=py;sb_top.x+=px;sb_top.y+=py;if(zoom!=1){FLSUtil.transformPoint([zoom,0,0,zoom,0,0],sb,true);FLSUtil.transformPoint([zoom,0,0,zoom,0,0],sb_top,true);}
var strokeStyle=this.default_control_border_color();var activeFillStyle=this.default_control_active_fill_color();var activeIconColor='rgb(255,255,255)';for(var oci in other_controls.normal){strokeStyle=fonticonprops[oci]['control_border_color']?fonticonprops[oci]['control_border_color']:this.default_control_border_color();strokeStyle=((current_other_control==oci)&&fonticonprops[oci]['control_active_border_color'])?fonticonprops[oci]['control_active_border_color']:strokeStyle;activeFillStyle=fonticonprops[oci]['control_active_fill_color']?fonticonprops[oci]['control_active_fill_color']:this.default_control_active_fill_color();activeIconColor=fonticonprops[oci]['active_color']?fonticonprops[oci]['active_color']:'rgb(255,255,255)';switch(oci){case'path_scale_bottom':case'path_scale_top':var ctrl=(oci=='path_scale_bottom')?sb:sb_top
ctx.save();ctx.fillStyle=current_other_control==oci?activeFillStyle:fonticonprops[oci]['bg_color'];ctx.strokeStyle=strokeStyle;if(oci&&(current_other_control==oci)&&fonticonprops[oci]['active_shadow']){ctx.shadowColor='rgba(0,0,0,0.3)';ctx.shadowBlur=4;}
ctx.translate(ctrl.x,ctrl.y);ctx.rotate(objrotation);ctx.beginPath();ctx.arc(0,0,otherControlSize,0,2*Math.PI);ctx.closePath();ctx.fill();ctx.stroke();ctx.shadowColor='transparent';ctx.font=fonticonprops[oci]['size']+'px FlsObjectEditIcons';ctx.fillStyle=current_other_control==oci?activeIconColor:fonticonprops[oci]['color'];var text=fonticonprops[oci]['glyph'];ctx.fillText(text,fonticontextpos[oci]['x'],fonticontextpos[oci]['y']);ctx.restore();other_controls.normal[oci]=ctrl;break;}}}}else{if(ctx&&this.getActive()&&commands.length){ctx.save();ctx.strokeStyle='rgb(255,0,0)';ctx.lineWidth=1.5;ctx.beginPath();for(var cidx=0;cidx<commands.length;cidx++){var cmd=commands[cidx];var newargs=[];for(var arg_idx=0;arg_idx<cmd.args.length;arg_idx+=2){var cp={x:cmd.args[arg_idx],y:cmd.args[arg_idx+1]};this.applyTransformMatrixToPoint(cp);newargs.push(cp.x);newargs.push(cp.y);}
ctx[cmd['func']].apply(ctx,newargs);}
ctx.stroke();ctx.restore();ctx.save();ctx.strokeStyle='rgb(0,0, 255)';ctx.lineWidth=1;for(var vli=0;vli<cp_lines.length;vli++){ctx.beginPath();var s={x:path_vertexes[cp_lines[vli][0]].x,y:path_vertexes[cp_lines[vli][0]].y,};var e={x:path_vertexes[cp_lines[vli][1]].x,y:path_vertexes[cp_lines[vli][1]].y,};this.applyTransformMatrixToPoint(s);this.applyTransformMatrixToPoint(e);ctx.moveTo(s.x,s.y);ctx.lineTo(e.x,e.y);ctx.stroke();}
ctx.restore();ctx.save();ctx.strokeStyle='rgb(255,255,255)';ctx.shadowColor='rgba(0,0,0,0.8)';ctx.shadowBlur=3;ctx.shadowOffsetX=1;ctx.shadowOffsetY=1;ctx.lineWidth=1;for(var cpli=0;cpli<path_vertexes.length;cpli++){var pv={x:path_vertexes[cpli].x,y:path_vertexes[cpli].y,};this.applyTransformMatrixToPoint(pv);ctx.fillStyle=path_vertexes[cpli].type=='v'?'rgb(255,0,0)':'rgb(0,0,255)';if(current_control==path_vertexes[cpli])ctx.fillStyle='rgb(0,255,0)';ctx.beginPath();ctx.arc(pv.x,pv.y,vertex_cntrl_radius,0,2*Math.PI);ctx.closePath();ctx.fill();ctx.stroke();}
ctx.restore();ctx.save();var use_pivot=this.use_pivot();var pivot=this.pivot();var px=use_pivot?pivot.x:0,py=use_pivot?pivot.y:0,zoom=this.editor().zoom();var objrotation=-_this.getRotation();for(var oci in other_controls.path_edit){switch(oci){case'path_scale':var pbbox=SVGPath2Cnvs.bbox(commands)
var pszize={width:(pbbox.x1-pbbox.x0),height:(pbbox.y1-pbbox.y0)};var sb={x:(pszize.width/2)+(pbbox.x0-px),y:(pbbox.y0-py)+(pszize.height/2)};this.applyTransformMatrixToPoint(sb);sb.x+=px;sb.y+=py;if(zoom!=1){FLSUtil.transformPoint([zoom,0,0,zoom,0,0],sb,true);}
strokeStyle=fonticonprops[oci]['control_border_color']?fonticonprops[oci]['control_border_color']:this.default_control_border_color();strokeStyle=((current_other_control==oci)&&fonticonprops[oci]['control_active_border_color'])?fonticonprops[oci]['control_active_border_color']:strokeStyle;activeFillStyle=fonticonprops[oci]['control_active_fill_color']?fonticonprops[oci]['control_active_fill_color']:this.default_control_active_fill_color();activeIconColor=fonticonprops[oci]['active_color']?fonticonprops[oci]['active_color']:'rgb(255,255,255)';ctx.save();ctx.fillStyle=current_other_control==oci?activeFillStyle:fonticonprops[oci]['bg_color'];ctx.strokeStyle=strokeStyle;ctx.translate(sb.x,sb.y);ctx.rotate(objrotation);ctx.beginPath();ctx.arc(0,0,otherControlSize,0,2*Math.PI);ctx.closePath();if(oci&&(current_other_control==oci)&&fonticonprops[oci]['active_shadow']){ctx.shadowColor='rgba(0,0,0,0.3)';ctx.shadowBlur=4;}
ctx.fill();ctx.stroke();ctx.shadowColor='transparent';ctx.font=fonticonprops[oci]['size']+'px FlsObjectEditIcons';ctx.fillStyle=current_other_control==oci?activeIconColor:fonticonprops[oci]['color'];var text=fonticonprops[oci]['glyph'];ctx.fillText(text,fonticontextpos[oci]['x'],fonticontextpos[oci]['y']);ctx.restore();other_controls.path_edit[oci]=sb;break;}}
ctx.restore();}}};this.whichControl=function(mousepos,mousepos2){var op='op:none';current_other_control='none';current_control=false;var tmp=this.editor().viewtopleft();var mpos={x:mousepos.x-tmp.x,y:mousepos.y-tmp.y}
if(this.getActive()){if(!enable_path_edit||!commands.length){for(var oci in other_controls.normal){var cpos={x:other_controls.normal[oci].x,y:other_controls.normal[oci].y};if(FLSUtil.pointInCircle(cpos,otherControlSize,mpos)){current_other_control=oci;op='op:'+oci;break;}}
if(op=='op:none'){op=whichControl_org.apply(this,arguments)}}else{var tmp=this.editor().viewtopleft();var mpos={x:mousepos.x-tmp.x,y:mousepos.y-tmp.y}
for(var ci in path_vertexes){var cpos={x:path_vertexes[ci].x,y:path_vertexes[ci].y};this.applyTransformMatrixToPoint(cpos);if(FLSUtil.pointInCircle(cpos,controlSize,mpos)){op='op:vertex_move';current_control=path_vertexes[ci];break;}}
if(op=='op:none'){for(var oci in other_controls.path_edit){var cpos={x:other_controls.path_edit[oci].x,y:other_controls.path_edit[oci].y};if(FLSUtil.pointInCircle(cpos,otherControlSize,mpos)){current_other_control=oci;op='op:'+oci;break;}}}
if(op=='op:none'){var check=this.containsPoint(mousepos,true);if(check){op='op:translate';}}}}
return op;};this.mvertex_move=function(from,to){if(current_control){var zoom=this.editor().zoom();var _from,_to,cfrom={x:from.x,y:from.y},cto={x:to.x,y:to.y};if(zoom!=1){FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],cfrom,true);FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],cto,true);}
_from=this.transformPoint(cfrom);_to=this.transformPoint(cto);var dx=_to.x-_from.x;var dy=_to.y-_from.y;current_control.x+=dx;current_control.y+=dy;commands[current_control.cmd_idx].args[current_control.cmd_p_idx]+=dx;commands[current_control.cmd_idx].args[current_control.cmd_p_idx+1]+=dy;calcPathLength();updateLetters();}};this.mpath_scale=function(from,to,origin,op_type){var pos=this.getPosition();var zoom=this.editor().zoom();var pivot=this.pivot();var grow_scale=false;var path_bbox;var current_center={x:pivot.x,y:pivot.y};FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],origin,true);var _from=FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],from);var _to=FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],to);var _pivot={x:pos.x,y:pos.y};_from.x-=origin.x;_from.y-=origin.y;_to.x-=origin.x;_to.y-=origin.y;if(enable_path_edit==false){var corners=[];var ocntr=this.objCenter(corners);_pivot.x=((corners[1].x+corners[0].x)/2);_pivot.y=((corners[1].y+corners[0].y)/2);switch(op_type){case'path_scale_top':grow_scale=true;break;default:case'path_scale_bottom':break;}}
var sizeold=FLSUtil.pointDistance(_pivot,_from);var sizenew=FLSUtil.pointDistance(_pivot,_to);var s=Math.abs(enable_path_edit||grow_scale?(sizenew/sizeold):(sizeold/sizenew));if(s<1){if(path_pixel_lenght<=(this.get_text_width()+10)){return false;}}else{var mysize=this.getSize();if(mysize.height<this.getFontSize()*1.2)return false;}
if(enable_path_edit){if((_to.x-_pivot.x)<0){return false;}}else{if(grow_scale){if((_pivot.y-_to.y)<0){return false;}}else{if((_to.y-_pivot.y)<0){return false;}}}
if(enable_path_edit){path_bbox=SVGPath2Cnvs.bbox(commands);current_center.x=(path_bbox.x1-path_bbox.x0)/2;current_center.y=(path_bbox.y1-path_bbox.y0)/2;}
var scale_mtrx=[1,0,0,1,0,0];FLSUtil.tmatrixScale(scale_mtrx,s,s);var commands_args_cpy=[];for(var cmd_idx=0;cmd_idx<commands.length;cmd_idx++){commands_args_cpy.push(commands[cmd_idx].args.slice(0));}
SVGPath2Cnvs.applyMatrix(commands,scale_mtrx);calcPathLength();if(s<1&&(path_pixel_lenght<=(this.get_text_width()+10))){for(var cmd_idx=0;cmd_idx<commands.length;cmd_idx++){commands[cmd_idx].args=commands_args_cpy[cmd_idx];}
calcPathLength();}else{updateLetters();updatePathVertexCache()
var new_center={x:0,y:0};if(enable_path_edit){path_bbox=SVGPath2Cnvs.bbox(commands);new_center.x=(path_bbox.x1-path_bbox.x0)/2;new_center.y=(path_bbox.y1-path_bbox.y0)/2;}else{new_center=pivot;}
var dx=current_center.x-new_center.x;var dy=current_center.y-new_center.y;this.translate(dx,dy);}};this.scalePath=function(nscl){if(this.has_path()){var pivot=this.pivot();var current_center={x:pivot.x,y:pivot.y};var scale_mtrx=[1,0,0,1,0,0];FLSUtil.tmatrixScale(scale_mtrx,nscl,nscl);SVGPath2Cnvs.applyMatrix(commands,scale_mtrx);calcPathLength();updatePathVertexCache()}}
this.toSVG=function(svgparent){var tn=document.createElementNS('http://www.w3.org/2000/svg','text');if(color.indexOf('%')!=-1){var rgb=color.replace('rgb(','').replace(')','').replace(/%/ig,'').split(',');var r=(parseFloat(rgb[0],10)*2.55).toFixed(0);var g=(parseFloat(rgb[1],10)*2.55).toFixed(0);var b=(parseFloat(rgb[2],10)*2.55).toFixed(0);color='rgb('+r+','+g+','+b+')';}
var stroke_style=[];if(stroke){stroke_style.push('stroke:'+stroke);if(stroke_width)stroke_style.push('stroke-width:'+stroke_width);}
tn.setAttribute('style','fill:'+color+(stroke_style.length?';'+stroke_style.join(';'):''));tn.setAttribute('font-family',font_family.replace(/"/gi,''));tn.setAttribute('font-size',fontsize);tn.setAttribute('transform','matrix('+this.getMatrix().join(',')+')');if(this.bold()){tn.setAttribute('font-weight','bold');}
if(this.italic()){tn.setAttribute('font-style','italic');}
if(typeof(this.id)!='undefined'&&this.id){tn.setAttribute('id',this.id);}
tn.setAttribute('xml:space','preserve');if(typeof(this.logochild)!='undefined'&&this.logochild){tn.setAttribute('logochild',this.logochild);tn.setAttribute('type','logo');}
if(typeof(this.bcchild)!='undefined'&&this.bcchild){tn.setAttribute('type','bc');}
if(typeof(this.alluppercase)!='undefined'&&this.alluppercase){tn.setAttribute('data-alluppercase','1');}
if(typeof(this.alllowercase)!='undefined'&&this.alllowercase){tn.setAttribute('data-alllowercase','1');}
var cdata_txt=new DOMParser().parseFromString('<xml></xml>','application/xml').createCDATASection((text!=default_text||this.for_bc_tpl)?text:'');if(commands.length&&use_path){data=SVGPath2Cnvs.commandsDataStr(commands);var pathDefId='flsTextPath'+((typeof(this.id)!='undefined'&&this.id)?this.id:Math.floor(Math.random()*1000)+1);var txtPathDef=document.createElementNS('http://www.w3.org/2000/svg','defs');var txtPathDefPath=document.createElementNS('http://www.w3.org/2000/svg','path');txtPathDefPath.setAttribute('id',pathDefId);txtPathDefPath.setAttribute('d',data);txtPathDef.appendChild(txtPathDefPath);if(txt_dy){tn.setAttribute('dy',txt_dy);}
var tnTxtPAth=document.createElementNS('http://www.w3.org/2000/svg','textPath');tnTxtPAth.setAttribute('xlink:href','#'+pathDefId);tnTxtPAth.appendChild(cdata_txt);if(center_text_on_path){tn.setAttribute('text-anchor','middle');tnTxtPAth.setAttribute('startOffset','50%');}
if(letter_spacing){tn.setAttribute('letter-spacing',letter_spacing);}
tn.appendChild(tnTxtPAth);if(typeof(svgparent)!='undefined'){svgparent.appendChild(document.createTextNode('\n    '));svgparent.appendChild(txtPathDef);}}else{tn.appendChild(cdata_txt);}
if(typeof(svgparent)!='undefined'){svgparent.appendChild(document.createTextNode('\n    '));svgparent.appendChild(tn);}
return tn;};this.txt_dy=function(_dy){_dy=parseInt(_dy);if(!isNaN(_dy)){txt_dy=_dy;updateLetters();}
return txt_dy;};this.center_text_on_path=function(_center){if(typeof(_center)=='boolean'){center_text_on_path=_center;updateLetters();}
return center_text_on_path;};this.get_text_width=function(){var ctx=document.createElement('canvas').getContext('2d');ctx.font=fontstyle+' '+fontsize+'px '+font_family;return ctx.measureText(text).width;};this.calculateBoundingBox=function(){if(commands.length&&use_path&&letters.length){var pbb={x0:0,y0:-fontsize,x1:1,y1:0};for(var lidx=0;lidx<letters.length;lidx++){var letter_info=letters[lidx];var ltl={x:0,y:-fontsize+txt_dy};var ltr={x:letter_info[2],y:-fontsize+txt_dy};var lrb={x:letter_info[2],y:0+txt_dy};var llb={x:0,y:0+txt_dy};var lettertransform=letter_info[0];FLSUtil.transformPoint(lettertransform,ltl,true);FLSUtil.transformPoint(lettertransform,ltr,true);FLSUtil.transformPoint(lettertransform,lrb,true);FLSUtil.transformPoint(lettertransform,llb,true);pbb.x0=lidx==0?Math.min(ltl.x,lrb.x,ltr.x,llb.x):Math.min(pbb.x0,ltl.x,lrb.x,ltr.x,llb.x);pbb.y0=lidx==0?Math.min(ltl.y,lrb.y,ltr.y,llb.y):Math.min(pbb.y0,ltl.y,lrb.y,ltr.y,llb.y);pbb.x1=lidx==0?Math.max(ltl.x,lrb.x,ltr.x,llb.x):Math.max(pbb.x1,ltl.x,lrb.x,ltr.x,llb.x);pbb.y1=lidx==0?Math.max(ltl.y,lrb.y,ltr.y,llb.y):Math.max(pbb.y1,ltl.y,lrb.y,ltr.y,llb.y);}
var width=pbb.x1-pbb.x0;var height=pbb.y1-pbb.y0;_this.setSize(width,height);_this.bboxpos(pbb.x0,pbb.y0);var pvt={x:Math.floor(pbb.x0+width/2),y:Math.floor(pbb.y0+height/2)};_this.pivot(pvt);_this.center(pvt);}else{this.setText(this.getText());}}};FLSEditorCore.CPathText.prototype=new FLSEditorCore.CText;FLSEditorCore.CSelectionGroup=function(x,y){FLSEditorCore.CObject.apply(this,arguments);var resize_controls={'resize_x':{x:0,y:0},'resize_xs':{x:0,y:0}};var current_control=false;var current_resize_control='none';var otherControlSize=10;var _this=this;this.removable(false);this.hasrotate(false);this.setSize(0,0);this.setPosition(x,y);this.bboxpad(2);this.pivot({x:0,y:0});this.center(this.pivot());var sbox={x1:0,y1:0,x2:0,y2:0};var sl_wdth=0;var elements=[];var move_org=this.move;var mscale_org=this.mscale;var kbscale_org=this.kbscale;var setSize_org=this.setSize;var drawControls_org=this.drawControls;var whichControl_org=this.whichControl;function _applyMatrixToElements(){var smatrx=[].concat(_this.getMatrix());FLSUtil.tmatrixTranslate(smatrx,-smatrx[4],-smatrx[5]);for(var i=0;i<elements.length;i++){var tmtrx=elements[i].getMatrix();var mulmtrx=FLSUtil.tmatrixMultiply(tmtrx,smatrx);elements[i].setMatrix(mulmtrx);}
var obj_sz=_this.getSize();var obj_scale=_this.getScaleX();var normalized_size={width:obj_sz.width*obj_scale,height:obj_sz.height*obj_scale};_this.setSize(normalized_size.width,normalized_size.height);var scale_delta=obj_sz.width/(obj_sz.width*obj_scale);_this.scaleUniform(scale_delta);}
this.updateBox=function(){sbox.x1=0;sbox.y1=0;sbox.x2=0;sbox.y2=0;for(var i=0;i<elements.length;i++){var _bboxpos=elements[i].bboxpos();var omtrx=elements[i].getMatrix();var _size=elements[i].getSize();var lt={x:_bboxpos.x,y:_bboxpos.y};var rt={x:_size.width+_bboxpos.x,y:_bboxpos.y};var rb={x:_size.width+_bboxpos.x,y:_bboxpos.y+_size.height};var lb={x:_bboxpos.x,y:_bboxpos.y+_size.height};FLSUtil.transformPoint(omtrx,lt,true);FLSUtil.transformPoint(omtrx,rt,true);FLSUtil.transformPoint(omtrx,rb,true);FLSUtil.transformPoint(omtrx,lb,true);var min_x=Math.min(lt.x,rt.x,rb.x,lb.x);var max_x=Math.max(lt.x,rt.x,rb.x,lb.x);var min_y=Math.min(lt.y,rt.y,rb.y,lb.y);var max_y=Math.max(lt.y,rt.y,rb.y,lb.y);sbox.x1=i>0?Math.min(sbox.x1,min_x):min_x;sbox.y1=i>0?Math.min(sbox.y1,min_y):min_y;sbox.x2=i>0?Math.max(sbox.x2,max_x):max_x;sbox.y2=i>0?Math.max(sbox.y2,max_y):max_y;}
this.setPosition(sbox.x1,sbox.y1);var w=sbox.x2-sbox.x1;var h=sbox.y2-sbox.y1;this.setSize(w,h);this.center({x:w/2,y:h/2});};this.addElement=function(elmnt){if((elmnt!=this)&&(elmnt instanceof FLSEditorCore.CObject)&&(elements.indexOf(elmnt)==-1)){elmnt.in_selection=true;elements.push(elmnt);this.updateBox();return true;}
return false;};this.clear=function(){while(elements.length){var elm=elements.shift();elm.in_selection=false;}};this.setElements=function(spoint,epoint){this.clear();var sx=Math.min(spoint.x,epoint.x);var sy=Math.min(spoint.y,epoint.y);var ex=Math.max(spoint.x,epoint.x);var ey=Math.max(spoint.y,epoint.y);spoint.x=sx;spoint.y=sy;epoint.x=ex;epoint.y=ey;this.setSize(0,0);this.setPosition(0,0);this.setActive(false);if(this.editor()){this.setMatrix([1,0,0,1,0,0]);var objs;if(this.only_layout_zones===true){objs=this.editor().getLayoutObjects();}else{objs=this.editor().getObjects().concat(this.editor().getLayoutObjects());}
var zoom=this.editor().zoom();var vwt_pos=this.editor().viewtopleft();for(var i=0;i<objs.length;i++){var _size=objs[i].getSize();if(!objs[i].fixed()&&_size.width&&objs[i].selectable()){var _bboxpos=objs[i].bboxpos();var omtrx=objs[i].getMatrix();var lt={x:_bboxpos.x,y:_bboxpos.y};var rt={x:_size.width+_bboxpos.x,y:_bboxpos.y};var rb={x:_size.width+_bboxpos.x,y:_bboxpos.y+_size.height};var lb={x:_bboxpos.x,y:_bboxpos.y+_size.height};FLSUtil.transformPoint(omtrx,lt,true);FLSUtil.transformPoint(omtrx,rt,true);FLSUtil.transformPoint(omtrx,rb,true);FLSUtil.transformPoint(omtrx,lb,true);if(zoom!=1){FLSUtil.transformPoint([zoom,0,0,zoom,0,0],lt,true);FLSUtil.transformPoint([zoom,0,0,zoom,0,0],rt,true);FLSUtil.transformPoint([zoom,0,0,zoom,0,0],rb,true);FLSUtil.transformPoint([zoom,0,0,zoom,0,0],lb,true);}
var min_x=Math.min(lt.x,rt.x,rb.x,lb.x)+vwt_pos.x;var max_x=Math.max(lt.x,rt.x,rb.x,lb.x)+vwt_pos.x;var min_y=Math.min(lt.y,rt.y,rb.y,lb.y)+vwt_pos.y;var max_y=Math.max(lt.y,rt.y,rb.y,lb.y)+vwt_pos.y;var intersected=false;var contained=((min_x>=spoint.x)&&(min_y>=spoint.y)&&(max_x<=epoint.x)&&(max_y<=epoint.y));if(!contained&&(this.intersection_select===true)){intersected=FLSUtil.selectionIntersect({spoint:spoint,epoint:epoint},{lt:lt,rt:rt,rb:rb,lb:lb},vwt_pos);}
if(intersected||contained){sbox.x1=elements.length?Math.min(sbox.x1,min_x):min_x;sbox.y1=elements.length?Math.min(sbox.y1,min_y):min_y;sbox.x2=elements.length?Math.max(sbox.x2,max_x):max_x;sbox.y2=elements.length?Math.max(sbox.y2,max_y):max_y;objs[i].in_selection=true;elements.push(objs[i]);}}}
this.setPosition((sbox.x1-vwt_pos.x)/zoom,(sbox.y1-vwt_pos.y)/zoom);var w=sbox.x2-sbox.x1;var h=sbox.y2-sbox.y1;this.setSize(w/zoom,h/zoom);this.center({x:w/2/zoom,y:h/2/zoom});}
return elements;};this.setSize=function(width,height){setSize_org.apply(this,arguments);};this.setColor=function(_color){for(var i=0;i<elements.length;i++){if(elements[i].colorEditable()&&(elements[i]instanceof FLSEditorCore.CText)){elements[i].setColor(_color);}}};this.setColorAllChild=function(_color){for(var i=0;i<elements.length;i++){if(elements[i].colorEditable()){elements[i].setColorAllChild(_color);}}};this.getColor=function(){if(elements.length){for(var i=0;i<elements.length;i++){if(elements[i].colorEditable()&&(elements[i]instanceof FLSEditorCore.CText)){return elements[i].getColor();}}}
return'transparent';};this.setFontFamily=function(_ff){for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CText){elements[i].setFontFamily(_ff);}}
this.updateBox();};this.getFontFamily=function(){if(elements.length){for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CText){return elements[i].getFontFamily();}}}
return false;};this.setFontSize=function(_fs){for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CText){elements[i].setFontSize(_fs);}}
this.updateBox();};this.getFontSize=function(){if(elements.length){for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CText){return elements[i].getFontSize();}}}
return false;};this.bold=function(bold){var set=typeof(bold)==='boolean';if(elements.length){for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CText){if(set){elements[i].bold(bold);}else{return elements[i].bold();}}}}
return bold;};this.italic=function(italic){var set=typeof(italic)==='boolean';if(elements.length){for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CText){if(set){elements[i].italic(italic);}else{return elements[i].italic();}}}}
return italic;};this.move=function(){move_org.apply(this,arguments);for(var i=0;i<elements.length;i++){elements[i].move.apply(elements[i],arguments);}};this.mscale=function(){mscale_org.apply(this,arguments);_applyMatrixToElements();};this.kbscale=function(){if(this.scalable()){kbscale_org.apply(this,arguments);_applyMatrixToElements();}};this.render=function(ctx,cctx,timedelta){if(!this.getActive()){sl_wdth=sl_wdth?sl_wdth:0.5/this.editor().zoom();var sze=this.getSize();ctx.save();ctx.lineWidth=sl_wdth;ctx.strokeStyle='rgb(41, 243, 35)';ctx.fillStyle='rgba(41, 243, 35,0.05)';this.transformsApply(ctx);ctx.fillRect(0,0,sze.width,sze.height);ctx.strokeRect(0,0,sze.width,sze.height);ctx.restore();}
if(elements.length){this.drawControls(cctx);}};this.stranslate=function(dx,dy){var scl=this.getScaleX();var zoom=this.editor().zoom();for(var i=0;i<elements.length;i++){elements[i].move.apply(elements[i],[{x:0,y:0},{x:dx/scl*zoom,y:dy/scl*zoom}]);}};this.getElements=function(){return elements;};this.drawControls=function(ctx){drawControls_org.apply(this,arguments);if(this.only_layout_zones===true){if(ctx){var highlight=this.highlight()
var use_pivot=this.use_pivot();var pivot=this.pivot();var bboxpad=this.bboxpad();var bboxpos=this.bboxpos();var size=this.getSize();var px=use_pivot?pivot.x:0,py=use_pivot?pivot.y:0,zoom=this.editor().zoom();var _bboxpad=bboxpad;var lt={x:(bboxpos.x-_bboxpad-px),y:(bboxpos.y-_bboxpad-py)};var rt={x:size.width+bboxpos.x-px+_bboxpad,y:bboxpos.y-py-_bboxpad};var rb={x:(size.width)+(bboxpos.x-px)+_bboxpad,y:(bboxpos.y-py)+(size.height)+_bboxpad};var lb={x:(bboxpos.x-px-_bboxpad),y:(bboxpos.y-py)+(size.height)+_bboxpad};this.applyTransformMatrixToPoint(lt);this.applyTransformMatrixToPoint(rt);this.applyTransformMatrixToPoint(rb);this.applyTransformMatrixToPoint(lb);lt.x+=px;lt.y+=py;rt.x+=px;rt.y+=py;rb.x+=px;rb.y+=py;lb.x+=px;lb.y+=py;if(zoom!=1){FLSUtil.transformPoint([zoom,0,0,zoom,0,0],lt,true);FLSUtil.transformPoint([zoom,0,0,zoom,0,0],rt,true);FLSUtil.transformPoint([zoom,0,0,zoom,0,0],rb,true);FLSUtil.transformPoint([zoom,0,0,zoom,0,0],lb,true);}
if(this.getActive()||highlight){if(highlight===false){var cntrl_radius=otherControlSize/2;var ilinewidth=4.5;ctx.save();ctx.strokeStyle='rgb(255,255,255)';ctx.shadowColor='rgba(0,0,0,0.8)';ctx.shadowBlur=3;ctx.shadowOffsetX=1;ctx.shadowOffsetY=1;var objrotation=-_this.getRotation();ctx.lineCap='round';for(var ci in resize_controls){switch(ci){case'resize_x':resize_controls[ci]={x:rt.x,y:(rt.y+rb.y)/2};ctx.fillStyle=current_resize_control==ci?'rgb(255,255,255)':'rgb(101,152,19)';break;case'resize_y':resize_controls[ci]={x:(lb.x+rb.x)/2,y:rb.y};ctx.fillStyle=current_resize_control==ci?'rgb(255,255,255)':'rgb(101,152,19)';break;case'resize_xs':resize_controls[ci]={x:lt.x,y:(rt.y+rb.y)/2};ctx.fillStyle=current_resize_control==ci?'rgb(255,255,255)':'rgb(101,152,19)';break;}
ctx.beginPath();ctx.arc(resize_controls[ci].x,resize_controls[ci].y,cntrl_radius,0,2*Math.PI);ctx.closePath();ctx.fill();ctx.stroke();}
ctx.restore();}}}}};this.whichControl=function(mousepos,mousepos2){var op='op:none';current_resize_control='none';current_control=false;var tmp=this.editor().viewtopleft();var mpos={x:mousepos.x-tmp.x,y:mousepos.y-tmp.y}
if(this.getActive()){if(this.only_layout_zones===true){for(var oci in resize_controls){var cpos={x:resize_controls[oci].x,y:resize_controls[oci].y};if(FLSUtil.pointInCircle(cpos,otherControlSize,mpos)){current_resize_control=oci;op='op:'+oci;break;}}}
if(op=='op:none'){op=whichControl_org.apply(this,arguments)}}
return op;};this.mresize_x=function(from,to,origin){if(this.only_layout_zones===true){var zoom=this.editor().zoom();var _to=FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],to);var _from=FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],from);var dx=_to.x-_from.x;var shortest_zone_w=0;for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CLayoutZone){var z_w=elements[i].getSize().width;if((shortest_zone_w==0)||(z_w<shortest_zone_w)){shortest_zone_w=z_w;}}}
if((shortest_zone_w<=20)&&((shortest_zone_w+dx)<20)&&(dx<0))return false;for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CLayoutZone){var lz_sz=elements[i].getSize();var lz_new_width=lz_sz.width+dx;elements[i].setSize(lz_new_width,lz_sz.height);}}
this.updateBox();}};this.mresize_xs=function(from,to,origin){if(this.only_layout_zones===true){var zoom=this.editor().zoom();var _to=FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],to);var _from=FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],from);var dx=_to.x-_from.x;var shortest_zone_w=0;for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CLayoutZone){var z_w=elements[i].getSize().width;if((shortest_zone_w==0)||(z_w<shortest_zone_w)){shortest_zone_w=z_w;}}}
if((shortest_zone_w<=20)&&((shortest_zone_w-dx)<20)&&(dx>0))return false;for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CLayoutZone){var lz_sz=elements[i].getSize();var lz_new_width=lz_sz.width-dx;elements[i].setSize(lz_new_width,lz_sz.height);elements[i].translateX(dx);}}
this.updateBox();}};this.kbresize=function(x,y,keep_right){y=0;if((this.only_layout_zones===true)&&x&&!y){if(typeof(keep_right)!=='boolean'){keep_right=false;}
x=parseFloat(x);y=parseFloat(y);x=isNaN(x)?0:x;y=isNaN(y)?0:y;var _x=keep_right?x*-1:x;var _y=keep_right?y*-1:y;var shortest_zone_w=0;for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CLayoutZone){var z_w=elements[i].getSize().width;if((shortest_zone_w==0)||(z_w<shortest_zone_w)){shortest_zone_w=z_w;}}}
if((shortest_zone_w<=20)&&((shortest_zone_w+_x)<20))return false;for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CLayoutZone){var lz_sz=elements[i].getSize();var lz_new_width=lz_sz.width+_x;if((keep_right==true)&&(lz_new_width!=lz_sz.width)){elements[i].translateX(x);}
elements[i].setSize(lz_new_width,lz_sz.height);}}
this.updateBox();}};this.hasTextElements=function(){for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CText){return true;}}
return false;};this.isEmpty=function(){return elements.length==0;}};FLSEditorCore.CSelectionGroup.prototype=new FLSEditorCore.CObject;FLSEditorCore.CTextCollection=function(x,y){FLSEditorCore.CObject.apply(this,arguments);var curtxt=null;var curtxtsclable=false;var curtxtremovable=false;var current_control=false;var min_collection_font_size=7;var max_collection_font_size=7;var _this=this;this.removable(false);this.hasrotate(false);this.unlockable(true);this.scalable(false);this.setSize(0,0);this.setPosition(x,y);this.bboxpad(2);this.pivot({x:0,y:0});this.center(this.pivot());var sbox={x1:0,y1:0,x2:0,y2:0};var sl_wdth=0;var elements=[];var move_org=this.move;var mscale_org=this.mscale;var setSize_org=this.setSize;var drawControls_org=this.drawControls;var whichControl_org=this.whichControl;var containsPoint_org=this.containsPoint;var unlocked_org=this.unlocked;var translate_org=this.translate;this.translate=function(dx,dy){if(this.unlocked()&&curtxt){curtxt.translate.apply(curtxt,arguments);this.updateBox();}else{translate_org.apply(this,arguments);}};this.unlocked=function(what){var is_unlocked=unlocked_org.apply(this,arguments);if(typeof(what)==='boolean'){if(curtxt){curtxt.setActive(is_unlocked);}}
return is_unlocked;};this.containsPoint=function(point){var point_check_result=containsPoint_org.apply(this,arguments);if(point_check_result&&unlocked_org()){var vpoint=this.editor().viewtopleft();var zoom=this.editor().zoom();var _point={x:point.x-vpoint.x,y:point.y-vpoint.y};FLSUtil.unTransformPoint([zoom,0,0,zoom,0,0],_point,true);for(var i=0;i<elements.length;i++){var el_bboxpos=elements[i].bboxpos();var el_sz=elements[i].getSize();var el_point=FLSUtil.unTransformPoint(elements[i].getMatrix(),_point,false)
if((el_bboxpos.x<=el_point.x)&&(el_sz.width+el_bboxpos.x>=el_point.x)&&(el_bboxpos.y<=el_point.y)&&(el_sz.height+el_bboxpos.y>=el_point.y)){if(curtxt){curtxt.setActive(false);curtxt.scalable(curtxtsclable);curtxt.removable(curtxtremovable);}
curtxt=elements[i];curtxt.setActive(true);curtxtsclable=curtxt.scalable();curtxtremovable=curtxt.removable();curtxt.scalable(false);curtxt.removable(false);break;}}}
return point_check_result;};this.updateBox=function(){sbox.x1=0;sbox.y1=0;sbox.x2=0;sbox.y2=0;for(var i=0;i<elements.length;i++){var _bboxpos=elements[i].bboxpos();var omtrx=elements[i].getMatrix();var _size=elements[i].getSize();var lt={x:_bboxpos.x,y:_bboxpos.y};var rt={x:_size.width+_bboxpos.x,y:_bboxpos.y};var rb={x:_size.width+_bboxpos.x,y:_bboxpos.y+_size.height};var lb={x:_bboxpos.x,y:_bboxpos.y+_size.height};FLSUtil.transformPoint(omtrx,lt,true);FLSUtil.transformPoint(omtrx,rt,true);FLSUtil.transformPoint(omtrx,rb,true);FLSUtil.transformPoint(omtrx,lb,true);var min_x=Math.min(lt.x,rt.x,rb.x,lb.x);var max_x=Math.max(lt.x,rt.x,rb.x,lb.x);var min_y=Math.min(lt.y,rt.y,rb.y,lb.y);var max_y=Math.max(lt.y,rt.y,rb.y,lb.y);sbox.x1=i>0?Math.min(sbox.x1,min_x):min_x;sbox.y1=i>0?Math.min(sbox.y1,min_y):min_y;sbox.x2=i>0?Math.max(sbox.x2,max_x):max_x;sbox.y2=i>0?Math.max(sbox.y2,max_y):max_y;}
this.setPosition(sbox.x1,sbox.y1);var w=sbox.x2-sbox.x1;var h=sbox.y2-sbox.y1;this.setSize(w,h);};this.addElement=function(elmnt){if((elmnt!=this)&&(elmnt instanceof FLSEditorCore.CText)&&(elements.indexOf(elmnt)==-1)){elmnt.in_selection=true;elements.push(elmnt);this.updateBox();return true;}
return false;};this.clear=function(){while(elements.length){var elm=elements.shift();elm.in_selection=false;elm.setActive(false);}
if(curtxt){curtxt.scalable(curtxtsclable);curtxt.removable(curtxtremovable);}
curtxtsclable=curtxtremovable=false;curtxt=null;unlocked_org.apply(this,[false]);min_collection_font_size=max_collection_font_size=0;};this.populate=function(){this.clear();this.setSize(0,0);this.setPosition(0,0);this.setActive(false);if(this.editor()){this.setMatrix([1,0,0,1,0,0]);var objs=this.editor().getObjects();var zoom=this.editor().zoom();var vwt_pos=this.editor().viewtopleft();var font_sizes=[];for(var i=0;i<objs.length;i++){var _size=objs[i].getSize();if(!objs[i].fixed()&&_size.width&&objs[i].selectable()&&(objs[i]instanceof FLSEditorCore.CText)){font_sizes.push(objs[i].getFontSize());var _bboxpos=objs[i].bboxpos();var omtrx=objs[i].getMatrix();var lt={x:_bboxpos.x,y:_bboxpos.y};var rt={x:_size.width+_bboxpos.x,y:_bboxpos.y};var rb={x:_size.width+_bboxpos.x,y:_bboxpos.y+_size.height};var lb={x:_bboxpos.x,y:_bboxpos.y+_size.height};FLSUtil.transformPoint(omtrx,lt,true);FLSUtil.transformPoint(omtrx,rt,true);FLSUtil.transformPoint(omtrx,rb,true);FLSUtil.transformPoint(omtrx,lb,true);if(zoom!=1){FLSUtil.transformPoint([zoom,0,0,zoom,0,0],lt,true);FLSUtil.transformPoint([zoom,0,0,zoom,0,0],rt,true);FLSUtil.transformPoint([zoom,0,0,zoom,0,0],rb,true);FLSUtil.transformPoint([zoom,0,0,zoom,0,0],lb,true);}
var min_x=Math.min(lt.x,rt.x,rb.x,lb.x)+vwt_pos.x;var max_x=Math.max(lt.x,rt.x,rb.x,lb.x)+vwt_pos.x;var min_y=Math.min(lt.y,rt.y,rb.y,lb.y)+vwt_pos.y;var max_y=Math.max(lt.y,rt.y,rb.y,lb.y)+vwt_pos.y;sbox.x1=elements.length?Math.min(sbox.x1,min_x):min_x;sbox.y1=elements.length?Math.min(sbox.y1,min_y):min_y;sbox.x2=elements.length?Math.max(sbox.x2,max_x):max_x;sbox.y2=elements.length?Math.max(sbox.y2,max_y):max_y;objs[i].in_selection=true;elements.push(objs[i]);}}
if(elements.length){curtxt=elements[0];curtxtsclable=curtxt.scalable();curtxt.scalable(false);min_collection_font_size=Math.min.apply(null,font_sizes);max_collection_font_size=Math.max.apply(null,font_sizes);}
this.setPosition((sbox.x1-vwt_pos.x)/zoom,(sbox.y1-vwt_pos.y)/zoom);var w=sbox.x2-sbox.x1;var h=sbox.y2-sbox.y1;this.setSize(w/zoom,h/zoom);}
return elements;};this.setText=function(){if(unlocked_org()&&curtxt){curtxt.setText.apply(curtxt,arguments);this.updateBox();}};this.getText=function(){if(unlocked_org()&&curtxt){return curtxt.getText.apply(curtxt,arguments);}
return'';};this.default_text=function(){if(unlocked_org()&&curtxt){return curtxt.default_text.apply(curtxt,arguments);}
return'';};this.id=function(){if(unlocked_org()&&curtxt){return curtxt.id;}
return null;};this.setSize=function(width,height){setSize_org.apply(this,arguments);};this.setColor=function(_color){if(unlocked_org()&&curtxt){curtxt.setColor(_color);}else{for(var i=0;i<elements.length;i++){if(elements[i].colorEditable()){elements[i].setColor(_color);}}}};this.setColorAllChild=function(_color){for(var i=0;i<elements.length;i++){if(elements[i].colorEditable()){elements[i].setColorAllChild(_color);}}};this.getColor=function(){if(unlocked_org()&&curtxt){return curtxt.getColor();}else if(elements.length){for(var i=0;i<elements.length;i++){if(elements[i].colorEditable()){return elements[i].getColor();}}}
return'transparent';};this.setFontFamily=function(_ff){if(unlocked_org()&&curtxt){curtxt.setFontFamily(_ff);}else{for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CText){elements[i].setFontFamily(_ff);}}}
this.updateBox();};this.getFontFamily=function(){if(unlocked_org()&&curtxt){return curtxt.getFontFamily();}else if(elements.length){for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CText){return elements[i].getFontFamily();}}}
return false;};this.setFontSize=function(_fs){if(unlocked_org()&&curtxt){curtxt.setFontSize(_fs);}else{var fsz_diff=_fs-this.getFontSize();if(((min_collection_font_size+fsz_diff)>7)&&((max_collection_font_size+fsz_diff)<70)){min_collection_font_size+=fsz_diff;max_collection_font_size+=fsz_diff;for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CText){var el_fsz=elements[i].getFontSize();elements[i].setFontSize(el_fsz+fsz_diff);}}}}
this.updateBox();};this.getFontSize=function(){if(unlocked_org()&&curtxt){return curtxt.getFontSize();}else if(elements.length){return max_collection_font_size;}
return false;};this.bold=function(bold){var set=typeof(bold)==='boolean';if(elements.length){for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CText){if(set){elements[i].bold(bold);}else{return elements[i].bold();}}}}
return bold;};this.italic=function(italic){var set=typeof(italic)==='boolean';if(elements.length){for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CText){if(set){elements[i].italic(italic);}else{return elements[i].italic();}}}}
return italic;};this.move=function(){if(this.unlocked()&&curtxt){curtxt.move.apply(curtxt,arguments);this.updateBox()}else{move_org.apply(this,arguments);for(var i=0;i<elements.length;i++){elements[i].move.apply(elements[i],arguments);}}};this.mscale=function(){mscale_org.apply(this,arguments);var smatrx=[].concat(this.getMatrix());FLSUtil.tmatrixTranslate(smatrx,-smatrx[4],-smatrx[5]);for(var i=0;i<elements.length;i++){var tmtrx=elements[i].getMatrix();var mulmtrx=FLSUtil.tmatrixMultiply(tmtrx,smatrx);elements[i].setMatrix(mulmtrx);}
var obj_sz=this.getSize();var obj_scale=this.getScaleX();var normalized_size={width:obj_sz.width*obj_scale,height:obj_sz.height*obj_scale};this.setSize(normalized_size.width,normalized_size.height);var scale_delta=obj_sz.width/(obj_sz.width*obj_scale);this.scaleUniform(scale_delta);};this.render=function(ctx,cctx,timedelta){if(elements.length){this.drawControls(cctx);}};this.stranslate=function(dx,dy){var scl=this.getScaleX();var zoom=this.editor().zoom();for(var i=0;i<elements.length;i++){elements[i].move.apply(elements[i],[{x:0,y:0},{x:dx/scl*zoom,y:dy/scl*zoom}]);}};this.getElements=function(){return elements;};this.getActiveTextObject=function(){if(this.unlocked()&&(curtxt instanceof FLSEditorCore.CText)){return curtxt}
return null;};this.getElementsWidth=function(){var widths=[];for(var i=0;i<elements.length;i++){widths.push(elements[i].getSize().width);}
return widths;};this.drawControls=function(ctx){drawControls_org.apply(this,arguments);};this.whichControl=function(mousepos,mousepos2){var op='op:none';if(this.getActive()){if(op=='op:none'){op=whichControl_org.apply(this,arguments)}}
return op;};this.hasTextElements=function(){for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CText){return true;}}
return false;};this.isEmpty=function(){return elements.length==0;};this.getProperties=function(){if(curtxt instanceof FLSEditorCore.CText){return curtxt.getProperties();}
return null;};};FLSEditorCore.CTextCollection.prototype=new FLSEditorCore.CObject;var FLSPlugin=function(){var name='BasePlugin';var editor=false;this.init=function(_editor,_settings,_canvas){console.warn('Implement "init" method in your plugin: ',this.name());};this.eventCallback=function(evt,mouseCoords,edit_operation){console.warn('No event handling defined in your plugin. Implement "eventCallback" method in: ',this.name());};this.onBeforeRender=function(ctx){};this.onObjectAdded=function(_new_obj){};this.onViewframeChange=function(_settings){};this.onMisc=function(){};this.editor=function(_editor){if(_editor instanceof FLSEditorCore){editor=_editor;}
return editor;};this.name=function(_name){if(typeof(_name)!='undefined'){if(typeof(_name)=='string'&&name.length){name=_name;}else{console.warn('Invalid name specified');}}
return name;};};var FLSEditorGuideLines=function(){FLSPlugin.apply(this,arguments);var _this=this;var match_corners=true;var kb_evt_tmr=null;var rotationGuides=[0,-Math.PI/2,Math.PI,Math.PI/2];var rotate_snap_tolerance=0.015;var center_align_tolerance=1;var draw_rotation_guide=false;var extra_dx=180;var extra_dy=180;this.name('FLSEditorGuideLines');var guidecvs=null,glctx=null,view_topleft={x:0,y:0},settings={},guidePoints=[];function buildGuidePoints(skipobj){var framesize=settings.viewFrame;guidePoints.length=0;guidePoints.push({x:Math.floor(framesize.width/2),y:Math.floor(framesize.height/2)});var fls_objects=_this.editor().getObjects().slice(0).concat(_this.editor().getLayoutObjects());if(fls_objects.length){for(var i=0;i<fls_objects.length;i++){fls_objects[i].highlight(false);if(fls_objects[i]==skipobj||!fls_objects[i].selectable()||fls_objects[i].fixed()||fls_objects[i].in_selection)continue;var corners=[];var tmp=fls_objects[i].objCenter(match_corners?corners:null);tmp['obj']=fls_objects[i];guidePoints.push(tmp);for(var j=0;j<corners.length;j++){var ctmp={x:corners[j].x,y:corners[j].y,'obj':fls_objects[i]};guidePoints.push(ctmp);}}}}
function drawGuidelines(currentObj,edit_operation){glctx.clearRect(-view_topleft.x,-view_topleft.y,guidecvs.width+view_topleft.x,guidecvs.height+view_topleft.y);if(!glctx.setLineDash){glctx.setLineDash=function(){};}
if(currentObj instanceof FLSEditorCore.CObject){switch(edit_operation){case'op:translate':var alignpoints=[];var intersections=[];var matchX=false;var matchY=false;var intpoint={};var endpoint={};alignpoints.unshift(currentObj.objCenter(match_corners?alignpoints:null));for(var i=0;i<guidePoints.length;i++){for(var j=0;j<alignpoints.length;j++){var obcntr=alignpoints[j];var dif_x=obcntr.x-guidePoints[i].x;var dif_y=obcntr.y-guidePoints[i].y;if((j==0)){dif_x=Math.abs(dif_x);dif_y=Math.abs(dif_y);var real_center=currentObj.objCenterReal();if(dif_x==center_align_tolerance){dif_x=real_center.x>obcntr.x?-(real_center.x-obcntr.x):-(obcntr.x-real_center.x);currentObj.translateX(dif_x);dif_x=0;}
if(dif_y==center_align_tolerance){dif_y=real_center.y>obcntr.y?-(real_center.y-obcntr.y):-(obcntr.y-real_center.y);currentObj.translateY(dif_y);dif_y=0;}}
matchX=dif_x==0;matchY=dif_y==0;if(i>0){guidePoints[i]['obj'].highlight(false);}
if(matchX||matchY){if(matchX){intpoint={};endpoint={}
intpoint.x=endpoint.x=obcntr.x;intpoint.y=guidePoints[i].y<=obcntr.y?guidePoints[i].y:obcntr.y;intpoint.y-=extra_dy;endpoint.y=guidePoints[i].y>=obcntr.y?guidePoints[i].y:obcntr.y;endpoint.y+=extra_dy;intersections.push([intpoint,endpoint,i]);}
if(matchY){intpoint={};endpoint={}
intpoint.y=endpoint.y=obcntr.y;intpoint.x=guidePoints[i].x<=obcntr.x?guidePoints[i].x:obcntr.x;intpoint.x-=i==0?250:extra_dx;endpoint.x=guidePoints[i].x>=obcntr.x?guidePoints[i].x:obcntr.x;endpoint.x+=i==0?250:extra_dx;intersections.push([intpoint,endpoint,i]);}}}}
if(intersections.length){glctx.lineWidth=1.5;for(var i=0;i<intersections.length;i++){var jdx=intersections[i][2];glctx.strokeStyle=(jdx==0)?'rgb(237, 32, 36)':'#006699';glctx.beginPath();glctx.setLineDash([8,6]);glctx.mozDash=[8,6];glctx.webkitLineDash=[8,6];if(jdx>0){guidePoints[jdx]['obj'].highlight(true);}
glctx.lineCap='round';glctx.moveTo(intersections[i][0].x,intersections[i][0].y);glctx.lineTo(intersections[i][1].x,intersections[i][1].y);glctx.stroke();}}
break;case'op:rotate':if(draw_rotation_guide===true){var cntr=null;var corners=[]
if(currentObj.use_pivot()){currentObj.use_pivot(false)
cntr=currentObj.objCenter(corners);currentObj.use_pivot(true)}else{cntr=currentObj.objCenter(corners);}
var w=Math.max((corners[1].x-corners[0].x),(corners[0].x-corners[1].x))
var wdx=Math.round((w/2)+50);var start_point={x:cntr.x-wdx,y:cntr.y};var end_point={x:cntr.x+wdx,y:cntr.y};glctx.lineWidth=1.5;glctx.strokeStyle='rgb(58, 146, 67)'
glctx.beginPath();glctx.setLineDash([8,6]);glctx.mozDash=[8,6];glctx.webkitLineDash=[8,6];glctx.lineCap='round';glctx.moveTo(start_point.x,start_point.y);glctx.lineTo(end_point.x,end_point.y);glctx.stroke();}
break;}}}
this.init=function(_editor,_settings,_canvas){if(this.editor(_editor)){settings=_settings;var framesize=_settings.viewFrame;if(!guidecvs){guidecvs=document.createElement('canvas');_canvas.parentNode.insertBefore(guidecvs,_canvas);}
guidecvs.width=_settings['width'];guidecvs.height=_settings['height'];guidecvs.style.position='absolute';guidecvs.style.display='block';guidecvs.style.zIndex='2';var frametopX=(guidecvs.width-framesize.width)/2;var frametopY=(guidecvs.height-framesize.height)/2;frametopX+=framesize.offcenter;frametopY+=framesize.offheight;glctx=guidecvs.getContext('2d');if(!glctx.setLineDash){glctx.setLineDash=function(){};glctx.setLineDash([11.1,8]);glctx.mozDash=[11.1,8];glctx.webkitLineDash=[11.1,8];}
glctx.setTransform(1,0,0,1,0,0);glctx.translate(frametopX,frametopY);buildGuidePoints();view_topleft.x=frametopX;view_topleft.y=frametopY;}};this.onViewframeChange=function(_settings){if(this.editor()){settings=_settings;var framesize=_settings.viewFrame;guidecvs.width=_settings['width'];guidecvs.height=_settings['height'];var frametopX=(guidecvs.width-framesize.width)/2;var frametopY=(guidecvs.height-framesize.height)/2;frametopX+=framesize.offcenter;frametopY+=framesize.offheight;glctx.setTransform(1,0,0,1,0,0);glctx.translate(frametopX,frametopY);buildGuidePoints();view_topleft.x=frametopX;view_topleft.y=frametopY;}};this.eventCallback=function(evt,mouseCoords,edit_operation){var currentObj=this.editor().getCurrentObject();switch(evt.type){case'mousedown':case'touchstart':buildGuidePoints(currentObj);drawGuidelines(currentObj,edit_operation);break;case'mousemove':case'touchmove':case'keydown':if(currentObj&&edit_operation!='op:none'){switch(edit_operation){case'op:translate':drawGuidelines(currentObj,edit_operation);break;case'op:rotate':draw_rotation_guide=false;var rotation=currentObj.getRotation();var diff=0;for(var i=0;i<rotationGuides.length;i++){diff=rotation-rotationGuides[i];if((Math.abs(diff)<=rotate_snap_tolerance)===true){currentObj.rotate(diff);draw_rotation_guide=true;break;}}
drawGuidelines(currentObj,edit_operation);break}}
break;case'mouseup':case'touchend':case'touchcancel':case'mouseout':buildGuidePoints(currentObj);drawGuidelines(currentObj,edit_operation);break;case'keyup':clearTimeout(kb_evt_tmr);kb_evt_tmr=setTimeout(function(){buildGuidePoints(currentObj);drawGuidelines(currentObj,edit_operation);},1000);break;}};this.onObjectAdded=function(fls_obj){buildGuidePoints(fls_obj);};};FLSEditorGuideLines.prototype=new FLSPlugin;var FLSSwitchSideControl=function(){FLSPlugin.apply(this,arguments);this.name('FLSSwitchSideControl');var _this=this;var side='front';var ghostcvs=null;var view_topleft={x:0,y:0},settings={},psettings={'front':'Front','back':'Back'},label_box={front:{top_left:[0,0],bottom_right:[0,0]},back:{top_left:[0,0],bottom_right:[0,0]}},no_image=false;var cimg=new Image();cimg.src='data:image/png;base64,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';function c_side(){return side;};function detectControl(mouseCoords){var gctx=ghostcvs.getContext('2d');var zoom=_this.editor().zoom();var vpoint=_this.editor().viewtopleft();gctx.save();gctx.setTransform(1,0,0,1,0,0);gctx.clearRect(0,0,ghostcvs.width,ghostcvs.height);gctx.setTransform(zoom,0,0,zoom,vpoint.x,vpoint.y);_this.onBeforeRender(gctx);var clr=gctx.getImageData(mouseCoords.x,mouseCoords.y,1,1).data;gctx.restore();if(no_image===true){if((label_box[side].top_left[0]<=mouseCoords.x)&&(label_box[side].bottom_right[0]>=mouseCoords.x)&&(label_box[side].top_left[1]<=mouseCoords.y)&&(label_box[side].bottom_right[1]>=mouseCoords.y)){return true;}}
return clr[3]>0;}
this.no_image=function(_no_image){if(typeof(_no_image)==='boolean'){no_image=_no_image;if(no_image===true){var viewtopleft=this.editor().viewtopleft();var gctx=ghostcvs.getContext('2d');var zoom=this.editor().zoom();var framesize=settings.viewFrame;var dx=(framesize.width)+viewtopleft.x;var dy=(framesize.height)+viewtopleft.y;dy+=(30+framesize.shrink[1]/2);var fs=15;gctx.save();gctx.font='bold '+fs+'px '+framesize.message_font;for(var pside in psettings){var txt_w=gctx.measureText(psettings[pside]).width;label_box[pside].top_left[0]=dx-txt_w;label_box[pside].top_left[1]=dy-fs;label_box[pside].bottom_right[0]=dx;label_box[pside].bottom_right[1]=dy;}
gctx.restore();}}
return no_image;}
this.init=function(_editor,_settings,_canvas){if(this.editor(_editor)){this.onViewframeChange(_settings);}};this.onViewframeChange=function(_settings){if(this.editor()){settings=_settings;var framesize=_settings.viewFrame;var frametopX=(settings.width-framesize.width)/2;var frametopY=(settings.height-framesize.height)/2;view_topleft.x=frametopX;view_topleft.y=frametopY;if(settings.pluginparams[this.name()]){if(settings.pluginparams[this.name()]['front']){psettings.front=settings.pluginparams[this.name()]['front'];}
if(settings.pluginparams[this.name()]['back']){psettings.back=settings.pluginparams[this.name()]['back'];}
if(typeof(settings.pluginparams[this.name()]['ui_cb'])=='function'){c_side=settings.pluginparams[this.name()]['ui_cb'];}}
ghostcvs=this.editor().ghostcanvas();}};this.eventCallback=function(evt,mouseCoords,edit_operation){switch(evt.type){case'mousedown':case'touchstart':if(detectControl(mouseCoords)){side=c_side();}
break;case'mousemove':case'touchmove':if(detectControl(mouseCoords)){document.body.style.cursor='pointer';}else{document.body.style.cursor='default';}
break;case'mouseup':case'touchend':case'touchcancel':case'mouseout':break;}};this.onBeforeRender=function(ctx){var zoom=this.editor().zoom();var framesize=settings.viewFrame;ctx.save();var dx=framesize.width/zoom;var dy=framesize.height/zoom;var txt_dx=0;if(no_image!==true){var cw=cimg.width/zoom;var ch=cimg.height/zoom;dx=dx-cw/3;dy=dy-ch/2.1;ctx.translate(dx,dy);ctx.drawImage(cimg,0,0,cimg.width,cimg.height,0,0,cw,ch);txt_dx=5;}
ctx.restore();ctx.save();dy=framesize.height/zoom;if(no_image!==true){dy+=((cimg.height/2)/zoom)-5;}else{dy+=30/zoom;}
var fs=15/zoom;ctx.font='bold '+fs+'px '+framesize.message_font;ctx.fillStyle='rgb(130,130,131)';ctx.textAlign='end';ctx.translate(dx-txt_dx,dy);ctx.fillText(psettings[side],0,0);ctx.restore();};this.onMisc=function(nside){if(psettings[nside]){side=nside;}};};FLSSwitchSideControl.prototype=new FLSPlugin;FLSUtil.DisplacementMapFilter=function(mapBitmap,componentX,componentY,mapPoint,scaleX,scaleY,mode,color,alpha){if(!(this instanceof FLSUtil.DisplacementMapFilter)){throw"FLSUtil.DisplacementMapFilter is a constructor. use it with the new keyword";}
if(!(mapBitmap instanceof HTMLCanvasElement)){throw"First argument needs to be a canvas element";}
var ColorChannel={RED:0,GREEN:1,BLUE:2,ALPHA:3};mapPoint=mapPoint||{x:0,y:0};scaleX=scaleX||0;scaleY=scaleY||0;if(componentX!=0&&componentX!=1&&componentX!=2&&componentX!=3)componentX=ColorChannel.RED;if(componentY!=0&&componentY!=1&&componentY!=2&&componentY!=3)componentY=ColorChannel.RED;var mapCtx=mapBitmap.getContext('2d');function setPixels(target,pos,source,i){target.data[i*4]=source.data[pos*4];target.data[i*4+1]=source.data[pos*4+1];target.data[i*4+2]=source.data[pos*4+2];target.data[i*4+3]=source.data[pos*4+3];}
this.applyFilter=function(sourceCanvas,destinationCanvas){if(typeof destinationCanvas=='undefined'){destinationCanvas=sourceCanvas;}
if(!(sourceCanvas instanceof HTMLCanvasElement)||!(destinationCanvas instanceof HTMLCanvasElement)){throw"Source and destination needs to be a canvas element";}
var sourceCtx=sourceCanvas.getContext('2d');var targetCtx=destinationCanvas.getContext('2d');var sourceData=sourceCtx.getImageData(0,0,sourceCanvas.width,sourceCanvas.height);var targetDataX=targetCtx.getImageData(0,0,destinationCanvas.width,destinationCanvas.height);var targetDataY=targetCtx.getImageData(0,0,destinationCanvas.width,destinationCanvas.height);var mapData=mapCtx.getImageData(0,0,mapBitmap.width,mapBitmap.height);var pixelsLength=mapData.data.length/4;var colorValue,alphaValue,ratio,ratioWithAlpha,pixelShift,sourcePosition,targetPosition,x,y;var i=0;while(i<pixelsLength){x=((i%mapBitmap.width)+mapPoint.x)|0;y=(((i/mapBitmap.width)|0)+mapPoint.y)|0;colorValue=mapData.data[i*4+componentX];alphaValue=mapData.data[i*4+ColorChannel.ALPHA];ratio=(colorValue/0xFF*2)-1;ratioWithAlpha=ratio*(alphaValue/0xFF);pixelShift=(ratioWithAlpha*scaleX|0);sourcePosition=(sourceCanvas.width*y)+x;targetPosition=(destinationCanvas.width*y)+x+pixelShift;setPixels(targetDataX,targetPosition,sourceData,sourcePosition);i++;}
i=0;while(i<pixelsLength){x=((i%mapBitmap.width)+mapPoint.x)|0;y=(((i/mapBitmap.width)|0)+mapPoint.y)|0;colorValue=mapData.data[i*4+componentY];alphaValue=mapData.data[i*4+ColorChannel.ALPHA];ratio=(colorValue/0xFF*2)-1;ratioWithAlpha=ratio*(alphaValue/0xFF);pixelShift=(ratioWithAlpha*scaleY|0);sourcePosition=(sourceCanvas.width*y)+x;targetPosition=(destinationCanvas.width*(y+pixelShift))+x;setPixels(targetDataY,targetPosition,targetDataX,sourcePosition);i++;}
targetCtx.putImageData(targetDataY,0,0);};};var FLSTracker=function(GoogleTrackingID,_editor,ga_callback,report){if(typeof(GoogleTrackingID)=='undefined'){GoogleTrackingID='UA-10220601-4';}
if(typeof(_editor)=='undefined'){_editor='Logo';}
var GaTracker=false;if(typeof(ga)=='function'){try{ga('create',GoogleTrackingID,'auto',{'name':'FlsHTML5Tracker'});GaTracker=true;}catch(e){GaTracker=false;console.log(e);}}
if(typeof(ga_callback)!='function'){ga_callback=function(){}}
var event_collection={};function _send_report(){return new Promise((resolve,reject)=>{if(navigator.sendBeacon(epip,JSON.stringify(event_collection))){resolve(true);}else{reject('data not sent')}});}
function _flushEventReports(){if(event_collection.events.length){var events_copy=event_collection.events.slice(0);_send_report().then(resp=>{while(events_copy.length){var tmp=events_copy.pop();var idx=event_collection.events.indexOf(tmp);if(idx>-1){event_collection.events.splice(idx,1);}}}).catch(err=>{console.log('could not send event collection')});}}
if(typeof(report)==='object'){var epip=typeof(report.epip)==='string'?report.epip:'/epip/epip.php'
event_collection.events=[{category:'Load',action:'init',label:{product:report.product,product_id:report.product_id,mode:report.mode,device_type:report.device_type},timestamp:Date.now()}];event_collection.props={product:report.product,editor:_editor,urlPath:location.pathname+location.search};event_collection.uuid=report.uuid?report.uuid:'not_set';var intervalID=setInterval(function(){_flushEventReports();},60*1000);window.addEventListener('beforeunload',evt=>{clearInterval(intervalID);if(event_collection.events.length){_send_report().then(resp=>{}).catch(err=>{});}});}
this.flushEvents=function(){_flushEventReports();}
this.track=!GaTracker?function(){console.log('tracker not found');}:function(_action,_label,_category,_value){if(typeof(_category)!='string'){_category='Custom';}
_value=typeof(_value)=='number'?parseInt(_value,10):1;var action=_action;if(_action instanceof FLSEditorCore.CObject){action='path';if((_action instanceof FLSEditorCore.CPathGroup)&&_action.unlocked()&&(typeof(_action.getCurrentPath().stringdata!='undefined'))){action='text';}
if(_action instanceof FLSEditorCore.CText){action=((_action instanceof FLSEditorCore.CPathText)&&_action.has_path())?'arc_text':'text';}
if(_action instanceof FLSEditorCore.CImage){action='image';}
if(_action instanceof FLSEditorCore.CRect){action='background';}
if(_action instanceof FLSEditorCore.CLogoObjectGroup){action='logo';}
if(_action instanceof FLSEditorCore.CSelectionGroup){action='selection';}}else if(!action||(action==null)){return false;}
try{var cb_data={editor:_editor,category:_category,action:action,label:_label,};if(action!='save_success'){ga('FlsHTML5Tracker.send','event','HTML5'+_editor+_category,action,_label);ga_callback(cb_data);}
if(report){delete cb_data.editor;cb_data.timestamp=Date.now();event_collection.events.push(cb_data);}}catch(e){console.log(e);}};};var SVGPath2Cnvs={parse:function(pathstr,_commands){var commands=(_commands instanceof Array)?_commands:[];var pathfuncs={'M':['moveTo',2],'m':['moveTo',2],'L':['lineTo',2],'l':['lineTo',2],'A':['ellipse',7],'a':['ellipse',7],'Q':['quadraticCurveTo',4],'q':['quadraticCurveTo',4],'C':['bezierCurveTo',6],'c':['bezierCurveTo',6],'Z':['closePath',0],'z':['closePath',0]};var specialpathfuncs=['S','s','T','t','H','h','V','v'];var relativepathfuncs=['m','l','a','q','c','h','v','s','t'];while(commands.length){commands.pop();}
var tmp=pathstr.replace(/[\,]/g,' ').replace(/([A-Za-z])/g,' $1 ').replace(/-/g,' -').replace(/\s{2,}/g,' ');var merged=tmp.match(/(\s[-]?\.\d{1,}(\.\d{1,}){1,})/g);if(merged&&merged.length){while(merged.length){var mrg_tmp=merged.shift();var mrg_tmp_corrected=mrg_tmp.replace(/\./g,' .').replace(/-\s{1,}/,' -');tmp=tmp.replace(mrg_tmp,mrg_tmp_corrected+' ');}}
merged=tmp.match(/(\s[-]?\d{1,}(\.\d{1,}){1,})/g);if(merged&&merged.length){while(merged.length){var mrg_tmp=merged.shift();var mrg_tmp_split=mrg_tmp.split('.');var mrg_tmp_corrected=mrg_tmp_split.shift()+'.'+mrg_tmp_split.shift();if(mrg_tmp_split.length){mrg_tmp_corrected+=' .'+mrg_tmp_split.join(' .');}
tmp=tmp.replace(mrg_tmp,mrg_tmp_corrected);}}
tmp=tmp.replace(/\s{2,}/g,' ').trim().split(' ');if(!tmp.length||!pathstr.trim().length){return commands;}
var current_command=tmp[0];var last_svg_command=current_command;var pen=[parseFloat(tmp[1]),parseFloat(tmp[2])];var first=[pen[0],pen[1]];var cur_cmd_type=relativepathfuncs.indexOf(current_command)>-1?'relative':'absolute';if(['M','m'].indexOf(current_command)==-1||isNaN(pen[0])||isNaN(pen[1])){throw'Soemthing is wrong with the given path. ('+pathstr+')';}
var specialCommand=function(_drawcmd,i){var pcmd=commands[commands.length-1];var argcount=0;var tmp_command='';var pstart=tmp[i]==current_command?1:0;switch(current_command){case'S':case's':tmp_command='C';argcount=pathfuncs[tmp_command][1]-2;if(pcmd.func!='bezierCurveTo'){_drawcmd.args.push(pen[0]);_drawcmd.args.push(pen[1]);}else{var pargs=pcmd.args;var endp={x:pen[0],y:pen[1]};var lcp={x:pargs[pargs.length-4],y:pargs[pargs.length-3]};var cp_mr=FLSUtil.mirrorPoint(lcp,endp);_drawcmd.args.push(cp_mr.x);_drawcmd.args.push(cp_mr.y);}
for(var x=0;x<argcount;x++){var coord=parseFloat(tmp[i+pstart]);var pen_i=x%2;coord+=((cur_cmd_type=='relative')&&i2)?pen[pen_i]:0;drawcmd.args.push(coord);i++;}
pen[0]=drawcmd.args[argcount-2];pen[1]=drawcmd.args[argcount-1];break;case'T':case't':tmp_command='Q';argcount=pathfuncs[tmp_command][1]-2;if(pcmd.func!='quadraticCurveTo'){_drawcmd.args.push(pen[0]);_drawcmd.args.push(pen[1]);}else{var pargs=pcmd.args;var endp={x:pen[0],y:pen[1]};var lcp={x:pargs[pargs.length-4],y:pargs[pargs.length-3]};var cp_mr=FLSUtil.mirrorPoint(lcp,endp);_drawcmd.args.push(cp_mr.x);_drawcmd.args.push(cp_mr.y);}
for(var x=0;x<argcount;x++){var coord=parseFloat(tmp[i+pstart]);var pen_i=x%2;coord+=((cur_cmd_type=='relative')&&i2)?pen[pen_i]:0;drawcmd.args.push(coord);i++;}
pen[0]=drawcmd.args[argcount-2];pen[1]=drawcmd.args[argcount-1];break;case'V':case'v':tmp_command='L';argcount=pathfuncs['L'][1]-1;var coord=parseFloat(tmp[i+pstart]);coord+=cur_cmd_type=='relative'?pen[1]:0;_drawcmd.args.push(pen[0]);_drawcmd.args.push(coord);pen[1]=coord;break;case'H':case'h':tmp_command='L';argcount=pathfuncs['L'][1]-1;var coord=parseFloat(tmp[i+pstart]);coord+=cur_cmd_type=='relative'?pen[0]:0;_drawcmd.args.push(coord);_drawcmd.args.push(pen[1]);pen[0]=coord;break;}
_drawcmd.func=pathfuncs[tmp_command][0];return argcount;};for(var i=0;i<tmp.length;i++){var i2=i;var drawcmd={'func':'','args':[]};if(i>0){if(!isFinite(tmp[i])){if((typeof(pathfuncs[tmp[i]])!='undefined')||(specialpathfuncs.indexOf(tmp[i])>-1)){current_command=tmp[i];}else{console.log([tmp[i],i])
throw"unknown path command encountered.";}
cur_cmd_type=relativepathfuncs.indexOf(current_command)>-1?'relative':'absolute';}else{}}
if(typeof(pathfuncs[tmp[i]])!='undefined'){drawcmd.func=pathfuncs[tmp[i]][0];var argcount=pathfuncs[tmp[i]][1];last_svg_command=tmp[i];if(argcount){if(drawcmd.func!='ellipse'){for(var x=0;x<argcount;x++){var coord=parseFloat(tmp[i+1]);var pen_i=x%2;coord+=((cur_cmd_type=='relative')&&i2)?pen[pen_i]:0;drawcmd.args.push(coord);i++;}}else{for(var x=0;x<argcount;x++){var coord=parseFloat(tmp[i+1]);if((x>=5)&&(x<=6)){var pen_i=x%2?0:1;coord+=((cur_cmd_type=='relative')&&i2)?pen[pen_i]:0;}
drawcmd.args.push(coord);i++;}}
pen[0]=drawcmd.args[argcount-2];pen[1]=drawcmd.args[argcount-1];}}else if(specialpathfuncs.indexOf(tmp[i])>-1){i+=specialCommand(drawcmd,i);last_svg_command=current_command;}else{var special=false;switch(last_svg_command){case'M':last_svg_command='L';break;case'm':last_svg_command='l';break;default:special=specialpathfuncs.indexOf(last_svg_command)>-1;}
if(!special){drawcmd.func=pathfuncs[last_svg_command][0];var argcount=pathfuncs[last_svg_command][1];if(argcount){if(drawcmd.func!='ellipse'){for(var x=0;x<argcount;x++){var coord=parseFloat(tmp[i+x]);var pen_i=x%2;coord+=cur_cmd_type=='relative'?pen[pen_i]:0;drawcmd.args.push(coord);}}else{for(var x=0;x<argcount;x++){var coord=parseFloat(tmp[i+x]);if((x>=5)&&(x<=6)){var pen_i=x%2?0:1;coord+=((cur_cmd_type=='relative')&&i2)?pen[pen_i]:0;}
drawcmd.args.push(coord);}}
pen[0]=drawcmd.args[argcount-2];pen[1]=drawcmd.args[argcount-1];i+=argcount-1;}}else{i+=(specialCommand(drawcmd,i)-1);}}
if(drawcmd.func!='ellipse'){if(drawcmd.func=='closePath'){pen[0]=first[0];pen[1]=first[1];}else if(drawcmd.func=='moveTo'){first[0]=pen[0];first[1]=pen[1];}
commands.push(drawcmd);}else{drawcmd.args=SVGPath2Cnvs.svg_arc_2_canvas_ellipse(pen_cpy[0],pen_cpy[1],drawcmd.args);commands.push(drawcmd);}}
return commands;},normalize:function(pathstr){try{var commands=SVGPath2Cnvs.parse(pathstr);var ccmd2svgc={'moveTo':'M','lineTo':'L','ellipse':'A','quadraticCurveTo':'Q','bezierCurveTo':'C','closePath':'Z'};var d=[];while(commands.length){var tmp=commands.shift();d.push(ccmd2svgc[tmp.func]);for(var i=0;i<tmp.args.length;i++){tmp.args[i]=parseFloat(tmp.args[i].toFixed(6));}
d=d.concat(tmp.args);}
return d.join(' ');}catch(e){console.log(e);}},commandsDataStr:function(_commands){if(_commands instanceof Array){try{var commands=_commands.slice(0);var ccmd2svgc={'moveTo':'M','lineTo':'L','ellipse':'A','quadraticCurveTo':'Q','bezierCurveTo':'C','closePath':'Z'};var d=[];while(commands.length){var tmp=commands.shift();d.push(ccmd2svgc[tmp.func]);for(var i=0;i<tmp.args.length;i++){tmp.args[i]=parseFloat(tmp.args[i].toFixed(6));}
d=d.concat(tmp.args);}
return d.join(' ');}catch(e){console.log(e);}}
return'';},cbezier:function(strt,cntrl1,cntrl2,end,t){return(strt*Math.pow(1-t,3))+(3*cntrl1*t*Math.pow(1-t,2))+(3*cntrl2*(1-t)*Math.pow(t,2))+(Math.pow(t,3)*end);},qbezier:function(strt,cntrl,end,t){return(strt*Math.pow(1-t,2))+(2*cntrl*(1-t)*t)+(end*Math.pow(t,2));},nbezier:function(coords,t){if(coords instanceof Array){t=(t&&t>=0&&t<=1)?t:0;var order=coords.length-1;var res=0;var coefs=[1];for(var ni=0;ni<order;ni++){coefs.push(coefs[ni]*(order-ni)/(ni+1));}
for(var i=0;i<coords.length;i++){res+=(coefs[i]*coords[i]*Math.pow(1-t,order-i)*Math.pow(t,i));}
return res;}
return null;},p2d_bbox:function(p2d,tmtrx){var svgdiv=document.querySelector('#svg-bbox-cald-container');if(!svgdiv){svgdiv=document.createElement('div');svgdiv.style.position='absolute';svgdiv.style.left='-1000px';svgdiv.style.top='-1000px';svgdiv.style.oveflow='hidden';document.body.appendChild(svgdiv);}
var svg=document.createElementNS('http://www.w3.org/2000/svg','svg');svgdiv.append(svg);var path=document.createElementNS('http://www.w3.org/2000/svg','path');path.setAttribute('d',(p2d instanceof Path2D)?p2d.data:p2d);svg.append(path);var path_bb=path.getBBox();svg.remove();var tl={x:path_bb.x,y:path_bb.y};var br={x:(path_bb.x+path_bb.width),y:(path_bb.y+path_bb.height)};if((tmtrx instanceof Array)&&(tmtrx.length==6)){FLSUtil.transformPoint(tmtrx,tl,true);FLSUtil.transformPoint(tmtrx,br,true);}
return{x0:tl.x,y0:tl.y,x1:br.x,y1:br.y,};},bbox:function(pathinfo,tmatrix){if((typeof(Path2D)=='function')&&(pathinfo instanceof Path2D)){return this.p2d_bbox(pathinfo,tmatrix);}
if(!(tmatrix instanceof Array)||(tmatrix.length!=6)){tmatrix=[1,0,0,1,0,0];}
var tmtrx=tmatrix.slice(0);for(var tmi=0;tmi<6;tmi++){tmtrx[tmi]=parseFloat(tmtrx[tmi]);}
var qbezier=function(strt,cntrl,end,t){return(strt*Math.pow(1-t,2))+(2*cntrl*(1-t)*t)+(end*Math.pow(t,2));};var cbezier=function(strt,cntrl1,cntrl2,end,t){return(strt*Math.pow(1-t,3))+(3*cntrl1*t*Math.pow(1-t,2))+(3*cntrl2*(1-t)*Math.pow(t,2))+(Math.pow(t,3)*end);};try{var has_transform=(tmtrx[0]!=1)||(tmtrx[1]!=0)||(tmtrx[2]!=0)||(tmtrx[3]!=1)||(tmtrx[4]!=0)||(tmtrx[5]!=0);var segments=(pathinfo instanceof Array)?[].concat(pathinfo):SVGPath2Cnvs.parse(pathinfo);if(!segments.length){var ptmp={x:0,y:0};if(has_transform){ptmp=FLSUtil.transformPoint(tmtrx,{x:0,y:0});}
return{x0:ptmp.x,y0:ptmp.y,x1:ptmp.x,y1:ptmp.y};}
var tmp=segments.shift();var args=tmp.args.slice(0);var pen=[args[0],args[1]];if(has_transform){var ptmp=FLSUtil.transformPoint(tmtrx,{x:pen[0],y:pen[1]});pen[0]=ptmp.x;pen[1]=ptmp.y;}
var first=[pen[0],pen[1]];var bb={x0:pen[0],y0:pen[1],x1:pen[0],y1:pen[1]};while(segments.length){tmp=segments.shift();args=tmp.args.slice(0);if(has_transform){for(var argi=0;argi<args.length;argi+=2){var ptmp=FLSUtil.transformPoint(tmtrx,{x:args[argi],y:args[argi+1]});args[argi]=ptmp.x;args[argi+1]=ptmp.y;}}
if(tmp.func=='moveTo'){pen[0]=first[0]=args[0];pen[1]=first[1]=args[1];continue;}
if(tmp.func=='closePath'){args=[first[0],first[1]];}
var pcount=(args.length/2)+1;switch(pcount){case 2:bb.x0=Math.min(pen[0],args[0],bb.x0);bb.x1=Math.max(pen[0],args[0],bb.x1);bb.y0=Math.min(pen[1],args[1],bb.y0);bb.y1=Math.max(pen[1],args[1],bb.y1);break;case 3:var cx=args[0];var cy=args[1];var ex=args[2];var ey=args[3];if(!FLSUtil.pointOnLine({x:pen[0],y:pen[1]},{x:ex,y:ey},{x:cx,y:cy})){var tx_numerator=(pen[0]-cx);var tx_denominator=(pen[0]-(2*cx)+ex);var ty_numerator=(pen[1]-cy);var ty_denominator=(pen[1]-(2*cy)+ey);var x1,y1;if((tx_denominator!=0)&&(ty_denominator!=0)){var tx=tx_numerator==0?0:tx_numerator/tx_denominator;var ty=ty_numerator==0?0:ty_numerator/ty_denominator;tx=tx<0?0:(tx>1?1:tx);ty=ty<0?0:(ty>1?1:ty);x1=qbezier(pen[0],cx,ex,tx);y1=qbezier(pen[1],cy,ey,ty);}else{x1=cx;y1=cy;}
bb.x0=Math.min(pen[0],ex,x1,bb.x0);bb.y0=Math.min(pen[1],ey,y1,bb.y0);bb.x1=Math.max(pen[0],ex,x1,bb.x1);bb.y1=Math.max(pen[1],ey,y1,bb.y1);}else{bb.x0=Math.min(pen[0],ex,bb.x0);bb.x1=Math.max(pen[0],ex,bb.x1);bb.y0=Math.min(pen[1],ey,bb.y0);bb.y1=Math.max(pen[1],ey,bb.y1);}
break;case 4:var a=pen[0],b=pen[1],c=args[0],d=args[1],e=args[2],f=args[3],g=args[4],h=args[5];if(a>=bb.x0&&b>=bb.y0&&a<=bb.x1&&b<=bb.y1&&c>=bb.x0&&d>=bb.y0&&c<=bb.x1&&d<=bb.y1&&e>=bb.x0&&f>=bb.y0&&e<=bb.x1&&f<=bb.y1&&g>=bb.x0&&h>=bb.y0&&g<=bb.x1&&h<=bb.y1){break;}
var ux=a+(3*c)-(3*e)+g;var vx=-(2*a)-(4*c)+(2*e);var wx=(a+c);var uy=b+(3*d)-(3*f)+h;var vy=-(2*b)-(4*d)+(2*f);var wy=(b+d);var deltax=Math.sqrt((vx*vx)-(4*ux*wx));var deltay=Math.sqrt((vy*vy)-(4*uy*wy));var t1x=(-vx+deltax)/(2*ux);var t2x=(-vx-deltax)/(2*ux);var t1y=(-vy+deltay)/(2*uy);var t2y=(-vy-deltay)/(2*uy);var xs=[];var ys=[];for(var i=0.1;i<0.9;i+=0.1){xs.push(cbezier(pen[0],args[0],args[2],args[4],i));ys.push(cbezier(pen[1],args[1],args[3],args[5],i));}
if(t1x>0&&t1x<1){xs.push(cbezier(pen[0],args[0],args[2],args[4],t1x));}
if(t2x>0&&t2x<1){xs.push(cbezier(pen[0],args[0],args[2],args[4],t2x));}
if(t1y>0&&t1y<1){ys.push(cbezier(pen[1],args[1],args[3],args[5],t1y));}
if(t2y>0&&t2y<1){ys.push(cbezier(pen[1],args[1],args[3],args[5],t2y));}
bb.x0=Math.min.apply(null,xs.concat([pen[0],args[4],bb.x0]));bb.x1=Math.max.apply(null,xs.concat([pen[0],args[4],bb.x1]));bb.y0=Math.min.apply(null,ys.concat([pen[1],args[5],bb.y0]));bb.y1=Math.max.apply(null,ys.concat([pen[1],args[5],bb.y1]));break;}
pen[0]=args[args.length-2];pen[1]=args[args.length-1];}
return bb;}catch(e){console.log(e);}},applyMatrix:function(commands,matrix){if((commands instanceof Array)&&(matrix instanceof Array)&&matrix.length==6){if((matrix[0]+matrix[1]+matrix[2]+matrix[3]+matrix[4]+matrix[5])==2)return false;for(var i=0;i<commands.length;i++){var pvertex={x:0,y:0};switch(commands[i]['func']){case'moveTo':case'lineTo':case'bezierCurveTo':case'quadraticCurveTo':for(var c_idx=0;c_idx<commands[i]['args'].length;c_idx+=2){pvertex.x=commands[i]['args'][c_idx];pvertex.y=commands[i]['args'][c_idx+1];FLSUtil.transformPoint(matrix,pvertex,true);commands[i]['args'][c_idx]=pvertex.x;commands[i]['args'][c_idx+1]=pvertex.y;}}}}},getPathPoint:function(t,start,end,control_points){var point=[0,0];if(!(control_points instanceof Array)){control_points=[];}
var points=[start];for(var cpi=0;cpi<control_points.length;cpi++){points.push(control_points[cpi]);}
points.push(end);if(t){t=t>1?1:(t<0?0:t);}else{t=0;}
var n=points.length-1;var t1=1-t;var coefs=[1];for(var ni=0;ni<n;ni++){coefs.push(coefs[ni]*(n-ni)/(ni+1));}
for(var ci=0;ci<=n;ci++){var tmp_term=Math.pow(t1,n-ci)*Math.pow(t,ci)*coefs[ci];point[0]+=points[ci][0]*tmp_term;point[1]+=points[ci][1]*tmp_term;}
return point;},getDerivPathPoint:function(t,start,end,control_points){var point=[0,0];if(!(control_points instanceof Array)){control_points=[];}
var points=[start];for(var cpi=0;cpi<control_points.length;cpi++){points.push(control_points[cpi]);}
points.push(end);if(t){t=t>1?1:(t<0?0:t);}else{t=0;}
var n=points.length-1;var k=n-1;var t1=1-t;var coefs=[1];for(var ni=0;ni<k;ni++){coefs.push(coefs[ni]*(k-ni)/(ni+1));}
for(var ci=0;ci<=k;ci++){var tmp_term=Math.pow(t1,k-ci)*Math.pow(t,ci)*coefs[ci]*n;point[0]+=(points[ci+1][0]-points[ci][0])*tmp_term;point[1]+=(points[ci+1][1]-points[ci][1])*tmp_term;}
return point;},pathLength:function(commands){var path_pixel_lenght=0;if(commands.length){var Tvalues=0||[[],[],[-0.5773502691896257645091487805019574556476,0.5773502691896257645091487805019574556476],[0,-0.7745966692414833770358530799564799221665,0.7745966692414833770358530799564799221665],[-0.3399810435848562648026657591032446872005,0.3399810435848562648026657591032446872005,-0.8611363115940525752239464888928095050957,0.8611363115940525752239464888928095050957],[0,-0.5384693101056830910363144207002088049672,0.5384693101056830910363144207002088049672,-0.9061798459386639927976268782993929651256,0.9061798459386639927976268782993929651256],[0.6612093864662645136613995950199053470064,-0.6612093864662645136613995950199053470064,-0.2386191860831969086305017216807119354186,0.2386191860831969086305017216807119354186,-0.9324695142031520278123015544939946091347,0.9324695142031520278123015544939946091347],[0,0.4058451513773971669066064120769614633473,-0.4058451513773971669066064120769614633473,-0.7415311855993944398638647732807884070741,0.7415311855993944398638647732807884070741,-0.9491079123427585245261896840478512624007,0.9491079123427585245261896840478512624007],[-0.1834346424956498049394761423601839806667,0.1834346424956498049394761423601839806667,-0.5255324099163289858177390491892463490419,0.5255324099163289858177390491892463490419,-0.7966664774136267395915539364758304368371,0.7966664774136267395915539364758304368371,-0.9602898564975362316835608685694729904282,0.9602898564975362316835608685694729904282],[0,-0.8360311073266357942994297880697348765441,0.8360311073266357942994297880697348765441,-0.9681602395076260898355762029036728700494,0.9681602395076260898355762029036728700494,-0.3242534234038089290385380146433366085719,0.3242534234038089290385380146433366085719,-0.6133714327005903973087020393414741847857,0.6133714327005903973087020393414741847857],[-0.1488743389816312108848260011297199846175,0.1488743389816312108848260011297199846175,-0.4333953941292471907992659431657841622000,0.4333953941292471907992659431657841622000,-0.6794095682990244062343273651148735757692,0.6794095682990244062343273651148735757692,-0.8650633666889845107320966884234930485275,0.8650633666889845107320966884234930485275,-0.9739065285171717200779640120844520534282,0.9739065285171717200779640120844520534282],[0,-0.2695431559523449723315319854008615246796,0.2695431559523449723315319854008615246796,-0.5190961292068118159257256694586095544802,0.5190961292068118159257256694586095544802,-0.7301520055740493240934162520311534580496,0.7301520055740493240934162520311534580496,-0.8870625997680952990751577693039272666316,0.8870625997680952990751577693039272666316,-0.9782286581460569928039380011228573907714,0.9782286581460569928039380011228573907714],[-0.1252334085114689154724413694638531299833,0.1252334085114689154724413694638531299833,-0.3678314989981801937526915366437175612563,0.3678314989981801937526915366437175612563,-0.5873179542866174472967024189405342803690,0.5873179542866174472967024189405342803690,-0.7699026741943046870368938332128180759849,0.7699026741943046870368938332128180759849,-0.9041172563704748566784658661190961925375,0.9041172563704748566784658661190961925375,-0.9815606342467192506905490901492808229601,0.9815606342467192506905490901492808229601],[0,-0.2304583159551347940655281210979888352115,0.2304583159551347940655281210979888352115,-0.4484927510364468528779128521276398678019,0.4484927510364468528779128521276398678019,-0.6423493394403402206439846069955156500716,0.6423493394403402206439846069955156500716,-0.8015780907333099127942064895828598903056,0.8015780907333099127942064895828598903056,-0.9175983992229779652065478365007195123904,0.9175983992229779652065478365007195123904,-0.9841830547185881494728294488071096110649,0.9841830547185881494728294488071096110649],[-0.1080549487073436620662446502198347476119,0.1080549487073436620662446502198347476119,-0.3191123689278897604356718241684754668342,0.3191123689278897604356718241684754668342,-0.5152486363581540919652907185511886623088,0.5152486363581540919652907185511886623088,-0.6872929048116854701480198030193341375384,0.6872929048116854701480198030193341375384,-0.8272013150697649931897947426503949610397,0.8272013150697649931897947426503949610397,-0.9284348836635735173363911393778742644770,0.9284348836635735173363911393778742644770,-0.9862838086968123388415972667040528016760,0.9862838086968123388415972667040528016760],[0,-0.2011940939974345223006283033945962078128,0.2011940939974345223006283033945962078128,-0.3941513470775633698972073709810454683627,0.3941513470775633698972073709810454683627,-0.5709721726085388475372267372539106412383,0.5709721726085388475372267372539106412383,-0.7244177313601700474161860546139380096308,0.7244177313601700474161860546139380096308,-0.8482065834104272162006483207742168513662,0.8482065834104272162006483207742168513662,-0.9372733924007059043077589477102094712439,0.9372733924007059043077589477102094712439,-0.9879925180204854284895657185866125811469,0.9879925180204854284895657185866125811469],[-0.0950125098376374401853193354249580631303,0.0950125098376374401853193354249580631303,-0.2816035507792589132304605014604961064860,0.2816035507792589132304605014604961064860,-0.4580167776572273863424194429835775735400,0.4580167776572273863424194429835775735400,-0.6178762444026437484466717640487910189918,0.6178762444026437484466717640487910189918,-0.7554044083550030338951011948474422683538,0.7554044083550030338951011948474422683538,-0.8656312023878317438804678977123931323873,0.8656312023878317438804678977123931323873,-0.9445750230732325760779884155346083450911,0.9445750230732325760779884155346083450911,-0.9894009349916499325961541734503326274262,0.9894009349916499325961541734503326274262],[0,-0.1784841814958478558506774936540655574754,0.1784841814958478558506774936540655574754,-0.3512317634538763152971855170953460050405,0.3512317634538763152971855170953460050405,-0.5126905370864769678862465686295518745829,0.5126905370864769678862465686295518745829,-0.6576711592166907658503022166430023351478,0.6576711592166907658503022166430023351478,-0.7815140038968014069252300555204760502239,0.7815140038968014069252300555204760502239,-0.8802391537269859021229556944881556926234,0.8802391537269859021229556944881556926234,-0.9506755217687677612227169578958030214433,0.9506755217687677612227169578958030214433,-0.9905754753144173356754340199406652765077,0.9905754753144173356754340199406652765077],[-0.0847750130417353012422618529357838117333,0.0847750130417353012422618529357838117333,-0.2518862256915055095889728548779112301628,0.2518862256915055095889728548779112301628,-0.4117511614628426460359317938330516370789,0.4117511614628426460359317938330516370789,-0.5597708310739475346078715485253291369276,0.5597708310739475346078715485253291369276,-0.6916870430603532078748910812888483894522,0.6916870430603532078748910812888483894522,-0.8037049589725231156824174550145907971032,0.8037049589725231156824174550145907971032,-0.8926024664975557392060605911271455154078,0.8926024664975557392060605911271455154078,-0.9558239495713977551811958929297763099728,0.9558239495713977551811958929297763099728,-0.9915651684209309467300160047061507702525,0.9915651684209309467300160047061507702525],[0,-0.1603586456402253758680961157407435495048,0.1603586456402253758680961157407435495048,-0.3165640999636298319901173288498449178922,0.3165640999636298319901173288498449178922,-0.4645707413759609457172671481041023679762,0.4645707413759609457172671481041023679762,-0.6005453046616810234696381649462392798683,0.6005453046616810234696381649462392798683,-0.7209661773352293786170958608237816296571,0.7209661773352293786170958608237816296571,-0.8227146565371428249789224867127139017745,0.8227146565371428249789224867127139017745,-0.9031559036148179016426609285323124878093,0.9031559036148179016426609285323124878093,-0.9602081521348300308527788406876515266150,0.9602081521348300308527788406876515266150,-0.9924068438435844031890176702532604935893,0.9924068438435844031890176702532604935893],[-0.0765265211334973337546404093988382110047,0.0765265211334973337546404093988382110047,-0.2277858511416450780804961953685746247430,0.2277858511416450780804961953685746247430,-0.3737060887154195606725481770249272373957,0.3737060887154195606725481770249272373957,-0.5108670019508270980043640509552509984254,0.5108670019508270980043640509552509984254,-0.6360536807265150254528366962262859367433,0.6360536807265150254528366962262859367433,-0.7463319064601507926143050703556415903107,0.7463319064601507926143050703556415903107,-0.8391169718222188233945290617015206853296,0.8391169718222188233945290617015206853296,-0.9122344282513259058677524412032981130491,0.9122344282513259058677524412032981130491,-0.9639719272779137912676661311972772219120,0.9639719272779137912676661311972772219120,-0.9931285991850949247861223884713202782226,0.9931285991850949247861223884713202782226],[0,-0.1455618541608950909370309823386863301163,0.1455618541608950909370309823386863301163,-0.2880213168024010966007925160646003199090,0.2880213168024010966007925160646003199090,-0.4243421202074387835736688885437880520964,0.4243421202074387835736688885437880520964,-0.5516188358872198070590187967243132866220,0.5516188358872198070590187967243132866220,-0.6671388041974123193059666699903391625970,0.6671388041974123193059666699903391625970,-0.7684399634756779086158778513062280348209,0.7684399634756779086158778513062280348209,-0.8533633645833172836472506385875676702761,0.8533633645833172836472506385875676702761,-0.9200993341504008287901871337149688941591,0.9200993341504008287901871337149688941591,-0.9672268385663062943166222149076951614246,0.9672268385663062943166222149076951614246,-0.9937521706203895002602420359379409291933,0.9937521706203895002602420359379409291933],[-0.0697392733197222212138417961186280818222,0.0697392733197222212138417961186280818222,-0.2078604266882212854788465339195457342156,0.2078604266882212854788465339195457342156,-0.3419358208920842251581474204273796195591,0.3419358208920842251581474204273796195591,-0.4693558379867570264063307109664063460953,0.4693558379867570264063307109664063460953,-0.5876404035069115929588769276386473488776,0.5876404035069115929588769276386473488776,-0.6944872631866827800506898357622567712673,0.6944872631866827800506898357622567712673,-0.7878168059792081620042779554083515213881,0.7878168059792081620042779554083515213881,-0.8658125777203001365364256370193787290847,0.8658125777203001365364256370193787290847,-0.9269567721871740005206929392590531966353,0.9269567721871740005206929392590531966353,-0.9700604978354287271239509867652687108059,0.9700604978354287271239509867652687108059,-0.9942945854823992920730314211612989803930,0.9942945854823992920730314211612989803930],[0,-0.1332568242984661109317426822417661370104,0.1332568242984661109317426822417661370104,-0.2641356809703449305338695382833096029790,0.2641356809703449305338695382833096029790,-0.3903010380302908314214888728806054585780,0.3903010380302908314214888728806054585780,-0.5095014778460075496897930478668464305448,0.5095014778460075496897930478668464305448,-0.6196098757636461563850973116495956533871,0.6196098757636461563850973116495956533871,-0.7186613631319501944616244837486188483299,0.7186613631319501944616244837486188483299,-0.8048884016188398921511184069967785579414,0.8048884016188398921511184069967785579414,-0.8767523582704416673781568859341456716389,0.8767523582704416673781568859341456716389,-0.9329710868260161023491969890384229782357,0.9329710868260161023491969890384229782357,-0.9725424712181152319560240768207773751816,0.9725424712181152319560240768207773751816,-0.9947693349975521235239257154455743605736,0.9947693349975521235239257154455743605736],[-0.0640568928626056260850430826247450385909,0.0640568928626056260850430826247450385909,-0.1911188674736163091586398207570696318404,0.1911188674736163091586398207570696318404,-0.3150426796961633743867932913198102407864,0.3150426796961633743867932913198102407864,-0.4337935076260451384870842319133497124524,0.4337935076260451384870842319133497124524,-0.5454214713888395356583756172183723700107,0.5454214713888395356583756172183723700107,-0.6480936519369755692524957869107476266696,0.6480936519369755692524957869107476266696,-0.7401241915785543642438281030999784255232,0.7401241915785543642438281030999784255232,-0.8200019859739029219539498726697452080761,0.8200019859739029219539498726697452080761,-0.8864155270044010342131543419821967550873,0.8864155270044010342131543419821967550873,-0.9382745520027327585236490017087214496548,0.9382745520027327585236490017087214496548,-0.9747285559713094981983919930081690617411,0.9747285559713094981983919930081690617411,-0.9951872199970213601799974097007368118745,0.9951872199970213601799974097007368118745]];var Cvalues=0||[[],[],[1.0,1.0],[0.8888888888888888888888888888888888888888,0.5555555555555555555555555555555555555555,0.5555555555555555555555555555555555555555],[0.6521451548625461426269360507780005927646,0.6521451548625461426269360507780005927646,0.3478548451374538573730639492219994072353,0.3478548451374538573730639492219994072353],[0.5688888888888888888888888888888888888888,0.4786286704993664680412915148356381929122,0.4786286704993664680412915148356381929122,0.2369268850561890875142640407199173626432,0.2369268850561890875142640407199173626432],[0.3607615730481386075698335138377161116615,0.3607615730481386075698335138377161116615,0.4679139345726910473898703439895509948116,0.4679139345726910473898703439895509948116,0.1713244923791703450402961421727328935268,0.1713244923791703450402961421727328935268],[0.4179591836734693877551020408163265306122,0.3818300505051189449503697754889751338783,0.3818300505051189449503697754889751338783,0.2797053914892766679014677714237795824869,0.2797053914892766679014677714237795824869,0.1294849661688696932706114326790820183285,0.1294849661688696932706114326790820183285],[0.3626837833783619829651504492771956121941,0.3626837833783619829651504492771956121941,0.3137066458778872873379622019866013132603,0.3137066458778872873379622019866013132603,0.2223810344533744705443559944262408844301,0.2223810344533744705443559944262408844301,0.1012285362903762591525313543099621901153,0.1012285362903762591525313543099621901153],[0.3302393550012597631645250692869740488788,0.1806481606948574040584720312429128095143,0.1806481606948574040584720312429128095143,0.0812743883615744119718921581105236506756,0.0812743883615744119718921581105236506756,0.3123470770400028400686304065844436655987,0.3123470770400028400686304065844436655987,0.2606106964029354623187428694186328497718,0.2606106964029354623187428694186328497718],[0.2955242247147528701738929946513383294210,0.2955242247147528701738929946513383294210,0.2692667193099963550912269215694693528597,0.2692667193099963550912269215694693528597,0.2190863625159820439955349342281631924587,0.2190863625159820439955349342281631924587,0.1494513491505805931457763396576973324025,0.1494513491505805931457763396576973324025,0.0666713443086881375935688098933317928578,0.0666713443086881375935688098933317928578],[0.2729250867779006307144835283363421891560,0.2628045445102466621806888698905091953727,0.2628045445102466621806888698905091953727,0.2331937645919904799185237048431751394317,0.2331937645919904799185237048431751394317,0.1862902109277342514260976414316558916912,0.1862902109277342514260976414316558916912,0.1255803694649046246346942992239401001976,0.1255803694649046246346942992239401001976,0.0556685671161736664827537204425485787285,0.0556685671161736664827537204425485787285],[0.2491470458134027850005624360429512108304,0.2491470458134027850005624360429512108304,0.2334925365383548087608498989248780562594,0.2334925365383548087608498989248780562594,0.2031674267230659217490644558097983765065,0.2031674267230659217490644558097983765065,0.1600783285433462263346525295433590718720,0.1600783285433462263346525295433590718720,0.1069393259953184309602547181939962242145,0.1069393259953184309602547181939962242145,0.0471753363865118271946159614850170603170,0.0471753363865118271946159614850170603170],[0.2325515532308739101945895152688359481566,0.2262831802628972384120901860397766184347,0.2262831802628972384120901860397766184347,0.2078160475368885023125232193060527633865,0.2078160475368885023125232193060527633865,0.1781459807619457382800466919960979955128,0.1781459807619457382800466919960979955128,0.1388735102197872384636017768688714676218,0.1388735102197872384636017768688714676218,0.0921214998377284479144217759537971209236,0.0921214998377284479144217759537971209236,0.0404840047653158795200215922009860600419,0.0404840047653158795200215922009860600419],[0.2152638534631577901958764433162600352749,0.2152638534631577901958764433162600352749,0.2051984637212956039659240656612180557103,0.2051984637212956039659240656612180557103,0.1855383974779378137417165901251570362489,0.1855383974779378137417165901251570362489,0.1572031671581935345696019386238421566056,0.1572031671581935345696019386238421566056,0.1215185706879031846894148090724766259566,0.1215185706879031846894148090724766259566,0.0801580871597602098056332770628543095836,0.0801580871597602098056332770628543095836,0.0351194603317518630318328761381917806197,0.0351194603317518630318328761381917806197],[0.2025782419255612728806201999675193148386,0.1984314853271115764561183264438393248186,0.1984314853271115764561183264438393248186,0.1861610000155622110268005618664228245062,0.1861610000155622110268005618664228245062,0.1662692058169939335532008604812088111309,0.1662692058169939335532008604812088111309,0.1395706779261543144478047945110283225208,0.1395706779261543144478047945110283225208,0.1071592204671719350118695466858693034155,0.1071592204671719350118695466858693034155,0.0703660474881081247092674164506673384667,0.0703660474881081247092674164506673384667,0.0307532419961172683546283935772044177217,0.0307532419961172683546283935772044177217],[0.1894506104550684962853967232082831051469,0.1894506104550684962853967232082831051469,0.1826034150449235888667636679692199393835,0.1826034150449235888667636679692199393835,0.1691565193950025381893120790303599622116,0.1691565193950025381893120790303599622116,0.1495959888165767320815017305474785489704,0.1495959888165767320815017305474785489704,0.1246289712555338720524762821920164201448,0.1246289712555338720524762821920164201448,0.0951585116824927848099251076022462263552,0.0951585116824927848099251076022462263552,0.0622535239386478928628438369943776942749,0.0622535239386478928628438369943776942749,0.0271524594117540948517805724560181035122,0.0271524594117540948517805724560181035122],[0.1794464703562065254582656442618856214487,0.1765627053669926463252709901131972391509,0.1765627053669926463252709901131972391509,0.1680041021564500445099706637883231550211,0.1680041021564500445099706637883231550211,0.1540457610768102880814315948019586119404,0.1540457610768102880814315948019586119404,0.1351363684685254732863199817023501973721,0.1351363684685254732863199817023501973721,0.1118838471934039710947883856263559267358,0.1118838471934039710947883856263559267358,0.0850361483171791808835353701910620738504,0.0850361483171791808835353701910620738504,0.0554595293739872011294401653582446605128,0.0554595293739872011294401653582446605128,0.0241483028685479319601100262875653246916,0.0241483028685479319601100262875653246916],[0.1691423829631435918406564701349866103341,0.1691423829631435918406564701349866103341,0.1642764837458327229860537764659275904123,0.1642764837458327229860537764659275904123,0.1546846751262652449254180038363747721932,0.1546846751262652449254180038363747721932,0.1406429146706506512047313037519472280955,0.1406429146706506512047313037519472280955,0.1225552067114784601845191268002015552281,0.1225552067114784601845191268002015552281,0.1009420441062871655628139849248346070628,0.1009420441062871655628139849248346070628,0.0764257302548890565291296776166365256053,0.0764257302548890565291296776166365256053,0.0497145488949697964533349462026386416808,0.0497145488949697964533349462026386416808,0.0216160135264833103133427102664524693876,0.0216160135264833103133427102664524693876],[0.1610544498487836959791636253209167350399,0.1589688433939543476499564394650472016787,0.1589688433939543476499564394650472016787,0.1527660420658596667788554008976629984610,0.1527660420658596667788554008976629984610,0.1426067021736066117757461094419029724756,0.1426067021736066117757461094419029724756,0.1287539625393362276755157848568771170558,0.1287539625393362276755157848568771170558,0.1115666455473339947160239016817659974813,0.1115666455473339947160239016817659974813,0.0914900216224499994644620941238396526609,0.0914900216224499994644620941238396526609,0.0690445427376412265807082580060130449618,0.0690445427376412265807082580060130449618,0.0448142267656996003328381574019942119517,0.0448142267656996003328381574019942119517,0.0194617882297264770363120414644384357529,0.0194617882297264770363120414644384357529],[0.1527533871307258506980843319550975934919,0.1527533871307258506980843319550975934919,0.1491729864726037467878287370019694366926,0.1491729864726037467878287370019694366926,0.1420961093183820513292983250671649330345,0.1420961093183820513292983250671649330345,0.1316886384491766268984944997481631349161,0.1316886384491766268984944997481631349161,0.1181945319615184173123773777113822870050,0.1181945319615184173123773777113822870050,0.1019301198172404350367501354803498761666,0.1019301198172404350367501354803498761666,0.0832767415767047487247581432220462061001,0.0832767415767047487247581432220462061001,0.0626720483341090635695065351870416063516,0.0626720483341090635695065351870416063516,0.0406014298003869413310399522749321098790,0.0406014298003869413310399522749321098790,0.0176140071391521183118619623518528163621,0.0176140071391521183118619623518528163621],[0.1460811336496904271919851476833711882448,0.1445244039899700590638271665537525436099,0.1445244039899700590638271665537525436099,0.1398873947910731547221334238675831108927,0.1398873947910731547221334238675831108927,0.1322689386333374617810525744967756043290,0.1322689386333374617810525744967756043290,0.1218314160537285341953671771257335983563,0.1218314160537285341953671771257335983563,0.1087972991671483776634745780701056420336,0.1087972991671483776634745780701056420336,0.0934444234560338615532897411139320884835,0.0934444234560338615532897411139320884835,0.0761001136283793020170516533001831792261,0.0761001136283793020170516533001831792261,0.0571344254268572082836358264724479574912,0.0571344254268572082836358264724479574912,0.0369537897708524937999506682993296661889,0.0369537897708524937999506682993296661889,0.0160172282577743333242246168584710152658,0.0160172282577743333242246168584710152658],[0.1392518728556319933754102483418099578739,0.1392518728556319933754102483418099578739,0.1365414983460151713525738312315173965863,0.1365414983460151713525738312315173965863,0.1311735047870623707329649925303074458757,0.1311735047870623707329649925303074458757,0.1232523768105124242855609861548144719594,0.1232523768105124242855609861548144719594,0.1129322960805392183934006074217843191142,0.1129322960805392183934006074217843191142,0.1004141444428809649320788378305362823508,0.1004141444428809649320788378305362823508,0.0859416062170677274144436813727028661891,0.0859416062170677274144436813727028661891,0.0697964684245204880949614189302176573987,0.0697964684245204880949614189302176573987,0.0522933351526832859403120512732112561121,0.0522933351526832859403120512732112561121,0.0337749015848141547933022468659129013491,0.0337749015848141547933022468659129013491,0.0146279952982722006849910980471854451902,0.0146279952982722006849910980471854451902],[0.1336545721861061753514571105458443385831,0.1324620394046966173716424647033169258050,0.1324620394046966173716424647033169258050,0.1289057221880821499785953393997936532597,0.1289057221880821499785953393997936532597,0.1230490843067295304675784006720096548158,0.1230490843067295304675784006720096548158,0.1149966402224113649416435129339613014914,0.1149966402224113649416435129339613014914,0.1048920914645414100740861850147438548584,0.1048920914645414100740861850147438548584,0.0929157660600351474770186173697646486034,0.0929157660600351474770186173697646486034,0.0792814117767189549228925247420432269137,0.0792814117767189549228925247420432269137,0.0642324214085258521271696151589109980391,0.0642324214085258521271696151589109980391,0.0480376717310846685716410716320339965612,0.0480376717310846685716410716320339965612,0.0309880058569794443106942196418845053837,0.0309880058569794443106942196418845053837,0.0134118594871417720813094934586150649766,0.0134118594871417720813094934586150649766],[0.1279381953467521569740561652246953718517,0.1279381953467521569740561652246953718517,0.1258374563468282961213753825111836887264,0.1258374563468282961213753825111836887264,0.1216704729278033912044631534762624256070,0.1216704729278033912044631534762624256070,0.1155056680537256013533444839067835598622,0.1155056680537256013533444839067835598622,0.1074442701159656347825773424466062227946,0.1074442701159656347825773424466062227946,0.0976186521041138882698806644642471544279,0.0976186521041138882698806644642471544279,0.0861901615319532759171852029837426671850,0.0861901615319532759171852029837426671850,0.0733464814110803057340336152531165181193,0.0733464814110803057340336152531165181193,0.0592985849154367807463677585001085845412,0.0592985849154367807463677585001085845412,0.0442774388174198061686027482113382288593,0.0442774388174198061686027482113382288593,0.0285313886289336631813078159518782864491,0.0285313886289336631813078159518782864491,0.0123412297999871995468056670700372915759,0.0123412297999871995468056670700372915759]];var start=[0,0];var first=[0,0];for(var i=0;i<commands.length;i++){if(commands[i]['func']=='moveTo'){start=[commands[i]['args'][0],commands[i]['args'][1]];i++;first[0]=start[0];first[1]=start[1];}
var end=[start[0],start[1]];var cpoints=[];switch(commands[i]['func']){case'lineTo':end[0]=commands[i]['args'][0];end[1]=commands[i]['args'][1];break;case'quadraticCurveTo':end[0]=commands[i]['args'][2];end[1]=commands[i]['args'][3];cpoints.push([commands[i]['args'][0],commands[i]['args'][1]]);break;case'bezierCurveTo':end[0]=commands[i]['args'][4];end[1]=commands[i]['args'][5];cpoints.push([commands[i]['args'][0],commands[i]['args'][1]]);cpoints.push([commands[i]['args'][2],commands[i]['args'][3]]);break;case'closePath':end[0]=first[0];end[1]=first[1];break;}
var sum=0;var t=1;var z=t/2;var n=20;for(var xi=0;xi<n;xi++){var corrected_t=z*Tvalues[n][xi]+z;var derivp=SVGPath2Cnvs.getDerivPathPoint(corrected_t,start,end,cpoints);var combined=Math.sqrt(derivp[0]*derivp[0]+derivp[1]*derivp[1]);sum+=Cvalues[n][xi]*combined;}
sum*=z;path_pixel_lenght+=sum;start=[end[0],end[1]];}}
return path_pixel_lenght;},simplify:function(_path_commands,getcommands,samplecount){getcommands=typeof(getcommands)=='boolean'?getcommands:true;samplecount=parseInt(samplecount,10);samplecount=(isNaN(samplecount)||!samplecount)?20:samplecount;var t_step=1/samplecount;var commands;var simplified=[];if(_path_commands instanceof Array){commands=_path_commands.slice(0);}else{commands=SVGPath2Cnvs.parse(_path_commands);}
if(commands){var last_command=commands.shift();var current_command
if(last_command.func!='moveTo'){console.log('invalid path given');return false;}
var start_point=last_command.args.slice(0);simplified.push(last_command);while(commands.length){current_command=commands.shift();switch(current_command.func){case'quadraticCurveTo':for(var i=1;i<=samplecount;i++){var newcmd={func:'lineTo',args:[]};newcmd.args[0]=SVGPath2Cnvs.qbezier(start_point[0],current_command.args[0],current_command.args[2],t_step*i)
newcmd.args[1]=SVGPath2Cnvs.qbezier(start_point[1],current_command.args[1],current_command.args[3],t_step*i)
simplified.push(newcmd);}
start_point[0]=current_command.args[2]
start_point[1]=current_command.args[3]
break;case'bezierCurveTo':for(var i=1;i<=samplecount;i++){var newcmd={func:'lineTo',args:[]};newcmd.args[0]=SVGPath2Cnvs.cbezier(start_point[0],current_command.args[0],current_command.args[2],current_command.args[4],t_step*i)
newcmd.args[1]=SVGPath2Cnvs.cbezier(start_point[1],current_command.args[1],current_command.args[3],current_command.args[5],t_step*i)
simplified.push(newcmd);}
start_point[0]=current_command.args[4]
start_point[1]=current_command.args[5]
break;case'closePath':case'moveTo':case'lineTo':simplified.push(current_command);if(current_command.func!='closePath'){start_point[0]=current_command.args[0]
start_point[1]=current_command.args[1]}
break;}}
if(getcommands){return simplified;}else{var spathstr=SVGPath2Cnvs.commandsDataStr(simplified);while(simplified.length){simplified.pop();}
return spathstr;}}
return false;},svg_arc_2_canvas_ellipse:function(start_x,start_y,svg_arc_params){var x_radius=svg_arc_params[0],y_radius=svg_arc_params[1],x_axis_rot=svg_arc_params[2],large_arc=svg_arc_params[3],sweep=svg_arc_params[4],end_x=svg_arc_params[5],end_y=svg_arc_params[6];var x12=end_x-start_x,y12=end_y-start_y,phi=x_axis_rot/180*Math.PI,cp=phi?Math.cos(phi):1,sp=phi?Math.sin(phi):0,k=y_radius/x_radius,dth_sgn=sweep?1:-1,Nx=dth_sgn*(-x12*cp-y12*sp),Ny=dth_sgn*(-x12*sp+y12*cp),NN=Math.hypot(Nx,Ny/k),R=2*x_radius>NN?x_radius:NN/2,dth=2*dth_sgn*Math.asin(NN/2/R),th1,ct,st;if(large_arc){dth=dth>0?(2*Math.PI-dth):(-2*Math.PI-dth);}
th1=Math.atan2(k*Nx,Ny)-dth/2;ct=Math.cos(th1);st=Math.sin(th1);return[start_x-R*((cp*ct)-(sp*k*st)),start_y-R*((sp*ct)+(cp*k*st)),R,R*k,phi,th1,th1+dth,dth_sgn===-1];}};var FLSMultiselect=function(editor){var selection_start={x:0,y:0};var handle_multiselect=false;var selection_box=new FLSEditorCore.CSelectionGroup();var _this=this;if(handle_multiselect||selection_start){}
function _handleMultiSelect(evt,mouseCoords,edit_operation,lastSelectedObj){var objs=editor.getObjects().concat(editor.getLayoutObjects());switch(evt.type){case'mousedown':case'touchstart':handle_multiselect=false;if(edit_operation=='op:none'&&(evt.ctrlKey==false)){editor.deselect();handle_multiselect=true;if(objs.indexOf(selection_box)==-1){editor.addObject(selection_box);}
var zoom=editor.zoom();var ed_wt=editor.viewtopleft();selection_start.x=mouseCoords.x;selection_start.y=mouseCoords.y;selection_box.setPosition((selection_start.x-ed_wt.x)/zoom,(selection_start.y-ed_wt.y)/zoom);selection_box.setSize(0,0);selection_box.setActive(false);}else{if((lastSelectedObj!=selection_box)){if(!evt.ctrlKey||lastSelectedObj.fixed()||!lastSelectedObj.selectable()||((lastSelectedObj instanceof FLSEditorCore.CRect)&&lastSelectedObj.id=='backgroundColor')){_removeSelectionBox();}else{selection_box.addElement(lastSelectedObj);if(objs.indexOf(selection_box)==-1){editor.addObject(selection_box);}
lastSelectedObj=selection_box;editor.setCurrentObject(selection_box);}}}
break;case'mousemove':case'touchmove':if(handle_multiselect&&edit_operation=='op:none'){var zoom=editor.zoom();var w=mouseCoords.x-selection_start.x;var h=mouseCoords.y-selection_start.y;selection_box.setSize(w/zoom,h/zoom);if(typeof(evt.preventDefault)=='function'){evt.stopPropagation();evt.preventDefault();}else{evt.returnValue=false;};}
break;case'mouseup':case'touchend':if(handle_multiselect&&edit_operation=='op:none'){selection_box.only_layout_zones=_this.only_layout_zones===true?true:false;selection_box.intersection_select=_this.intersection_select===true?true:false;var elements=selection_box.setElements(selection_start,{x:mouseCoords.x,y:mouseCoords.y});if(!elements.length){_removeSelectionBox();}else{editor.deselect();if(lastSelectedObj){lastSelectedObj.setActive(false);}
if(elements.length==1){editor.setCurrentObject(elements[0]);_removeSelectionBox();}else{editor.setCurrentObject(selection_box);}
lastSelectedObj=editor.getCurrentObject();}}
handle_multiselect=false;}
return lastSelectedObj;}
function _removeSelectionBox(){selection_box.clear();editor.removeObject(selection_box);}
this.exec=_handleMultiSelect;this.hide=_removeSelectionBox;this.scalable=selection_box.scalable;};var SVGToCanvasLoader=function(svg_path,onLoadedCallback){var defs={};var elements=[];function handleLoadComplete(){if(typeof(onLoadedCallback)=='function'){onLoadedCallback(elements,defs);}}
function svgFilter(tofilter,ctype){tofilter=tofilter.replace(/(xmlns:ns[0-9]*?="")|(\sns[0-9]*?:)|(xmlns="http:\/\/www.w3.org\/2000\/svg"\s?)|(inkscape:[^=]+=[\s]?"[^"]+"\s?)/ig,'');return tofilter.replace(/(<svg\s)/i,'<svg xmlns="http://www.w3.org/2000/svg" ');}
function _parseStyles(svgnode,edobj){var styles=svgnode.attr('style');if(styles){styles=styles.trim().split(';');for(var i=0;i<styles.length;i++){var stmp=styles[i].split(':');if(stmp.length==2){switch(stmp[0]){case'fill':if(stmp[1]!='none'){edobj.setColor(stmp[1]);}
break;case'stroke':if(stmp[1]!='none'){edobj.setStroke(stmp[1]);}else{edobj.setStroke();}
break;case'stroke-width':if(stmp[1]!='none'){edobj.setStrokeWidth(stmp[1]);}else{edobj.setStrokeWidth();}
break;case'stroke-linecap':if(stmp[1]!='none'){edobj.setStrokeCap(stmp[1]);}else{edobj.setStrokeCap();}
break;case'stroke-miterlimit':if(stmp[1]!='none'){edobj.setStrokeMieter(stmp[1]);}else{edobj.setStrokeMieter();}
break;case'stroke-linejoin':if(stmp[1]!='none'){edobj.setStrokeJoin(stmp[1]);}else{edobj.setStrokeJoin();}
break;default:}}}}
var fillattr=(svgnode.attr('fill'));if(fillattr&&fillattr!='none'){var normcolor=FLSUtil.normalizeCssColor(fillattr);fillattr=normcolor.css;edobj.setColor(fillattr);}
if(edobj instanceof FLSEditorCore.CText){var ff=svgnode.attr('font-family');edobj.setFontFamily(ff);var fs=parseFloat(svgnode.attr('font-size'));edobj.setFontSize(fs);}
var ptransform={};if(svgnode.attr('transform')){var ptransforms=svgnode.attr('transform').trim().split(') ');if(ptransforms.length){for(var l=0;l<ptransforms.length;l++){var fn=ptransforms[l].split('(');if(fn.length==2){fn[1]=fn[1].replace(/\)/g,'').replace(/\s+/g,',').replace(/,+/g,',').split(',');ptransform[fn[0]]=[];if(fn[1].length){for(var fi=0;fi<fn[1].length;fi++){ptransform[fn[0]].push(parseFloat(fn[1][fi]));}}}}}
if(ptransform['matrix']){edobj.setMatrix(ptransform['matrix']);}
if(ptransform['translate']){edobj.translate(ptransform['translate'][0],ptransform['translate'][1]);}}
var id=svgnode.attr('id');if(id){edobj.id=id;}}
function parseDefs(svg){var definitions=jQuery('defs',svg);if(definitions.length){for(var di=0;di<definitions.length;di++){var cdefs=jQuery(definitions[di]).children();for(var cdefi=0;cdefi<cdefs.length;cdefi++){var defn=cdefs[cdefi];var $defn=jQuery(defn);switch(defn.nodeName){case'path':defs[$defn.attr('id')]=$defn.attr('d');break;default:console.log('def node not yet supported:',defn.nodeName);}}}}}
function handleTextNode(tn){var pathtxtx=false;var text=tn.text();var tpaths=tn.children('textPath');if(tpaths.length){text=tpaths.text();pathtxtx=true;}
var to=null;if(pathtxtx){to=new FLSEditorCore.CPathText(text);var defid=tpaths.attr('xlink:href').replace(/#/,'');to.setPathStr(defs[defid]);}else{to=new FLSEditorCore.CText(text);}
to.removable(true);_parseStyles(tn,to);return to;}
function handleImageNode(imn){}
function parseSVG(svg,pobj){svg.children().each(function(index){var snode=jQuery(this);switch(this.nodeName){case'text':elements.push(handleTextNode(snode));break;case'image':elements.push(handleImageNode(snode));break;case'g':var gid=snode.attr('id');switch(gid){case'surface4':parseSVG(snode,pobj);break;case'surface2':break;case'images':break;case'logo':break;default:console.log('generic group not yet supported');}
break;}});}
try{if(typeof(svg_path)=='string'){jQuery.ajax({url:svg_path,success:function(xml){var svg=jQuery('svg',xml);parseDefs(svg);parseSVG(svg,elements);handleLoadComplete();},contentType:'xml',data:{},dataFilter:svgFilter,error:function(resp,type,error){console.log(error.message);handleLoadComplete();}});}}catch(err){console.log(err);}};var FloatingWidget=function(title,container){var widget=jQuery(document.createElement('div'));var wdgt_ttl=jQuery('<h4 class=flt-wdgt-ttl><span class="wdgt-ttl-btn close">&times;</span><span class="wdgt-ttl">'+(title?title.toString():'Untitled')+'</span></h4>');var wdgt_content=jQuery(document.createElement('div'));widget.addClass('flt-wdgt-container');wdgt_content.addClass('flt-wdgt-content');widget.append(wdgt_ttl);widget.append(wdgt_content);container=container?jQuery(container):jQuery('body');container.append(widget);jQuery('style#FLS-HTML5-FloatingWidget-CSS').remove();var widget_css='<style type="text/css" id="FLS-HTML5-FloatingWidget-CSS">\n';widget_css+='.flt-wdgt-container{z-index:50;-moz-user-select: none; user-select:none;-webkit-user-select:none;position:absolute; left:0; top:0; box-shadow: 0 0 2px rgba(0, 0, 0, 0.5); width:170px;border:1px solid #C5C5C5;background-color:#e0e0e0;font-family:arial,verdana,sans-serif;color:#666;background-color:#e0e0e0;font-size:11px;font-weight:normal;}\n';widget_css+='.flt-wdgt-container .flt-wdgt-ttl{margin:0; padding:0;border:1px solid #FFF;line-height:1.5em; color:#FFF; background-color:#104d81;}\n';widget_css+='.flt-wdgt-container .wdgt-ttl{margin:0 5px; display:block;}\n';widget_css+='.flt-wdgt-container .flt-wdgt-content{margin:0; padding:0;border:1px solid #FFF;border-top-color:#C5C5C5;}\n';widget_css+='.flt-wdgt-container .wdgt-content{margin:5px;}\n';widget_css+='.flt-wdgt-container .wdgt-ttl-btn{cursor:pointer;-moz-user-select: none; user-select:none;color:#FFF;background-color:#e0e0e0;font-size:12px;font-weight:normal;width:11px; height:11px; display:block; text-align:center; line-height: 11px;border-radius:3px; float:right; margin:2px;}\n';widget_css+='.flt-wdgt-container .wdgt-ttl-btn.close{background-color:#F00;border:1px solid #FFF;}\n';widget_css+='.flt-wdgt-container .flt-wdgt-sldr-cntrl{display:block; position:relative;margin:10px 0 20px 5px;padding:0;}\n';widget_css+='.flt-wdgt-container .flt-wdgt-sldr-cntrl .flt-wdgt-sldr{box-shadow: 1px 1px 0 #fff;display:block; border-radius:10px;height:3px; border:1px solid #666;position:relative;}\n';widget_css+='.flt-wdgt-container .flt-wdgt-sldr-cntrl .flt-wdgt-sldr .flst-wdgt-sldr-cnob{cursor:pointer;background-color: #ccc;border: 1px solid #666;border-radius: 10px;display: block;height: 13px;left: -8px;margin-top: -8px;position: absolute;top: 50%;width: 13px;z-index: 10;box-shadow: 0 0 1px rgba(0,0,0,0.5);}\n';widget_css+='.flt-wdgt-container .flt-wdgt-sldr-cntrl .flst-wdgt-sldr-ticks{display: block;height:1em;margin:10px 0 0 0;position:relative;}\n';widget_css+='.flt-wdgt-container .flt-wdgt-sldr-cntrl .flst-wdgt-sldr-ticks .sldr-tick{position:absolute; color:#000; font-size:11px;text-align:left;left:0px;}\n';widget_css+='.flt-wdgt-container .flt-wdgt-sldr-cntrl .flst-wdgt-sldr-ticks .sldr-tick::AFTER{content:"";position:absolute; width:1px; height:5px; top:-5px; left:50%;border-left:1px solid #000;}\n';widget_css+='.flt-wdgt-container .flt-wdgt-sldr-cntrl .flst-wdgt-sldr-ticks .sldr-tick.first::AFTER{}\n';widget_css+='.flt-wdgt-container .flt-wdgt-sldr-cntrl .flst-wdgt-sldr-ticks .sldr-tick.last::AFTER{left:auto;right:0}\n';widget_css+='.flt-wdgt-container .flt-wdgt-sldr-cntrl .flst-wdgt-sldr-ticks .sldr-tick.last{left:auto !important;right:0 !important;}\n';widget_css+='.flt-wdgt-container fieldset.flt-wdgt-sldr-cntrl,.flt-wdgt-container fieldset.flt-wdgt-cntrl{margin:0;padding:5px 10px 10px 10px; border:1px solid #666;}\n';widget_css+='.flt-wdgt-container fieldset.flt-wdgt-cntrl.top-border{padding: 3px 0; border-width: 1px 0 0 0;}\n';widget_css+='.flt-wdgt-container fieldset.flt-wdgt-sldr-cntrl legend,.flt-wdgt-container fieldset.flt-wdgt-cntrl legend{color:#000;}\n';widget_css+='.flt-wdgt-container fieldset.flt-wdgt-cntrl.top-border legend{margin-left: 10px;}\n';widget_css+='.flt-wdgt-container .flt-wdgt-sqbtn{ border: 1px solid #666; box-shadow: 1px 1px 0 #fff;cursor: pointer; display: block; font-family: georgia,verdana,arial,sans-serif; font-size: 18px; height: 26px; line-height: 25px; margin: 3px 0; text-align: center; width: 26px;}\n';widget_css+='.flt-wdgt-container .flt-wdgt-sqbtn.active{color: #FFF; background-color: #4988BD;}\n';widget_css+='.flt-wdgt-container .flt-wdgt-sqbtn.disabled{color: #FFF; background-color: #CCC; cursor:default;}\n';widget_css+='</style>\n';jQuery(widget_css).appendTo('head');jQuery('.wdgt-ttl-btn.close',widget).on('click',function(evt){widget.hide();return false;});this.setContent=function(content){if(((content instanceof jQuery)||(typeof(content)==='string'))&&content.length){var cwrp=jQuery('<div class="wdgt-content"></div>');cwrp.append(content);wdgt_content.empty().append(cwrp);}};this.setTitle=function(ttl){if((typeof(ttl)==='string')&&ttl.trim().length){jQuery('span.wdgt-ttl',wdgt_ttl).html(ttl);}};this.getWidget=function(){return widget;};this.show=function(){widget.show();};this.hide=function(){widget.hide();};};FloatingWidget.prototype.createSliderControl=function(config){var mobile=FLSUtil.mobile();var wp_mobile=FLSUtil.wp_mobile();var mouseCoords=0||{x:0,y:0};var _this=this;config.unit=typeof(config.unit)=='string'?config.unit.trim():'';var _unit=config.unit;var ticks_cnt=5;var cntntname=typeof(config.clabel)==='string'&&config.clabel.trim().length?'fieldset':'span';var slider_cntrl=document.createElement(cntntname);if(cntntname==='fieldset'){var slider_cntrl_lbl=document.createElement('legend');slider_cntrl_lbl.innerHTML=config.clabel+(config.unit.length?'('+config.unit+')':'');slider_cntrl.appendChild(slider_cntrl_lbl);_unit='';}
var slider=document.createElement('span');var cnob=document.createElement('span');var ticks=document.createElement('span');slider.appendChild(cnob);slider_cntrl.appendChild(slider);slider_cntrl.appendChild(ticks);slider_cntrl.className='flt-wdgt-sldr-cntrl';slider.className='flt-wdgt-sldr';cnob.className='flst-wdgt-sldr-cnob';ticks.className='flst-wdgt-sldr-ticks';var dragstart=null;var cnb_w=0,cnb_w2=0,min_x=0,max_x=0;config.min=parseFloat(config.min,10);config.max=parseFloat(config.max,10);config.default_value=parseFloat(config.default_value);config.min=isNaN(config.min)?0:config.min;config.max=isNaN(config.max)?100:config.max;config.default_value=isNaN(config.default_value)?config.min:((config.default_value>=config.min)&&(config.default_value<=config.max))?config.default_value:config.min;var config_cp=JSON.parse(JSON.stringify(config));var value=config.default_value;var tick_step=(config.max-config.min)/(ticks_cnt-1);setTimeout(function(){cnb_w=cnob.clientWidth;cnb_w2=cnb_w/2;min_x=-Math.round(cnb_w2);max_x=Math.round(slider.clientWidth+min_x);slider.setAttribute('data-value',value);slider.setAttribute('data-name',config.cname);var range_diff=config.max-config.min;var x_diff=slider.clientWidth;var pos_scale=(Math.abs(config.min)+value)/range_diff;var newleft=(x_diff*pos_scale);cnob.style.left=(newleft-cnb_w2)+'px';var width_steps=ticks.clientWidth/(ticks_cnt-1);for(var i=0;i<ticks_cnt;i++){var tick=document.createElement('span');var tick_cls='sldr-tick';tick_cls+=(i==0)?' first':(i==ticks_cnt-1)?' last':'';tick.innerHTML=Math.round((i==ticks_cnt-1)?config.max:config.min+(tick_step*i))+_unit;tick.className=tick_cls;ticks.appendChild(tick);tick.style.left=((width_steps*i)-(tick.clientWidth/2))+'px';}},20);function onchange(newleft){var range_diff=config.max-config.min;var x_diff=slider.clientWidth;var pos_scale=parseFloat(((newleft+cnb_w2)/x_diff).toFixed(2));value=config.min+Math.round((range_diff*pos_scale));value=value<config.min?config.min:(value>config.max?config.max:value);slider.setAttribute('data-value',value);if(typeof(_this.onchange)=='function'){_this.onchange(value,config_cp);}}
function getMousePos(evt){var rect=slider.getBoundingClientRect();if(evt.type=='touchend')return mouseCoords;if(evt.touches){mouseCoords.x=evt.touches[0].clientX-rect.left;mouseCoords.y=evt.touches[0].clientY-rect.top;}else{mouseCoords.x=evt.clientX-rect.left;mouseCoords.y=evt.clientY-rect.top;}
return mouseCoords;}
function _handleSliderDrag(evt){getMousePos(evt);switch(evt.type){case'mousedown':case'touchstart':case'pointerdown':if([cnob,slider].indexOf(evt.target)>-1){dragstart={x:mouseCoords.x,y:mouseCoords.y};}
if(evt.target==slider){var dx=Math.round(mouseCoords.x-cnob.offsetLeft);var newleft=cnob.offsetLeft+dx+min_x;if(newleft>=min_x&&newleft<max_x){cnob.style.left=newleft+'px';onchange(newleft);}}
break;case'mousemove':case'touchmove':case'pointermove':if(dragstart){var dx=mouseCoords.x-dragstart.x;var newleft=cnob.offsetLeft+dx;if(newleft>=min_x&&newleft<=max_x){cnob.style.left=newleft+'px';onchange(newleft);}
dragstart.x=mouseCoords.x;dragstart.y=mouseCoords.y;}
break;case'mouseup':case'touchend':case'pointerup':dragstart=null;break;case'mouseout':case'touchcancel':case'pointercancel':if(evt.target===slider_cntrl&&evt.relatedTarget===slider_cntrl){dragstart=null;}
break;}
if(typeof(evt.preventDefault)=='function'){evt.stopPropagation();evt.preventDefault();}else{evt.returnValue=false;};return false;}
var mob_evtnts=wp_mobile?['pointerdown','pointermove','pointerup']:['touchstart','touchmove','touchend'];var events=mobile?mob_evtnts:['mousedown','mousemove','mouseup'];for(var i in events){if(document.addEventListener){slider_cntrl.addEventListener(events[i],_handleSliderDrag,false);}else if(document.attachEvent){slider_cntrl.attachEvent("on"+events[i],_handleSliderDrag);}}
this.value=function(val){val=parseFloat(val);if(!isNaN(val)&&(val>=config.min)&&(val<=config.max)){value=val;slider.setAttribute('data-value',value);var range_diff=config.max-config.min;var x_diff=slider.clientWidth;var pos_scale=(Math.abs(config.min)+value)/range_diff;var newleft=(x_diff*pos_scale);cnob.style.left=(newleft-cnb_w2)+'px';}
return value;};this.control=function(){return slider_cntrl;};};FloatingWidget.prototype.createColorPicker=function(config,canvas){var mobile=FLSUtil.mobile();var wp_mobile=FLSUtil.wp_mobile();var mouseCoords=0||{x:0,y:0};var _this=this;if(!canvas||!canvas.getContext){canvas=document.createElement('canvas');}
var cntntname=typeof(config.clabel)==='string'&&config.clabel.trim().length?'fieldset':'span';var picker_cntrl=document.createElement(cntntname);if(cntntname==='fieldset'){var picker_cntrl_lbl=document.createElement('legend');picker_cntrl_lbl.innerHTML=config.clabel;picker_cntrl.appendChild(picker_cntrl_lbl);picker_cntrl.className='flt-wdgt-cntrl top-border';}
var ctx=canvas.getContext('2d');config.width=parseInt(config.width);config.height=parseInt(config.height);var value='rgb(0,0,0)';canvas.setAttribute('data-name',config.cname);canvas.setAttribute('data-value',value);config.width=config.width&&!isNaN(config.width)?config.width:120;config.height=config.height&&!isNaN(config.height)?config.height:120;var config_cp=JSON.parse(JSON.stringify(config));canvas.width=config.width;canvas.height=config.height;canvas.style.cursor='crosshair';ctx.fillStyle='#FFF';ctx.fillRect(0,0,config.width,config.height);var gradient=ctx.createLinearGradient(0,0,config.width,0);gradient.addColorStop(0,"rgb(255,   0,   0)");gradient.addColorStop(0.15,"rgb(255,   0, 255)");gradient.addColorStop(0.33,"rgb(0,     0, 255)");gradient.addColorStop(0.49,"rgb(0,   255, 255)");gradient.addColorStop(0.67,"rgb(0,   255,   0)");gradient.addColorStop(0.84,"rgb(255, 255,   0)");gradient.addColorStop(1,"rgb(255,   0,   0)");ctx.fillStyle=gradient;ctx.fillRect(0,0,config.width,config.height);gradient=ctx.createLinearGradient(0,0,0,config.height);gradient.addColorStop(0,"rgba(255, 255, 255, 1)");gradient.addColorStop(0.5,"rgba(255, 255, 255, 0)");gradient.addColorStop(0.5,"rgba(0,     0,   0, 0)");gradient.addColorStop(1,"rgba(0,     0,   0, 1)");ctx.fillStyle=gradient;ctx.fillRect(0,0,config.width,config.height);picker_cntrl.appendChild(canvas);var dragstart=null;function onchange(mousep){if(mousep){var pxl=ctx.getImageData(mousep.x,mousep.y,1,1).data;value='rgb('+pxl[0]+','+pxl[1]+','+pxl[2]+')';}
canvas.setAttribute('data-value',value);if(typeof(_this.onchange)=='function'){_this.onchange(value,config_cp);}}
function getMousePos(evt){var rect=canvas.getBoundingClientRect();if(evt.type=='touchend')return mouseCoords;if(evt.touches){mouseCoords.x=evt.touches[0].clientX-rect.left;mouseCoords.y=evt.touches[0].clientY-rect.top;}else{mouseCoords.x=evt.clientX-rect.left;mouseCoords.y=evt.clientY-rect.top;}
return mouseCoords;}
function _handleColorDrag(evt){getMousePos(evt);switch(evt.type){case'mousedown':case'touchstart':case'pointerdown':dragstart={x:mouseCoords.x,y:mouseCoords.y};onchange(dragstart);break;case'mousemove':case'touchmove':case'pointermove':if(dragstart){dragstart.x=mouseCoords.x;dragstart.y=mouseCoords.y;onchange(dragstart);}
break;case'mouseup':case'touchend':case'pointerup':dragstart=null;break;}
if(typeof(evt.preventDefault)=='function'){evt.stopPropagation();evt.preventDefault();}else{evt.returnValue=false;};return false;}
var mob_evtnts=wp_mobile?['pointerdown','pointermove','pointerup']:['touchstart','touchmove','touchend'];var events=mobile?mob_evtnts:['mousedown','mousemove','mouseup'];for(var i in events){if(document.addEventListener){canvas.addEventListener(events[i],_handleColorDrag,false);}else if(document.attachEvent){canvas.attachEvent("on"+events[i],_handleColorDrag);}}
this.value=function(val){if(typeof(val)==='string'&&val.length){val=FLSUtil.normalizeCssColor(val);value=val.css;}
return value;};this.control=function(){return picker_cntrl;};};FloatingWidget.prototype.createCheckbox=function(config){var chck_cntrl=document.createElement('label');var value=config.default_value?true:false;var _this=this;var config_cp=JSON.parse(JSON.stringify(config));if(config.clabel){var chck_cntrl_lbl=document.createElement('span');chck_cntrl_lbl.innerHTML=config.clabel;chck_cntrl.appendChild(chck_cntrl_lbl);}
var control=document.createElement('input');control.type='checkbox';control.name=config.cname;control.checked=value;control.setAttribute('data-name',config.cname);control.setAttribute('data-value',value);chck_cntrl.appendChild(control);function onchange(){value=control.checked;control.setAttribute('data-value',value);if(typeof(_this.onchange)=='function'){_this.onchange(value,config_cp);}}
var events=['change'];for(var i in events){if(document.addEventListener){control.addEventListener(events[i],onchange,false);}else if(document.attachEvent){control.attachEvent("on"+events[i],onchange);}}
this.value=function(val){if(typeof(val)==='boolean'){value=val;control.checked=value;}
return control.checked;};this.control=function(){return chck_cntrl;};};var VettingToolWidget=function(editor,on_objects,container){this.show=function(){console.log('please override the "show" method');};this.hide=function(){console.log('please override the "hide" method');};this.update=function(){console.log('please override the "update" method');};this.validObject=function(obj){if(on_objects instanceof Array){for(var i=0;i<on_objects.length;i++){if(obj instanceof on_objects[i]){return true;}}
return false;}
return(obj instanceof FLSEditorCore.CObject);};};var DropShadowEditWidget=function(editor,on_objects,container){if(!editor)return false;var cur_obj=null;var cobj_shdw={color:'rgb(0,0,0)',offset:{x:0,y:0},blur:0,opacity:1};VettingToolWidget.apply(this,arguments);var wId='FLS-HTML5-Editor-DropShadow-Widget';var mobile=editor.mobile();var wp_mobile=editor.wp_mobile();var wgt=new FloatingWidget('Edit Drop-Shadow',container);var shadow_controls={shadow_color:{title:'color',type:'colorpicker',default_value:cobj_shdw.color},shadow_blur_radius:{title:'blur radius',type:'slider',min:0,max:10,default_value:cobj_shdw.blur,unit:'px'},shadow_opacity:{title:'shadow opacity',type:'slider',min:0,max:100,default_value:cobj_shdw.opacity,unit:'%'},shadow_x_offset:{title:'horizontal offset',type:'slider',min:-10,max:10,default_value:cobj_shdw.offset.x,unit:'px'},shadow_y_offset:{title:'vertical offset',type:'slider',min:-10,max:10,default_value:cobj_shdw.offset.y,unit:'px'},use_shadow:{title:'shadow active',type:'checkbox',default_value:0}};var $wgt=wgt.getWidget();$wgt.attr('id',wId);var w_width=$wgt.width();var content=jQuery(document.createElement('div'));for(var i in shadow_controls){var cntrl=shadow_controls[i];var $cntrl=null;switch(cntrl.type){case'colorpicker':var pckr=new wgt.createColorPicker({cname:i,width:w_width-12,height:80,clabel:cntrl.title});pckr.onchange=controlsCallback;$cntrl=pckr.control();cntrl.wdg_ctrl=pckr;break;case'slider':var sldr=new wgt.createSliderControl({cname:i,min:cntrl.min,max:cntrl.max,width:w_width-12,clabel:cntrl.title,unit:cntrl.unit,default_value:cntrl.default_value});sldr.onchange=controlsCallback;cntrl.wdg_ctrl=sldr;$cntrl=sldr.control();break;case'checkbox':var chck=new wgt.createCheckbox({cname:i,clabel:cntrl.title,default_value:cntrl.default_value});chck.onchange=controlsCallback;cntrl.wdg_ctrl=chck;$cntrl=chck.control();break;}
if($cntrl!==null){content.append($cntrl);}}
wgt.setContent(content);setTimeout(function(){wgt.hide();},100);function controlsCallback(value,cfg){if(cur_obj){switch(cfg.cname){case'use_shadow':cur_obj.use_shadow(value);break;case'shadow_x_offset':cobj_shdw.offset.x=value;break;case'shadow_y_offset':cobj_shdw.offset.y=value;break;case"shadow_blur_radius":cobj_shdw.blur=value;break;case"shadow_opacity":cobj_shdw.opacity=value/100;break;case"shadow_color":cobj_shdw.color=value;break;default:console.log(arguments);}
cur_obj.setDropShadow(cobj_shdw);cur_obj.use_shadow(shadow_controls.use_shadow.wdg_ctrl.value());}}
this.show=wgt.show;this.hide=wgt.hide;this.update=function(){wgt.hide();cur_obj=null;if(editor instanceof FLSEditorCore){var cobj=editor.getCurrentObject();if(this.validObject(cobj)){wgt.show();cur_obj=cobj;var obj_shadow=cobj.getDropShadow();shadow_controls.use_shadow.wdg_ctrl.value(cobj.use_shadow());if(obj_shadow){var clr=cobj_shdw.color;if(obj_shadow.color){clr=FLSUtil.normalizeCssColor(obj_shadow.color);clr='rgb('+FLSUtil.hexdec2rgb(clr.uint).join(',')+')';}
cobj_shdw.color=clr;cobj_shdw.opacity=obj_shadow.opacity?obj_shadow.opacity:1;cobj_shdw.offset.x=obj_shadow.offset_x?obj_shadow.offset_x:0;cobj_shdw.offset.y=obj_shadow.offset_y?obj_shadow.offset_y:0;cobj_shdw.blur=obj_shadow.blur?obj_shadow.blur:0;}
for(var i in cobj_shdw){switch(i){case'color':shadow_controls.shadow_color.wdg_ctrl.value(cobj_shdw.color);break;case'opacity':shadow_controls.shadow_opacity.wdg_ctrl.value(parseInt(cobj_shdw.opacity*100));break;case'offset':shadow_controls.shadow_x_offset.wdg_ctrl.value(cobj_shdw.offset.x);shadow_controls.shadow_y_offset.wdg_ctrl.value(cobj_shdw.offset.y);break;case'blur':shadow_controls.shadow_blur_radius.wdg_ctrl.value(cobj_shdw.blur);break;}}}}};};DropShadowEditWidget.prototype=new VettingToolWidget;var FontStyleEditWidget=function(editor,on_objects,container,extra,fontPathObj){if(!editor)return false;var cur_obj=null;VettingToolWidget.apply(this,arguments);var wId='FLS-HTML5-Editor-FontStyle-Widget';var _this=this;var mobile=editor.mobile();var wp_mobile=editor.wp_mobile();var cntnr=jQuery(container);var font_style_controls={bold:{icon:'B'},italic:{icon:'I'}};var content=jQuery(document.createElement('div'));var btn_tpl='<span class="flt-wdgt-sqbtn disabled" data-value="{FNT_STYLE}">{ICON}</span>';var mob_evtnts=wp_mobile?['pointerdown']:['touchstart'];var events=mobile?mob_evtnts:['mousedown'];for(var i in font_style_controls){var cntrl=font_style_controls[i];var $cntrl=jQuery(btn_tpl.replace(/{FNT_STYLE}/,i).replace(/{ICON}/,cntrl.icon));switch(i){case'bold':$cntrl.css({'font-weight':'bold','font-style':'normal'});break;case'italic':$cntrl.css({'font-weight':'normal','font-style':'italic'});break;}
font_style_controls[i]['cntrl']=$cntrl;for(var i in events){if(document.addEventListener){$cntrl.get(0).addEventListener(events[i],controlsCallback,false);}else if(document.attachEvent){$cntrl.get(0).attachEvent("on"+events[i],controlsCallback);}}
content.append($cntrl);}
cntnr.empty().append(content);var updateTimer=null;var measurements={};function controlsCallback(evt){var me=jQuery(this);var action=me.attr('data-value');var set=false;if(cur_obj&&_this.validObject(cur_obj)){var ff=cur_obj.getFontFamily();var fontinfo=extra.fonts[ff];var old_w=cur_obj.getSize().width;switch(action){case'bold':set=!cur_obj.bold()&&(fontinfo.bold_src.length>0);font_style_controls['bold']['cntrl'].toggleClass('active',cur_obj.bold(set));break;case'italic':set=!cur_obj.italic()&&(fontinfo.italic_src.length>0);font_style_controls['italic']['cntrl'].toggleClass('active',cur_obj.italic(set));break;default:console.log(arguments);}
if((typeof(_this.on_control_callback)=='function')&&(['bold','italic'].indexOf(action)>-1)){_this.on_control_callback(cur_obj,old_w);}
clearTimeout(updateTimer);var mkey=cur_obj.bold()?1:0;mkey|=cur_obj.italic()?2:0;var mask=mkey==3?4:mkey;if(fontPathObj){fontPathObj.initFontProd(cur_obj,extra.fonts[cur_obj.getFontFamily()],function(){});}
if(measurements[ff]&mask){measurements[ff]^=mask;updateTimer=setTimeout(function(){cur_obj.updateMeasurements();},1000);}}}
this.update=function(){cur_obj=null;if(editor instanceof FLSEditorCore){var cobj=editor.getCurrentObject();if(this.validObject(cobj)){cur_obj=cobj;var ff=cur_obj.getFontFamily();var fontinfo=extra.fonts[ff];font_style_controls['bold']['cntrl'].toggleClass('active',cur_obj.bold());font_style_controls['italic']['cntrl'].toggleClass('active',cur_obj.italic());if(typeof(measurements[ff])=='undefined'){measurements[ff]=0;if(fontinfo){measurements[ff]|=(fontinfo.bold_src.length==0)?0:1;measurements[ff]|=(fontinfo.italic_src.length==0)?0:2;measurements[ff]|=(fontinfo.bolditalic_src.length==0)?0:4;}}
if(fontinfo){font_style_controls['bold']['cntrl'].toggleClass('disabled',(fontinfo.bold_src.length==0));font_style_controls['italic']['cntrl'].toggleClass('disabled',(fontinfo.italic_src.length==0));}}else{font_style_controls['bold']['cntrl'].addClass('disabled');font_style_controls['italic']['cntrl'].addClass('disabled');}}};};FontStyleEditWidget.prototype=new VettingToolWidget;var FLSProductShowcaseBlock=function(editor,showcfg){var twidth=300;var theight=200;var thumbnails=[];var refreshing=false;if(showcfg&&(editor instanceof FLSEditorCore)){if((showcfg.items instanceof Array)&&showcfg.items.length){showcfg.twidth=parseInt(showcfg.twidth,10);showcfg.theight=parseInt(showcfg.theight,10);if(!isNaN(showcfg.twidth)&&!isNaN(showcfg.theight)){twidth=showcfg.twidth;theight=showcfg.theight;}}else{return false;}}else{return false;}
var block=jQuery('<div class="fls-product-showcase-container"></div>;');var addclasselement;if(showcfg.showcaseAfterElementID||showcfg.showcaseContainerID){var element_found=false;var afterelement,parentelement;if(showcfg.showcaseAfterElementID){afterelement=document.getElementById(showcfg.showcaseAfterElementID);addclasselement=afterelement;}
if(!afterelement&&showcfg.showcaseContainerID){parentelement=document.getElementById(showcfg.showcaseContainerID);addclasselement=parentelement;}
if(!afterelement&&!parentelement){afterelement=editor.getCanvasWrapper().parentNode;}
if(afterelement){block.insertAfter(afterelement);}else{jQuery(parentelement).append(block);addclasselement=parentelement;}}else{block.insertAfter(editor.getCanvasWrapper().parentNode);}
var lgroup=new FLSEditorCore.CLogoObjectGroup();lgroup.editor(editor);for(var i_idx=0;i_idx<showcfg.items.length;i_idx++){if(showcfg.items[i_idx].img&&showcfg.items[i_idx].layout){var thmbnail=jQuery('<div class="editor-showcase-thumb" style="display:inline-block;"><canvas class="editor-showcase-thumb-canvas" width="'+twidth+'" height="'+theight+'"></canvas></div>');var elements=[];var img=new FLSEditorCore.CImage(showcfg.items[i_idx].img);img.editor(editor);img.targetdpi(75)
img.onload=function(me){var imgtag=me.getImageTag();me.setSize(imgtag.width,imgtag.height);var dx=Math.ceil((twidth-imgtag.width)/2);var dy=Math.ceil((theight-imgtag.height)/2);me.tctx.setTransform(1,0,0,1,dx,dy);delete me.tctx;_refreshThumbs();}
elements.push(img);elements.push(lgroup);var tctx=thmbnail.find('canvas').get(0).getContext('2d');block.append(thmbnail);var tlayout=showcfg.items[i_idx].layout;thumbnails.push({ctx:tctx,elements:elements,layout:tlayout});img.tctx=tctx}}
function _refreshThumbs(){if(refreshing===false){refreshing=true;setTimeout(function(){var logoElements;var pgrp_mtrx;switch(editor.product){case'product':var edobj=editor.getObjects().slice(0);for(var oidx=0;oidx<edobj.length;oidx++){if(edobj[oidx]instanceof FLSEditorCore.CLogoObjectGroup){logoElements=edobj[oidx].getElements().slice(0);}else if((edobj[oidx]instanceof FLSEditorCore.CDIFMLogoSVGImg)&&edobj[oidx].xlinktype&&(edobj[oidx].xlinktype=='difm_logo')){}else if((edobj[oidx]instanceof FLSEditorCore.CImage)&&edobj[oidx].xlinktype&&(edobj[oidx].xlinktype=='image_logo')){}}
break;default:var lgobj=editor.getObjects().slice(0);logoElements=[];for(var i=0;i<lgobj.length;i++){if(lgobj[i]instanceof FLSEditorCore.CPathGroup){var npg=new FLSEditorCore.CPathGroup();var mtrx=lgobj[i].getMatrix().slice(0);npg.editor(editor);npg.setMatrix(mtrx);var cpgp=lgobj[i].getPaths();for(var pi=0;pi<cpgp.length;pi++){npg.addPath(cpgp[pi]);}
var gsz=lgobj[i].getSize();var bbpos=lgobj[i].bboxpos();var tl={x:bbpos.x,y:bbpos.y};var tr={x:bbpos.x+gsz.width,y:bbpos.y};var br={x:bbpos.x+gsz.width,y:bbpos.y+gsz.height};var bl={x:bbpos.x,y:bbpos.y+gsz.height};FLSUtil.transformPoint(mtrx,tl,true);FLSUtil.transformPoint(mtrx,tr,true);FLSUtil.transformPoint(mtrx,br,true);FLSUtil.transformPoint(mtrx,bl,true);var min_x=Math.min(tl.x,tr.x,br.x,bl.x);var min_y=Math.min(tl.y,tr.y,br.y,bl.y);var max_x=Math.max(tl.x,tr.x,br.x,bl.x);var max_y=Math.max(tl.y,tr.y,br.y,bl.y);npg.setSize(max_x-min_x,max_y-min_y);npg.bboxpos(min_x,min_y);npg.bboxCalculated(true);logoElements.unshift(npg);}else if(lgobj[i]instanceof FLSEditorCore.CText){var textClass=(lgobj[i]instanceof FLSEditorCore.CPathText)?FLSEditorCore.CPathText:FLSEditorCore.CText;textClass=(lgobj[i]instanceof FLSEditorCore.CMultiLineText)?FLSEditorCore.CMultiLineText:textClass;var ctxt=new textClass();ctxt.setProperties(lgobj[i].getProperties());if((ctxt instanceof FLSEditorCore.CMultiLineText)&&lgobj[i].multistyle_on()){ctxt.multistyle_on(true);ctxt.multistyle_cfg(lgobj[i].multistyle_cfg());}
logoElements.push(ctxt);}
if(logoElements.length>3)break;}}
var lgobjs=lgroup.getElements();while(lgobjs.length){lgobjs.pop();}
if(logoElements&&logoElements.length){for(var nidx=0;nidx<logoElements.length;nidx++){lgroup.addElement(logoElements[nidx]);}}
lgroup.calculateBoundingBox();for(var tidx=0;tidx<thumbnails.length;tidx++){var elements=thumbnails[tidx].elements;thumbnails[tidx].ctx.save();thumbnails[tidx].ctx.setTransform(1,0,0,1,0,0);thumbnails[tidx].ctx.clearRect(0,0,twidth,theight);thumbnails[tidx].ctx.restore();for(var eidx=0;eidx<elements.length;eidx++){if(elements[eidx]instanceof FLSEditorCore.CLogoObjectGroup){if(thumbnails[tidx].layout&&thumbnails[tidx].layout.logo){elements[eidx].setMatrix([1,0,0,1,0,0]);var logoarea=thumbnails[tidx].layout.logo
var logosize=elements[eidx].getSize();var area_center={x:(logoarea.w/2)+logoarea.x,y:(logoarea.h/2)+logoarea.y};var logocenter=elements[eidx].center();var tx=area_center.x-logocenter.x;var ty=area_center.y-logocenter.y;var scale=1;scale=Math.min(logoarea.w/logosize.width,logoarea.h/logosize.height);elements[eidx].translate(tx,ty);elements[eidx].use_pivot(true);elements[eidx].scaleUniform(scale);elements[eidx].use_pivot(false);}}else if((elements[eidx]instanceof FLSEditorCore.CImage)||(elements[eidx]instanceof FLSEditorCore.CDIFMLogoSVGImg)){}
elements[eidx].render(thumbnails[tidx].ctx);}}
refreshing=false;},0);}};jQuery(editor.getCanvasWrapper().parentNode).addClass('editor-has-product-showcase-block').on('mouseup touchend pointerup',_refreshThumbs);if(addclasselement){jQuery(addclasselement).addClass('editor-product-showcase-block-inserted');}
this.refreshThumbs=_refreshThumbs;this.editor=function(_editor){if(_editor instanceof FLSEditorCore){editor=_editor;}
return editor;};this.show=function(){block.show();};this.hide=function(){block.hide();};};var FLSArcTextButtonsBar=function(editor,buttoncallback,show_path_edit_btn){var keep_round=false;var _toolbar=jQuery(document.createElement('div'));show_path_edit_btn=typeof(show_path_edit_btn)=='boolean'?show_path_edit_btn:false
if(typeof(buttoncallback)!='function'){buttoncallback=function(type,keep_round){console.log(arguments);}}
function _handleButtons(evt){var me=jQuery(this);var action=me.attr('data-action');switch(action){case'toggle_keep_round':keep_round=!keep_round;jQuery('[data-action=toggle_keep_round]',_toolbar).toggleClass('switched-on',keep_round);break;default:buttoncallback(action,keep_round);}}
jQuery('style#ArcTextToolbar-CSS').remove();var toolbar_css='<style type="text/css" id="ArcTextToolbar-CSS">\n'+'.fls-arc-text-toolbar{position:absolute; top:10px; left:10px; border-radius:25px; width:49px; background-color:transparent;z-index:70;box-shadow: 0 0 3px rgba(0,0,0,0.5);}\n'+'.fls-arc-text-toolbar .action-button{position:relative; width: 39px; height:39px; background-color:#FFF; margin: 4px; border-radius:25px; '+'box-shadow:0 0 2px rgba(0,0,0,0.5); display:block;cursor:pointer;border:1px solid #CCC;\n'+'background-image:url("data:image/png;base64,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");\n'+'background-repeat:no-repeat; background-position: center 0;}\n'+'.fls-arc-text-toolbar .action-button:hover{background-color:#4D9BCE;}\n'+'.fls-arc-text-toolbar .action-button.switched-on{background-color:#e3bc34;}\n'+'.fls-arc-text-toolbar .action-button.around_top{background-position:center 1px;}\n'+'.fls-arc-text-toolbar .action-button.around_bottom{background-position:center -37px;}\n'+'.fls-arc-text-toolbar .action-button.arc_bottom{background-position:center -75px;}\n'+'.fls-arc-text-toolbar .action-button.arc_top{background-position:center -122px;}\n'+'.fls-arc-text-toolbar .action-button.line_path{background-position:center -310px;}\n'+'.fls-arc-text-toolbar .action-button.toggle_path_edit{background-position:center -161px;}\n'+'.fls-arc-text-toolbar .action-button.toggle_use_path{background-position:center -198px;}\n'+'.fls-arc-text-toolbar .action-button.toggle_keep_round{background-position:center -232px;}\n'+'.fls-arc-text-toolbar .action-button.switch_vertical_shift{background-position:center -268px;}\n'+'\n';toolbar_css+='</style>\n';jQuery(toolbar_css).appendTo('head');_toolbar.addClass('fls-arc-text-toolbar');var btns=['around_top','around_bottom','arc_top','arc_bottom','line_path','toggle_use_path','toggle_keep_round','switch_vertical_shift'];if(show_path_edit_btn){btns.push('toggle_path_edit');}
for(var i=0;i<btns.length;i++){var btn=jQuery(document.createElement('span'));btn.addClass('action-button '+btns[i]);btn.attr('data-action',btns[i]);btn.attr('title',btns[i].replace(/_/g,' '));_toolbar.append(btn);}
var events=FLSUtil.mobile()?(FLSUtil.wp_mobile()?['pointerdown']:['touchstart']):['mousedown'];var elements=jQuery('.action-button',_toolbar);for(var i=0;i<elements.length;i++){var where=elements[i];for(var j in events){if(document.addEventListener){where.addEventListener(events[j],_handleButtons,false);}else if(document.attachEvent){where.attachEvent("on"+events[j],_handleButtons);}}}
return _toolbar;}
var FLSMUltilineButtonsBar=function(editor,buttoncallback){var _toolbar=jQuery(document.createElement('div'));if(typeof(buttoncallback)!='function'){buttoncallback=function(type){console.log(arguments);}}
function _handleButtons(evt){var me=jQuery(this);var action=me.attr('data-action');switch(action){default:buttoncallback(action);}}
jQuery('style#MultilineToolbar-CSS').remove();var toolbar_css='<style type="text/css" id="MultilineToolbar-CSS">\n'+'.fls-multi-line-toolbar{position:absolute; top:10px; left:10px; border-radius:25px; width:49px; background-color:transparent;z-index:70;box-shadow: 0 0 3px rgba(0,0,0,0.5);}\n'+'.fls-multi-line-toolbar .action-button{position:relative; width: 39px; height:39px; background-color:#FFF; margin: 4px; border-radius:25px; '+'box-shadow:0 0 2px rgba(0,0,0,0.5); display:block;cursor:pointer;border:1px solid #CCC;\n'+'background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAABOCAYAAABFccTjAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAJ/wAACf8BB8w+RgAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzI'+'ENTNXG14zYAAAAWdEVYdENyZWF0aW9uIFRpbWUAMDUvMDgvMTcOLkTKAAAC/UlEQVRoge2ZP2hUMRzHP1d7RbA66KCg4hWtiC0UHaToUKyiIAg61M1RRKiuoouDFp0EETcR1EkQ/0wqIi7qIgdFhyJYi5yliqW0KGq1XhySK/dy7/deYq93b8'+'gXQrgkl9/nfi8vv+R3OaUUWVBLswEqCiC2AoitAGIrMyAopWoK8AFQHuUzkF+I3VZh3F1gm8e874A5H5BUskXa8juBIaq8VmOzASAbgRn0I3wG+ik0GqQATBFdT4+AJY0GKQJ/gZcG4pWpjzUaZLcpFwzAFuAosNb1rdmAXmCuGgNGY9qfm3q'+'PqcvA7bgJJJA3wAoPkN9AO/BH6E91swRyBO0VV00kQAA8BLqAj9KAXNyayOVyHgz/J9tuZmJNALGVGRDprTkIbPWYZxQdsSX1AmeBAWA2doSws1aClGuZJfk8ct6M2yzZlTzSBaxOmNjWJMn7SOp+IIF8MmWh2ocOehW1ACeBe8B4ZGSDou8L'+'mhx9C2TkPAL6hDZtIB7TpBNaRZ3AGRLOrFLQuwz0eRgqAsdxCPfVIDUNWbjXxHqkGcpMrAkgtgKIrQBiK4DYCiC2AoitAGIrgNgKILYyAyKd4sfwO8V/BZYmmNkFlIB1kl3pEn4L6Pb4PSXgV0J/t4EoIFzuJZBzHhB1kQSyEujwmGcGeB/TP'+'ohOzoyYz+3AHeAG8CQyUlgjb/FbI2VgUwzITdM/Yeovph50vfv2ofNerpoGrhNNygC0odMQ/VVtV4FTrnffeioPPEV74opkV/LIdnRew1Xj6GyQpFagB501mAeJ2BRAvgPLPEDKwHLgh+sXbLvSW9MLrPEAmUqBWA8cAq6hoePJFnmNFNDpT4'+'XOJrbE2ZUezX7gsIexSfTfqT+t9g7gNbCqqu0+MKCUir5hgkcqfwb67CM9MYDDpq9oxg0jpDclj+TRu6Cr5oBvMe0HTF8/cBqd398LPFBKlSIjG5RVvIT2xPzu6xp9LwI7PQyNACeQs4rpv65OWcW088gOdLBrk+yGrKKtAGIrgNj6B3MBB6j'+'jN0I5AAAAAElFTkSuQmCC");\n'+'background-repeat:no-repeat; background-position: center 0;}\n'+'.fls-multi-line-toolbar .action-button:hover{background-color:#4D9BCE;}\n'+'.fls-multi-line-toolbar .action-button.switched-on{background-color:#e3bc34;}\n'+'.fls-multi-line-toolbar .action-button.increase_distance{background-position:center -2px;}\n'+'.fls-multi-line-toolbar .action-button.decrease_distance{background-position:center -44px;}\n'+'\n';toolbar_css+='</style>\n';jQuery(toolbar_css).appendTo('head');_toolbar.addClass('fls-multi-line-toolbar');var btns=['increase_distance','decrease_distance'];for(var i=0;i<btns.length;i++){var btn=jQuery(document.createElement('span'));btn.addClass('action-button '+btns[i]);btn.attr('data-action',btns[i]);btn.attr('title',btns[i].replace(/_/g,' '));_toolbar.append(btn);}
var events=FLSUtil.mobile()?(FLSUtil.wp_mobile()?['pointerdown']:['touchstart']):['mousedown'];var elements=jQuery('.action-button',_toolbar);for(var i=0;i<elements.length;i++){var where=elements[i];for(var j in events){if(document.addEventListener){where.addEventListener(events[j],_handleButtons,false);}else if(document.attachEvent){where.attachEvent("on"+events[j],_handleButtons);}}}
return _toolbar;}
var FLSLaserEngraveButtonsBar=function(editor,buttoncallback){var _toolbar=jQuery(document.createElement('div'));if(typeof(buttoncallback)!='function'){buttoncallback=function(type){console.log(arguments);}}
function _handleButtons(evt){var me=jQuery(this);var action=me.attr('data-action');switch(action){default:buttoncallback(action);}}
jQuery('style#ArcTextToolbar-CSS').remove();var toolbar_css='<style type="text/css" id="ArcTextToolbar-CSS">\n'+'.fls-laser-engrave-toolbar{position:absolute; top:10px; left:10px; border-radius:25px; width:49px; background-color:transparent;z-index:70;box-shadow: 0 0 3px rgba(0,0,0,0.5);}\n'+'.fls-laser-engrave-toolbar .action-button{position:relative; width: 39px; height:39px; background-color:#FFF; margin: 4px; border-radius:25px; '+'box-shadow:0 0 2px rgba(0,0,0,0.5); display:block;cursor:pointer;border:1px solid #CCC;\n'+'background-image:url("data:image/png;base64,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");\n'+'background-repeat:no-repeat; background-position: center 0;}\n'+'.fls-laser-engrave-toolbar .action-button:hover{background-color:#4D9BCE;}\n'+'.fls-laser-engrave-toolbar .action-button.switched-on{background-color:#e3bc34;}\n'+'.fls-laser-engrave-toolbar .action-button.stroke_text{background-position:center 1px;}\n'+'.fls-laser-engrave-toolbar .action-button.stroke_logo{background-position:center -45px;}\n'+'\n';toolbar_css+='</style>\n';jQuery(toolbar_css).appendTo('head');_toolbar.addClass('fls-laser-engrave-toolbar');var btns=['stroke_text','stroke_logo'];for(var i=0;i<btns.length;i++){var btn=jQuery(document.createElement('span'));btn.addClass('action-button '+btns[i]);btn.attr('data-action',btns[i]);btn.attr('title',btns[i].replace(/_/g,' '));_toolbar.append(btn);}
var events=FLSUtil.mobile()?(FLSUtil.wp_mobile()?['pointerdown']:['touchstart']):['mousedown'];var elements=jQuery('.action-button',_toolbar);for(var i=0;i<elements.length;i++){var where=elements[i];for(var j in events){if(document.addEventListener){where.addEventListener(events[j],_handleButtons,false);}else if(document.attachEvent){where.attachEvent("on"+events[j],_handleButtons);}}}
return _toolbar;}
var FLSSVGGradient=function(gradientDefNode){var dom_def;var $defn;if(gradientDefNode instanceof jQuery){$defn=gradientDefNode;dom_def=gradientDefNode[0];}else{dom_def=gradientDefNode;$defn=jQuery(gradientDefNode);}
var cnvsGradient=[];var cnvsContexts=[];var id;var gradientTypes=['linearGradient','radialGradient'];var gradientType='';var gradientParams=[];var gradientTransforms={};var gradienColorStops=[];var stop_tmp;if(gradientTypes.indexOf(dom_def.nodeName)>-1){gradientType=dom_def.nodeName;id=$defn.attr('id').trim();switch(gradientType){case'linearGradient':var x1=parseFloat($defn.attr('x1'),10);var y1=parseFloat($defn.attr('y1'),10);var x2=parseFloat($defn.attr('x2'),10);var y2=parseFloat($defn.attr('y2'),10);x1=!isNaN(x1)?x1:0.00;y1=!isNaN(y1)?y1:0.00;x2=!isNaN(x2)?x2:0.00;y2=!isNaN(y2)?y2:0.00;gradientParams.push(x1);gradientParams.push(y1);gradientParams.push(x2);gradientParams.push(y2);break;case'radialGradient':var cx=parseFloat($defn.attr('cx'),10);var cy=parseFloat($defn.attr('cy'),10);var r=parseFloat($defn.attr('r'),10);var fx=parseFloat($defn.attr('fx'),10);var fy=parseFloat($defn.attr('fy'),10);var fr=parseFloat($defn.attr('fr'),10);cx=!isNaN(cx)?cx:0.00;cy=!isNaN(cy)?cy:0.00;r=!isNaN(r)?r:0.00;fx=!isNaN(fx)?fx:cx;fy=!isNaN(fy)?fy:cy;fr=!isNaN(fr)?fr:0.00;gradientParams.push(fx);gradientParams.push(fy);gradientParams.push(fr);gradientParams.push(cx);gradientParams.push(cy);gradientParams.push(r);break;}
_setGardientColorStopDef(dom_def);}
var transform={};var transforms=$defn.attr('gradientTransform');if(transforms){transforms=transforms.trim().split(') ');if(transforms.length){for(var l=0;l<transforms.length;l++){var fn=transforms[l].split('(');if(fn.length==2){fn[1]=fn[1].replace(/\)/g,'').replace(/\s+/g,',').replace(/,+/g,',').split(',');transform[fn[0]]=[];if(fn[1].length){for(var fi=0;fi<fn[1].length;fi++){transform[fn[0]].push(parseFloat(fn[1][fi]));}}}}}}
var grad_matrix=[1,0,0,1,0,0];if((transforms instanceof Array)&&transforms.length){if(transform['matrix']){grad_matrix=transform['matrix'];}
if(transform['translate']){FLSUtil.tmatrixTranslate(grad_matrix,transform['translate'][0],transform['translate'][1]);}
switch(gradientType){case'linearGradient':var x1y1={x:gradientParams[0],y:gradientParams[1]};var x2y2={x:gradientParams[2],y:gradientParams[3]};FLSUtil.transformPoint(grad_matrix,x1y1,true);FLSUtil.transformPoint(grad_matrix,x2y2,true);gradientParams[0]=x1y1.x;gradientParams[1]=x1y1.y;gradientParams[2]=x2y2.x;gradientParams[3]=x2y2.y;break;case'radialGradient':var cxcy={x:gradientParams[3],y:gradientParams[4]};var fxfy={x:gradientParams[1],y:gradientParams[1]};FLSUtil.transformPoint(grad_matrix,cxcy,true);FLSUtil.transformPoint(grad_matrix,fxfy,true);gradientParams[0]=fxfy.x;gradientParams[1]=fxfy.y;gradientParams[3]=cxcy.x;gradientParams[4]=cxcy.y;break;}}
function _setGardientColorStopDef(_dom_def){var $color_stops=jQuery('stop',jQuery(_dom_def));if($color_stops.length){while(gradienColorStops.length){gradienColorStops.pop();}
$color_stops.each(function(index){var snode=jQuery(this);var styles={};styles.offset=parseFloat(snode.attr('offset'),10);var stop_color=snode.attr('stop-color');var stop_opacity=snode.attr('stop-opacity');if(stop_color){styles['stop-color']=stop_color;}
if(stop_opacity){styles['stop-opacity']=stop_opacity;}
var _styles=snode.attr('style');if(_styles){_styles=_styles.split(';');while(_styles.length){var style=_styles.shift();style=style.replace(/\s/g,'').split(':');switch(style[0]){case'stop-color':case'stop-opacity':styles[style[0]]=style[1];break;}}}
if(styles['stop-color']){var ncolor=FLSUtil.normalizeCssColor(styles['stop-color']);if(typeof(styles['stop-opacity'])!='undefined'){var _opcty=parseFloat(styles['stop-opacity'],10);if(_opcty>1){_opcty=_opcty/255;}
if(_opcty<1){ncolor.css=ncolor.css.replace(/rgb\(/g,'rgba(');ncolor.css=ncolor.css.replace(/\)/g,','+_opcty+')');}}
styles.cnvs_clr=ncolor.css;gradienColorStops.push(styles);}});}}
this.setGardientColorStopDef=function(_dom_def){_setGardientColorStopDef(_dom_def);};this.valid=function(){return gradienColorStops.length;};this.id=function(_id){if(typeof(_id)=='string'&&!id){id=_id.toString().trim();}
return id;};this.getCanvasGradient=function(ctx){var cnvsgrd;if(ctx instanceof CanvasRenderingContext2D){var grad_idx=cnvsContexts.indexOf(ctx);if(grad_idx==-1){switch(gradientType){case'linearGradient':cnvsgrd=ctx.createLinearGradient.apply(ctx,gradientParams);break;case'radialGradient':cnvsgrd=ctx.createRadialGradient.apply(ctx,gradientParams);break;}
for(var cs_idx=0;cs_idx<gradienColorStops.length;cs_idx++){cnvsgrd.addColorStop(gradienColorStops[cs_idx]['offset'],gradienColorStops[cs_idx]['cnvs_clr']);}
cnvsContexts.push(ctx);cnvsGradient.push(cnvsgrd);}else{cnvsgrd=cnvsGradient[grad_idx];}}
return cnvsgrd;};this.getGradDomNode=function(){return dom_def;}};FLSEditorCore.prototype.textObjToPath=function(s3FontPathBase){if(typeof(window.opentype)=='undefined'){throw'opentype library not loaded';}
var loadedFonts={};var triedfontsrc=[];this.initFont=function(font_family,fontinfo,callback){if(typeof(window.opentype)=='object'){var fnt_key_idx='ttf_src';if(!loadedFonts[font_family]){loadedFonts[font_family]={};}
if(typeof(loadedFonts[font_family][fnt_key_idx])=='undefined'){try{window.opentype.load(s3FontPathBase+'html5/'+fontinfo[fnt_key_idx]+'?rnd='+Math.round(Math.random()*100000),function(err,font){if(err){console.warn(err);loadedFonts[font_family][fnt_key_idx]=err;}else{loadedFonts[font_family][fnt_key_idx]=font;}
if(font){callback(true);}else{callback(false,err);}});}catch(e){callback(false,e);}}else{callback(loadedFonts[font_family][fnt_key_idx]instanceof opentype.Font);}}else{callback(false,'opentype.js not loaded');}};this.initFontProd=function(txtobj,fontinfo,callback){if(typeof(window.opentype)=='object'){var tp=txtobj.getProperties();var font_family=tp.font_family
var fnt_key_idx=[];if(tp.bold){fnt_key_idx.push('bold');}
if(tp.italic){fnt_key_idx.push('italic');}
fnt_key_idx=fnt_key_idx.join('');fnt_key_idx=fnt_key_idx.length?fnt_key_idx+'_src':'ttf_src';if(!loadedFonts[font_family]){loadedFonts[font_family]={};}
var tried=font_family+fnt_key_idx;if((typeof(loadedFonts[font_family][fnt_key_idx])=='undefined')&&(triedfontsrc.indexOf(tried)==-1)){try{triedfontsrc.push(tried)
window.opentype.load(s3FontPathBase+'html5/'+fontinfo[fnt_key_idx]+'?rnd='+Math.round(Math.random()*100000),function(err,font){if(err){console.warn(err);loadedFonts[font_family][fnt_key_idx]=err;}else{loadedFonts[font_family][fnt_key_idx]=font;}
if(font){callback(true);}else{callback(false,err);}});}catch(e){callback(false,e);}}else{callback(loadedFonts[font_family][fnt_key_idx]instanceof opentype.Font);}}else{callback(false,'opentype.js not loaded');}};this.get=function(txtobj,fontinfo,callback,ccallback){var ldfont=null;var tp=null;function _handleGetMultiline(){var lines_info=txtobj.getTextLines();var pth_str=[];while(lines_info.length){var tmp_ln_inf=lines_info.shift();var sub_pth_str=ldfont.getPath(tmp_ln_inf.text,0,0,tmp_ln_inf.fontsize).toPathData(6);if(tmp_ln_inf.dx||tmp_ln_inf.dy){var cmds=SVGPath2Cnvs.parse(sub_pth_str);SVGPath2Cnvs.applyMatrix(cmds,[1,0,0,1,tmp_ln_inf.dx,tmp_ln_inf.dy]);sub_pth_str=SVGPath2Cnvs.commandsDataStr(cmds);}
pth_str.push(sub_pth_str);}
callback(txtobj,pth_str.join(' '),ccallback);}
function _handleGetPathText(){var lines_info=txtobj.get_letters();var pth_str=[];var txt_dy=txtobj.txt_dy();while(lines_info.length){var tmp_ln_inf=lines_info.shift();var sub_pth_str=ldfont.getPath(tmp_ln_inf[1],0,0,tp.fontsize).toPathData(6);var cmds=SVGPath2Cnvs.parse(sub_pth_str);var mtrx=tmp_ln_inf[0].slice(0);if(txt_dy){FLSUtil.tmatrixTranslate(mtrx,0,txt_dy);}
SVGPath2Cnvs.applyMatrix(cmds,mtrx);sub_pth_str=SVGPath2Cnvs.commandsDataStr(cmds);pth_str.push(sub_pth_str);}
callback(txtobj,pth_str.join(' '),ccallback);}
if((typeof(window.opentype)=='object')&&(txtobj instanceof FLSEditorCore.CText)&&(typeof(callback)=='function')){tp=txtobj.getProperties();var fnt_key_idx=[];if(tp.bold){fnt_key_idx.push('bold');}
if(tp.italic){fnt_key_idx.push('italic');}
fnt_key_idx=fnt_key_idx.join('');fnt_key_idx=fnt_key_idx.length?fnt_key_idx+'_src':'ttf_src';if(!loadedFonts[tp.font_family]){loadedFonts[tp.font_family]={};}
var is_multiline=txtobj instanceof FLSEditorCore.CMultiLineText;var is_pathtext=(txtobj instanceof FLSEditorCore.CPathText)&&txtobj.has_path();if(typeof(loadedFonts[tp.font_family][fnt_key_idx])=='undefined'){window.opentype.load(s3FontPathBase+'html5/'+fontinfo[fnt_key_idx]+'?rnd='+Math.round(Math.random()*100000),function(err,font){if(err){console.warn('could not load font');loadedFonts[tp.font_family][fnt_key_idx]=err;}else{loadedFonts[tp.font_family][fnt_key_idx]=ldfont=font;}
if(ldfont){if(is_multiline){_handleGetMultiline();}else if(is_pathtext){_handleGetPathText();}else{callback(txtobj,ldfont.getPath(tp.text,0,0,tp.fontsize).toPathData(6),ccallback);}}});}else{ldfont=loadedFonts[tp.font_family][fnt_key_idx]
if(is_multiline){_handleGetMultiline();}else if(is_pathtext){_handleGetPathText();}else{callback(txtobj,ldfont.getPath(tp.text,0,0,tp.fontsize).toPathData(6),ccallback);}}}else{callback(txtobj,false,ccallback);}};this.get_direct=function(tp,fontinfo,multiline){if((typeof(window.opentype)=='object')&&tp.text&&tp.font_family&&tp.fontsize){var fnt_key_idx=[];if(tp.bold){fnt_key_idx.push('bold');}
if(tp.italic){fnt_key_idx.push('italic');}
fnt_key_idx=fnt_key_idx.join('');fnt_key_idx=fnt_key_idx.length?fnt_key_idx+'_src':'ttf_src';if(typeof(loadedFonts[tp.font_family][fnt_key_idx])!='undefined'){var ldfont=loadedFonts[tp.font_family][fnt_key_idx]
if((multiline instanceof Array)&&multiline.length){var pth_str=[];while(multiline.length){var tmp_ln_inf=multiline.shift();var sub_pth_str=ldfont.getPath(tmp_ln_inf.text,0,0,tmp_ln_inf.fontsize).toPathData(6);if(tmp_ln_inf.dx||tmp_ln_inf.dy){var cmds=SVGPath2Cnvs.parse(sub_pth_str);SVGPath2Cnvs.applyMatrix(cmds,[1,0,0,1,tmp_ln_inf.dx,tmp_ln_inf.dy]);sub_pth_str=SVGPath2Cnvs.commandsDataStr(cmds);}
pth_str.push(sub_pth_str);}
return pth_str.join(' ');}
return ldfont.getPath(tp.text,0,0,tp.fontsize).toPathData(6);}}
return false;};this.loadFont=function(font_family,fontinfo){if(typeof(window.opentype)=='object'){var srcs=['ttf_src'];if(fontinfo['italic_src']){srcs.push('italic_src');}
if(fontinfo['bold_src']){srcs.push('bold_src');}
if(fontinfo['bolditalic_src']){srcs.push('bolditalic_src');}
var fnt_key_idx='ttf_src';if(!loadedFonts[font_family]){loadedFonts[font_family]={};}
function _do_font_load(key_idx){window.opentype.load(s3FontPathBase+'html5/'+fontinfo[fnt_key_idx]+'?rnd='+Math.round(Math.random()*100000),function(err,font){if(err){console.warn(err);loadedFonts[font_family][key_idx]=err;}else{loadedFonts[font_family][key_idx]=font;}});}
while(srcs.length){fnt_key_idx=srcs.shift();if(typeof(loadedFonts[font_family][fnt_key_idx])=='undefined'){try{_do_font_load(fnt_key_idx);}catch(e){console.warn(e);}}else{}}}else{console.log('opentype.js not loaded');}};this.charUnSupported=function(char_arr,font_family,bold,italic){var unsupported=[];if(typeof(window.opentype)=='object'){var fnt_key_idx=[];if(bold==true){fnt_key_idx.push('bold');}
if(italic==true){fnt_key_idx.push('italic');}
fnt_key_idx=fnt_key_idx.join('');fnt_key_idx=fnt_key_idx.length?fnt_key_idx+'_src':'ttf_src';if(loadedFonts[font_family]&&(loadedFonts[font_family][fnt_key_idx]instanceof opentype.Font)){var ldfont=loadedFonts[font_family][fnt_key_idx];if(typeof(char_arr)=='string'){char_arr=char_arr.replace(/\s/g,'').split('');}
if(char_arr instanceof Array){for(var ch_idx=0;ch_idx<char_arr.length;ch_idx++){var glph=ldfont.charToGlyph(char_arr[ch_idx]);if(!glph.unicode||(glph.unicodes.length>1)){unsupported.push(char_arr[ch_idx]);}}}}}
return unsupported;};};var FLSColorPicker=function(curcolor,container,size_overrides,mobile){var scr_wdth=Math.min(window.screen.width,window.screen.height);var sliderHeight=Math.floor(scr_wdth*0.36762);sliderHeight=sliderHeight>150?150:sliderHeight;var sliderMargin=Math.ceil(scr_wdth*0.02181);sliderMargin=sliderMargin>10?10:sliderMargin;var sliderWidth=10;var colorDragTile,colorGragKnob;var colorSlideBar,colorSlideKnob;var dragKnobRadius=3;var sampleColorNew,sampleColorStart;var sampleColorNewTxt,sampleColorStartTxt;var _this=this;var changed=false;mobile=typeof(mobile)==='boolean'?mobile:false;if(size_overrides&&size_overrides.height){sliderHeight=size_overrides.height;}
if(size_overrides&&size_overrides.margin){sliderMargin=size_overrides.margin;}
var r=0,g=0,b=0,a=1;var h,s,v;var normalclr=normalizeCssColor(curcolor);var RGB=hexdec2rgb(normalclr.uint);r=RGB[0];g=RGB[1];b=RGB[2];h=getHue();var flat_rgb=flatColor();buildUI();function buildUI(){var pickerContainer=document.createElement('div');pickerContainer.style.overflow='hidden';pickerContainer.style.display='block';pickerContainer.style.position='relative';pickerContainer.className='fls-mobile-color-picker-container';colorDragTile=document.createElement('div');colorDragTile.style.width=sliderHeight+'px';colorDragTile.style.height=sliderHeight+'px';colorDragTile.style.display='block';colorDragTile.style.position='relative';colorDragTile.className='fls-mobile-color-picker-color';colorDragTile.style['float']='left';colorDragTile.style.margin=sliderMargin+'px';var saturationDiv=document.createElement('div');saturationDiv.style.width=sliderHeight+'px';saturationDiv.style.height=sliderHeight+'px';saturationDiv.style.display='block';saturationDiv.style.position='relative';saturationDiv.className='fls-mobile-color-picker-saturation';saturationDiv.style.backgroundImage='linear-gradient(to right, #fff, rgba(204, 154, 129, 0))';colorDragTile.appendChild(saturationDiv);var valueDiv=document.createElement('div');valueDiv.style.width=sliderHeight+'px';valueDiv.style.height=sliderHeight+'px';valueDiv.style.display='block';valueDiv.style.position='relative';valueDiv.className='fls-mobile-color-picker-value';valueDiv.style.backgroundImage='linear-gradient(to top, #000, rgba(204, 154, 129, 0))';saturationDiv.appendChild(valueDiv);colorGragKnob=document.createElement('div');colorGragKnob.style.position='absolute'
colorGragKnob.style.border=dragKnobRadius+'px solid #FFF';colorGragKnob.style.width=(dragKnobRadius*2)+'px';colorGragKnob.style.height=(dragKnobRadius*2)+'px';colorGragKnob.style.borderRadius=(dragKnobRadius*2)+'px'
colorGragKnob.style.boxShadow='0 0 3px rgba(0,0,0,0.8)';colorGragKnob.style.cursor='pointer';valueDiv.appendChild(colorGragKnob);var colorSlidebarContainer=document.createElement('div');colorSlidebarContainer.style.position='relative';colorSlidebarContainer.style.pdisplay='block';colorSlidebarContainer.style['float']='left';colorSlidebarContainer.className='fls-mobile-color-picker-hue';colorSlidebarContainer.style.margin=sliderMargin+'px 0';colorSlidebarContainer.style.padding='0 '+sliderWidth+'px';colorSlideBar=document.createElement('canvas');colorSlideBar.width=sliderWidth;colorSlideBar.height=sliderHeight;var sl_ctx=colorSlideBar.getContext('2d');var color_step=1/6;var gradient=sl_ctx.createLinearGradient(0,0,0,sliderHeight);gradient.addColorStop(0,"#ff0000");gradient.addColorStop(color_step,"#ffff00");gradient.addColorStop(color_step*2,"#00ff00");gradient.addColorStop(color_step*3,"#00ffff");gradient.addColorStop(color_step*4,"#0000ff");gradient.addColorStop(color_step*5,"#ff00ff");gradient.addColorStop(1,"#ff0000");sl_ctx.fillStyle=gradient;sl_ctx.fillRect(0,0,sliderWidth,sliderHeight);var knob_left=((3*sliderWidth)-(sliderWidth+10))/2;colorSlideKnob=document.createElement('div');colorSlideKnob.style.position='absolute'
colorSlideKnob.style.border='5px solid #FFF';colorSlideKnob.style.width=sliderWidth+'px';colorSlideKnob.style.height='1px';colorSlideKnob.style.left=knob_left+'px';colorSlideKnob.style.borderRadius='5px'
colorSlideKnob.style.boxShadow='0 0 3px rgba(0,0,0,0.8)';colorSlideKnob.style.cursor='pointer';colorSlidebarContainer.appendChild(colorSlideBar);colorSlidebarContainer.appendChild(colorSlideKnob);pickerContainer.appendChild(colorDragTile);pickerContainer.appendChild(colorSlidebarContainer);var pickerparent;if(typeof(container)=='string'){pickerparent=document.querySelector(container);}else if(container instanceof HTMLElement){pickerparent=container;}
if(pickerparent){pickerparent.appendChild(pickerContainer);updatePickerUI();var events=mobile?['touchstart','touchmove','touchend']:['mousedown','mousemove','mouseup'];colorDragTile.setAttribute('data-pickerdata','saturation-value');colorSlidebarContainer.setAttribute('data-pickerdata','hue');_setupEvents(events,colorDragTile);_setupEvents(events,colorSlidebarContainer);}}
function _setupEvents(_events,_domobj){for(var i=0;i<_events.length;i++){if(document.addEventListener){_domobj.addEventListener(_events[i],_handleUserColorChoice,false);}else if(_domobj.attachEvent){_domobj.attachEvent("on"+events[i],_handleUserColorChoice);}}}
function flatColor(){return hsv2rgb(true);}
function hexdec2rgb(hexdec){var R=(hexdec&0xFF0000)>>16;var G=(hexdec&0x00FF00)>>8;var B=(hexdec&0x0000FF);return[R,G,B];}
function normalizeCssColor(csscolorstr){var colorint=0;if(!csscolorstr){return{css:"rgb(255,0,0)","uint":0,css_hex:'#FF0000'};}
csscolorstr=csscolorstr.toString().replace(/\s/ig,'');var newcssclsstr='';if(/#/ig.test(csscolorstr)){csscolorstr=csscolorstr.replace('#','');if(csscolorstr.length==3){newcssclsstr+=csscolorstr[0]+csscolorstr[0];newcssclsstr+=(csscolorstr[1]+csscolorstr[1]);newcssclsstr+=(csscolorstr[2]+csscolorstr[2]);colorint=parseInt(newcssclsstr,16);}else{colorint=parseInt(csscolorstr,16);}
newcssclsstr='rgb('+hexdec2rgb(colorint).join(',')+')';}else{var colors=csscolorstr.replace(/rgb(a?)\(/ig,'').replace(')','').split(',');for(var i=0;i<colors.length;i++){colors[i]=/%/i.test(colors[i])?Math.round(parseFloat(colors[i],10)*255/100):(i<3?parseInt(colors[i],10):parseFloat(colors[i],10));}
colorint=colors[0]<<16;colorint+=colors[1]<<8;colorint+=colors[2];newcssclsstr=colors.length==4?'rgba(':'rgb(';newcssclsstr+=hexdec2rgb(colorint).join(',')+(colors.length==4?','+colors[3]:'')+')';}
var css_hex='#'+(0x1000000|colorint).toString(16).substring(1);return{css:newcssclsstr,uint:colorint,css_hex:css_hex};}
function getHue(){var R,G,B,H;R=r/255;G=g/255;B=b/255;var MIN=Math.min(R,G,B);var MAX=Math.max(R,G,B);var delta=MAX-MIN;if(MIN==MAX){H=0;}else{if(MAX==R){H=(G-B)/delta;}else if(MAX==G){H=2.0+(B-R)/delta;}else{H=4.0+(R-G)/delta}}
H*=60;H=H>0?H:H+360;v=MAX;s=MAX==0?0:delta/MAX;return H;}
function hsv2rgb(flatcolor){var rgb={r:0,g:0,b:0};;if(h==undefined){return rgb;}
var _v=v,_s=s;if(flatcolor===true){_v=1;_s=1;}
var pre_rgb={r:0,g:0,b:0};var Hp=h/60;var C=_v*_s;var X=C*(1-Math.abs((Hp%2)-1));var m=_v-C;if(Hp>=0&&Hp<=1){pre_rgb.r=C;pre_rgb.g=X;pre_rgb.b=0;}else if(Hp>=1&&Hp<=2){pre_rgb.r=X;pre_rgb.g=C;pre_rgb.b=0;}else if(Hp>=2&&Hp<=3){pre_rgb.r=0;pre_rgb.g=C;pre_rgb.b=X;}else if(Hp>=3&&Hp<=4){pre_rgb.r=0;pre_rgb.g=X;pre_rgb.b=C;}else if(Hp>=4&&Hp<=5){pre_rgb.r=X;pre_rgb.g=0;pre_rgb.b=C;}else if(Hp>=5&&Hp<=6){pre_rgb.r=C;pre_rgb.g=0;pre_rgb.b=X;}
rgb.r=Math.ceil((pre_rgb.r+m)*255);rgb.g=Math.ceil((pre_rgb.g+m)*255);rgb.b=Math.ceil((pre_rgb.b+m)*255);return rgb;}
function cssColor(){var _rgb=hsv2rgb();var colorint=_rgb.r<<16;colorint+=_rgb.g<<8;colorint+=_rgb.b;var flat=hsv2rgb(true);var css_rgb=changed?'rgb('+_rgb.r+','+_rgb.g+','+_rgb.b+')':normalclr.css;return{'css_hex':'#'+(0x1000000|colorint).toString(16).substring(1),'css_rgb':css_rgb,'flat_css_rgb':'rgb('+flat.r+','+flat.g+','+flat.b+')','initial_rgb_css':normalclr.css,'rgb':[_rgb.r,_rgb.g,_rgb.b],'initial_rgb':FLSUtil.hexdec2rgb(normalclr.uint),'changed':changed}}
function updatePickerUI(evt_type){var css_clr=cssColor();colorGragKnob.style.top=(((1-v)*sliderHeight)-(dragKnobRadius*2))+'px';colorGragKnob.style.left=((s*sliderHeight)-(dragKnobRadius*2))+'px';colorSlideKnob.style.top=(((h/360)*sliderHeight)-6)+'px';colorDragTile.style.backgroundColor=css_clr.flat_css_rgb;if(sampleColorNew instanceof HTMLElement){sampleColorNew.style.backgroundColor=css_clr.css_rgb;}
if(sampleColorStart instanceof HTMLElement){sampleColorStart.style.backgroundColor=css_clr.initial_rgb_css;}
if((sampleColorStartTxt instanceof HTMLElement)&&(sampleColorStartTxt.nodeName.toLowerCase()=='input')&&(sampleColorStartTxt.type=='text')){sampleColorStartTxt.value=normalclr.css_hex;}
if((sampleColorNewTxt instanceof HTMLElement)&&(sampleColorNewTxt.nodeName.toLowerCase()=='input')&&(sampleColorNewTxt.type=='text')){sampleColorNewTxt.value=css_clr.css_hex;}
if(typeof(_this.onColorChange)=='function'){_this.onColorChange(css_clr,normalclr,evt_type);}}
function _handleUserColorChoice(evt){if(evt.touches||evt.buttons||(['mouseup','touchend'].indexOf(evt.type)>-1)){var clientrect=this.getBoundingClientRect();var x,y,has_clientxy;if(evt.touches&&evt.touches.length){x=evt.touches[0].clientX-clientrect.left;y=evt.touches[0].clientY-clientrect.top;has_clientxy=true;}else{has_clientxy=evt.clientX>=0;x=evt.clientX-clientrect.left;y=evt.clientY-clientrect.top;}
if(has_clientxy){var what=this.getAttribute('data-pickerdata');y=y>0?y:0;y=y<sliderHeight?y:sliderHeight;x=x>0?x:0;x=x<sliderHeight?x:sliderHeight;switch(what){case'saturation-value':s=x/sliderHeight;v=1-(y/sliderHeight);break;case'hue':h=(y/sliderHeight)*360;break;}
changed=true;updatePickerUI(evt.type);}}
evt.stopPropagation();evt.preventDefault();};this.set=function(newcolor){if(newcolor&&typeof(newcolor)=='string'){normalclr=normalizeCssColor(newcolor);curcolor=normalclr.css;RGB=hexdec2rgb(normalclr.uint);r=RGB[0];g=RGB[1];b=RGB[2];h=getHue();flat_rgb=flatColor();changed=false;}
updatePickerUI();};this.get=function(){return cssColor();};this.setColorSampleNewElement=function(sampledomnode){if(sampledomnode instanceof HTMLElement){sampleColorNew=sampledomnode;}};this.setColorSampleStartElement=function(sampledomnode){if(sampledomnode instanceof HTMLElement){sampleColorStart=sampledomnode;}};this.setSampleColorNewTxtElement=function(sampledomnode){if(sampledomnode instanceof HTMLElement){sampleColorNewTxt=sampledomnode;}};this.setColorSampleStartTxtElement=function(sampledomnode){if(sampledomnode instanceof HTMLElement){sampleColorStartTxt=sampledomnode;}};};var FLSFontSizeSlider=function(cfg,container){var min=cfg.min?parseInt(cfg.min):7;var max=cfg.max?parseInt(cfg.max):70;var unit=(typeof(cfg.unit)=='string')&&(cfg.unit.length)?cfg.unit:'px';var _label=(typeof(cfg.label)=='string')&&(cfg.label.length)?cfg.label:'Font Size';var _this=this;var current_value=cfg.value?parseInt(cfg.value,10):min;if((current_value<min)||(current_value>max)){current_value=min;}
var sliderDom=null;var sliderStrip=null;var sliderStripLineKnob=null;_BuildUI();function _setupEvents(_events,_domobj){for(var i=0;i<_events.length;i++){if(document.addEventListener){_domobj.addEventListener(_events[i],_handleSliderEvents,false);}else if(_domobj.attachEvent){_domobj.attachEvent("on"+events[i],_handleSliderEvents);}}}
function _BuildUI(){sliderDom=document.createElement('div');sliderDom.className='font-size-slider-control-wrapper';var sliderControl=document.createElement('div');sliderControl.className='font-size-slider-controls';sliderStrip=document.createElement('div');sliderStripLineKnob=document.createElement('div');var decrementCntrl=document.createElement('div');var incrementCntrl=document.createElement('div');var sliderStripLine=document.createElement('div');var sliderStripLineKnobinner=document.createElement('div');sliderStrip.className='font-size-slider-strip';decrementCntrl.className='font-size-slider-btn slider-decrement';incrementCntrl.className='font-size-slider-btn slider-increment';sliderStripLine.className='font-size-slider-strip-line';sliderStripLineKnob.className='font-size-slider-knob';sliderStripLineKnobinner.className='font-size-slider-knob-inner';sliderStripLineKnob.appendChild(sliderStripLineKnobinner);sliderStripLine.appendChild(sliderStripLineKnob);sliderStrip.appendChild(sliderStripLine);sliderControl.appendChild(decrementCntrl);sliderControl.appendChild(sliderStrip);sliderControl.appendChild(incrementCntrl);var sliderLabel=document.createElement('div');sliderLabel.style.width='100%';sliderLabel.style.position='relative';sliderLabel.style.textAlign='center';sliderLabel.className='font-size-slider-label';sliderLabel.appendChild(document.createTextNode(_label));sliderDom.appendChild(sliderLabel);sliderDom.appendChild(sliderControl);sliderStrip.setAttribute('data-slidercntrl','drag-line');decrementCntrl.setAttribute('data-slidercntrl','down-value');incrementCntrl.setAttribute('data-slidercntrl','up-value');var sliderparent;if(typeof(container)=='string'){sliderparent=document.querySelector(container);}else if(container instanceof HTMLElement){sliderparent=container;}
if(sliderparent){sliderparent.appendChild(sliderDom);updateSliderUI();_setupEvents(['touchstart','touchmove','mousedown','mousemove'],sliderStrip);_setupEvents(['touchstart','mousedown'],incrementCntrl);_setupEvents(['touchstart','mousedown'],decrementCntrl);}}
function _handleSliderEvents(evt){if(evt&&(evt.buttons||(evt.touches&&evt.touches.length))){var action=this.getAttribute('data-slidercntrl');switch(action){case'drag-line':var clientrect=this.getBoundingClientRect();var x,y;if(evt.touches&&evt.touches.length){x=evt.touches[0].clientX-clientrect.left;y=evt.touches[0].clientY-clientrect.top;}else{x=evt.clientX-clientrect.left;y=evt.clientY-clientrect.top;}
var rawval=(x*(max-min)/this.clientWidth);var decimals=rawval-Math.floor(rawval);if(decimals>0.5){rawval=Math.ceil(rawval);}else{rawval=Math.floor(rawval);}
current_value=rawval+min;current_value=current_value>max?max:current_value;current_value=current_value<min?min:current_value;break;case'down-value':current_value-=1;current_value=min>current_value?min:current_value;break
case'up-value':current_value+=1;current_value=max<current_value?max:current_value;break;}
if(typeof(_this.onSizeChange)=='function'){_this.onSizeChange(current_value,evt.type);}
updateSliderUI();if(evt.preventDefault){evt.preventDefault();}else{evt.returnValue=false;}
return false;}}
function updateSliderUI(){var slidestep=sliderStrip.clientWidth/(max-min);var newpos=Math.ceil(slidestep*(current_value-min)-(sliderStripLineKnob.clientWidth/2));sliderStripLineKnob.style.left=newpos+'px';}
this.set=function(new_val){new_val=parseInt(new_val,10);if(!isNaN(new_val)){if((min<=new_val)&&(max>=new_val)){current_value=new_val;}
if(new_val<min){current_value=min;}}
updateSliderUI();};};var FLSMultiStyleTextEditDlg=function(cfg){var _this=this;var KEYS={DEL:8,BACKSPACE:46,LEFT:37,RIGHT:39,HOME:36,END:35};var styleWithCss=false;var has_touch_evt=window.TouchEvent!='undefined';var has_mouse_evt=window.MouseEvent!='undefined';var has_pointer_evt=window.PointerEvent!='undefined';var mobile=FLSUtil.mobile();var windows_mobile=FLSUtil.wp_mobile();var fontsOptions={};var fontsOrder=[];var swatches=[];var fonts_select_option_positioned=false;var resources={buttons:'data:image/png;base64,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',buttons16px:'data:image/png;base64,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'};var editAreaContainer=null,editArea=null,toolsContainer=null,editDlg=null,editOverlay=null,fontsSelectOptions=null,fontColorSample=null,fontNameLabel=null,fontSizeControl=null,fontSelectorContainer=null;var txtObj=null;var toolbar_cfg=[{action:'toggle_font_weight',active:false},{action:'toggle_font_style',active:false},{action:'undo',active:true},{action:'redo',active:true},{action:'clear_format',active:false},{action:'reset',active:false},{action:'set_font_family',active:true},{action:'set_font_size',active:true},{action:'show_color_picker',active:true},{action:'color_swatch',active:true}];var MstUndoManager={undo_stack:[],redo_stack:[],pushStack:function(which,data){switch(which){case'undo':this.undo_stack.push(data);break;case'redo':this.redo_stack.push(data);break;default:}},popStack:function(which){switch(which){case'undo':return this.undo_stack.pop();break;case'redo':return this.redo_stack.pop();break;default:}},clear:function(){while(this.undo_stack.length){this.undo_stack.pop();}
while(this.redo_stack.length){this.redo_stack.pop();}},hasUndo:function(){return this.undo_stack.length>0;},hasRedo:function(){return this.redo_stack.length>0;}};_buildDlg();function SortFontByName(){while(fontsOrder.lenght){fontsOrder.shift();}
for(var fontname in fontsOptions){fontsOrder.push(fontname);}
fontsOrder.sort(function(a,b){var _a=a.toLowerCase();var _b=b.toLowerCase();return _a<_b?-1:1;});}
function _updateToolbar(){var current_node=document.getSelection().anchorNode;if(current_node){current_node=(current_node.nodeType==3?current_node.parentNode:current_node);var font_name=current_node.style.fontFamily;var font_size=current_node.style.fontSize;var _stop=font_name.length>0;var curclr=current_node.style.color;while(!_stop){current_node=current_node.parentNode;if(current_node){if(!font_size&&current_node.style){font_size=current_node.style.fontSize;}
if(current_node==editArea){_stop=true;}
if(current_node.style){font_name=current_node.style.fontFamily;}
_stop=font_name.length>0;}else{_stop=true;}}
if(!font_size){font_size=(current_node&&current_node.style.fontSize)?current_node.style.fontSize:editArea.style.fontSize;}
fontColorSample.set(curclr);if(fontSizeControl){fontSizeControl.set(editArea.style.fontSize.replace(/px/,''));}
fontNameLabel.html(font_name.replace(/"/g,''));}}
function _handleEditAreaEvnets(evt){var prevent=false;switch(evt.type){case'paste':var clipdata=evt.clipboardData||window.clopboardData;var pasted=clipdata.getData('text');prevent=true;break;case'keydown':var plain_text=editArea.innerText;var selection=window.getSelection().toString().length>0;if((evt.keyCode==13)||((plain_text.length>=30)&&!selection&&([KEYS.DEL,KEYS.BACKSPACE,KEYS.LEFT,KEYS.RIGHT,KEYS.HOME,KEYS.END]).indexOf(evt.keyCode)==-1)){prevent=true;}else{MstUndoManager.pushStack('undo',{cmd:'native',action:'textChange',evt_type:evt.type,text:plain_text});}
break;case'mouseup':case'touchend':case'pointerup':case'keyup':_updateToolbar();break;default:prevent:false;}
if(prevent){evt.preventDefault();evt.stopPropagation();return false;}}
function _handleWysywigUiEvents(evt){var me=jQuery(evt.target);var action=me.attr('data-action');var done=true;switch(action){case'undo':case'redo':var action_info;if(action=='undo'){action_info=MstUndoManager.popStack('undo');if(action_info){MstUndoManager.pushStack('redo',action_info);switch(action_info.action){case'textChange':document.execCommand(action,false);var plain_text=editArea.innerText;done=false;if(MstUndoManager.hasUndo()){while((plain_text!=action_info.text)&&(done===false)){console.log(plain_text,action_info.text);action_info=MstUndoManager.popStack('undo');if((action_info.action!='textChange')||!action_info){done=true;if(action_info){MstUndoManager.pushStack('undo',action_info);}}}}
break;case'foreColor':if(action_info.cmd=='custom'){console.log(action_info.node.style.color,action_info.font_color);var cur_color=action_info.node.style.color;action_info.node.style.color=action_info.font_color;action_info.font_color=cur_color;}
break;case'fontSize':if(action_info.cmd=='custom'){var cur_fs=action_info.node.style.fontSize;action_info.node.style.fontSize=action_info.prev_font_size?action_info.prev_font_size+'px':'';action_info.prev_font_size=cur_fs.replace(/px/,'');}
break;case'set_font_family':if(action_info.cmd=='custom'){var cur_fn=action_info.node.style.fontFamily;action_info.node.style.fontFamily=action_info.font_name?action_info.font_name.replace(/"/,''):'';action_info.font_name=cur_fn.trim();}
break;default:document.execCommand(action,false);}}}else{action_info=MstUndoManager.popStack('redo');if(action_info){MstUndoManager.pushStack('undo',action_info);if(action_info.cmd=='native'){document.execCommand(action,false);}else{switch(action_info.action){case'foreColor':if(action_info.cmd=='custom'){var cur_color=action_info.node.style.color;action_info.node.style.color=action_info.font_color;action_info.font_color=cur_color;}
break;case'fontSize':if(action_info.cmd=='custom'){var cur_fs=action_info.node.style.fontSize;action_info.node.style.fontSize=action_info.prev_font_size?action_info.prev_font_size+'px':'';action_info.prev_font_size=cur_fs.replace(/px/,'');}
break;case'set_font_family':if(action_info.cmd=='custom'){var cur_fn=action_info.node.style.fontFamily;action_info.node.style.fontFamily=action_info.font_name?action_info.font_name.replace(/"/,''):'';action_info.font_name=cur_fn.trim();}
break;}}}else{document.execCommand(action,false);}}
break;case'show_fonts_list':if(fonts_select_option_positioned===false){fonts_select_option_positioned=true;var ps=fontSelectorContainer[0].offsetTop;var hg=fontSelectorContainer[0].offsetHeight;var tmrg=parseInt(getComputedStyle(fontSelectorContainer[0]).marginTop.replace(/[^0-9]/,''),10);if(isNaN(tmrg)){tmrg=0;}
fontsSelectOptions.css({top:(ps+hg+tmrg)+'px'});}
fontsSelectOptions.toggle();break;case'toggle_font_weight':MstUndoManager.pushStack('undo',{cmd:'native',action:action,evt_type:evt.type});document.execCommand('bold',false);break;case'toggle_font_style':MstUndoManager.pushStack('undo',{cmd:'native',action:action,evt_type:evt.type});document.execCommand('italic',false);break;case'clear_format':MstUndoManager.pushStack('undo',{cmd:'native',action:action,evt_type:evt.type});document.execCommand('removeFormat',false);break;case'set_font_family':var selection=window.getSelection().toString();var font_name=me.attr('data-fontfamily');if(font_name){if(selection.length){MstUndoManager.pushStack('undo',{cmd:'native',action:action,evt_type:evt.type});document.execCommand('fontName',false,font_name);}else{var current_node=document.getSelection().anchorNode;if(current_node){current_node=(current_node.nodeType==3?current_node.parentNode:current_node);}else{current_node=editArea;}
var prev_font_family=current_node.style.fontFamily;current_node.style.fontFamily=font_name;MstUndoManager.pushStack('undo',{cmd:'custom',action:action,evt_type:evt.type,node:current_node,font_name:prev_font_family});}
fontNameLabel.html(font_name);}
fontsSelectOptions.hide();break;case'reset':if(txtObj instanceof FLSEditorCore.CMultiLineText){_resetContent()}else{editArea.style.fontSize='20px';editArea.style.fontFamily='Helvetica';editArea.style.color='rgb(0,0,0)';editArea.innerText='PlayHard';}
_updateToolbar();break;case'set_color_swatch':var clr=me.attr('data-color');if(clr!='none'){_handleColorPickerChange({css_rgb:clr},null,'set_color_swatch');_updateToolbar();}
break;default:console.log(action);}
evt.preventDefault();evt.stopPropagation();return false;}
function _handleFontSizeSlider(newsize,evt_type){var current_node=editArea;if(['mousedown','touchstart'].indexOf(evt_type)>-1){var prev_font_size=current_node.style.fontSize.replace(/px/,'');MstUndoManager.pushStack('undo',{cmd:'custom',action:'fontSize',evt_type:evt_type,node:current_node,prev_font_size:prev_font_size});}
current_node.style.fontSize=newsize+'px';}
function _handleColorPickerChange(css_clr,normalclr,evt_type){if(!evt_type)return false;var selection=window.getSelection().toString();if(selection.length){MstUndoManager.pushStack('undo',{cmd:'native',action:'foreColor',evt_type:evt_type});document.execCommand('foreColor',false,css_clr.css_rgb);}else{var current_node=document.getSelection().anchorNode;if(current_node){current_node=(current_node.nodeType==3?current_node.parentNode:current_node);if(!(current_node&&current_node.style)){current_node=editArea;}}else{current_node=editArea;}
var prev_font_color=current_node.style.color;current_node.style.color=css_clr.css_rgb;if(['mousedown','touchstart','set_color_swatch'].indexOf(evt_type)>-1){MstUndoManager.pushStack('undo',{cmd:'custom',action:'foreColor',evt_type:evt_type,node:current_node,font_color:prev_font_color});}}}
function _handleBottomButtons(evt){var me=jQuery(evt.target);var action=me.attr('data-action');switch(action){case'apply':var styles=_mergeStylesInfo(_getStylesInfo(editArea));var style_cpy=styles.slice(0);if((txtObj instanceof FLSEditorCore.CMultiLineText)&&txtObj.multistyle_on()){var old_w=txtObj.getSize().width;txtObj.setFontSize(editArea.style.fontSize.replace(/px/g,''));txtObj.setFontFamily(editArea.style.fontFamily);txtObj.setColor(editArea.style.color);txtObj.multistyle_cfg(styles);if(typeof(_this.onApply)=='function'){_this.onApply(txtObj,old_w);}
if(cfg._caller&&typeof(cfg._caller.updateUserCustomColorSwatch)=='function'){while(style_cpy.length){var tmp_styl=style_cpy.shift();if(cfg.swatchColors&&(cfg.swatchColors.indexOf(tmp_styl.color)==-1)&&(cfg.swatchColors.indexOf(tmp_styl.color.replace(/\s/g,''))==-1)){cfg._caller.updateUserCustomColorSwatch(tmp_styl.color);}}}}
_hideDlg();break;case'cancel':_hideDlg();break;default:}}
function _getStylesInfo(node){var rootNodes=node.childNodes;var styles=[];for(var node_idx=0;node_idx<rootNodes.length;node_idx++){var node=rootNodes[node_idx];if(node.nodeType==3){var ff=node.parentNode.style.fontFamily;ff=ff?ff:(node.parentNode.getAttribute('face')||'');var clr=node.parentNode.style.color;clr=clr?clr:(node.parentNode.getAttribute('color')||'');var fs=node.parentNode.style.fontSize.replace(/px/,'');var pnode=node.parentNode;var clr_pnode=node.parentNode;var fs_pnode=node.parentNode;while(!ff.length){ff=pnode.style.fontFamily;ff=ff?ff:(pnode.getAttribute('face')||'');pnode=pnode.parentNode;}
while(!clr.length){clr=clr_pnode.style.color;clr=clr?clr:(clr_pnode.getAttribute('color')||'');clr_pnode=clr_pnode.parentNode;}
while(!fs.length){fs=fs_pnode.style.fontSize.replace(/px/,'');fs_pnode=fs_pnode.parentNode;}
styles.push({text:node.nodeValue,font_family:ff,color:clr});}else{styles=styles.concat(_getStylesInfo(node))}}
return styles;}
function _mergeStylesInfo(styles){var merged=[styles.shift()];while(styles.length){var str_style=styles.shift();var mrg_style=merged[merged.length-1];if((str_style.font_family==mrg_style.font_family)&&(str_style.color==mrg_style.color)&&(str_style.font_size==mrg_style.font_size)){mrg_style.text+=str_style.text;}else{merged.push(str_style);}}
return merged;}
function _buildDlg(){_addMLCss();var color_swatch_cntrl_width=65;var default_content_view=569;var use_width=(cfg.view&&cfg.view.width)?cfg.view.width:default_content_view;if(cfg.editor_width&&cfg.editor_width>default_content_view){use_width=default_content_view;}
editAreaContainer=document.createElement('div');editAreaContainer.style.width='100%';editAreaContainer.style.height='112px';editAreaContainer.style.border='1px solid #CCC';editAreaContainer.style.lineHeight='100px';editAreaContainer.style.overflow='auto hidden';editAreaContainer.style.backgroundColor='#FFF';editArea=document.createElement('div');editArea.contentEditable=true;editArea.className='fls-mst-edit-area';editArea.style.lineHeight='100px';editArea.style.height='100px';editArea.style.textAlign='center';editArea.style.whiteSpace='nowrap';editArea.style.outline='0';editArea.spellcheck=false;editArea.style.fontSize='20px';editArea.style.fontFamily='Helvetica';editArea.style.color='rgb(0,0,0)';editArea.innerText='PlayHard';editAreaContainer.appendChild(editArea);toolsContainer=document.createElement('div');toolsContainer.style.margin='0';toolsContainer.style.position='relative';var dlg_ttl=cfg.btn_labels.header?cfg.btn_labels.header:'Font Editor';var dlg_hint=cfg.btn_labels.description?cfg.btn_labels.description:'Highlight sections of your logo text to make further customizations.';var topHeader=jQuery('<div class="mst-tools-header"><h4>'+dlg_ttl+'</h4><span>'+dlg_hint+'<\span><\/div>').get(0);var toolsLeft=jQuery('<div class="mst-tools-left mst-btns-small"><\/div>').get(0);var toolsRight=jQuery('<div class="mst-tools-right"><\/div>').get(0);var bottomButtons=jQuery('<div class="mst-buttons-container"><span class="fls-button fls-orangebutton" data-action="cancel">'+cfg.btn_labels.cancel+'<\/span><span class="fls-button fls-bluebutton" data-action="apply">'+cfg.btn_labels.apply+'<\/span><\/div>').get(0);toolsContainer.appendChild(topHeader)
toolsContainer.appendChild(toolsLeft)
toolsContainer.appendChild(toolsRight)
for(var i=0;i<toolbar_cfg.length;i++){var cntrl=toolbar_cfg[i]['action'];var activebtn=toolbar_cfg[i]['active'];if(activebtn){switch(cntrl){case'set_font_family':toolsLeft.appendChild(_buildFontsSelector());break;case'toggle_font_weight':case'toggle_font_style':case'undo':case'redo':case'clear_format':case'reset':var lbl='&nbsp;';var label_class='';if(['undo','redo'].indexOf(cntrl)>-1&&cfg.btn_labels.undo&&cfg.btn_labels.redo){lbl=cfg.btn_labels[cntrl].toLowerCase();label_class=' mst-with-label'}
var btn=jQuery('<span class="mst-btn mst-'+cntrl+label_class+'" data-action="'+cntrl+'">'+lbl+'<\/span>');toolsLeft.appendChild(btn.get(0));break;case'show_color_picker':var cnt_wdth=115;var left_prcnt=Math.floor((1-((120+40+color_swatch_cntrl_width)/use_width))*100);toolsLeft.style.width=left_prcnt+'%';toolsRight.style.width=(100-left_prcnt)+'%';fontColorSample=new FLSColorPicker('rgb(0,0,0',toolsRight,{height:Math.min(120,cnt_wdth),margin:5});fontColorSample.onColorChange=_handleColorPickerChange;break;case'color_swatch':var swtch_container=jQuery('<div class="mst-color-swatches-contianer"></div>');var swatches_count=9;for(var ci=0;ci<swatches_count;ci++){var swatch=jQuery('<span class="color-swatch">&nbsp;</span>');var clr=cfg.swatchColors[ci]?cfg.swatchColors[ci]:'none';swatch.css({backgroundColor:clr});swatch.attr('data-color',clr);swatch.attr('data-action','set_color_swatch');if((ci%3)==2){swatch.addClass('last-swatch')}
swtch_container.append(swatch);swatches.push(swatch);}
toolsRight.appendChild(swtch_container.get(0));break;case'set_font_size':fontSizeControl=new FLSFontSizeSlider({min:7,max:70,label:cfg.btn_labels.fontsize},toolsLeft);fontSizeControl.onSizeChange=_handleFontSizeSlider;break;default:}}}
editDlg=jQuery(document.createElement('div'));editDlg.addClass('mst-edit-dlg');editDlg.append(toolsContainer);editDlg.append(editAreaContainer);editDlg.append(bottomButtons);editDlg.css({width:use_width+'px'});editArea.addEventListener('keydown',_handleEditAreaEvnets,false);editArea.addEventListener('keyup',_handleEditAreaEvnets,false);editArea.addEventListener('paste',_handleEditAreaEvnets,false);toolsContainer.appendChild(fontsSelectOptions.get(0));if(mobile){if(windows_mobile){toolsContainer.addEventListener('pointerdown',_handleWysywigUiEvents,false);editArea.addEventListener('pointerup',_handleEditAreaEvnets,false);bottomButtons.addEventListener('pointerdown',_handleBottomButtons,false);}else{toolsContainer.addEventListener('touchstart',_handleWysywigUiEvents,false);editArea.addEventListener('touchend',_handleEditAreaEvnets,false);bottomButtons.addEventListener('touchstart',_handleBottomButtons,false);}}else{toolsContainer.addEventListener('mousedown',_handleWysywigUiEvents,false);editArea.addEventListener('mouseup',_handleEditAreaEvnets,false);bottomButtons.addEventListener('mousedown',_handleBottomButtons,false);}}
function _addMLCss(){jQuery('style#FLSMultyStyleDLGCss').remove();jQuery('<style type="text/css" id="FLSMultyStyleDLGCss">\n'+'.fls-mst-edit-area span, .fls-mst-edit-area font{font-size:1em;font-family:inherit;-moz-user-select:text !important;user-select: text !important;}\n'+'.mst-edit-dlg{background-color:#F1F2F2;padding: 19px;position:relative;margin: 0 auto 0 auto; top:50%;}\n'+'.mst-font-selector-drop{border: 1px solid #CACACA;font-size: 12px;text-decoration: none;font-family: verdana, arial,sans-serif;color: #666;display: inline-block;text-overflow: ellipsis;white-space: nowrap;overflow: hidden;position: relative;cursor: pointer; margin: 5px 0 0 0;width:100%;background-color:#FFF;}'+'.mst-font-selector-drop .mst-font-name{padding:5px;display:block;width:100%;text-overflow:ellipsis;overflow:hidden;height:19px;line-height:19px}'+'.mst-font-selector-drop .mst-down-arrow{padding:0; line-height:25px;display:block;width:25px;height:100%;position:absolute;right: 0;top: 0;font-size: 18px;color:#666;text-align:center;background-color:#DDD;border-left:1px solid #CCC;}'+'span.mst-font-selector-drop .mst-down-arrow:after{position: absolute; top:5px; left:0px; content:""; width:100%; height: 14px; background-position: center 0; background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAYCAYAAADKx8xXAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNXG14zYAAAAWdEVYdENyZWF0aW9uIFRpbWUAMDMvMjcvMTWhU1PqAAAApklEQVQ4je3TsQ3CQAyF4T8kg2SDWyNlFjjrxqBjFFBYgjEIG9AxAlSPhqAcuYRTSsRrLNn6XFhy4c1qYEd+HsC2APBmAdhnovbYdacS4NL3Z+fcFWhzEEA5dL/gCEVwAU/QBCZwEi3GmwVv1szNC0nZy8bZrFJ/+DOwAmpWPDKSkBSUl7ukRhIDzMFv9AmXcIRSMIUnaA6OcRJJopq53OFVb0Dy+5/9/ClmjINyVAAAAABJRU5ErkJggg=="); background-repeat:no-repeat;}\n'+'#mst-fontselector-list {display:none; padding: 0; margin:-13px 0 0 0; box-shadow: 0px 2px 2px rgba(0,0,0,0.5); background-color: #FFF; min-width: 140px; max-height: 215px;overflow-x:hidden; overflow-y: auto;}\n'+'#mst-fontselector-list span.mst-font-item{white-space: nowrap;cursor:pointer;display:block; padding:2px 3px; font-size: 18px; text-decoration: none; border: 2px solid #FFF; color: #000; width: 215px; overflow: hidden;text-align:left;}\n'+'#mst-fontselector-list span.mst-font-item.active{border-color: #CCC;}\n'+'#mst-fontselector-list span.mst-font-item:HOVER{border-color: #000;}\n'+'.mst-font-selector-drop.disabled .mst-font-name{background-color:#f6f6f6; color:#aaa;}'+'.mst-font-selector-drop.disabled{cursor:default;}'+'.mst-btn{position:relative;cursor:pointer; display:inline-block; width:38px; height:38px; line-height:40px; border:1px solid #CCC;text-align:center;margin:5px 10px 5px 0;background-color:#FFF;}\n'+'.mst-btn.disabled{opacity:0.5}\n'+'.mst-btn:after{content:"";position:absolute; left:0; top:0; width:100%; height:100%; background-image: url("'+resources.buttons+'");background-repeat:no-repeat;background-position:center 0;display:block;}\n'+'.mst-btn.mst-toggle_font_weight:after{background-position:center 2px;}\n'+'.mst-btn.mst-toggle_font_style:after{background-position:center -17px;}\n'+'.mst-btn.mst-undo:after{background-position:4px 5px;}\n'+'.mst-btn.mst-redo:after{background-position:-77px 5px;}\n'+'.mst-btn.mst-clear_format:after{background-position:center -78px;}\n'+'.mst-btn.mst-reset:after{background-position:-164px 5px;}\n'+'.mst-btn.mst-color-sample:after{background-image:none;}\n'+'.mst-tools-left{width: 65%;padding:5px 0 5px 0; text-align:left;}\n'+'.mst-tools-right{width: 35%;position: absolute;bottom: 0px;right: -10px;}\n'+'.fls-mst-edit-area{text-align:center;}\n'+'.mst-buttons-container{text-align:center;margin:10px 0 0 0;}\n'+'.mst-tools-header{padding:5px 0 10px 0; border-bottom:1px solid #CCC; font-size: 13px; color: #666;font-family: arial,verdana,sans-serif;margin:0 0 5px 0;text-align:center;}\n'+'.mst-tools-header h4{margin: 0 0 5px 0;color: #666;font-size: 13px;}\n'+'.show-fonts-list-container{display: block; margin: 5px 0 0 0; color: #666; font-size: 12px; font-family: arial,verdana,sans-serif;}\n'+'.mst-color-swatches-contianer{width: 56px; height: 56px; float: right;box-shadow: 0 0 10px inset rgba(0,0,0,0.3); position:relative; overflow:hidden;margin:5px;}\n'+'.mst-color-swatches-contianer .color-swatch{width: 18px; height: 18px; float: left;border:1px solid #000;border-width:0 1px 1px 0;display:block;cursor:pointer;}\n'+'.mst-color-swatches-contianer .color-swatch.last-swatch{border-width:0 0 1px 0;}\n'+'.mst-tools-left .font-size-slider-control-wrapper{margin:9px 0 0 0;}\n'+'.mst-tools-left .font-size-slider-control-wrapper .font-size-slider-controls{margin:0 0 5px 0;}\n'+'.mst-tools-left .font-size-slider-control-wrapper .font-size-slider-btn{border-radius:0;width:24px;height:24px;}\n'+'.mst-tools-left .font-size-slider-control-wrapper .font-size-slider-btn.slider-increment::after,\n'+'.mst-tools-left .font-size-slider-control-wrapper .font-size-slider-btn.slider-decrement::after{font-size:22px; color:#666;font-weight:normal;}\n'+'.mst-tools-left .font-size-slider-control-wrapper .font-size-slider-strip{height:24px;}\n'+'.mst-tools-left .font-size-slider-control-wrapper .font-size-slider-knob{height:15px;width:15px;top:-9px;}\n'+'.mst-tools-left .font-size-slider-control-wrapper .font-size-slider-knob .font-size-slider-knob-inner{height:13px;width:13px;margin:0px; border-radius:15px; border-color:#666;background-color:#666;}\n'+'.mst-tools-left .font-size-slider-control-wrapper .font-size-slider-label{font-size:11px;color:#666;top:4px; margin:0;}\n'+'.mst-btns-small .mst-btn{padding-left:23px; height:23px; line-height:23px;text-align:left; font-size:11px; font-family:arial,verdana,sans-serif; width:auto;color:#666;}\n'+'.mst-btns-small .mst-btn:after{width:23px; height:100%; background-image: url("'+resources.buttons16px+'");}\n'+'.mst-btns-small .mst-btn.mst-undo:after{background-position:3px 3px;}\n'+'.mst-btns-small .mst-btn.mst-redo:after{background-position:-45px 3px;}\n'+'.mst-btns-small .mst-btn.mst-reset:after{background-position:-97px 3px;}\n'+'.mst-btns-small .mst-btn.mst-with-label{padding: 0 5px 0 25px;}\n'+'.mst-tools-right .fls-mobile-color-picker-container{float:right;}\n'+'</style>').appendTo('head');}
function _buildFontsSelector(){if(cfg.fonts){fontsSelectOptions=jQuery(document.createElement('ul'))
fontsSelectOptions.css({position:'absolute',zIndex:100,left:'0px',top:'100%',listStyle:'none'});fontsSelectOptions.attr('id','mst-fontselector-list');for(var fnt_nm in cfg.fonts){fontsOptions[fnt_nm]={'bold':cfg.fonts[fnt_nm]['bold_src'].length>1,'italic':cfg.fonts[fnt_nm]['italic_src'].length>1,}}
SortFontByName();var fontitems='';for(var fi=0;fi<fontsOrder.length;fi++){var fontname=fontsOrder[fi];fontitems+='<li><span data-fontfamily="'+fontname+'" style="font-family: \''+fontname+'\';" class="mst-font-item" data-action="set_font_family">'+fontname+'</span></li>';}
fontsSelectOptions.append(jQuery(fontitems));fontSelectorContainer=jQuery('<span class="show-fonts-list-container"><\/span>');var selector=jQuery('<span data-action="show_fonts_list"><\/span>');fontSelectorContainer.append(selector);selector.addClass('mst-font-selector-drop');fontNameLabel=jQuery('<span class="mst-font-name" data-action="show_fonts_list">&nbsp;</span>');selector.append(fontNameLabel);var downarrow=jQuery('<span class="mst-down-arrow" data-action="show_fonts_list">&nbsp;</span>');selector.append(downarrow);return fontSelectorContainer.get(0);}}
function _showDlg(){if(!editOverlay){editOverlay=jQuery(document.createElement('div'));editOverlay.css({position:'absolute',width:'100%',height:'100%',backgroundColor:'rgba(0,0,0,0.7)',top:0,left:0,'z-index':120});if(cfg.container){jQuery('#'+cfg.container).append(editOverlay);}else{jQuery('body').append(editOverlay);}
editOverlay.append(editDlg);var ed_h=editDlg.height();editDlg.css({marginTop:-(ed_h/2)+'px'});}else{editOverlay.show();}
styleWithCss=document.execCommand('styleWithCSS',false,true);editArea.focus();MstUndoManager.clear();_updateColorSwatches();_updateToolbar();}
function _hideDlg(){if(editOverlay instanceof jQuery){editOverlay.hide();}}
function _resetContent(){editArea.innerHTML='';if((txtObj instanceof FLSEditorCore.CMultiLineText)&&txtObj.multistyle_on()){editArea.style.fontFamily=txtObj.getFontFamily();editArea.style.fontSize=txtObj.getFontSize()+'px';editArea.style.color=txtObj.getColor();var styles=txtObj.multistyle_cfg();if(styles.length){for(var i=0;i<styles.length;i++){var spn=document.createElement('span');spn.innerHTML=styles[i].text;if(styles[i].font_family){spn.style.fontFamily=styles[i].font_family;}
if(styles[i].color){spn.style.color=styles[i].color;}
if(styles[i].font_size){spn.style.fontSize=styles[i].font_size+'px';}
editArea.appendChild(spn);}}else{editArea.innerHTML=txtObj.getText();}}}
function _updateColorSwatches(){for(var ci=0;ci<swatches.length;ci++){var clr=cfg.swatchColors[ci]?cfg.swatchColors[ci]:'none';swatches[ci].css('background-color',clr);swatches[ci].attr('data-color',clr);}}
this.editTextObj=function(to){editArea.innerHTML='';txtObj=null;if((to instanceof FLSEditorCore.CMultiLineText)&&to.multistyle_on()){txtObj=to;_resetContent();editArea.focus();_updateToolbar();}};this.show=function(){_showDlg();};this.hide=function(){_hideDlg();};this.getMultistyleText=function(){var plain_text=editArea.innerText;console.log(editArea.childNodes,plain_text);};};var FLSUndoRedo=function(cfg){cfg=cfg?cfg:{};var sides=[];var undo_stack={};var redo_stack={};var defaultUndoStepsCount=40;var last_undo_obj={};if(!cfg.editor||!(cfg.editor instanceof FLSEditorCore)){throw"undo/redo requires an editor of type FLSEditorCore set in the constructor config";}
if((cfg.sides instanceof Array)&&cfg.sides.length){cfg.sides.forEach(value=>{value=value.toString().trim();sides.push(value);});}
if(!sides.length){sides.push('front');sides.push('back');}
sides.forEach(side=>{undo_stack[side]=[];redo_stack[side]=[];last_undo_obj[side]={obj:null,props:null};});var elements=cfg.editor.getObjects();var current_stack=sides[0];var undoSteps=parseInt(cfg.undoSteps,10);undoSteps=isNaN(undoSteps)?defaultUndoStepsCount:Math.abs(undoSteps);undoSteps=undoSteps>=10?undoSteps:defaultUndoStepsCount;function _getObjectConstructor(obj){if(obj instanceof FLSEditorCore.CObject){if(obj instanceof FLSEditorCore.CText){if(obj instanceof FLSEditorCore.CPathText){return FLSEditorCore.CPathText}else if(obj instanceof FLSEditorCore.CMultiLineText){return FLSEditorCore.CMultiLineText}else{return FLSEditorCore.CText;}}else if(obj instanceof FLSEditorCore.CImage){return FLSEditorCore.CImage}else if(obj instanceof FLSEditorCore.CLogoObjectGroup){return FLSEditorCore.CLogoObjectGroup}else if(obj instanceof FLSEditorCore.CDIFMLogoSVGImg){return FLSEditorCore.CDIFMLogoSVGImg}else{}}
return false;}
function clear(){while(undo_stack[current_stack].length){undo_stack[current_stack].pop();}
while(redo_stack[current_stack].length){redo_stack[current_stack].pop();}
last_undo_obj[current_stack]['obj']=null;last_undo_obj[current_stack]['props']=null;return true;}
function redoPush(obj,op){if(!obj)return false;if(redo_stack[current_stack].length>=undoSteps){redo_stack[current_stack].shift();}
var FLSobj=[];var proprts=[];if(obj instanceof FLSEditorCore.CSelectionGroup){var sobjects=obj.getElements();for(var i=0;i<sobjects.length;i++){var sobj=sobjects[i];FLSobj.push(elements.indexOf(sobj));proprts.push(sobj.getProperties());}
redo_stack[current_stack].push({FLSobj:FLSobj,properties:proprts,operation:op});}else if(obj instanceof Array){for(var j=0;j<obj.length;j++){var sobj=elements[obj[j]];proprts.push(sobj.getProperties());}
redo_stack[current_stack].push({FLSobj:obj.slice(0),properties:proprts,operation:op});}else{redo_stack[current_stack].push({FLSobj:elements.indexOf(obj),properties:obj.getProperties(),operation:op,obj:obj});}};this.undoPush=function(obj,clearRedo,op){if(!obj)return false;if(obj instanceof FLSEditorCore.CObject){if((last_undo_obj[current_stack]['obj']===obj)&&['op:none','op:translate','op:rotate','op:scale'].includes(op)){var props=obj.getProperties();var oldProps=last_undo_obj[current_stack]['props'];var _quit=true;for(var key in oldProps){var val=oldProps[key];var newVal=props[key];if(key==='tmatrix'){val.forEach((value,key)=>{if(value!=newVal[key]){_quit=false;}});}else{if(val!=newVal){_quit=false;break;}}
if(_quit===true){return false;}}}
last_undo_obj[current_stack]['obj']=obj;last_undo_obj[current_stack]['props']=obj.getProperties();}
if(typeof(clearRedo)!='boolean'){clearRedo=true;}
if(clearRedo){redo_stack[current_stack].length=0;redo_stack[current_stack]=null;redo_stack[current_stack]=[];}
if(undo_stack[current_stack].length>=undoSteps){undo_stack[current_stack].shift();}
if(typeof(op)=='undefined'){op=cfg.editor.edit_operation();}
var FLSobj=[];var proprts=[];if(obj instanceof FLSEditorCore.CSelectionGroup){var sobjects=obj.getElements();for(var i=0;i<sobjects.length;i++){var sobj=sobjects[i];FLSobj.push(elements.indexOf(sobj));proprts.push(sobj.getProperties());}
undo_stack[current_stack].push({FLSobj:FLSobj,properties:proprts,operation:op,obj:obj});}else if(obj instanceof Array){for(var j=0;j<obj.length;j++){var sobj=elements[obj[j]];proprts.push(sobj.getProperties());}
undo_stack[current_stack].push({FLSobj:obj.slice(0),properties:proprts,operation:op});}else{undo_stack[current_stack].push({FLSobj:elements.indexOf(obj),properties:obj.getProperties(),operation:op,obj:obj});}};this.undo=function(){if(undo_stack[current_stack].length){var _top=undo_stack[current_stack].pop();switch(_top.operation){case'op:delete':case'op:clear_logo_before_embed':case'op:clear_backdesign_before_embed':elements.splice(_top.FLSobj,0,_top.obj);_top.obj.setActive(false);break;}
if(_top.FLSobj instanceof Array){redoPush(_top.FLSobj,_top.operation);}else{redoPush(elements[_top.FLSobj],_top.operation);}
if(['op:insert_image','op:addtext','op:embed_logo_image_asset','op:embed_logo','op:use_frontdesign_on_back'].includes(_top.operation)){cfg.editor.removeObject(elements[_top.FLSobj]);}else{if(_top.FLSobj instanceof Array){for(var i=0;i<_top.FLSobj.length;i++){elements[_top.FLSobj[i]]['setProperties'](_top.properties[i]);}}else{elements[_top.FLSobj]['setProperties'](_top.properties);}}
return _top;}
return false;};this.redo=function(){if(redo_stack[current_stack].length){var _top=redo_stack[current_stack].pop();switch(_top.operation){case'op:addtext':case'op:insert_image':case'op:embed_logo_image_asset':case'op:embed_logo':case'op:use_frontdesign_on_back':elements.splice(_top.FLSobj,0,_top.obj);_top.obj.setActive(false);break;}
if(_top.FLSobj instanceof Array){this.undoPush(_top.FLSobj,false,_top.operation);}else{last_undo_obj[current_stack]['obj']=null;this.undoPush(elements[_top.FLSobj],false,_top.operation);}
if(_top.FLSobj instanceof Array){for(var i=0;i<_top.FLSobj.length;i++){elements[_top.FLSobj[i]]['setProperties'](_top.properties[i]);}}else{elements[_top.FLSobj]['setProperties'](_top.properties);}
if(['op:clear_logo_before_embed','op:delete','op:clear_backdesign_before_embed'].includes(_top.operation)){cfg.editor.removeObject(elements[_top.FLSobj]);}
return _top;}
return false;};this.clear=function(){return clear();};this.undoStats=function(){return{undo:undo_stack[current_stack].length,redo:redo_stack[current_stack].length};};this.hasUndo=function(){return undo_stack[current_stack].length>0;};this.hasRedo=function(){return redo_stack[current_stack].length>0;};this.currentStack=function(set){if(set&&sides.includes(set)){current_stack=set;elements=cfg.editor.getObjects();}
return current_stack;}};var FLS_Font_Family_Name_Map={'def':{'Noto Serif JP':'Serif','Noto Serif JP Black':'Serif Heavy','Noto Serif JP Bold':'Serif Bold','Noto Serif JP SemiBold':'Serif Semi','Noto Serif JP Medium':'Serif Medium','Noto Sans JP Black':'Sans Serif Heavy','Noto Sans JP Bold':'Sans Serif Bold','Noto Sans JP Regular':'Sans Serif Regular','Noto Sans JP Medium':'Sans Serif Medium','Rounded Mplus 1c':'Rounded Regular','Rounded Mplus 1c Black':'Rounded Heavy','Rounded Mplus 1c Bold':'Rounded Bold','Rounded Mplus 1c Medium':'Rounded Medium',},'jp':{'Noto Serif JP':' ','Noto Serif JP Black':' ','Noto Serif JP Bold':' ','Noto Serif JP SemiBold':' ','Noto Serif JP Medium':' ','Noto Sans JP Black':' ','Noto Sans JP Bold':' ','Noto Sans JP Regular':' ','Noto Sans JP Medium':' ','Rounded Mplus 1c':'','Rounded Mplus 1c Black':'','Rounded Mplus 1c Bold':'','Rounded Mplus 1c Medium':'',},};var FLSinLineTextEdit=function(editor,onChangeCallback,max_char_count){if(!(editor instanceof FLSEditorCore)){throw"inLineTextEdit needs a valid editor object";}
if(!(this instanceof FLSinLineTextEdit)){throw"inLineTextEdit is a constructor. (use new)";}
max_char_count=parseInt(max_char_count,10);max_char_count=(isNaN(max_char_count)||(max_char_count<=0))?30:max_char_count;onChangeCallback=(typeof onChangeCallback=='function')?onChangeCallback:function(txt){}
var container=editor.getCanvasWrapper();var xoverflow=container.style.overflowX;var zoom=editor.zoom();var editDiv=document.createElement('span');var txtObj=null;var _this=this;var KEYS={DEL:8,BACKSPACE:46,LEFT:37,RIGHT:39,HOME:36,END:35,ESC:27};var viewtop=editor.viewtopleft();var base_matrix=[1,0,0,1,viewtop.x,viewtop.y];editDiv.contentEditable=true;editDiv.style.whiteSpace='nowrap';editDiv.style.outline='0';editDiv.spellcheck=false;editDiv.style.fontSize='20px';editDiv.style.fontFamily='Helvetica';editDiv.style.color='rgb(0,0,0)';editDiv.style.position='absolute';editDiv.style.zIndex='99';editDiv.style.top=(viewtop.y)+'px';;editDiv.style.left=(viewtop.x)+'px';editDiv.innerText='';editDiv.style.transformOrigin="bottom left";editDiv.style.padding=0;editDiv.style.margin=0;editDiv.style.display='inline-block';editDiv.style.border='1px solid #000';editDiv.style.boxSizing="border-box";function _handleEditDivEvents(evt){var prevent=false;switch(evt.type){case'paste':break;case'keydown':var plain_text=editDiv.innerText;if((evt.keyCode==13)||((plain_text.length>=max_char_count)&&([KEYS.DEL,KEYS.BACKSPACE,KEYS.LEFT,KEYS.RIGHT].indexOf(evt.keyCode)==-1))){prevent=true;}
if(evt.keyCode==13){_this.hide();}
setTimeout(function(){onChangeCallback(editDiv.innerText,evt);},10);break;default:prevent:true;}
evt.stopPropagation();if(prevent){evt.preventDefault();return false;}}
editDiv.addEventListener('keydown',_handleEditDivEvents,false);editDiv.addEventListener('paste',_handleEditDivEvents,false);this.edit=function(textObject){if(textObject instanceof FLSEditorCore.CText){textObject.hide=true;if(this.inline_text_edit_keep_controls===true){editDiv.style.border='0';if((textObject instanceof FLSEditorCore.CPathText)&&textObject.has_path()){textObject.fixed(true);editDiv.style.border='1px solid #000';}}else{textObject.draw_cntrl=false;textObject.fixed(true);}
txtObj=textObject
container.style.overflowX='hidden';container.style.scrollBehaviour='unset';container.append(editDiv);this.refresh();editDiv.focus();document.execCommand('selectAll',false,null);}else{this.hide();}}
this.hide=function(){editDiv.remove();if(txtObj instanceof FLSEditorCore.CText){container.style.overflowX=xoverflow;container.style.scrollBehaviour='initial';txtObj.hide=false;txtObj.draw_cntrl=true;txtObj.fixed(false)
editDiv.innerText=editDiv.innerText.trim();if(editDiv.innerText.length){txtObj.setText(editDiv.innerText);}}
txtObj=null;}
this.refresh=function(opt){if(txtObj instanceof FLSEditorCore.CText){var mtrx=txtObj.getMatrix().slice(0);mtrx=FLSUtil.tmatrixMultiply(mtrx,[zoom,0,0,zoom,0,0]);switch(opt){case'position':break;default:editDiv.style.color=txtObj.getColor();editDiv.style.fontSize=txtObj.getFontSize()+'px';editDiv.style.fontFamily=txtObj.getFontFamily();editDiv.innerText=txtObj.getText();}
var dy=txtObj.ascent;editDiv.style.top=((viewtop.y-dy))+'px';editDiv.style.left=(viewtop.x)+'px';editDiv.style.transformOrigin='0 '+dy+'px';editDiv.style.transform="matrix("+mtrx.join(',')+")";}}
this.onWindowResize=function(){viewtop=editor.viewtopleft();base_matrix[4]=viewtop.x;base_matrix[5]=viewtop.y;editDiv.style.top=(viewtop.y)+'px';;editDiv.style.left=(viewtop.x)+'px';this.refresh();}};"use strict";var _FLSLogoEditor=function(){var fltype_param='';var TrackerName='Logo';var InitTracker=true;var enable_LMX_5715_features=false;var obj_moved=false;var inlineTextEditor=null;var use_inline_text_edit=enable_LMX_5715_features;var inline_text_edit_keep_alignment=true;var inline_text_edit_keep_controls=false;var select_logo_by_bbox=enable_LMX_5715_features;var scale_to_font_size=enable_LMX_5715_features;var intersection_select=enable_LMX_5715_features;var multiSelectObj=null;var use_multiselect=enable_LMX_5715_features;var selection_has_text=false;var multiselect_text_font_size_control_idividual=true;var editor_version=50;var loadEndTime=new Date().getTime();var view_frame_image_border=enable_LMX_5715_features;var ui_side_bar_width=view_frame_image_border?0:95;var ui_top_bar_height=view_frame_image_border?0:133;if(typeof(jQuery)=='undefined')throw"You need to include jQuery for this editor to work properly.";var productShowcase={refreshThumbs:function(){},show:function(){},hide:function(){}};var GoogleWebFonts={api_base:'//fonts.googleapis.com/css?family=',api_protocol:window.location.protocol.replace(':','')+':',fonts:{},faces:{normal:'400',italic:'400italic',bold:'700',bolditalic:'700italic'}};var svg_fonts=[];var font_load_wait_time=65;var font_loaded_check_max_iterations=150;var font_loaded_check_iteration=0;var fonts_base_url='';var needsFontpath=false;var single_font_logo=false;var replace_logo_fonts=false;var text_align='center';var mobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|PlayBook|BB10|IEMobile|Windows Phone/i.test(navigator.userAgent);var wp_mobile=/IEMobile/i.test(navigator.userAgent);var macos_safari=/Safari/i.test(navigator.userAgent)&&/Macintosh/i.test(navigator.userAgent)&&!(/Chrome/i.test(navigator.userAgent));var macos_firefox=/Firefox/i.test(navigator.userAgent)&&/Macintosh/i.test(navigator.userAgent);var ml_style_ed=null;var cardSuggestSelector=false;var editor=null;var GTrack={track:function(){},flushEvents:function(){}};var last_editor_op='op:none';var orgObjColor=null;var tempObjColor=null;var lastSelectedObj=null;var lastSelectedObjSubpath=null;var maxTextObjCnt=3;var textprops=[];var editorID='';var canvasID='';var loadingOverlayID='';var logofonts={};var logofontsorder=[];var logoCfg={};var langparam='';var reset_transforms=[];var test_fonts=true;var missing_save_fonts=[];var resources={fontsizeupdown:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAAeCAYAAACfWhZxAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABZ0RVh0Q3JlYXRpb24gVGltZQAwNy8zMS8xM6R0pKAAAAAcdEVYdFNvZnR3YXJlAEFkb2JlIEZpcmV3b3JrcyBDUzVxteM2AAACWElEQVRYhe2YPU/bUBSG3+trEouKhgz5AWUAwVRVVb9UUdSy9Ad0qNS5Y38MI1LHir1z1Qoh6EdUoarIkhcPGaOCBAgSyP3oUC61Y9f1PXawIvJuseNz/OS558ox6/V6GhXE8zzW6XQq6e1W0dSEMVZJ30qhHceppO/E9FVnYvoKQ4b2gxAAsLQwR24+Vqb9IMT2t5+XpqjgtqbfvnufuKY25eLVi+dWdayh/SDE1pcfaDSb4A7HTnsPAA3c1nTaj3Q+ENZ1rKD9IMTm513MzNyEkgoA0JhtksHLmmnbOrmh/SDEp+3vmJ6+ASll7BwVnDLTjDFoHX+QG4lpPwjxcauNWr2eADahgFNMO5xDSRkDL920H4T4sPkV3HUvl/S/YgtOMc0dDgAx8FJNG2AAkEJAQoAxhrrnxb53sP8r9tlc8z9wmum/gAa8VNNLC3OJG19b30g1/ub1S6vGAM20c2HaRArC7j28KeSJVMm5ptSxMWTqcz4EfbH6bOIqlT2naVEpmxmlTlaioxXNsFXGGNbWN2LHVp/czxwtkmmtdQKcUicr5qZ32ntozDYhlYSSCmpoldU9D0qqP+eFwOrKAyzO38qsTTINJMHLNg0kwbMixCAXMEA0bRIFL9u0SR7ws7M+ni3fywUMFDBtYmBHYdokC/z09ARPH9/NDQwUNB3NqEybpIEfHx1i5dEdK2CAYLo25eJ8IBLHR2naJAqutcbyw9vWwADAut1uJa9hW60W6/f7pN5+EIIxYHGe9j++8ExXkSJva4ASZ3qcMpami2Zi+rrkWpr+DdW1KcXy4ACAAAAAAElFTkSuQmCC',fontsizeupdown_a:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAAeCAYAAACfWhZxAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAK6wAACusBgosNWgAAABZ0RVh0Q3JlYXRpb24gVGltZQAwNy8zMS8xM6R0pKAAAAAcdEVYdFNvZnR3YXJlAEFkb2JlIEZpcmV3b3JrcyBDUzVxteM2AAAB00lEQVRYhe2XPUvDQBiAn4iFgnYwgx3iJBk6+LFUd6Ggk3/A0QoVOugvccng0E39AbqJhTrbLlLRDqFTOmSwDq1QqRAHjRK1TXLGJqF9tjvu3nsfuI/3pJWDU4sQuD3akVYPz0JZeyqMRcNmIj0uTKTHBWHpVDJBKpkIMpeRMS0yKZVMUCrmAMhrZTq9fqBJDWJNnSerpr86LGi1n7moNn3F8S1tC2cUGYBSMTcy8ayaprC54ui70U3Oq00kH3F8be/vwgAZRaZUzIW31QXKG8/SvwnbhC7uE0/Sw4Rt4iTuKu1F2CYu4q4XWVZNU6kbVOoGANvriyjyrGNMVTep6aZzzp0RcKrB4SpduTMcAlk1/UO6ppscX9aDz+6fiE1FJg16kyR8PVcgWJyMio2lBTILc59tR2HygSLPsL+5/G5uQaP15Hq0Ii1d000KW8tDL1FFnqWw9V6wPBhtTq4brnEjvb07vT55rUyj1XYde288kteu6L64V4aRlgZv4vfGI3tame7Lq6eYkZeG4eJ+hSEm0vC7uIgwCFxkFzdNRyEC/Gj/F7Z4qZjDsiwhYRCR9vl3DZpOr8+uVgYQEoaIP1mD6P7x7x6bMx0kE+lxYSI9LrwBydm3KpQtCooAAAAASUVORK5CYII=',sidebuttons:'data:image/png;base64,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',color_picker:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARkAAAA4CAYAAADJl4wwAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAK6wAACusBgosNWgAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNXG14zYAAAAWdEVYdENyZWF0aW9uIFRpbWUAMDcvMjkvMTNcoKX/AAAgAElEQVR4nO2dXbLjOq6lF2TXQ8+gn3v+Y+oeRUdk5jaJ+0D8LICU9z6n7o0oV5QydooiQUoWyU8LkCzL//+//08BQMT/AyCA2BqetaWXkVdxW7lJA5JtcD1eSp7W7W7/XX2xNn5SX8xSs0astW7XMtnzbto5lZ3aOpahZn5rs7UjW9339pTWk50fK3Uo2kCIfa60Hu3u1pnWt7ao2+UE84elD3HsBH1fH4BsA+HQ/hsbgUJsSF/lbCgupTytZ+uU/7/+z/8W7F34L7s856/fO0gEEAaOxFhZaQByrW0VCZiwndeNtlq9mNgg29u0/sDGzNxeD3Zsf+giHlvfQaOPJ7UPtNU92nqbstn9ZTjRh+rtH9t5c3zcxnkf/Fk6YM5/Yaencm4Hbe3pC9mxvGZ7y+cTvU38E0hu8v+pOmybdS5Vg4aBBQtcF4AHFHJTrmV7QefTluf49SsgsCkNAkeAwhVKwEKO4yvrLRBFmz4efOM7cADr7N6V9zHnndvhomh52upQbgdAh8cBGq5EJtnvNj1PzvMCh/qaH7q0SQd+C5Gtrb0dXt+3JeXYEx505dhUi9uV6WOtVOCcthmiFTSHJSitmT5N+ndA0G5jn/yuo0q9A5yo/oUFCVYuFxRPzfSleZYugoza9icuz/nrdwHKGgPLtTmC4rK8C8VtIgzTX5Z5PWgCC0AqjzuARN7B5gQYVjI3Y3Et1GGCXUWobGOUJ/y+LWWMejt7fdlhogtOO2TkCLSyPgLhe4V0huYb+PTPXDrbO9dBcgLPZXkTrGx+5HLFNOM8PzLaZkAU4PCHZBhkHemwuK172IYC85BHtleBTAWORp6dOVU8sPLVbAOcH7g85+/fa9IHNBwIUuCT7hEgl8S4kq5organa0FFp7X/sLYvOoquVDbI6D4GtW/rPXTkpnOaiilXcJ5UlD6pD558U+XcxrHNBNk2fpHlaPlZfpe/Q4brAKy47tURf/ayz6ZgEjgX0OCj4SY9AMwGp652TuBBSyvZ5Hae4DMspOTTB+vbc1Jbvbx3YNpI3y9qXVcvDhBOQ2e4Ta5eVBUPZFpBx/Fhy1Iy1u9ypVpJuEiByVI7ssZMuWAJyljrwHIowWwZBg6R2O7rA2S+synLdx1D5VoVyR1kNjiY3ezlvX4BWUJm/gAyJxDEBZRg0ffJ+WqfcbZPvu8bAM5qbpUZUJRVSkImYBJukiKVTA6QAhTdAeTHsasbgosvDJY5jzC4hYyXTW1lKy0FYId2o955Xw+DzMMUS2xjqZWHKmaUI/Oh1i8Gso+EzO/fAQPpUDjkuYK5HgkVt8MlqV6sTigbz4NEbEaBw8VKD3lAuEusUNTyteVzGbq9f3TNfQAHcKRimcA2NlceTWytdt19KvltXwBB5gZisR/wcUjJu4eLlH31OuwunYGyH5tdi5GwyXS6S3nVUVXK0woXMIjaVcoGiRbb03KAxZ2yOaTlVPcAm9v0nLc2K2A78dAFj4fB4wFg6KrngJkAHjqhAB4BFTs+ODg/a4nArxgEWNVU0EiAQgSYT8kYTowlKdteB5exYAICkzMqOLpJnNfzTwqa3aR+kVO9H5On3qIZdesWFQBUkEzQ2L5xhTb4gMY17iHjZdvxtG2g7htH2x1OZ7jsqiyOQwUu/Ovfw+AbUYeVNshoh892deC7SZf1AXfiiuno1um26R3gSiYg0gFwsz0nd+Kb+q3ubGmUwYAHQebpkLG16MQM0ACKpsJoHQHoD1qe8/efBIy7RRdDZ0FBH+Qq+Tgw27xwSR1vM9tzQLlbFYPkTsncqZh39jFWqSNKn9x1kMb/PgGjX9EmPgFlg4dy/q5k3EVJ10hK2VrfTGxdH7pDJdyeBqMEzhky81je4HSs63bWwUXBPODuUMLFy8CtQJUHkSJdLM9zoAoiWMxKRhtg+ICn7krG3ZmTwokykCJhaHR36QCXDTKZJwpSL4qpCzBPS186oaD6fp5oe93i1o+8w/Scv36Fagkl07YdNkrpy8aXPFjRiF/MUtnYuJMVLl8ulAKiBJkTUIBadqdk2F0KJUO2EzgGfr2etRV952BxV6jBxSdoQMMBAcmxTdsFCAaKtMmL3ojxLNTmGR534Nhh0Orxfu3Y37b5dn8P62iDi2a8JdWK5ztkHEQKqNt657laOT2Ax3esLKYTXUqdz5JwA80BBm4XSkWB0dye3kZcRWp7MqzHOmysHYfKUxXDAQPFQycuUzJq0NGDehlwxbMP5X/1JQK/8kgXCQaSlZdg8TJc4uoXGKReLE4jM+38wqSa8Rmo+9p4A5CWd72BTFfcHIu5PNEXghkBJiZUDwDH+JIcmy3f3aVJk7fbgSDF5VNlb/Okaho85rH8DJwE1zdKZoNNtpttnCCz8jSuNNMUy8NOsQEmXCpvfaWV0g6dGouZseanrbNLaZIPUiSTIFIggD3P6zVYSK/T22v763UfBoqhiqdOTAPKE4rHnFguUgOMrjPuKmbq+vu05Tl/NyXzQCiZy9IOECUYQdM23SNSMg0y8pAcT5bOp4MJIHfKBbpD5gKKaglTylP4f23RLb36z47tABmeoNsYJSXDykabLedz+XgDmZjYfBx9H6W8QmYeVE5xz45tnyGXAL0APAF1deKu0gKLhTC9k+zcKkLJRAA4037lqr3lsZsETMZ4Wsez68JKpkx6hkjWEc8b4wiKWmcHijCcDnWfBJlJMZipcwV6VaFYaxhURJd68bQrHgCYfqv9A5aMyZCScXjMlieuVh52heFxRECBSskTVzJ2wRMeGB0oHTwR89MKICADEh02DCafHbeKZrXnF4gSk8EOhqqyK3DW+MqrfVE1MbGlwYkgAzTQ1Ele7141YB1iQMWu5Q36bB0yk+r19oblQx8Ekgl4XAEOipX22Et9ruWRV2yuo2lRBwigRcnouSt5kg8F9DDxOwAcEtPsx7y1iWAyb58g02AmigDLesBuhlukmHjOaefQgTcLZC64iknI/Pnz5zyW/wWX5/j1C5e7Rg+pwHkkXC5SMtdD4O5PXMQuidhLuEYGGX0YWBRLKDzEQKM5+atbvrtBHTIMFA8weP2AnWZdjx3GolsylCpogpVJb5AI0KRL5ApmaA0Ad1fqBCYFMOZBIW1KJic9g4yPhYFR6pGtqhgsOlwOsZsGq2Fggt+E1QcUzzVBMQE8CQgTy61yyLiSyZOtfNSRl52ipdO8XRtjfeEJzrCY0yBygE1AxOy93qzQkIAKqn1AZty0vcD01Il/KMHCYKNQPOew82dQcheJIHN9MmTmr9/QS3A9010K2DyBy4K30/IijQWdy8eWA2UCmAtQ6upGAZiSweVXJtmDtgoCSAPJO8h4Ht+EmJxHQInF8rztAAy5Sw0yPkETEFJgsW5OnJVMT9dy4DUdBGcI+SSviiph0fO7i+XdVCCjBCDUzxruWmk/95dwYUXzBEy9BDwMPgkZg4d6nfx0Vcn4HSahPM9PW8QVBShweFVQyAEMeXWY1V3q6qWk/WQ0yLzGwd7bXs/DpBqpquY5p4FlIpSMQebCXF85sACx3136/fv3YUz/ay4r8PsA8DK4PHJ9jYTL9TSoPAEMi/Y/6AL2EIjKUi12jnGZY+RXHcsLSdGh4arGFclF5QUyqDEZXpdFfUbUbDH7iD1qmgRcmqvQIOPpgEuMWUmYcD4OSoYUzqD6AaAWc9kDxqRIekAZVK8FqydOrhkBJ/a579+PK+HyXODQ3KOqPxCfIJlaO0fVA7utb0qOIG911798uI/6l2MxJyXjEDpAJrZfByXDEOrtGHDkNSt4ZoXQP8JFmvZnn0UnXnMswMD2FWBZcHl4oHjOODufpWR+/15BWVYyT8F1CebT3KNrXaHlsdbXA5gikLkG8GXqRWN0e2DY4hsPAA6l4a+GsCc8GSgKUjeaF6mTknHlvKkWKg93yRelFYOlwqQoGdR0GWfkUjkQ5gE8NSgsOcaRt6498DsaEEaZ5PuzOMNPeQdJr+fHY7ahgKItghF2yNTjEWiHC8VkFAycBA/1AKGEcqJ7Mrq/FM++LHeJB8BVJ/aoE10YGj1IOwksY9Ztrx/uVIKlKKEXBYxbfVEDhE0QnX7OFNCBL1IyMpd6eWkqmKFzPV8zP9VdcsiMBYXLQIAHIHPFX+YDuOZSKdfTgCMSQFF/9MFdInI5APdWbOBM+y7UaO6Sm3R3KapqVS+bPWqQ2MHjQOGFIeYZPiMj8GsyXekPBByCTAGJK2oGS4vJODh8zCqWu8TgYptwvxpkQpHYce0xnW8go1R2rFtdv4zJIOIJwLTzlTCIL/T5RAIw8bIz7apWoyuynlSbDLiZXUhPcpe4zwkCQ5PgoWR2eAQkPP/F7tJMWEWsB2172clXc5cK4Jab5IFo9TQUoiOUTMRgDDDDVYwqBiYeBJnPcpd+/1nukkEGpmTmYymUaeCZzwUdVVmgoHiLOmzi+RcJl0kA6EMAf7nVcFeJAr8+dthdKpAhqPi2XbzSTaK8WDpktKyiTSPI+jgOSJ9MCZZQDB0ssc1KRkipmEpBu4DSZPfAb9RXBEAYKh0yGZM5KxmGRYcMf4YOI69b23PlJGuyQAF9BmQSGxx7McioP6FpXWDjpEAm/u9Kxr/X5MrlDWRcqbjbY6AIJTN2CFTIzGyDQFKVTG+D4bSXySSwqEEpoDLwZZBh5bL+FEMHhioemJ+sZH4VJYPHUhmZB+CZSgZT1t2ldYMBeEqBjNhgVGXPZ0kNVUCfdmepB3vZXQIQsPE0UCHTgVNcKGqvgyhWlGYWBWAo8NvuKLFL7xMw4ZB3YDjOUl0jWxOkhrp9c61Q1UWf9K8DIPpdKQdQqCNgg8xJDe0qx44RgKo5aqFongGJvD3dIUOKxN0ov9uEvM2tGN654WLkADBlE9+PojHSlQxPdIdGh0yHxmsWheL2UlwxbsvKv0ZVPg0y0x64U1XotEuDweZrDlw6FmTmtGDvUi5DJwYsaDxnuI8fBZnx6/f6RvVzKZgFGQOOu0sDwBDIE9BpKuda5/TSChmdCyo+OZ0jVcmIvQRL0+VxIPiM79+g7mDhNLtQrGo4XtPBAk3IpYwhd6hCprtLDBpXIENNkRAgGByuakK9aI7b1x1kYsJ3INRJX4BHcGB4pAu2K5mueKJ+a3cExNIZ89hMPhujlHYoVMg4fJQGo4Yu22My9TtM+XAfXUkSAFNrAHdOSINGgMTqiAPCFQnHZrj8BjL4elG7tdwhA4MMPNCrSxt+jYSMu0sPnXjNuRSMKZulZNb5+Cx36dfvpUj+AcjLYDME11PW+3se6/a2Tonb09cDmJdBp0NmEQWAlQGQuEIBeK07UyICdUA4BBgu7EKJnsEy2Z5mhpeHRPGdN8hEmYaCyTthO2RicgdgpKZxr2R8Uke5pnpRtTuumgFgntQJDLmZ9KlWGE4MCna9yvGQ6qlttDLskIkv9dk5zNP5zl2yiwxqINi7YeW5kpkNMgmaZZvQAbRCYDAM/GE5zve0GggMGF+uZBhGM5UMKxVKy9c41gt3ado+sdoSzb+v+Ypb1DIXYPzPXaepE3MOj4B9lpKZv38Dz6Va5Gku0hRgeEwG8ACvx2R0yoqz0ARcA8d9bL91DbvRlDEZ/YesoO/FgV9N5Xtyl7bvNplNUS0tT4HiJt1BRqgYWe1OyUxSMuc03cKOcc/p6i7lvJDdltylDR62/aLjYrsCB3KXPG+0NlnxHCFToOaQAcEl3xGT8RJXLIKpI8YI2/h4ge2fbRIyrGI8n90lg4yfOP4LJZOqpECiQMPcpTEJRDNjOlGHlIqDpECmQmhBhoK7c8DvJl068RovPHSsb2rPiYGx4DI7ZFLJfBZkfv1ez1CxkpkS4Lks5qJToE8sajxWXKZApimZNVntG9oWg1EAeNlAcciclIxPfl9OSobLGCQndfMOMpQOJfMGMhGf0UyzQpnkLnUlM8iOlQyr+9Egc1Iy+6TfIVOVDLlu2JUMu3wJsFaGbyDzrZJ5oiiZI2SG5e2Q8Yf5qpKJPaIqGU1YhJLRhEBXMoOVzCB4ZB2JugwlJci8qH3aV4MMNJXMUi8jlMxDJ645DTjrIT0HzAgl85Hu0i/oU6BjAYWVDCwWs0YkKZmnKZmZE+3SqmRicrKSEWuPX9XpYOlKpjyla4NoUzsH+65cClA0A8IMGc30KSYzO3CQ8GDIlHVTMqOlu2vkSuYEmaIuHB6aSiaAQPkFDl2hqOB1sj0omR4Deh0howQZMchkGgCmvlCVjEbP7krGVcuwWA6rmx6T8TVDg/4cEq4wSH0USLjK+eo2DTKshljJ/Bl7+wGoDpkRkBGd+DIl82WQeenA02IyTx0EmvGZSubr9+8Vg5nANQSXQcbTsZ4CsfU11i1smQsu17R8S8vkPKtrZXiYHVpMxr/JfZc3Dzbv7FkhvbOxoHGOSzFlUWHQIdGB4DZRD+c6HTKe/voRZLr7ggULnJVMhwwrmf8eyCgi4FuUDAeB/YnfeP++5U/bXmuAHlYj7eYP3WmNKpG75OsrJ/iYKxBLMLiFDIGg1LuDDIGpQuaFXSlR2wfI+N+f8cKlljenBYGrqlkqZ6WBD4PMH/hvvNi88/Vcaf6TafkTGMMEybU8n/iD5XMaChFZLwf4apDxO0dvoQHgoTme/gpkxjc212q7XPzULmgBg/zTtj17vQBEze8xmbXWDPzeQCZB0YFwr3QqKLr6uV+nS7iLvN0mJ/56F8rACtgOU3vsFl3QomRwA5mJ9cXLtQaeVv+x/1m7t5B5jSMMjjGZYU/hjgmMDhmtdeiOVflTu4Xtf5E/F4B1wL9OoKZI1t/A0Jepl/UA3gsDL0x8YeKBgQfstrb9AR/mLr1gEIF1l0MGmnAx6MiVkLFAuSmgChq5qOsv4IJAxL6b+yIB0Se/tHRXMu8gg0OeqL2l7x2IEJBhAPxpcOiwKNvIvJfDCec6avasZFYMUYv9pDbWFPwGJrQ+geIEkeJtcD4velqrB7ByIPgaA/mioCuekRIL/EZgTblB+4TxTAyvgVQyAwkZDvx2yCjwejWw6EFpJGQysPuq9h44jjQaQFKdFMiUB++0QMgfzFNMrKdgVqzFt6a5SAvbEy+sW9kvjHj912crGThUZFMvK60Q6ycZBh5UyEByLq/4rikZBZ6PVEwFMh0gJQ/3SgZ6BogD68nbIBvafuwgqJDRAqCwxa5SXAEpEj7a2s52NNpIJUM22OHS3aWuZHq5sm1sa3GB3gV+K5gsoB/ukk+WgfVmvLFOKEEmbgSof61gLVXJMKj8dmbc1kS+tCjfxrf/cuWVgJlzf26Fnnmpd38ob8wl0W/tG2RY2egrtxto1CATSsahQrGWpWCWUnGYPHTiS4cpmPWdJjEl81mQUakXd93X7jot5SLVXRrWxa5ikHHdSy3tfFDg9ZVtl1heQAM5dngM9d956qC4yxt0QEXtoECmq5MvH09aXZiqRA6Q8bxugxNkEkhfE3UfB8gwAJTaXOXseJD9se7hZVuHuspptYhKbPd3wZD7pKk8VuxkhLsUf5pP+vrfHpPxOI8rGFIzehgofFfH3SW/1Xx4tiWvFqYuhpqS6TZcHztg5gRYyRTQrC9Iuru03oY3kK99GKZlhrnPy01yqPi7ZOJFVnZGPspd+oKuoKySCFCsDzbN3dGlYkRM0QzBY+oKBLc4TEBGl4K5BLjsyV9R4GHthZLpLtKd+zOw25S00nhTVDi9sTEaFkXQIFNhwXeNtLhMS5FUJcPuz7CJmiDJu0svtvH2vD6qy5MgULzgMOhfgkxAdZjUfCUItS9Zon6toL4pz0pKbGZ1EsdkUrr4w3crQ9Xr+NEMrGckLuxKxl/x6WqGf5myxWR88rOSYRgUgCCgFN9dGuNgd6hTVIyakqlwYSWjOuDvj1GPx7izpANDB14OFg/0mrIROGBGQOajlMwXVjiuKxkHT4BmronqsZnnXES55gKJA4eVjEDSXcJq+3Fyl8LlwQ0QQHKol51ARW3dQQYgn45AAoeFZjykQIahIaRsNCEDg4zZsfqpXxvQDTI9JtNBUSFzBom2ct3aqu7SFrMBGlz6epWmuzSXO+CAoPhLPjfFMRkx94o/gb+S80I5WvWOcjXDV5tDTCbUx0nJdOh4R5KdQ4Zt+MuS0TmkWKZC5yttCDARk3GFp4oVbaEXWC0ds5SMgedlKoaDvmJ5wMdBRhcMwPNWtztNYresRXS9zGo4ULyuJmRAwEKuQ8nMtQ8txpQ+QeMOMuh2nGeQeWsD4KHb5PYYyZqwGZRleFTo2K1vVzfo5XWbXaKYB0glc6c6+G5PfNcoysnO84Gicng7/gIgWrYR100zNGUi8O8UsQoRSCgZs4U1BkBQb2H7T6gIQ0Xnql/cogUg4StCfKnyEJNxALRvRcs7yBTgHCDzto61r6MCJlSNvbqzKZyMzyyXaYFG4V+I9PQrIGOv5cQE8GHu0h9JOGSXSaobdIVjc1fNhZqmYCg+I9GeWlqCE9fDXDFIdWv65D+pmw6iYn8oZyVztx87MHZtVDO2opQ/2vYJIK/Jk/tQh1UEPZcyZqqdVB5ajsHdlWgf2X6oEzR1AmpPs16qFNoHKowYOO6erXxB/CJBKBhXGKPepbJEvuvXMy/7hA4Zf/AuXSKGzOn3trdObc++MAj0qEAQdeJVDpPgpM1e6QrQ1Mp6WtkByj2k9rmn/e//FEPsawMy1kuqoHiJPaQnChH7YqaUXgPwaUpGac6agnF3aQHEQDENHiK4TM0ICCxoXf9INhQ4XbpUkQJnoAC3INkg0tPYQfX4pk0fnzERtbgva4LJVs6KhLc3twq7TYeXIuG0XtHoQ6q+0zeHbE76gAz2l1blMNfcH5CBX6/XQRX7ehOTCXdpBXbXy778+0m55GsmLzp6Rf31AVsXJWPgUk/XP906XSpEXMmoKxkq65CJjmxw0rTXomLI3tJLyRCcCoQ8FmOwiQDwcpmG3UF6kVpZIQZTLmo9EfGvT4MM1rBY82/FYQDdYzM28q4LkLkCv+BgL6kfwOHiCmaNTNH1iyryOAR++4Vpi5/cAOIIG0oP3j7sxwK/qUbWRHK3Z7sD04BTypWCuWDFwkqCX7+Z+3j1fRVI3EGGjqvla69fPsNN2wrCQG2nbivy9ZeuaDzwu1wqB02sddSc+GVJh88BOrgoTtP+1EdZjLYKhoCMd8C8SRtEAhqsgBImQrZbfEZ1KaAGllA5QABigTx/EsUjMpfmnaTLYjIS0GHcf6K7BCV3xp7HVKmqZi4FI4C9g7QqmPIYio1GUeC6NFWRpmvlz9y8hUwBCQGmlwEJnpML9aCyOyhdFQiK9X6XDoMODT3kcezmXGd3lyI+09vFDo2Ag23ni8QZGOXmMnpMJoarA6PZ5b60gKg+J2Ot6DBV4YHd5i556/H7S9ayMjQm1qXOf5FyZFmoG44aXoBuHVoh4vGZCMyegAMUpaOKu18r0AalrmTiKd8GGNg88q9aRPDXHrbzN+H5rxKsC/6MtY8ERbpcwMcpmYRJPL+ipGCmCVOLu4i7SdOgEyqIIAObwxfiDhXmUjAPWfkyKfBbAIF7ZXL91J7yOnSOkGEVsbqR7wzlhKzbdfLWB/Zy4p6Bw229g0xVGQQPm/Rpx2CRcgy7GuFXfQtBwf7XLCNarHJdJ1Hs+opQNH5ys3sWTDxI6zfbF5ykKJkFFWG4hJKZViY1v3Ym0l3yv6pkhMHAnVDcJQJHUzvlZ27ZPpROU0dF0WCdI/Xb2QYOS/uDeev3ru2hOwcOGDh+/j4MMn/AHq7FSnQHj8eeBOsrAg9Tv2W+GlhizWm1524gkEvXN73fKQy0PHaPvlMm+Em9CpnuSvjdnjXJ+TZvi1s0eGSMpAKG173OgpqWfa3TTQ+/IYHwzj3qYOGYDMPjDK5214n2P2n/6wuR/M3oYfzxVzX4//lLkflmu4n8LWx+wtKBw8E3D/xKy2c3iQYKA2AQPOJE9zzsZYMh1GFys1Z/KVWDS8RrgIzJ5I+7+QvCRyiXdaZLL7gCakrmo9ylL+ia+Iq4dQ2VSKerQ4rG1ChwmOd6TsNgE99tmsAtUP4OZO7yvoXTar8DZWhOzA6TW2Agb0HHxHxj3wG02ZAdw+OvQOZt3j9RJ/AUEKgP4NF3sm21oJFIW9BRhkdRNwwlvtfpttsVpU78USe7UvoEmby7dIITuUtx0jtIuqtEAKK1w4J/C3uYcrn8ElBUSyIGn+suCV3U8412fncp5+LqUL8lfTFk9PBHSgaC/LlbZNlpnJQ05103Nnf2QUQ/QMs8KRlpMQu1B+2wQ+H00yM84Usg9huwcPk42bf29+28/RzxEgV8imcdukuEZXRyl7TXK2VWTpBZNMkJELBxvkBiUizlokA8L1MDvKtei7tE+Jwkp63XPg6Q8ZPXYFHcnQ4ZhkiHTEBor1MgNO2MlrqIfQdgtCqZCS1KJmNdfpZZyawt4MMg80fXlxfvlYyrDuRtbKW17i5WKJdJtjaeLgKQio3GkyIp+Xq2uQUOtXHd2VcbnuAKfv6kgQEn8KwJuQBTXZyj0jjAJi6Sdrh3kEHb5pgMIv8Ah9IWB3hrLMfzgVZG7S0g+ORf9XjJXytQ6wAnk9+eTjdJizox2PQgb7nCuG0ZICiQ6UomPsAZAhU8kzon/1IJoe5n2hnpbhJyH0qQmWq/aw0HjIaS4TMeQMK03fqdqLV8mLtEQpcB4ekpEaiFIALA12x2njaYyJVwkYvy1J6TiQix7TjSOKR/ABkcyoE3kOE030VxVVMn5jGQegDPT+xKu3Z4qYAYUhyU3Sc9IAVG8DTZgT5T1j2ABQkqAG0/vkiWKm9XQylHYAPCICOhUAQ1oCvwF1FJdNDdczHrJWi3SmaDScLgCJlQOkAJ+G72DVje6dCs18vj4pvgcYCkslkAWcN8gaf35EcrmfUAkOzzz6EBUjcAMAG5FNeUBY6Zt73dTYLVkctcLFdIHrhkD0IAAAYlSURBVPidinjHr+80dn7Ka/lHuNy0dQcWBo/wxDfxb7ewzTLgAZCLonWCer0NKDfgKJPdIaPrINe+d/cFytsdOnUfONlZZrhO3L627cP+EG2sIZ8nlJTNpmQA2BOxPSZT1MkprbzNNtGR1Il3kEEtK9uoyoODugClyTZOotJJm2lDQHHbBAvgry6dhvilUKJ3Sg9wD/rZAz4MMn9AEACpEtActdgMxPPXDUwoatxFSclIrsXGSdxtEtC9buT65C5F2Z19q/fTuh0yPJliwi/zCowWw/iuHva2YyjpXu9+wq+tqmzkxl5rXZWtrazDqufsLu2fxQGRZQsGXkuoxhoQ/qsFZ2VSQaKcf4RMvks6O5Qhg3R7SE3kxGfQrLVGutY7p1seKGZzqLeSDhqYG+TPxDTlousMZmA4Xpqx3jFjn/zD3KWmZOzkiF3Fcu6bYpl+CzrtAygEGwjSVeK1Jnh8AB8nf88/goLXb8p/YBMTzceo8gS7BwsoHeqZtu/stv3hDmqZB8oPu0P7QLfRVle24wTbIe1OsFt3lfxJ3QYbKCIOA0U+Gbzy8ysDB3DQy67WcqGqFv4Dtk7u6iQUBbBNfj4hXgZUBXSy2eqvPG1xGF77/EmXZ2FyqiuZPE63yftwq3y9+OJD3aUvAIvEKyNcH6wZI9Z/oWTsIhXz3n+FYGoqFg8UO1gk667YjkQebP9l7ACHcfQNZO5sS/k3kKEJPCndyzYAqIEIfsX6znZvlyHmdqEsyJ7ruXUAwQrvYePHUAF6brtCp5b5LwrwSXTdI8jvG6U7pAGfrkhYTp4Uy553O1BOrpGdTL2DS98uZTsoflav5uW4SFXjsICuW9devt7rZOFxs1uPK2rc3Ac+DDJ/Yoiu/4tqAXWhvT8GonFn2Ps7IKJ1uwMm1M12MdL3gAHuAXHM0z1vs682++QX2u5uCvbJTNv96o9DPtfp9fGmDdyW62aXbR1AQp8NeqhjJyb2qX1ffGIVqWwcDDYYbCDoFmsBbVd43IPlm04l96UE1AgWcfKO+V7WytEh1dqCXTxv95OQmVTHC0eUaTiTHh6PbV1n1p91/ix3qcy1HMZCqQUPrbAwI6H+dgWTdmpryToXIOFj3cClb3fAfJvWvewb++x2G+haJ+0GCPuvT9x3dgUGSvu6q+eDO7bvYXECRWmn2MgbW5oDVMp2eQInUn0kVCSUjlBei7sod0xN77ch8lcO3nZoB0cDxZHgli93AOr1tjbu6lV7aWCJGwXQcM1d73HZZXU5kgV8mJL5ogMPoMQW1okS6lIF/CdnAQcGCngSPgYXussjPNZOMDhts+1PoLRtv4EZpXli98mXE0/OYzUGCOe1drTVjwF3qHM4hp7u9nd2u61SmXxbZz/GBEoC4EZxbD/Y9k6V7Hl6a8vLDWR6Hn+Q9qH0m3oS5XRm3u3PV5pnzMcWv0VnvSCDtJ961IqfIPL0x0LGFjs5pfs0BUeCRJay8DIgAdLGw225WKd9B4mSd4DMt3V6+X0b21gstYTKdC//Fiw/nbxUdqynQLeLdE60H0GjpU7H9H5fFTSrzNKKkv8OLvcK5bs19u2N/trK+sk+lN/ASLvdcX+9rHUGUlFOaD1zLU+AeCtCRznwYe7SHz8Rxo4YP7HkVw0icQAIcMgTG0LCRnXzCImt7AYOf6mNd3n1yk57zNLDpN/t8AM7JbvTvlq9nnFrfwbQ6di6evm23rZNA0W3TjeLnyiVu/Se158qPnbsHSm1FbaJX653P623kfhkp1v1AInmJ0tcG8K1ggXYtz9TyfjSBYZSRocRL65ygMMYsZP3l+Hyk/LT1Pj77Wtrr4+zuz3uefItII5guIHUd/v/a3Waerk9zvOJqrX/Pjj6dgf9yvzRVeLmIN91XJ39tehdx72B1WGXgAv/dIncbPvUcS2tZ79rxU9bnn8OR3240O9Lz5Obrv876uO75Z8903+h/mms3tr9tL0fGPy0vb9zDD+3P1t8n/tXwfCO+v+N0+oOMm/t3hT+8IQ3pG94JoFpq9rwT6/N/6rL83VX8ncul39ravy7Lv++56IO9H/fz/k/vWhb/7su1/cm/1n+s/xn+c/y95f/AqlqjJ2qIKuYAAAAAElFTkSuQmCC',color_picker2:'data:image/png;base64,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',bottom_butns_icons:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEUAAAASCAYAAAANBhNmAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNXG14zYAAAAWdEVYdENyZWF0aW9uIFRpbWUAMDMvMzAvMTUB5ELjAAAC2UlEQVRYhb2YS0hUURzGP8esTJM0Mgp6U4TQw6DAhRUFRVSLFtqDtkHopkWLoKKy3PSANi4CN0HUpqCIVkEuCnrSA4uorCyoMJVqtIeW/locb14P58yMc+/0wR/m3vM/3/nud96TB8iBcklbJFUMPXdIuiqp1ZUcAdWSmiX1S9op6UnM/JmgUNJlSUslNUhqEhCOYuAo8BroYxgDQAdwDlhk1ck2yoFXoTaeArNj4s40xgAXQxo6gV3hhJnAS9LjD7A9BkE1Du4PwIL/ZMhY4LpDQzJIKAKeORLeAW3AL0fZyoiiFgKDDt5PQEWODSkEWhxtA/ybPo1WwQ1gOWZ45QEzgONWzhuM21HE7fAI+wwszpEhRcAtT7uNgATMAd6HCh4A+R7CYxbJthhE1uIeMd3AspgNKQHueAw5GeQJOIBZJwKsSkGaj5lSAc7GJNa1vgB8BVbE1EYppsNTGhKYcilU2AVMTEN+IZTfEpNg4Z9KPZipHIV7MvDYw3/azk9IGgzt2XkZ7OvhnEFv1uhxXtJGSb3W+2JJJyJy10taYr1D0mFJe+zkhKSHkgaGnsskVaYgT0iqCj23ZavSg6SMWFe7UeCr3+N8C8xi5DpxFyjwDMOGUN4AsCbG6bMJ+O0Y3n1E3/6n4j+DHbHzgx+HrMR7QDUwDkgAc4EzVk4vMC8mQ9ZjTLbxA1gbUxvTgOceYw66TBmPeyH6iBlFrh4EaI/BmA2MvFIE+I7pmLhGooApQGs6Y+wV+qanQiq0Y64I2YjczMjjQIAkUBWDCa4oAx55vmUflinCnF73D32ojW9AE+bCaKMTc+odjbj5QL+D6wvxnU18UQrc9xhzylepANNTNcBWYB1mJAXley2iK8CkUQqrdQjqBipzbEgQJcBth4ZkFNLdmHnfnGX96cDbkJgX5P4iaMcE4BrD14wuoC4qaT3+7TuTWA38xPxXk6sLYLooZPg+VAfoL0roVNqLchpWAAAAAElFTkSuQmCC',image_border_canvasbgimg:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAUElEQVRIx+3MUQ2EMBRFwXORUQJ6FiV4wh2EnMromugXeSNgog7gba1tTKK+wLokMcnJREnOJFJKKaV8mHqrv5ln7/1QnwXYgWtmPsa4gO0PmiIc6OfFtiYAAAAASUVORK5CYII=',image_border_fsupdown:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAhCAYAAAAPm1F2AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAABsSURBVDiN7ZDBCYAwFEMT6Ua6hD24Rdbw4Bqdwosu4U7x2gpCFQQF3zEJ4f8A34OShtpwIDlXhwG0t276+XkfPAqSepKL7ZhSWnOvudL8XJiS+kIgOwATgNH2lnuB5HJSNJHl/8F2rG3+4nQ7CCwigoZNc0QAAAAASUVORK5CYII=',image_border_add_text:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAqSURBVCiRY2DAAdLS0v6npaX9xyXPhEuCEBgJGhnxhRxNbMQJRuORAo0AkGILDZPgBNIAAAAASUVORK5CYII=',image_border_pallete:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAuCAYAAAAldkmBAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAK6SURBVEiJ7ZTPSxRhGMc/z2wEtqumh4joUpcEOxRIER5ShMKjlUmXitRxpCI2pK51CIKEvaX7Xiq6VEa/IOqmRBIe1ltSf0EUZK3sJgTzPh3aWcbdmdmKiA5+T7PP+30++7zf952B/00SPHie162qF5ubm09OTk6Wk5qy2WxTuVy+A0wZY2YBnGDRWntBVQ8Vi8V72Wy2KQlSKpUeAP3AeFCvgtLp9ClgVkR6SqXS44mJiXTMJPdFpEdV54HTdVsLG4FeVZ1vbW09Gmyzdk1EjhhjvkWC4mC+79skSCQonENlC3MAwXMmkzmey+VWa3siQbWTAcRNEsiJKsappaUl9o//2tbqJqo9YhEZymQyx2lwNRKPP5xJ0tVYA2p0TxrBqlurvDu9lRwGok4nl8utptPpIVWdE5HulZWVW3UZOY5zE3gRF2YYVsnsRaVnXeta1z9U3RdycHAw1dbWNiQix1T1ANAOWOATsCAiz5aXlx/MzMx8jwV5nrfXWnsX6ASWgK0VUKCgVhaR8/l8/mmwUP2MjI2N9VlrXwGdqnrWGNMJ7ATeA9TUvqnqk9HR0etrQOPj47tU9SGQAUilUg8BjDFFEXkZVxORy67rXqqCfN/PA5sDuu/7JwCGh4fbVbU/rlbR1ZGRkR3ieV6PtXa2JoN24B2wDWgJNYVrYe81x1p7LCKD90BHDYSgFuE97ADdcRnEKcK73amMl5RBnSK8Kq7rfgS2RGTQSFWvqj7dAHwOgTp+ARAo8NpUKnXDAd78RnOtfODc9PT0vAM8+gPAF+C54zgHjTFT8PNdE9d13wD7ExrLQJ8xZiHO4AAqImeAYpxJVd8mQQIQ+Xx+CRgAvkaZRGSP53m7G4IAjDGzIrIPeBXh26iqg0mgVPhHoVBYLhQKt7u6ul4Dq8AmYCPwxVp7ZXFx8UMc6AfJvLVIsqek8AAAAABJRU5ErkJggg==',image_border_side_icons:'data:image/png;base64,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',image_border_fn_arrow:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAICAYAAAAm06XyAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAM6wAADOsB5dZE0gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAADxSURBVBiVfc1PSsNAFMfx70T0DkFERNzMHQpJwaXoxoBC6x+QLHKJCZNLBGyhUBGr4A003sCFILgQEXQO4NIZxs0UQo2+5Xvv8/sJgKqq1q21E+BUKfXKP1PX9bIx5kIIcRsBWGt7QA+401pv/AWVUivGmBmw773ficJyCpwBa865B631ZhcEroA94CaO46OodRyHgFXn3H07IMBZgNfAQZ7n32KxoSzLE+/9OfAB9IH3AHcDPFRKWYBfODQdAyPgE3gGtoFLKeUgyzI3/1vqwk3TPCZJ8gIMga3QPCiKwrX/OnEIeErT9A34klIOFyHAD24fWw+RjTGzAAAAAElFTkSuQmCC'};var dom_port='';if(document.location.port.length){dom_port=':'+document.location.port;}
var apiRoot=document.location.protocol.replace(':','')+'://'+(document.domain+dom_port)+'/';var _apiRoot=apiRoot;var texts_url='';var properties_url='';var apiUrl={};var uiColors={application:{backgroundColor:"#F1F2F2"},panels:{backgroundColor:"#F1F2F2",fontColor:'#666'},headerFontSize:20,headerFontColor:'#666'};var uiTexts={text_tool:{header:'Select Fonts',entered_text:'Text',select_font:'Font',size:'Size',entered_text_html5:'Text',select_font_html5:'Font'},color_tool:{'header':'Select Color','current_logo_color':'Colors in your logo','current_color':'Current Color','new_color':'New Color','advanced_colors':'Advanced Colors','popular':'Popular'},multistyle_tool:{'header':'Font Editor','description':'Highlight sections of your logo text to make further customizations.','apply':'Apply'},left_menu:{save:{label:'Save',tip:''},tips:{label:'Tips',tip:''},preview:{label:'Preview',tip:''},undo:{label:'Undo',tip:''},redo:{label:'Redo',tip:''},reset:{label:'Reset',tip:''}},menu1:'Select Color',menu2:'Select Fonts',preloaderMessage_LoadFontsList:'Loading list with fonts',preloaderMessage_LoadLogo:'Loading logo',preloaderMessage_SetFont:'Loading font',preloaderMessage_Save:'Saving logo',preloaderMessage_step1:"Building Custom Layouts",preloaderMessage_step2:"Configuring Your Font Library",preloaderMessage_step3:"Customizing Color Palette",preloaderMessage_step4:"Drawing Your Logo",preloaderMessage_step5:"Creating Your Design Studio",warn:{preview:'Please make sure your logo is the correct size and centered before you save',tips:'Anything outside of the red dashed line will be cut off when printing',suggestions:{heading:'Would You Like Matching Business Cards?',save:'No Thanks, Just Save My Logo!'},align:{heading:'Select a Logo Layout',layout:'Your Current Layout',action:'Select Layout'}},buttons:{preview:'Preview',save:'Save Logo',continue_editing:'Continue Editing',color_tool:{help:'Help',more_options:'More Options',less_options:'Less Options'},text_tool:{help:'Help',add_text_enabled:'Add Text',add_text_disabled:'Add Text',size_up:'Size Up',size_down:'Size Up'}},errors:{'errJSTitle':'Something went wrong...','errLoad':"We're really sorry!. Please try again in a few seconds and if the problem persists choose another logo!",'font_load':{title:'Something went wrong...',message:'Some of the fonts ($FONTS$) failed to load and what you see now in the editor is not representative of the final image. Please go back and change these fonts, or reload the page and try again.'},'font_non_english_chars':{title:'Something went wrong...',message:'It seems that some characters are not supported by the fonts in use. Please choose other fonts.'}},dynamic:{enter_text:'Enter Text',yes:'Yes',no:'No',ok:'OK',cancel:'Cancel',close:'Close',print_products:{},back_designs:{remove:'Remove Back of Card Design',add:'Add Back of Card Design',cancel:'Cancel'}},html5_ui:{text_label:{"label":"Text","tip":""},font_label:{"label":"Font","tip":""},current_color:{"label":"Current Color","tip":""},new_color:{"label":"New Color","tip":""},used_colors:{"label":"Colors in your logo","tip":""},enter_text:{"label":"Enter Text","tip":""}},html5_buttons:{apply_color:{"label":"Apply Color","tip":""}},kb_tip_msg:'Tip: Tap the arrow keys to better align your text',suggestions:{heading:'Would You Like Matching Business Cards?',save:'Not Right Now, Just Save My Logo!',select:'Select'},mobile_editor:{main_screen_message:'Tap on the part of your logo|you would like to edit',edit_text:'Edit Text',edit_color:'Edit Color',edit_logo_text:'Edit Logo Text',select_new_color:'Select New Color',use_current_color:'Use Current Color',tap_color_to_change:'Tap the color you would like to change',select_bc_design_subtitle:'Select A Business Card Design',font_size_slider_label:'Font Size',delete_text_warning:{title:'Warning!',message:'Are you sure you\'d like to delete this text from your logo?'},reset_logo_warning:{title:'Warning!',message:'This action will reset this logo to its original state. Would you like to reset this logo?'}}};var swatchColors=new Array(mobile?10:9);var swatchColorsIdx={};var logoColors=[];var customColorIdx=0;var currentCustomColorIdx=0;var swatches48=[0xed2024,0xba272d,0xde6426,0xc1d95b,0x968430,0x8cbd84,0x547d63,0x00585e,0xaae4ff,0x6f9fd2,0x37429b,0x633985,0x520f28,0x281102,0x86796f,0x10000,0xce0073,0xcf5352,0xe8944b,0xf2ea21,0x63ad5a,0x126a36,0x7ead88,0x0e7b96,0x2b6eb6,0x0000cc,0x2d2d72,0x8c6ba5,0x60013d,0x49240c,0xc6bdb5,0x505050,0xe281af,0xde8473,0xefbd31,0xffdf9c,0x0b8d45,0x013414,0x5aa58f,0x62a6b7,0x00425e,0x052856,0x484082,0x9b425d,0xb57387,0x925730,0xffffff,0x828283];var orgSVG=null;var leaveMessageSet=false;for(var sidx=0;sidx<swatches48.length;sidx++){swatches48[sidx]=FLSUtil.hexdec2rgb(swatches48[sidx]);}
var _this=this;var plugins=['FLSEditorGuideLines'];var use_vetting_widgets=['localhost','flslogoeditor.lcl','flslogoeditor.freelogoservices.com'].indexOf(window.location.hostname)>-1;var show_arc_text_buttons=use_vetting_widgets||['start.freelogoservices.com','dev01.freelogoservices.com','flslogoeditor.freelogoservices.com','admin.freelogoservices.com'].indexOf(window.location.hostname)>-1;var usedVettingTools={};var vettingToolsWdgts={};var logo_modes=['normal','badge','initial'];var logo_mode=logo_modes[0];var mixed_initial_badge=false;var mixed_path_logolines=[];var initial_logo_max_initials=3;var logoline_max_length=30;var two_line_badge=true;var loading=false;var loadSteps=[];var progress_bar=false;var total_steps=0;var layoutXML=null;var layout={areas:{},groups:{}};var fontPathArea={};var fontPathObj=null;var validCurTextObj=false;var apply_layout_on_update_load=false;var show_layout_suggest_delayed=false;var show_layout_suggest_delayed_executed=false;var generate_layout_delayed=false;var generate_layout_delayed_executed=false;var svg_defs={paths:{},gradients:{},shadows:{}};var text_path_templates={around_top:'M 50,100 C 22.385763,100 0,77.614237 0,50 C 0,22.385763 22.385763,0 50,0 C 77.614237,0 100,22.385763 100,50 C 100,77.614237 77.614237,100 50,100',around_bottom:'M 50,0 C 22.385763,0 0,22.385763 0,50 C 0,77.614237 22.385763,100 50,100 C 77.614237,100 100,77.614237 100,50 C 100,22.385763 77.614237,0 50,0',arc_top:'M 0,50 C 0,22.385763 22.385763,0 50,0 C 77.614237,0 100,22.385763 100,50',arc_bottom:'M 0,0 C 0,27.614237 22.385763,50 50,50 C 77.614237,50 100,27.614237 100,0'}
var arc_text_toolbar=false;var multiline_toolbar=false;var show_multiline_toolbar=false;var _fls_events_add=(typeof(window.fls_events_add)=='function')?window.fls_events_add:function(){};function _generateLayout(lyt){var layout_choices=['left-logo','right-logo','arc-logo','bottom-logo','middle-logo'];var layout_choice_text_anchors={'left-logo':'left','right-logo':'right','bottom-logo':'center','arc-logo':'center','middle-logo':'center',};if(layout_choices.indexOf(lyt)>-1){var _vs=editor.viewsize();var viewSize=[_vs.width,_vs.height];var viewframeCenterY=viewSize[1]/2;var viewframeCenterX=viewSize[0]/2;var objects=editor.getObjects();var objln=objects.length;var lr_ratio=1;var lr_ratio_found=false;var lr_center_dx=0;var t_idx=1;for(var i=0;i<objln;i++){objects[i].setMatrix([1,0,0,1,0,0]);}
switch(lyt){case'left-logo':case'right-logo':var corners=[];var lcorners=[];if(lr_ratio_found===false){objects[0].objCenter(corners);var lw=corners[1]['x']-corners[0]['x'];objects[1].objCenter(corners);var tw=corners[1]['x']-corners[0]['x'];if(objln>2){objects[2].objCenter(corners);var tw2=corners[1]['x']-corners[0]['x'];if(tw2>tw){tw=tw2;t_idx=2;}}
if((tw+lw)>viewSize[0]){var wttl=tw+lw;var dif=wttl-(viewSize[0]-20);lr_ratio=1-(dif/wttl);}
lr_ratio_found==true;}
if(lyt=='left-logo'){var lcenter=objects[0].objCenter(lcorners);for(var i=0;i<objln;i++){objects[i].scaleUniform(lr_ratio);var center=objects[i].objCenter(corners);if(i==0){objects[i].translate((-corners[0]['x'])/lr_ratio,(viewframeCenterY-center.y)/lr_ratio);lcenter=objects[0].objCenter(lcorners);}else if(i==1){if(objln>2){objects[i].translate((-corners[0]['x']+lcorners[1]['x'])/lr_ratio,(lcenter.y-corners[1]['y'])/lr_ratio);}else{objects[i].translate((-corners[0]['x']+lcorners[1]['x'])/lr_ratio,(viewframeCenterY-center.y)/lr_ratio);}}else{objects[i].translate((-corners[0]['x']+lcorners[1]['x'])/lr_ratio,(lcenter.y-corners[0]['y'])/lr_ratio);}}
objects[t_idx].objCenter(corners);lr_center_dx=(viewSize[0]-corners[1]['x'])/2;}else{var lcenter=objects[0].objCenter(lcorners);for(var i=0;i<objln;i++){objects[i].scaleUniform(lr_ratio);var center=objects[i].objCenter(corners);if(i==0){objects[i].translate((viewSize[0]-corners[1]['x'])/lr_ratio,(viewframeCenterY-center.y)/lr_ratio);lcenter=objects[0].objCenter(lcorners);}else if(i==1){if(objln>2){objects[i].translate((-corners[1]['x']+lcorners[0]['x'])/lr_ratio,(lcenter.y-corners[1]['y'])/lr_ratio);}else{objects[i].translate((-corners[1]['x']+lcorners[0]['x'])/lr_ratio,(viewframeCenterY-center.y)/lr_ratio);}}else{objects[i].translate((-corners[1]['x']+lcorners[0]['x'])/lr_ratio,(lcenter.y-corners[0]['y'])/lr_ratio);}}
objects[t_idx].objCenter(corners);lr_center_dx=-corners[0]['x']/2;}
for(var i=0;i<objln;i++){objects[i].translateX(lr_center_dx);}
break;case'bottom-logo':var ref_tl_y=0;var corners=[];var center=objects[1].objCenter(corners);objects[1].translate(viewframeCenterX-center.x,ref_tl_y-corners[0]['y']);if(objects.length>2){objects[1].objCenter(corners);ref_tl_y=corners[1]['y'];center=objects[2].objCenter(corners);objects[2].translate(viewframeCenterX-center.x,ref_tl_y-corners[0]['y']);objects[2].objCenter(corners);}else{objects[1].objCenter(corners);}
ref_tl_y=corners[1]['y'];center=objects[0].objCenter(corners);objects[0].translate(viewframeCenterX-center.x,ref_tl_y-corners[0]['y']);objects[0].objCenter(corners);ref_tl_y=(viewSize[1]-corners[1]['y'])/2;objects[0].translateY(ref_tl_y);objects[1].translateY(ref_tl_y);if(objln>2){objects[2].translateY(ref_tl_y);}
break;case'middle-logo':var center=objects[0].objCenter();objects[0].translate(viewframeCenterX-center.x,viewframeCenterY-center.y);var corners=[];objects[0].objCenter(corners);var ref_tl_y=corners[0]['y'];center=objects[1].objCenter(corners);objects[1].translate(viewframeCenterX-center.x,ref_tl_y-corners[1]['y']);if(objects.length>2){objects[0].objCenter(corners);ref_tl_y=corners[1]['y'];center=objects[2].objCenter(corners);objects[2].translate(viewframeCenterX-center.x,ref_tl_y-corners[0]['y']);}
var y_min=0,y_max=0;var ordered_obj_arr=[];for(var oi=0;oi<objects.length;oi++){objects[oi].objCenter(corners);ordered_obj_arr.push({obj:objects[oi],corners:corners.slice(0)});y_min=y_min>corners[0]['y']?corners[0]['y']:y_min;y_max=y_max<corners[1]['y']?corners[1]['y']:y_max;}
if(y_min<0||y_max>viewSize[1]){ordered_obj_arr.sort(function(a,b){return a.corners[0]['y']>=b.corners[0]['y'];});var lcontent_hght=y_max-y_min;if(lcontent_hght>viewSize[1]){var scale_factor=viewSize[1]/lcontent_hght;for(var oi=0;oi<ordered_obj_arr.length;oi++){ordered_obj_arr[oi].obj.use_pivot(true);ordered_obj_arr[oi].obj.scaleUniform(scale_factor);ordered_obj_arr[oi].obj.use_pivot(false);ordered_obj_arr[oi].obj.objCenter(corners);ordered_obj_arr[oi].corners=corners.slice(0);}
for(var oi=1;oi<ordered_obj_arr.length;oi++){var dy=ordered_obj_arr[oi-1].corners[1]['y']-ordered_obj_arr[oi].corners[0]['y'];ordered_obj_arr[oi].obj.translateY(dy);ordered_obj_arr[oi].obj.objCenter(corners);ordered_obj_arr[oi].corners=corners.slice(0);}}
y_max=ordered_obj_arr[ordered_obj_arr.length-1].corners[1]['y'];lcontent_hght=y_max-y_min;var c_dy=(viewSize[1]-lcontent_hght)/2;c_dy-=y_min;while(ordered_obj_arr.length){var oobj=ordered_obj_arr.shift();oobj.obj.translateY(c_dy);}}
break;case'arc-logo':var corners=[];var center=objects[0].objCenter();objects[0].translate(viewframeCenterX-center.x,viewframeCenterY-center.y);_this.generateTextPath('arc_top',true,objects[1])
if(objects.length>2){objects[0].objCenter(corners);ref_tl_y=corners[1]['y'];center=objects[2].objCenter(corners);objects[2].translate(viewframeCenterX-center.x,ref_tl_y-corners[0]['y']);}
var min_arctext_logo_distance=10;var arccorners=[];objects[1].objCenter(arccorners);objects[0].objCenter(corners);var arcdy=(corners[0]['y']-arccorners[1]['y']);if(arcdy>min_arctext_logo_distance){objects[1].translateY(arcdy-min_arctext_logo_distance);}
var temp_logo_group=new FLSEditorCore.CLogoObjectGroup();temp_logo_group.editor(editor);temp_logo_group.addElement(objects[0]);temp_logo_group.addElement(objects[1]);if(objects.length>2){temp_logo_group.addElement(objects[2]);}
temp_logo_group.calculateBoundingBox();var grp_size=temp_logo_group.getSize();if((grp_size.width>viewSize[0])||(grp_size.height>viewSize[1])){var gscale=Math.min(viewSize[0]/grp_size.width,viewSize[1]/grp_size.height);temp_logo_group.use_pivot(true);temp_logo_group.scaleUniform(gscale);temp_logo_group.use_pivot(false);}
var lg_center=temp_logo_group.objCenter();temp_logo_group.translate(viewframeCenterX-lg_center.x,viewframeCenterY-lg_center.y);temp_logo_group.clearElements();break;}
for(var oi=0;oi<objects.length;oi++){if((objects[oi]instanceof FLSEditorCore.CText)&&!objects[oi].has_path()){objects[oi].align_point=layout_choice_text_anchors[lyt];if((objects[oi]instanceof FLSEditorCore.CMultiLineText)&&objects[oi].multiline_on()){objects[oi].updateMeasurements();}}}
_this.replaceOrgSvg();}}
function _generateTextPath(type,keep_round,txt_obj){keep_round=typeof(keep_round)=='boolean'?keep_round:false;txt_obj=(txt_obj instanceof FLSEditorCore.CPathText)?txt_obj:lastSelectedObj;if(txt_obj instanceof FLSEditorCore.CPathText){switch(type){case'toggle_path_edit':if(txt_obj.has_path()){txt_obj.enable_path_edit(!txt_obj.enable_path_edit());}
break;case'toggle_use_path':txt_obj.use_path(!txt_obj.use_path());break;case'switch_vertical_shift':if(txt_obj.use_path()){var cur_dy=txt_obj.txt_dy();if(cur_dy||txt_obj.org_dy){txt_obj.org_dy=typeof(txt_obj.org_dy)=='undefined'?0:txt_obj.org_dy;var tmp=cur_dy;cur_dy=txt_obj.org_dy;txt_obj.org_dy=tmp;txt_obj.txt_dy(cur_dy);}}
break;default:if(txt_obj==lastSelectedObj){editor.undoPush(txt_obj);_updateUndoRedoButtons();}
var pathstr='';var text_width=(txt_obj.get_text_width());var pscale={sx:1,sy:1};var edvws=editor.viewsize();var zoom=editor.zoom();var lsize={width:120,height:120};var logo_center={x:edvws.width/2,y:edvws.height/2,};var logoscale=1;var test_h=(lsize.height*logoscale)/height_divider;var test_w=lsize.width*logoscale;logo_center.x/=zoom;logo_center.y/=zoom;if(type&&text_path_templates[type]){pathstr=text_path_templates[type];}else{type='autogen';var cx=text_width/4;pathstr='M 0,0 C '+cx+' -'+cx+' '+(3*cx)+' -'+cx+' '+text_width+' 0';}
var height_divider=['arc_top','arc_bottom','autogen'].indexOf(type)>-1?2:1;var pcommands=SVGPath2Cnvs.parse(pathstr);var path_bbox=SVGPath2Cnvs.bbox(pcommands);var path_box_size={width:path_bbox.x1-path_bbox.x0,height:path_bbox.y1-path_bbox.y0};var scale_mtrx=[1,0,0,1,0,0];var objs=editor.getObjects();for(var i=0;i<objs.length;i++){if(objs[i]instanceof FLSEditorCore.CPathGroup){if(objs[i].getPaths().length){var l_lsize=objs[i].getSize();lsize.width=l_lsize.width;lsize.height=l_lsize.height;logo_center=objs[i].objCenter();logoscale=objs[i].getScaleX();var aspect=lsize.width/lsize.height;if(keep_round||(aspect<1.2)){var r=Math.sqrt(Math.pow(lsize.width/2,2)+
Math.pow(lsize.height/2,2));lsize.width=lsize.height=Math.floor(r*2);aspect=1;}
if(aspect>1&&!keep_round){FLSUtil.tmatrixScale(scale_mtrx,aspect,1);SVGPath2Cnvs.applyMatrix(pcommands,scale_mtrx);path_bbox=SVGPath2Cnvs.bbox(pcommands);path_box_size.width=path_bbox.x1-path_bbox.x0;path_box_size.height=path_bbox.y1-path_bbox.y0;scale_mtrx=[1,0,0,1,0,0];}
test_h=(lsize.height*logoscale)/height_divider;test_w=lsize.width*logoscale;}
break;}}
if((path_box_size.width<test_w)||(path_box_size.height<test_h)){var newsize=Math.max(test_w/path_box_size.width,test_h/path_box_size.height);pscale.sx*=newsize;pscale.sy*=newsize;}
FLSUtil.tmatrixScale(scale_mtrx,pscale.sx,pscale.sy)
SVGPath2Cnvs.applyMatrix(pcommands,scale_mtrx);pscale.sx=pscale.sy=1;path_bbox=SVGPath2Cnvs.bbox(pcommands);path_box_size.width=path_bbox.x1-path_bbox.x0;path_box_size.height=path_bbox.y1-path_bbox.y0;if((test_w>path_box_size.width)||(test_h>path_box_size.height/height_divider)){var afterscale=Math.max(test_w/path_box_size.width,(test_h/height_divider)/path_box_size.height);scale_mtrx=[1,0,0,1,0,0];FLSUtil.tmatrixScale(scale_mtrx,afterscale,afterscale)
SVGPath2Cnvs.applyMatrix(pcommands,scale_mtrx);}
var path_length=SVGPath2Cnvs.pathLength(pcommands);if(text_width>path_length){var scale=text_width/path_length;pscale.sx*=scale;pscale.sy*=scale;}
scale_mtrx=[1,0,0,1,0,0];FLSUtil.tmatrixScale(scale_mtrx,pscale.sx,pscale.sy)
SVGPath2Cnvs.applyMatrix(pcommands,scale_mtrx);path_bbox=SVGPath2Cnvs.bbox(pcommands);pathstr=SVGPath2Cnvs.commandsDataStr(pcommands);txt_obj.setPathStr(pathstr);txt_obj.use_path(true);if(/bottom/.test(type)){txt_obj.txt_dy(Math.ceil(txt_obj.getFontSize()*0.75));}else{txt_obj.txt_dy(0);}
txt_obj.org_dy=0;txt_obj.setMatrix([1,0,0,1,0,0]);var ocenter={x:path_bbox.x0+((path_bbox.x1-path_bbox.x0)/2),y:path_bbox.y0+((path_bbox.y1-path_bbox.y0)/2),};switch(type){case'arc_top':case'autogen':ocenter.y+=(path_bbox.y1-path_bbox.y0)/2;break;case'arc_bottom':ocenter.y-=(path_bbox.y1-path_bbox.y0)/2;break;}
txt_obj.translate(logo_center.x-ocenter.x,logo_center.y-ocenter.y);}}
return txt_obj;}
this.generateTextPath=function(type,keep_round,txt_obj){return _generateTextPath(type,keep_round,txt_obj);};this.getTextToPath=function(txt_obj){return fontPathObj.get(txt_obj,logofonts[txt_obj.getFontFamily()],function(){console.log('callaback',arguments);},function(){console.log('ccallaback',arguments);})};var progressAnimHNDL=null;var usingFakeProgress=false;var fakeProgressAnimState={startTime:null,durationTarget:10000,msgChangeProgressStep:100/5,lastMsgIdx:0}
function apply_text_align(txt_obj,old_w){if((txt_obj instanceof FLSEditorCore.CText)&&(!txt_obj.has_path())){var new_w=txt_obj.getSize().width;var to_align=txt_obj.align_point?txt_obj.align_point:text_align;if(old_w!=new_w&&to_align!='left'){var dx=0;switch(to_align){case'center':dx=(old_w-new_w)/2;break;case'right':dx=old_w-new_w;break;}
txt_obj.translateX(dx);}}}
function displayFakeProgress(timedelta){if(!progress_bar)return false;usingFakeProgress=true;fakeProgressAnimState.startTime=fakeProgressAnimState.startTime?fakeProgressAnimState.startTime:new Date();timedelta=new Date()-fakeProgressAnimState.startTime;timedelta=(timedelta>fakeProgressAnimState.durationTarget)?fakeProgressAnimState.durationTarget:timedelta;var fakeProgress=Math.floor((timedelta/fakeProgressAnimState.durationTarget)*100);fakeProgress=fakeProgress<fakeProgressAnimState.msgChangeProgressStep?fakeProgressAnimState.msgChangeProgressStep:fakeProgress
var msg_idx=Math.floor(fakeProgress/fakeProgressAnimState.msgChangeProgressStep);if((fakeProgress<=100)&&(fakeProgressAnimState.lastMsgIdx!=msg_idx)){fakeProgressAnimState.lastMsgIdx=msg_idx;progress_bar.progress(fakeProgress,uiTexts['preloaderMessage_step'+msg_idx]);}
if(fakeProgress<100){progressAnimHNDL=requestAnimationFrame(displayFakeProgress);}}
function parseDefs(svg){var use_difmobj=false;var definitions=jQuery('defs',svg);if(definitions.length){for(var di=0;di<definitions.length;di++){var cdefs=jQuery(definitions[di]).children();for(var cdefi=0;cdefi<cdefs.length;cdefi++){var defn=cdefs[cdefi];var $defn=jQuery(defn);switch(defn.nodeName){case'path':svg_defs.paths[$defn.attr('id')]=$defn.attr('d');break;case'linearGradient':case'radialGradient':var tmp_gradient=new FLSSVGGradient($defn);if(tmp_gradient.valid()){svg_defs.gradients[$defn.attr('id')]=tmp_gradient;}
break;case'clipPath':use_difmobj=true;break;default:console.log('def node not yet supported:',defn.nodeName);}}}}
return use_difmobj;}
function _initFontPathObjOld(){if(!(fontPathObj instanceof editor.textObjToPath)){fontPathObj=new editor.textObjToPath(fonts_base_url);}}
function _initFontPathObj(){if(!(fontPathObj instanceof editor.textObjToPath)){try{fontPathObj=new editor.textObjToPath(fonts_base_url);}catch(e){fontPathObj=null;console.log(e);}}}
function _getStringdataAttributes(tn){var attr=tn.attributes;var ret={};var empty=true;for(var i in attr){if(/data\-str\-/i.test(attr[i].name)){var val=attr[i].value;empty=false;switch(attr[i].name){case'data-str-fontsize':val=parseInt(val);break;case'data-str-tmatrix':val=val.replace(/,/g,' ').replace(/\s+/g,' ').split(' ').map(Number);break;default:if(['true','false'].indexOf(val.trim().toLowerCase())>-1){val=(val.toLowerCase()=='true')}else if('undefined'==val.trim().toLowerCase()){val=false;}}
ret[attr[i].name.replace(/data\-str\-/,'')]=val;}}
return empty?false:ret;}
function execLoadSteps(canvasId){if(loadSteps.length){loading=true;var step=loadSteps.shift();if(typeof(step)=='function'){step(canvasId,execLoadSteps);return true;}}else{loading=false;}
return false;}
function _addLogoObjTextPath(textobj,pathstr,callback){var obj=editor.getObjects();for(var oi=0;oi<obj.length;oi++){if(obj[oi]instanceof FLSEditorCore.CPathGroup){var lpaths=obj[oi].getPaths();var stringpath=null;for(var li=0;li<lpaths.length;li++){if(lpaths[li]['stringdata']&&(lpaths[li]['stringdata']['lyt_name']==textobj.lyt_name)){stringpath=lpaths[li];break;}}
if(!stringpath){stringpath=new FLSEditorCore.CPath();stringpath.stringdata={};obj[oi].addPath(stringpath,true);}
stringpath.bboxpad(0);stringpath.setPathStr(pathstr);stringpath.inGroup(true);stringpath.editor(editor);stringpath.setFill(textobj.getColor());stringpath.setMatrix(textobj.getMatrix());obj[oi].calculateBoundingBox();obj[oi].hasStringPath=true;obj[oi].unlockable(true);stringpath.stringdata=textobj.getProperties();stringpath.lyt_name=textobj.lyt_name;stringpath.parentGroup=obj[oi];editor.removeObject(textobj);if(typeof(callback)=='function'){callback(stringpath);}
break;}}}
function _updateStringPathObj(newtextprops){if(!(lastSelectedObjSubpath instanceof FLSEditorCore.CPath)||!lastSelectedObjSubpath.stringdata){return false;}
if((typeof(newtextprops)=='object')&&(['initial','badge'].indexOf(logo_mode)>-1)&&fontPathArea[lastSelectedObjSubpath.lyt_name]){var update=false;for(var what in newtextprops){switch(what){case'text':if((typeof(newtextprops.text)=='string')&&newtextprops.text.length){switch(logo_mode){case'initial':var use_string=newtextprops.text;if(['init_1','init_1w2'].indexOf(lastSelectedObjSubpath.lyt_name)>-1){use_string=newtextprops.text.substring(0,initial_logo_max_initials);}
update=update||(lastSelectedObjSubpath.stringdata.text!=use_string);lastSelectedObjSubpath.stringdata.text=use_string;break;default:update=update||(lastSelectedObjSubpath.stringdata.text!=newtextprops.text);lastSelectedObjSubpath.stringdata.text=newtextprops.text;}}
break;case'font_family':update=update||(lastSelectedObjSubpath.stringdata.font_family!=newtextprops.font_family);lastSelectedObjSubpath.stringdata.font_family=newtextprops.font_family;break;case'fontsize':update=update||(lastSelectedObjSubpath.stringdata.fontsize!=newtextprops.fontsize);lastSelectedObjSubpath.stringdata.fontsize=newtextprops.fontsize;break;case'line_spaceing':update=update||(lastSelectedObjSubpath.stringdata.line_spaceing!=newtextprops.line_spaceing);lastSelectedObjSubpath.stringdata.line_spaceing=newtextprops.line_spaceing;break;}}
if(update){var TxTCls=lastSelectedObjSubpath.stringdata.multiline_on===true?FLSEditorCore.CMultiLineText:FLSEditorCore.CPathText
var to=new TxTCls();to.setProperties(lastSelectedObjSubpath.stringdata);fontPathObj.get(to,logofonts[lastSelectedObjSubpath.stringdata.font_family],function(txtobj,pathstr){var tpl_mtrx_scl=1;var tpl_mtrx_x=0;var tpl_mtrx_y=0;var tpl_mtrx_cpy=[1,0,0,1,0,0];var use_tpl_mtrx=false;var lmtrx=[1,0,0,1,0,0];lastSelectedObjSubpath.setMatrix(lmtrx);lastSelectedObjSubpath.setPathStr(pathstr);lastSelectedObjSubpath.calculateBoundingBox();var sz=lastSelectedObjSubpath.getSize();var _fontpathArea=fontPathArea[lastSelectedObjSubpath.lyt_name];var dx=0,dy=0;var zoom=editor.zoom();var scale_center=true;if(lastSelectedObjSubpath.parentGroup.tpl_matrix){tpl_mtrx_cpy=lastSelectedObjSubpath.parentGroup.tpl_matrix.slice(0);tpl_mtrx_x=tpl_mtrx_cpy[4]
tpl_mtrx_y=tpl_mtrx_cpy[5]
tpl_mtrx_scl=tpl_mtrx_cpy[0];tpl_mtrx_cpy[0]=tpl_mtrx_cpy[3]=1;use_tpl_mtrx=(tpl_mtrx_scl!=1)||(tpl_mtrx_x!=0)||(tpl_mtrx_y!=0);}
var center=lastSelectedObjSubpath.objCenter();var acenter={x:_fontpathArea.w/tpl_mtrx_scl/2,y:_fontpathArea.h/tpl_mtrx_scl/2,}
dy=acenter.y-center.y;dy+=_fontpathArea.y/tpl_mtrx_scl;switch(_fontpathArea.align){case'center':dx=acenter.x-center.x;dx+=_fontpathArea.x/tpl_mtrx_scl;break;case'left':dx=_fontpathArea.x/tpl_mtrx_scl;scale_center=false;break;}
if(use_tpl_mtrx){var d_xy={x:dx*tpl_mtrx_scl,y:dy*tpl_mtrx_scl};FLSUtil.unTransformPoint(tpl_mtrx_cpy,d_xy,true);dx=d_xy.x/tpl_mtrx_scl;dy=d_xy.y/tpl_mtrx_scl;}
FLSUtil.tmatrixTranslate(lmtrx,dx,dy);FLSUtil.tmatrixScale(lmtrx,zoom,zoom);lastSelectedObjSubpath.setMatrix(lmtrx);var tscale=Math.min(_fontpathArea.w/sz.width,_fontpathArea.h/sz.height);tscale=tscale>=1?1:tscale;if((tscale<1)||(tpl_mtrx_scl!=1)){lastSelectedObjSubpath.use_pivot(scale_center);lastSelectedObjSubpath.scaleUniform(tscale/tpl_mtrx_scl);lastSelectedObjSubpath.use_pivot(false);}
if(_fontpathArea.vAlign){var bpad=lastSelectedObjSubpath.bboxpad();sz=lastSelectedObjSubpath.getSize();var sh=(sz.height+(bpad*2));var sdy=((_fontpathArea.h/tscale)-sh)/2;switch(_fontpathArea.vAlign){case'bottom':lastSelectedObjSubpath.translateY(sdy/tpl_mtrx_scl);break;case'top':lastSelectedObjSubpath.translateY(-sdy/tpl_mtrx_scl);break;}}
lastSelectedObj.calculateBoundingBox();});}}}
function _layoutTextTypeLogo(stringpath){var objs=editor.getObjects();var zoom=editor.zoom();for(var oi=0;oi<objs.length;oi++){var area;var dx=0,dy=0;var lmtrx=[1,0,0,1,0,0];if(objs[oi]instanceof FLSEditorCore.CPathGroup){for(var ai in layout.areas){if(layout.areas[ai]['type']==stringpath['lyt_name']){area=layout.areas[ai];break;}}
if(area){fontPathArea[stringpath['lyt_name']]=area;var corners=[];objs[oi].objCenter(corners);stringpath.setMatrix(lmtrx);stringpath.calculateBoundingBox();var sz=stringpath.getSize();var tpl_mtrx_scl=1;var tpl_mtrx_x=0;var tpl_mtrx_y=0;var tpl_mtrx_cpy=[1,0,0,1,0,0];var use_tpl_mtrx=false;if(stringpath.parentGroup.tpl_matrix){tpl_mtrx_cpy=stringpath.parentGroup.tpl_matrix.slice(0);tpl_mtrx_x=tpl_mtrx_cpy[4]
tpl_mtrx_y=tpl_mtrx_cpy[5]
tpl_mtrx_scl=tpl_mtrx_cpy[0];tpl_mtrx_cpy[0]=tpl_mtrx_cpy[3]=1;use_tpl_mtrx=(tpl_mtrx_scl!=1)||(tpl_mtrx_x!=0)||(tpl_mtrx_y!=0);}
var center=stringpath.objCenter();var acenter={x:area.w/tpl_mtrx_scl/2,y:area.h/tpl_mtrx_scl/2,}
dy=acenter.y-center.y;dy+=area.y/tpl_mtrx_scl;switch(area.align){case'center':dx=acenter.x-center.x;dx+=area.x/tpl_mtrx_scl;break;case'left':dx=area.x/tpl_mtrx_scl;break;}
if(use_tpl_mtrx){var d_xy={x:dx*tpl_mtrx_scl,y:dy*tpl_mtrx_scl};FLSUtil.unTransformPoint(tpl_mtrx_cpy,d_xy,true);dx=d_xy.x/tpl_mtrx_scl;dy=d_xy.y/tpl_mtrx_scl;}
FLSUtil.tmatrixTranslate(lmtrx,dx,dy);FLSUtil.tmatrixScale(lmtrx,zoom,zoom);stringpath.setMatrix(lmtrx);var tscale=Math.min(area.w/sz.width,area.h/sz.height);tscale=tscale>=1?1:tscale;if((tscale<1)||(tpl_mtrx_scl!=1)){stringpath.use_pivot(true);stringpath.scaleUniform(tscale/tpl_mtrx_scl);stringpath.use_pivot(false);}
objs[oi].calculateBoundingBox();if(area.vAlign){var bpad=stringpath.bboxpad();sz=stringpath.getSize();var sh=(sz.height+(bpad*2));var sdy=((area.h/tscale)-sh)/2;switch(area.vAlign){case'bottom':stringpath.translateY(sdy/tpl_mtrx_scl);break;case'top':stringpath.translateY(-sdy/tpl_mtrx_scl);break;}}}
stringpath.scalable(false);stringpath.hasrotate(false);}else if(objs[oi]instanceof FLSEditorCore.CText){for(var ai in layout.areas){if(layout.areas[ai]['type']==objs[oi]['lyt_name']){area=layout.areas[ai];break;}}
if(area&&!objs[oi].has_path()){var tsz=objs[oi].getSize();var fs=objs[oi].getFontSize();var bpad=objs[oi].bboxpad()*2;var tscale=Math.min(area.w/tsz.width,area.h/tsz.height);tscale=tscale>=1?1:tscale;if(tscale<1){objs[oi].setFontSize(Math.ceil(fs*tscale));tsz=objs[oi].getSize();fs=objs[oi].getFontSize();}
switch(area.align){case'center':dx=(area.w-tsz.width)/2;dx+=area.x;dy=(area.h/2)+area.y-objs[oi].center().y;break;}
FLSUtil.tmatrixTranslate(lmtrx,dx,dy);objs[oi].setMatrix(lmtrx);objs[oi].align_point=area.align;}}}
if(show_layout_suggest_delayed&&!show_layout_suggest_delayed_executed&&logoCfg.showLogoLayouts){show_layout_suggest_delayed=false;show_layout_suggest_delayed_executed=true;productShowcase.refreshThumbs();jQuery('#'+loadingOverlayID).remove();_this.FLSLayoutSuggest(editor,editorID,uiTexts['warn']['align'],uiColors,mobile,_this);productShowcase.hide();}else{if(generate_layout_delayed&&!generate_layout_delayed_executed){generate_layout_delayed=false;generate_layout_delayed_executed=true;_generateLayout(logoCfg.generate_layout);}
productShowcase.refreshThumbs();}}
function _applyLogoLayout(){var txt_obj_to_include=[];var show_layout_suggest_delayed_org=show_layout_suggest_delayed;var generate_layout_delayed_org=generate_layout_delayed;function includeTextsInLogo(stringpath){if(stringpath){show_layout_suggest_delayed=generate_layout_delayed=false;_layoutTextTypeLogo(stringpath);}
var txtobj=txt_obj_to_include.shift();var callbackfunc=txt_obj_to_include.length?includeTextsInLogo:_layoutTextTypeLogo;show_layout_suggest_delayed=txt_obj_to_include.length?false:show_layout_suggest_delayed_org;generate_layout_delayed=txt_obj_to_include.length?false:generate_layout_delayed_org;fontPathObj.get(txtobj,logofonts[txtobj.getFontFamily()],_addLogoObjTextPath,callbackfunc);}
switch(logo_mode){case'initial':case'badge':_initFontPathObj();var obj=editor.getObjects();var lyt_name=logo_mode=='initial'?['init_1','init_1w2']:two_line_badge?['line_1','line_2']:['line_1'];var textobj0_idx=-1;var found_lyt_name=false;if(mixed_initial_badge&&mixed_path_logolines.length){for(var mx_idx=0;mx_idx<mixed_path_logolines.length;mx_idx++){if(lyt_name.indexOf(mixed_path_logolines[mx_idx])==-1){lyt_name.push(mixed_path_logolines[mx_idx]);}}}
for(var oi=0;oi<obj.length;oi++){if(obj[oi]instanceof FLSEditorCore.CText){textobj0_idx=textobj0_idx==-1?oi:textobj0_idx;if((lyt_name.indexOf(obj[oi]['lyt_name'])>-1)){found_lyt_name=true;txt_obj_to_include.push(obj[oi]);if(!obj[oi].has_path()){}else{}}else{}}}
if(txt_obj_to_include.length){includeTextsInLogo();}
if(!found_lyt_name&&(textobj0_idx>-1)){fontPathObj.get(obj[textobj0_idx],logofonts[obj[textobj0_idx].getFontFamily()],_addLogoObjTextPath,_layoutTextTypeLogo);}
break;case'normal':default:editor.centerResizeTexts(logoCfg.anchor1);}}
function _isValidTextObj(curtobj){var validobj=curtobj instanceof FLSEditorCore.CText;var istextobj=validobj;var multiline_on=(curtobj instanceof FLSEditorCore.CMultiLineText)&&curtobj.multiline_on();var line_spaceing=multiline_on?curtobj.line_spaceing():5;if(!validobj&&(['initial','badge'].indexOf(logo_mode)>-1)){validobj=(curtobj instanceof FLSEditorCore.CPathGroup)&&(lastSelectedObjSubpath instanceof FLSEditorCore.CPath)&&(typeof(lastSelectedObjSubpath.stringdata)=='object');istextobj=false;multiline_on=validobj?(lastSelectedObjSubpath.stringdata.multiline_on?true:false):false;line_spaceing=validobj?(lastSelectedObjSubpath.stringdata.line_spaceing?lastSelectedObjSubpath.stringdata.line_spaceing:5):5;}
return{valid:validobj,istextobj:istextobj,text:istextobj?curtobj.getText():(validobj?lastSelectedObjSubpath.stringdata.text:''),font_family:istextobj?curtobj.getFontFamily():(validobj?lastSelectedObjSubpath.stringdata.font_family:''),fontsize:istextobj?curtobj.getFontSize():(validobj?lastSelectedObjSubpath.stringdata.fontsize:0),color:istextobj?curtobj.getColor():(validobj?lastSelectedObjSubpath.stringdata.color:''),default_text:istextobj?curtobj.default_text():(validobj?lastSelectedObjSubpath.stringdata.default_text:''),lyt_name:istextobj?curtobj.lyt_name:(validobj?lastSelectedObjSubpath.lyt_name:''),multiline_on:multiline_on,line_spaceing:line_spaceing};}
function AddGoogleFonts(hardcoded){hardcoded=typeof(hardcoded)==='boolean'?harcoded:false;var api_link=window.location.protocol.replace(':','')+':'+GoogleWebFonts.api_base;var cnt=0;for(var fontfamily in logofonts){var thisfont=logofonts[fontfamily];if(thisfont.api==='google'){thisfont.img=false;var ff=fontfamily.replace(/\s/g,'+');var faces=[400];if(thisfont.bold_src)faces.push(GoogleWebFonts.faces.bold);if(thisfont.italic_src)faces.push(GoogleWebFonts.faces.italic);if(thisfont.bolditalic_src)faces.push(GoogleWebFonts.faces.bolditalic);ff+=faces.length>1?':'+faces.join(','):'';ff+='&subset=latin,latin-ext';var gf_style=document.createElement('link');gf_style.type='text/css';gf_style.rel='stylesheet';gf_style.href=api_link+ff;jQuery(gf_style).appendTo('head');cnt+=faces.length;}}
if(hardcoded){if(['printingnow.com','freelogservices.com','logomix.com'].indexOf(window.location.hostname)>-1)return cnt;for(var fontfamily in GoogleWebFonts.fonts){var fnt_name=fontfamily.replace(/\s/g,'_');logofonts[fontfamily]={ttf_src:'google_font_'+fnt_name,name:fnt_name,img:false,minSize:7,maxSize:70};cnt++;var gf_style=document.createElement('link');gf_style.type='text/css';gf_style.rel='stylesheet';gf_style.href=api_link+GoogleWebFonts.fonts[fontfamily];jQuery(gf_style).appendTo('head');}}
return cnt;}
function SortFontByName(){while(logofontsorder.lenght){logofontsorder.shift();}
for(var fontname in logofonts){logofontsorder.push(fontname);}
logofontsorder.sort(function(a,b){var _a=a.toLowerCase();var _b=b.toLowerCase();return _a<_b?-1:1;});}
function InitVettingToolsWidgets(){for(var vi in usedVettingTools){if(usedVettingTools[vi]['active']){if(usedVettingTools[vi].extra&&usedVettingTools[vi].extra.fonts){usedVettingTools[vi].extra.fonts=logofonts;}
var cntianer=usedVettingTools[vi]['container']?usedVettingTools[vi]['container']:editor.getCanvasWrapper();vettingToolsWdgts[vi]=new usedVettingTools[vi].construct(editor,usedVettingTools[vi].active_obj_types,cntianer,usedVettingTools[vi].extra);if(vi=='fontstyle_wgt'){vettingToolsWdgts[vi].on_control_callback=apply_text_align;}}}}
function UpdateVettingToolsWidgets(which_wgt){if(which_wgt){if(vettingToolsWdgts[which_wgt]){vettingToolsWdgts[which_wgt].update();}}else{for(var vi in vettingToolsWdgts){vettingToolsWdgts[vi].update();}}}
function _initFontCheckFunctionality(){_initFontPathObj();if(fontPathObj){var objs=editor.getObjects();for(var i=0;i<objs.length;i++){if((objs[i]instanceof FLSEditorCore.CText)&&FLSUtil.getExtendedCharsFromString(objs[i].getText())){var ff=objs[i].getFontFamily();fontPathObj.initFontProd(objs[i],logofonts[ff],function(){});}}}}
function _handleLoadComplete(){if(InitTracker===true){InitTracker=false;setTimeout(function(){if(typeof(logoCfg.report)=='object'){if(typeof(logoCfg.report.editorName)=='string'){logoCfg.report.editorName=logoCfg.report.editorName.trim();TrackerName=logoCfg.report.editorName.length?logoCfg.report.editorName:TrackerName;}
logoCfg.report.product='logo'
logoCfg.report.product_id=logoCfg.logoID;logoCfg.report.mode=logoCfg.act==='update'?'update':'create';}
GTrack=new FLSTracker(logoCfg.track_gaid,TrackerName,logoCfg.ga_callback,logoCfg.report);},0);}
_initFontCheckFunctionality();usingFakeProgress=false;cancelAnimationFrame(progressAnimHNDL);loadProgress('100%');if(logoCfg.act!='update'&&logoCfg.suggestCards&&cardSuggestSelector==false){cardSuggestSelector=_this.FLSCardsSuggest(uiTexts,editorID,logoCfg,apiUrl,logofonts);}
InitVettingToolsWidgets();loadEndTime=new Date().getTime();if(logoCfg.generate_layout){if(logo_mode=='normal'){generate_layout_delayed=false;generate_layout_delayed_executed=true;_generateLayout(logoCfg.generate_layout);}else{generate_layout_delayed=true;}}else{generate_layout_delayed=true;generate_layout_delayed_executed=true;}
if(typeof(logoCfg['showLogoLayouts'])!='undefined'&&logoCfg['showLogoLayouts']&&logoCfg['act']!='update'){if(logo_mode=='normal'){jQuery('#'+loadingOverlayID).remove();show_layout_suggest_delayed=false;show_layout_suggest_delayed_executed=true;_this.FLSLayoutSuggest(editor,editorID,uiTexts['warn']['align'],uiColors,mobile,_this);}else{show_layout_suggest_delayed=true;}}else{show_layout_suggest_delayed=true;show_layout_suggest_delayed_executed=true;if(logoCfg['act']!='update'){_this.replaceOrgSvg();}
jQuery('#'+loadingOverlayID).remove();}
if(logoCfg.product_showcase){productShowcase=new FLSProductShowcaseBlock(editor,logoCfg.product_showcase);if(logoCfg['showLogoLayouts']){productShowcase.hide();}}
var cnvsWrpr=editor.getCanvasWrapper();ml_style_ed=new FLSMultiStyleTextEditDlg({swatchColors:swatchColors,_caller:_this,fonts:logofonts,view:editor.viewsize(),container:editorID,btn_labels:{apply:uiTexts.multistyle_tool.apply,cancel:uiTexts.dynamic.cancel,undo:uiTexts.left_menu.undo.label,redo:uiTexts.left_menu.redo.label,fontsize:uiTexts.text_tool.size,header:uiTexts.multistyle_tool.header,description:uiTexts.multistyle_tool.description},editor_width:(cnvsWrpr.offsetWidth||cnvsWrpr.clientWidth)});ml_style_ed.onApply=apply_text_align;if(show_multiline_toolbar){multiline_toolbar=FLSMUltilineButtonsBar(editor,_handleMultilineButtonBar);editor.getCanvasWrapper().appendChild(multiline_toolbar[0]);multiline_toolbar.hide();}
if(view_frame_image_border===true){_onresizeImgBorder(null);}}
function svgFilter(tofilter,ctype){tofilter=tofilter.replace(/(xmlns:ns[0-9]*?="")|(\sns[0-9]*?:)|(xmlns="http:\/\/www.w3.org\/2000\/svg"\s?)|(inkscape:[^=]+=[\s]?"[^"]+"\s?)/ig,'');return tofilter.replace(/(<svg\s)/i,'<svg xmlns="http://www.w3.org/2000/svg" ');}
function _handleMultilineButtonBar(action){if(validCurTextObj.valid&&validCurTextObj.multiline_on){var ldist=validCurTextObj.line_spaceing;switch(action){case'decrease_distance':ldist-=2;break;case'increase_distance':ldist+=2;break;}
ldist=(ldist<5)?5:ldist;if(validCurTextObj.istextobj){lastSelectedObj.line_spaceing(ldist);}else{_updateStringPathObj({line_spaceing:ldist});}
validCurTextObj.line_spaceing=ldist}}
function _populateSwatches48(){var h=24;for(var i=0;i<14;i++){FLSUtil.hexdec2rgb(swatches48[i]);swatches48[i]=hsl2rgb(h*i/360,1,0.75);swatches48[i+16]=hsl2rgb(h*i/360,1,0.5);swatches48[i+32]=hsl2rgb(h*i/360,1,0.25);}
swatches48[14]=[153,153,153];swatches48[15]=[255,255,255];swatches48[30]=[51,51,51];swatches48[31]=[204,204,204];swatches48[46]=[0,0,0];swatches48[47]=[102,102,102];}
function _updateUndoRedoButtons(){jQuery('.sidebutton.undo, .sidebutton.redo').removeClass('disabled');var stack_active=editor.undoStats();if(!stack_active.undo){jQuery('.sidebutton.undo').addClass('disabled');}
if(!stack_active.redo){jQuery('.sidebutton.redo').addClass('disabled');}}
function _check_logo_direct_save(){if(typeof(jQuery.cookie)=='undefined'){jQuery.cookie=function(){};}
var logo_id=jQuery.cookie('step3_direct_save');if(!logo_id)logo_id=0;if(logo_id=='-1'){while(logo_id=='-1'){logo_id=jQuery.cookie('step3_direct_save');}}
jQuery.cookie("step3_direct_save",null,{path:'/'});return logo_id;}
function _setPageLeave(){if(!leaveMessageSet){window.onbeforeunload=function(){if(typeof(Drupal)=='object'){return Drupal.settings.leave_page_message;}else{return'You have attempted to exit this page. The design you are working on will be lost. Are you sure you want to lose your design?';}};$("a").click(function(){window.onbeforeunload=null;});}
leaveMessageSet=true;}
function _showPageLoadingOverlay(content){var pl_ovrly=jQuery('#FLS_PageLoadingOverlay');if(!pl_ovrly.length){pl_ovrly=jQuery('<div id="FLS_PageLoadingOverlay"></div>');jQuery('body').prepend(pl_ovrly);}
if(!content){var msg='The next page will be loading momentarily';try{msg=Drupal.settings.step2_texttojs.text2?Drupal.settings.step2_texttojs.text2:'The next page will be loading momentarily';}catch(e){msg='The next page will be loading momentarily';}
pl_ovrly.html('<div class="FLS-Overlay-Message">'+msg+'...</div>');if(typeof(Drupal)=='object'){jQuery('.FLS-Overlay-Message',pl_ovrly).css({backgroundImage:'url("'+Drupal.settings.baseUrl+'/sites/all/modules/thickbox/loading_animation.gif")'});}else{jQuery('.FLS-Overlay-Message',pl_ovrly).css({backgroundImage:'url("css/img/loading_animation.gif")'});}}else{pl_ovrly.html(content);}
pl_ovrly.show();}
function _hidePageLoadingOverlay(){jQuery('#FLS_PageLoadingOverlay').hide();}
function _bindEvents(events,elements,callback){if(!(elements instanceof jQuery)){elements=jQuery(elements);}
if(mobile&&wp_mobile){var evtmap={touchstrat:'pointerdown',touchmove:'pointermove',touchend:'pointerup',touchcancel:'pointercancel'};for(var ei=0;ei<events.length;ei++){if(evtmap[events[ei]]){events[ei]=evtmap[events[ei]];}}}
elements.each(function(){for(var i in events){if(document.addEventListener){this.addEventListener(events[i],callback,false);}else if(document.attachEvent){this.attachEvent("on"+events[i],callback);}}});}
var do_font_tap=true;function _handleFontSelectorScroll(evt){switch(evt.type){case'touchstart':case'pointerdown':do_font_tap=true;break;case'touchmove':case'pointermove':do_font_tap=false;break;}}
function _inlineTextEditCallback(new_txt,evt){if(lastSelectedObj instanceof FLSEditorCore.CText){jQuery('[name="entered-text-edit"]',jQuery('#'+editorID)).val(new_txt);if(inline_text_edit_keep_alignment===true){var old_w=lastSelectedObj.getSize().width;lastSelectedObj.setText(new_txt);apply_text_align(lastSelectedObj,old_w);validCurTextObj.text=new_txt;_handleInlineTextEditActions('refresh','position');}
if(evt&&evt.keyCode&&(evt.keyCode===13)){GTrack.track('text','edit-text','Customize');}}}
function _handleFontSelectorEvents(evt){var me=jQuery(this);var fontlist=jQuery('#'+editorID+' .fls-editor-top-toolbar #editor-fontselector-list');var selector=jQuery('#'+editorID+' .fls-editor-top-toolbar .logo-fonts-dropdown-container');var cobj=editor.getCurrentObject();if(me.hasClass('font-item')){if(do_font_tap){if(!me.hasClass('active')){jQuery('span',fontlist).removeClass('active');me.addClass('active');var fontfamily=me.attr('data-fontfamily');if((cobj instanceof FLSEditorCore.CSelectionGroup)&&selection_has_text){cobj.setFontFamily(fontfamily);if(fontPathObj){fontPathObj.loadFont(fontfamily,logofonts[fontfamily]);}}else if(validCurTextObj.istextobj){var old_w=cobj.getSize().width;cobj.setFontFamily(fontfamily);if(FLSUtil.getExtendedCharsFromString(validCurTextObj.text)){if(fontPathObj){fontPathObj.loadFont(fontfamily,logofonts[fontfamily]);}}
apply_text_align(cobj,old_w);var fsize=cobj.getFontSize();validCurTextObj.fontsize=fsize;jQuery('#'+editorID+' .fls-editor-top-toolbar .font-size-label').html(fsize);_handleInlineTextEditActions('refresh');}else{_updateStringPathObj({font_family:fontfamily});}
validCurTextObj.font_family=fontfamily;jQuery('.font-name',selector).html(FLS_Font_Family_Name_Map[logoCfg.lang][fontfamily]||FLS_Font_Family_Name_Map['def'][fontfamily]||fontfamily);GTrack.track('text','font-change','Customize');}
fontlist.hide();}}else{if(validCurTextObj.valid||((cobj instanceof FLSEditorCore.CSelectionGroup)&&selection_has_text)){if((cobj instanceof FLSEditorCore.CMultiLineText)&&cobj.multistyle_on()&&(ml_style_ed instanceof FLSMultiStyleTextEditDlg)){ml_style_ed.show();ml_style_ed.editTextObj(cobj);}else{var selpos=selector.position();fontlist.toggle();fontlist.css({left:selpos.left+'px',top:(selpos.top+24)+'px',});}}else{fontlist.hide();}}
if(evt.preventDefault){evt.preventDefault();}else{evt.returnValue=false;};return false;}
function addFontsDropdown(){var toptoolbar=jQuery('#'+editorID+' .fls-editor-top-toolbar');var drop_container=jQuery('.logo-fonts-dropdown-container',toptoolbar);drop_container.empty();var selector=jQuery(document.createElement('span'));selector.addClass('font-selector-drop');var fontlabel=jQuery('<span class="font-name">&nbsp;</span>');fontlabel.css({padding:'4px 0 4px 5px',display:'block',width:'158px',textOverflow:'ellipsis',overflow:'hidden',height:'18px',lineHeight:'18px'});selector.append(fontlabel);var downarrow=jQuery('<span class="down-arrow">&nbsp;</span>');downarrow.css({padding:'0',lineHeight:'25px',display:'block',width:'25px',height:'100%',position:'absolute',right:0,top:0,borderLeft:'1px solid #CACACA',backgroundColor:'#F0F0F0',fontSize:'18px',color:'#666',textAlign:'center'});selector.append(downarrow);drop_container.append(selector);var selpos=selector.offsetParent().position();var fontslist=jQuery(document.createElement('ul'));fontslist.css({position:'absolute',zIndex:100,left:selpos.left+'px',top:(selpos.top+24)+'px',listStyle:'none'});fontslist.attr('id','editor-fontselector-list');SortFontByName();var fontitems='';for(var fi=0;fi<logofontsorder.length;fi++){var fontname=logofontsorder[fi];var item_html=FLS_Font_Family_Name_Map[logoCfg.lang][fontname]||FLS_Font_Family_Name_Map['def'][fontname]||fontname;fontitems+='<li><span data-fontfamily="'+fontname+'" style="font-family: \''+fontname+'\';" class="font-item">'+item_html+'</span></li>';}
fontitems=jQuery(fontitems);fontslist.append(fontitems);toptoolbar.append(fontslist);jQuery('style#FLSFontSelectorStyle').remove();jQuery('<style type="text/css" id="FLSFontSelectorStyle">\n'+'.logo-fonts-dropdown-container{position:relative;}'+'.font-selector-drop{border: 1px solid #CACACA; font-size: 14px !important; text-decoration: none;font-family: verdana, arial !important;color: #666; display: inline-block;background-color: #FFF;text-overflow: ellipsis;white-space: nowrap; width: 190px; font-weight: bold;overflow:hidden;position: relative;cursor: pointer;margin: 0;}'+'.logo-fonts-dropdown-container span.font-selector-drop:ACTIVE .down-arrow{color:#FFF !important; background-color:#2763AC !important;}\n'+'.logo-fonts-dropdown-container span.font-selector-drop:HOVER .down-arrow{color:#FFF !important; background-color:#2763AC !important;}\n'+'#editor-fontselector-list {display:none; padding: 0; margin:0; box-shadow: 0px 2px 2px rgba(0,0,0,0.5); background-color: #FFF; min-width: 140px; max-height: 370px;overflow-x:hidden; overflow-y: auto;}\n'+'#editor-fontselector-list span.font-item{white-space: nowrap;cursor:pointer;display:block; padding:2px 3px; font-size: 18px; text-decoration: none; border: 2px solid #FFF; color: #000; width: 190px; overflow: hidden;text-align:left;}\n'+'#editor-fontselector-list span.font-item.active{border-color: #CCC;}\n'+'#editor-fontselector-list span.font-item:HOVER{border-color: #000;}\n'+'.font-selector-drop .font-name{font-size: 14px !important; font-family: verdana, arial !important;}'+'.font-selector-drop.disabled .font-name{background-color:#f6f6f6; color:#aaa;}'+'.font-selector-drop.disabled{cursor:default;}'+'.html5-desktop .font-selector-drop{ width: 170px; margin: 0 5px 0 0;}\n'+'.html5-desktop .font-selector-drop .font-name{ width: 140px !important;}\n'+'.html5-desktop #editor-fontselector-list{width: 170px;}\n'+'.html5-desktop #editor-fontselector-list span.font-item{width: 160px;}\n'+'.logo-fonts-dropdown-container span.font-selector-drop .down-arrow:after{position: absolute; top:5px; left:0px; content:""; width:100%; height: 14px; background-position: center 0; background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAYCAYAAADKx8xXAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNXG14zYAAAAWdEVYdENyZWF0aW9uIFRpbWUAMDMvMjcvMTWhU1PqAAAApklEQVQ4je3TsQ3CQAyF4T8kg2SDWyNlFjjrxqBjFFBYgjEIG9AxAlSPhqAcuYRTSsRrLNn6XFhy4c1qYEd+HsC2APBmAdhnovbYdacS4NL3Z+fcFWhzEEA5dL/gCEVwAU/QBCZwEi3GmwVv1szNC0nZy8bZrFJ/+DOwAmpWPDKSkBSUl7ukRhIDzMFv9AmXcIRSMIUnaA6OcRJJopq53OFVb0Dy+5/9/ClmjINyVAAAAABJRU5ErkJggg=="); background-repeat:no-repeat; }\n'+'.logo-fonts-dropdown-container span.font-selector-drop:ACTIVE .down-arrow:after{background-position: center -17px;}\n'+'.logo-fonts-dropdown-container span.font-selector-drop:HOVER .down-arrow:after{background-position: center -17px;}\n'+'</style>').appendTo('head');var events=mobile?['touchend']:['mouseup'];var _selector=selector.get(0);if(mobile){_bindEvents(['touchstart','touchmove'],fontslist,_handleFontSelectorScroll);}
_bindEvents(events,_selector,_handleFontSelectorEvents);_bindEvents(events,jQuery('span.font-item',fontitems),_handleFontSelectorEvents);}
function getMousePos(evt,canvs){var rect=canvs.getBoundingClientRect();var coords={x:-1,y:-1};if(evt.touches){coords.x=evt.touches[0].clientX-rect.left;coords.y=evt.touches[0].clientY-rect.top;}else{coords.x=evt.clientX-rect.left;coords.y=evt.clientY-rect.top;}
return coords;}
function addLogoTextObjects(textnodes){var ok=true;var textlines=0;var last_text_pos={x:0,y:0};var last_text_color=logoColors[0];textprops.length=0;mixed_initial_badge=false;while(mixed_path_logolines.length){mixed_path_logolines.pop();}
textnodes.each(function(index){var tn=jQuery(this);var txt=tn.text();var lyt_name=false;var gr_t_idx=tn.attr('id');gr_t_idx=gr_t_idx?'t'+gr_t_idx:'t'+index;if(logoCfg['act']!='update'){switch(logo_mode){case'initial':show_layout_suggest_delayed=!show_layout_suggest_delayed_executed;generate_layout_delayed=!generate_layout_delayed_executed;if(layout.groups[gr_t_idx]){lyt_name=layout.groups[gr_t_idx]['type'];switch(layout.groups[gr_t_idx]['type']){case'line_1':txt=decodeURIComponent(logoCfg['line1'].toString().replace(/\+/ig,'%20'));break;case'line_2':txt=decodeURIComponent(logoCfg['line2'].toString().replace(/\+/ig,'%20'));break;case'init_1':var txt_org=decodeURIComponent(logoCfg['line1'].toString().replace(/\+/ig,'%20')).trim();txt=FLSUtil.removeSpecialCharacters(txt_org);if(!txt.length){txt=txt_org;}
txt=txt[0].toUpperCase();break;case'init_1w2':var txt_org=decodeURIComponent(logoCfg['line1'].toString().replace(/\+/ig,'%20')).trim();txt=FLSUtil.removeSpecialCharacters(txt_org);if(!txt.length){txt=txt_org;}
var line_words=txt.split(' ');if(line_words.length>1){txt=line_words[1][0].toUpperCase();if(!FLSUtil.isLetter(txt)){var ltr_idx=-1;for(var w_idx=1;w_idx<line_words.length;w_idx++){ltr_idx=FLSUtil.getFirstLetter(line_words[w_idx]);if(ltr_idx>-1){txt=line_words[w_idx][ltr_idx].toUpperCase()}}}}else{if(typeof(logoCfg['line2'])!='undefined'){var txt_org=decodeURIComponent(logoCfg['line2'].toString().replace(/\+/ig,'%20')).trim();var txt=FLSUtil.removeSpecialCharacters(txt_org);txt=txt.length?txt:txt_org;if(txt.length){txt=txt[0].toUpperCase();}}
if(!txt.length){if(line_words[0].length>1){var ltr_idx=FLSUtil.getFirstLetter(line_words[0].substr(1));if(ltr_idx>-1){txt=line_words[0][ltr_idx+1].toUpperCase();}}
txt=txt?txt:line_words[0][0].toUpperCase();}}
break;}}
break;case'badge':show_layout_suggest_delayed=!show_layout_suggest_delayed_executed;generate_layout_delayed=!generate_layout_delayed_executed;if(layout.groups[gr_t_idx]){lyt_name=layout.groups[gr_t_idx]['type'];switch(layout.groups[gr_t_idx]['type']){case'line_1':txt=decodeURIComponent(logoCfg['line1'].toString().replace(/\+/ig,'%20'));break;case'line_2':txt=decodeURIComponent(logoCfg['line2'].toString().replace(/\+/ig,'%20'));break;}}
break;case'normal':default:show_layout_suggest_delayed_executed=generate_layout_delayed_executed=true;show_layout_suggest_delayed=!show_layout_suggest_delayed_executed;generate_layout_delayed=!generate_layout_delayed_executed;txt=decodeURIComponent(logoCfg['line'+(index+1)].toString().replace(/\+/ig,'%20'));}}else{if(layout.groups[gr_t_idx]){lyt_name=layout.groups[gr_t_idx]['type'];}}
if(txt.trim().length){if(['init_1','init_1w2'].indexOf(lyt_name)==-1){textlines++;}
var tpaths=tn.children('textPath');var is_multiline=tn.children('tspan').length>0;is_multiline=is_multiline?is_multiline:tn.attr('data-multiline_on')==1;var is_multistyle=is_multiline&&tn.attr('data-multistyle_on')==1
var TxtCls=(is_multiline||is_multistyle)?FLSEditorCore.CMultiLineText:FLSEditorCore.CPathText;var pathtxt=tpaths.length>0;if(is_multiline||is_multistyle){pathtxt=false;show_multiline_toolbar=is_multiline;if(logoCfg['act']=='update'){var org_txt=tn.attr('data-original_string');txt=org_txt?org_txt:txt;}}
var to=editor.addObject(new TxtCls(txt));to.hastextedit(true);var ff=tn.attr('font-family');if((replace_logo_fonts==true)&&svg_fonts.length){ff=single_font_logo?svg_fonts[0]:svg_fonts[index%svg_fonts.length]
if((logo_mode=='initial')&&(['line_1','init_1','init_1w2'].indexOf(lyt_name)>-1)){ff=svg_fonts[0];}}
if(typeof(logofonts[ff])=='undefined'){console.log(ff+' not found. Replacing with Helvetica')
ff='Helvetica';}
to.setFontFamily(ff);to.setFontSize(parseFloat(tn.attr('font-size')));to.removable(true);var fw=tn.attr('font-weight');var fst=tn.attr('font-style');to.bold(fw=='bold');to.italic(fst=='italic');var styles=tn.attr('style').trim().split(';');for(var i=0;i<styles.length;i++){var stmp=styles[i].split(':');if(stmp.length==2){switch(stmp[0]){case'fill':to.setColor(stmp[1]);last_text_color=stmp[1];logoColors.push(stmp[1]);break;default:}}}
if(is_multiline||is_multistyle){FLSUtil.setMultilineAttribs(to,this);if(is_multistyle&&(logoCfg['act']!='update')){var multicfg=to.multistyle_cfg();if(multicfg.length>1){FLSUtil.setMulticfgText(multicfg,txt);to.multistyle_cfg(multicfg);}}}
var transform={};if(tn.attr('transform')){var transforms=tn.attr('transform').trim().split(') ');if(transforms.length){for(var l=0;l<transforms.length;l++){var fn=transforms[l].split('(');if(fn.length==2){fn[1]=fn[1].replace(/\)/g,'').replace(/\s+/g,',').replace(/,+/g,',').split(',');transform[fn[0]]=[];if(fn[1].length){for(var fi=0;fi<fn[1].length;fi++){transform[fn[0]].push(parseFloat(fn[1][fi]));}}}}}
if(transform['matrix']){to.setMatrix(transform['matrix']);}
if(transform['translate']){to.translate(transform['translate'][0],transform['translate'][1]);}
last_text_pos=to.getPosition();var tp=to.getProperties();tp.text=uiTexts['dynamic']['enter_text'];textprops.push(tp);}
if(lyt_name){to.lyt_name=lyt_name;}else{if(apply_layout_on_update_load&&layout.groups[gr_t_idx]){to.lyt_name=layout.groups[gr_t_idx]['type'];}}
to.id=gr_t_idx.replace(/[t]/g,'');if(pathtxt){var path_id=tpaths.attr('xlink:href').replace(/#/,'');if(svg_defs.paths[path_id]){to.setPathStr(svg_defs.paths[path_id]);to.use_path(true);var ltrspcng=parseInt(tn.attr('letter-spacing'),10);var txt_anchr=tn.attr('text-anchor');var stroffst=tpaths.attr('startOffset');var txt_dy=parseInt(tn.attr('dy'),10);if(!isNaN(ltrspcng)){to.letter_spacing(ltrspcng);}
if(!isNaN(txt_dy)){to.txt_dy(txt_dy);}
to.center_text_on_path((txt_anchr=='middle')&&(stroffst=='50%'));logoCfg.showLogoLayouts=0;if(lyt_name&&(logo_mode=='initial')&&(['init_1','init_1w2'].indexOf(lyt_name)==-1)){for(var area_name in layout.areas){if(layout.areas[area_name].type==lyt_name){mixed_initial_badge=true;mixed_path_logolines.push(lyt_name);}}}}}}});if(logoCfg.act!='update'||apply_layout_on_update_load){_applyLogoLayout();}
if(!ok){jQuery('#'+loadingOverlayID).html(FlsFlashErrorMessage(uiTexts['errors']['errJSTitle'],uiTexts['errors']['errorMessageLoadFont']));}
_setAddTextBtnStatus();return ok;}
function addLogoImageObj(logoimage){var cpg=new FLSEditorCore.CPathGroup();if(select_logo_by_bbox){cpg.select_by_bbox=true;}
var found_stringpath=false;logoimage.find('path').each(function(index){var pn=jQuery(this);var pth=new FLSEditorCore.CPath();var lyt_name=pn.attr('data-lyt_name');var stringdata=false;if(lyt_name){stringdata=_getStringdataAttributes(this);if(stringdata){pth.stringdata=stringdata;}}
pth.setPathStr(pn.attr('d'));pth.inGroup(true);pth.editor(editor);var styles=pn.attr('style').trim().split(';');for(var i=0;i<styles.length;i++){var stmp=styles[i].split(':');if(stmp.length==2){switch(stmp[0]){case'fill':if(stmp[1]!='none'){if(/url\(/.test(stmp[1])){var grid=stmp[1].replace(/url\(/,'').replace(/\)/,'').replace(/#/,'')
pth.gradientId=grid;pth.setFill(svg_defs.gradients[grid].getCanvasGradient(editor.getContext()));}else{pth.setFill(stmp[1]);logoColors.push(stmp[1]);}}else{pth.no_fill=true;}
break;case'stroke':if(stmp[1]!='none'){pth.setStroke(stmp[1]);}else{pth.setStroke();}
break;case'stroke-width':if(stmp[1]!='none'){pth.setStrokeWidth(stmp[1]);}else{pth.setStrokeWidth();}
break;case'stroke-linecap':if(stmp[1]!='none'){pth.setStrokeCap(stmp[1]);}else{pth.setStrokeCap();}
break;case'stroke-miterlimit':if(stmp[1]!='none'){pth.setStrokeMieter(stmp[1]);}else{pth.setStrokeMieter();}
break;case'stroke-linejoin':if(stmp[1]!='none'){pth.setStrokeJoin(stmp[1]);}else{pth.setStrokeJoin();}
break;case'fill-opacity':stmp[1]=parseFloat(stmp[1]);if(!isNaN(stmp[1])&&stmp[1]<1){pth.setFillOpacity(stmp[1]);}
break;default:}}}
var ptransform={};if(pn.attr('transform')){var ptransforms=pn.attr('transform').trim().split(') ');if(ptransforms.length){for(var l=0;l<ptransforms.length;l++){var fn=ptransforms[l].split('(');if(fn.length==2){fn[1]=fn[1].replace(/\)/g,'').replace(/\s+/g,',').replace(/,+/g,',').split(',');ptransform[fn[0]]=[];if(fn[1].length){for(var fi=0;fi<fn[1].length;fi++){ptransform[fn[0]].push(parseFloat(fn[1][fi]));}}}}}
if(ptransform['matrix']){pth.setMatrix(ptransform['matrix']);}}
if(lyt_name){pth.lyt_name=lyt_name;if(stringdata){pth.stringdata=stringdata;cpg.hasStringPath=true;cpg.unlockable(true);pth.parentGroup=cpg;found_stringpath=true;pth.hasrotate(false);pth.scalable(false);pth.calculateBoundingBox();pth.showControls(true);}
for(var ai in layout.areas){if(layout.areas[ai]['type']==lyt_name){fontPathArea[lyt_name]=layout.areas[ai];_initFontPathObj();break;}}}
cpg.addPath(pth);});var transform={};if(logoimage.attr('transform')){var transforms=logoimage.attr('transform').trim().split(') ');if(transforms.length){for(var l=0;l<transforms.length;l++){var fn=transforms[l].split('(');if(fn.length==2){fn[1]=fn[1].replace(/\)/g,'').replace(/\s+/g,',').replace(/,+/g,',').split(',');transform[fn[0]]=[];if(fn[1].length){for(var fi=0;fi<fn[1].length;fi++){transform[fn[0]].push(parseFloat(fn[1][fi]));}}}}}}
if(transform['matrix']){cpg.setMatrix(transform['matrix']);}
apply_layout_on_update_load=(logoCfg.act!='')&&(logo_mode!='normal')&&(!found_stringpath);if(logoCfg.act==''){if(transform['matrix']){cpg.tpl_matrix=transform['matrix'].slice(0);}}else{var tpl_mtrx=logoimage.attr('data-tpl_matrix');if(tpl_mtrx){tpl_mtrx=tpl_mtrx.replace(/\s+/g,',').replace(/,+/g,',').split(',');if(tpl_mtrx.length){for(var fi=0;fi<tpl_mtrx.length;fi++){tpl_mtrx[fi]=parseFloat(tpl_mtrx[fi]);}
cpg.tpl_matrix=tpl_mtrx;}}else{if(apply_layout_on_update_load&&transform['matrix']){cpg.tpl_matrix=transform['matrix'].slice(0);}}}
editor.addObject(cpg);}
function initColorSwatchColors(){var coloridx={};if(logoColors.length){var ccnvs=document.createElement('canvas');ccnvs.width=1;ccnvs.height=1;var cctx=ccnvs.getContext('2d');var coloridxcnt=0;for(var i=0;i<logoColors.length;i++){cctx.fillStyle=logoColors[i];cctx.fillRect(0,0,1,1);var nclr=cctx.getImageData(0,0,1,1).data;logoColors[i]='rgb('+nclr[0]+','+nclr[1]+','+nclr[2]+')';var idx=Math.floor(colorLuma(nclr));if(typeof(coloridx[idx])=='undefined'){coloridxcnt+=1;}
coloridx[idx]=logoColors[i];}}
for(var swl in coloridx){if(customColorIdx>6)break;jQuery('#'+editorID+' #logo-swatch-'+customColorIdx).attr('data-color',coloridx[swl]).css('background-color',coloridx[swl]);swatchColors[customColorIdx]=coloridx[swl];swatchColorsIdx[coloridx[swl]]=true;customColorIdx++;}
currentCustomColorIdx=customColorIdx;}
function rgb2hsl(color){var R=color[0]/255;var G=color[1]/255;var B=color[2]/255;var Min=Math.min(R,G,B);var Max=Math.max(R,G,B);var del_Max=Max-Min;var H=0,S,L=(Max+Min)/2;if(del_Max==0){H=0;S=0;}else{if(L<0.5){S=del_Max/(Max+Min);}else{S=del_Max/(2-Max-Min);}
var del_R=(((Max-R)/6)+(del_Max/2))/del_Max;var del_G=(((Max-G)/6)+(del_Max/2))/del_Max;var del_B=(((Max-B)/6)+(del_Max/2))/del_Max;if(R==Max){H=del_B-del_G;}else if(G==Max){H=(1/3)+del_R-del_B;}else if(B==Max){H=(2/3)+del_G-del_R;}
if(H<0){H+=1;}
if(H>1){H-=1;}}
return{H:H,S:S,L:L};}
function hsl2rgb(h,s,l){var r,g,b;if(s==0){r=g=b=l;}else{var q=l<0.5?l*(1+s):l+s-l*s;var p=2*l-q;r=hue2rgb(p,q,h+1/3);g=hue2rgb(p,q,h);b=hue2rgb(p,q,h-1/3);}
return[Math.round(r*255),Math.round(g*255),Math.round(b*255)];}
function hue2rgb(p,q,t){if(t<0)t+=1;if(t>1)t-=1;if(t<1/6)return p+(q-p)*6*t;if(t<1/2)return q;if(t<2/3)return p+(q-p)*(2/3-t)*6;return p;}
function colorLuma(color){return(0.2126*color[0]+0.7152*color[1]+0.0722*color[2]);}
function parseSvgData(xml){editor.clearUndoStacks();if(typeof(xml)=='string'){xml=jQuery.parseXML(xml);}
orgSVG=xml;if(typeof(xml)=='undefined'||!xml){jQuery('#'+loadingOverlayID).html(FlsFlashErrorMessage(uiTexts['errors']['errJSTitle'],uiTexts['errors']['errLoad']));return false;}
var svgsource=(xml!==null)?jQuery('svg',xml):jQuery('nosvgreceived');var svgViewBox=svgsource.attr('viewBox');if(svgViewBox){svgViewBox=svgViewBox.split(' ');}else{svgViewBox=[0,0,svgsource.attr('width'),svgsource.attr('height')];}
editor.redrawViewFrame(svgViewBox[2],svgViewBox[3]);parseDefs(svgsource);addLogoImageObj(jQuery('#surface2',svgsource));if(addLogoTextObjects(jQuery('#surface4 text',svgsource))){return true;}
return false;}
function parseFontsData(xml){logofonts={};var fontcount=0;fonts_base_url=jQuery('TextFonts',xml).attr('base_path');fonts_base_url=fonts_base_url?fonts_base_url:'';jQuery('font',xml).each(function(index){var me=jQuery(this);var fontfamily=me.attr('fontfamily');logofonts[fontfamily]={ttf_src:me.attr('ttf_src'),name:me.attr('name'),img:fonts_base_url+me.attr('img'),minSize:me.attr('minSize'),maxSize:me.attr('maxSize'),bold_src:me.attr('bold'),italic_src:me.attr('italic'),bolditalic_src:me.attr('bolditalic'),api:me.attr('api'),font_style:me.attr('font_style')};});var valid_svg_fonts=[];while(svg_fonts.length){var tmpfont=svg_fonts.shift();if(logofonts[tmpfont]){valid_svg_fonts.push(tmpfont);}}
svg_fonts=svg_fonts.concat(valid_svg_fonts);fontcount=insertFontFaceCss();fontcount+=AddGoogleFonts();if(!fontcount){jQuery('#'+loadingOverlayID).html(FlsFlashErrorMessage(uiTexts['errors']['errJSTitle'],uiTexts['errors']['errorMessageLoadFont']));return false;}
addFontsDropdown();return fontcount;}
function insertFontFaceCss(){jQuery('style#FLSEditorFonts').remove();var fontface_css='<style type="text/css" id="FLSEditorFonts">\n';var fontcount=0;var count_inc=1;var formats={'.ttf':'truetype','.otf':'opentype'};var ext,font_format;if((svg_fonts instanceof Array)&&(svg_fonts.length>0)){jQuery('style#FLSEditorFontsSVG').remove();var fontface_css_svg='<style type="text/css" id="FLSEditorFontsSVG">\n';var loaded_svg_fnts=[];for(var fi=0;fi<svg_fonts.length;fi++){var fontfamily=svg_fonts[fi];if(logofonts[fontfamily]&&(loaded_svg_fnts.indexOf(fontfamily)==-1)){loaded_svg_fnts.push(fontfamily);var thisfont=logofonts[fontfamily];if(!thisfont['api']){count_inc=0;var fonturl=(fonts_base_url+'html5/'+thisfont['ttf_src']);ext=thisfont['ttf_src'].match(/(\.ttf)|(.otf)/ig);ext=(ext instanceof Array)?ext[0].toLowerCase():'.ttf';font_format=formats[ext];fontface_css_svg+='@font-face{\n\t';fontface_css_svg+='font-family: "'+fontfamily+'";\n\t';fontface_css_svg+='src: url("'+fonturl+'") format("'+font_format+'") ;\n\t';fontface_css_svg+='font-weight: normal;\n\t';fontface_css_svg+='font-style: normal;\n\t';fontface_css_svg+='}\n\n';fontcount+=1;if(thisfont.bold_src){fonturl=fonts_base_url+'html5/'+thisfont['bold_src']
fontface_css_svg+='@font-face{\n\t';fontface_css_svg+='font-family: "'+fontfamily+'";\n\t';fontface_css_svg+='src: url("'+fonturl+'") format("'+font_format+'") ;\n\t';fontface_css_svg+='font-weight: bold;\n\t';fontface_css_svg+='font-style: normal;\n\t';fontface_css_svg+='}\n\n';fontcount+=1;}
if(thisfont.italic_src){fonturl=fonts_base_url+'html5/'+thisfont['italic_src']
fontface_css_svg+='@font-face{\n\t';fontface_css_svg+='font-family: "'+fontfamily+'";\n\t';fontface_css_svg+='src: url("'+fonturl+'") format("'+font_format+'") ;\n\t';fontface_css_svg+='font-weight: normal;\n\t';fontface_css_svg+='font-style: italic;\n\t';fontface_css_svg+='}\n\n';fontcount+=1;}
if(thisfont.bolditalic_src){fonturl=fonts_base_url+'html5/'+thisfont['bolditalic_src']
fontface_css_svg+='@font-face{\n\t';fontface_css_svg+='font-family: "'+fontfamily+'";\n\t';fontface_css_svg+='src: url("'+fonturl+'") format("'+font_format+'") ;\n\t';fontface_css_svg+='font-weight: bold;\n\t';fontface_css_svg+='font-style: italic;\n\t';fontface_css_svg+='}\n\n';fontcount+=1;}}}}
fontface_css_svg+='</style>';jQuery(fontface_css_svg).appendTo('head');}
for(var fontfamily in logofonts){if(svg_fonts.indexOf(fontfamily)>-1){continue;}
var thisfont=logofonts[fontfamily];if(!thisfont['api']){var fonturl=(fonts_base_url+'html5/'+thisfont['ttf_src']);ext=thisfont['ttf_src'].match(/(\.ttf)|(.otf)/ig);ext=(ext instanceof Array)?ext[0].toLowerCase():'.ttf';font_format=formats[ext];fontface_css+='@font-face{\n\t';fontface_css+='font-family: "'+fontfamily+'";\n\t';fontface_css+='src: url("'+fonturl+'") format("'+font_format+'") ;\n\t';fontface_css+='font-weight: normal;\n\t';fontface_css+='font-style: normal;\n\t';fontface_css+='}\n\n';fontcount+=count_inc;if(thisfont.bold_src){fonturl=fonts_base_url+'html5/'+thisfont['bold_src']
fontface_css+='@font-face{\n\t';fontface_css+='font-family: "'+fontfamily+'";\n\t';fontface_css+='src: url("'+fonturl+'") format("'+font_format+'") ;\n\t';fontface_css+='font-weight: bold;\n\t';fontface_css+='font-style: normal;\n\t';fontface_css+='}\n\n';fontcount+=count_inc;}
if(thisfont.italic_src){fonturl=fonts_base_url+'html5/'+thisfont['italic_src']
fontface_css+='@font-face{\n\t';fontface_css+='font-family: "'+fontfamily+'";\n\t';fontface_css+='src: url("'+fonturl+'") format("'+font_format+'") ;\n\t';fontface_css+='font-weight: normal;\n\t';fontface_css+='font-style: italic;\n\t';fontface_css+='}\n\n';fontcount+=count_inc;}
if(thisfont.bolditalic_src){fonturl=fonts_base_url+'html5/'+thisfont['bolditalic_src']
fontface_css+='@font-face{\n\t';fontface_css+='font-family: "'+fontfamily+'";\n\t';fontface_css+='src: url("'+fonturl+'") format("'+font_format+'") ;\n\t';fontface_css+='font-weight: bold;\n\t';fontface_css+='font-style: italic;\n\t';fontface_css+='}\n\n';fontcount+=count_inc;}}}
fontface_css+='</style>';if(svg_fonts.length){setTimeout(function(){jQuery(fontface_css).appendTo('head');},200);}else{jQuery(fontface_css).appendTo('head');}
return fontcount;}
function _updateFontEditControls(curtobj){var txtedit=jQuery('[name="entered-text-edit"]',jQuery('#'+editorID));var fontlist=jQuery('#'+editorID+' .fls-editor-top-toolbar #editor-fontselector-list');var selector=jQuery('#'+editorID+' .fls-editor-top-toolbar .logo-fonts-dropdown-container');selection_has_text=false;if((curtobj instanceof FLSEditorCore.CSelectionGroup)&&curtobj.getFontFamily()){txtedit.attr('disabled',true);txtedit.val('');var ff=curtobj.getFontFamily();selection_has_text=true;jQuery('.font-item',fontlist).removeClass('active');jQuery('span.font-item[data-fontfamily="'+ff+'"]',fontlist).addClass('active');jQuery('.font-name',selector).html(FLS_Font_Family_Name_Map[logoCfg.lang][ff]||FLS_Font_Family_Name_Map['def'][ff]||ff);jQuery('#'+editorID+' .fls-editor-top-toolbar .font-size-label').html('-');jQuery('.font-selector-drop',selector).removeClass('disabled');}else if(validCurTextObj.valid&&curtobj){txtedit.removeAttr('disabled');var max_lngth=(logo_mode=='initial')&&(!validCurTextObj.istextobj)?initial_logo_max_initials:logoline_max_length;if(validCurTextObj.lyt_name&&(['init_1','init_1w2'].indexOf(validCurTextObj.lyt_name)==-1)){max_lngth=logoline_max_length;}
txtedit.attr('maxlength',max_lngth);var text=validCurTextObj.istextobj?curtobj.getText():lastSelectedObjSubpath.stringdata.text;var ff=validCurTextObj.istextobj?curtobj.getFontFamily():lastSelectedObjSubpath.stringdata.font_family;var fs=validCurTextObj.istextobj?curtobj.getFontSize():lastSelectedObjSubpath.stringdata.fontsize;txtedit.val(text);jQuery('.font-item',fontlist).removeClass('active');jQuery('span.font-item[data-fontfamily="'+ff+'"]',fontlist).addClass('active');jQuery('.font-name',selector).html(FLS_Font_Family_Name_Map[logoCfg.lang][ff]||FLS_Font_Family_Name_Map['def'][ff]||ff);jQuery('#'+editorID+' .fls-editor-top-toolbar .font-size-label').html(fs);jQuery('.font-selector-drop',selector).removeClass('disabled');}else{txtedit.blur();txtedit.attr('disabled',true);txtedit.val('');jQuery('#'+editorID+' .fls-editor-top-toolbar .font-size-label').html('-');var selector=jQuery('#'+editorID+' .fls-editor-top-toolbar .logo-fonts-dropdown-container');jQuery('.font-selector-drop',selector).addClass('disabled');}}
function _updateColorEditingTools(curtobj){if(!(curtobj instanceof FLSEditorCore.CObject)){if(orgObjColor!=tempObjColor&&lastSelectedObj instanceof FLSEditorCore.CObject){lastSelectedObj.setColor(orgObjColor);}
jQuery('#'+editorID+' #color-pick-canvas-color-sample').css('background-color','transparent');jQuery('#'+editorID+' #color-pick-canvas-color-sample-orig').css('background-color','transparent');orgObjColor=tempObjColor=null;jQuery('#apply-color-tool-button').addClass('disabled');}else{if(orgObjColor!=tempObjColor&&lastSelectedObj instanceof FLSEditorCore.CObject){if(lastSelectedObjSubpath!==null){lastSelectedObjSubpath.setFill(orgObjColor);}else{lastSelectedObj.setColor(orgObjColor);}}
jQuery('#'+editorID+' #color-pick-canvas-color-sample').css('background-color',curtobj.getColor());jQuery('#'+editorID+' #color-pick-canvas-color-sample-orig').css('background-color',curtobj.getColor());orgObjColor=tempObjColor=curtobj.getColor();updateUserCustomColorSwatch(orgObjColor);jQuery('#apply-color-tool-button').addClass('disabled');}
_updateDesktopExtraColorOptionInputs(curtobj);}
function _updateDesktopExtraColorOptionInputs(curtobj){if(mobile)return false;var inputs=jQuery('.more-options-rgb-inputs input[name*=color]');inputs.attr('disabled',true).val('');if((curtobj instanceof FLSEditorCore.CObject)&&curtobj.colorEditable()){inputs.attr('disabled',false);var color=curtobj.getColor();if(!color||(color instanceof CanvasGradient))return false;color=color.replace(/\)/g,'').replace(/rgb\(/g,'').replace(/,/g,' ').replace(/\s+/g,' ').trim();color=color.split(' ');for(var i=0;i<color.length;i++){if(color[i].indexOf('%')>-1){color[i]=Math.round(parseFloat(color[i],10)*255/100);}else{color[i]=parseInt(color[i],10);}
if(color[i]>255){color[i]=255;}else if(color[i]<0){color[i]=0;}}
var hex=color[0]<<16;hex+=color[1]<<8;hex+=color[2];var hexstr=(0x1000000|hex).toString(16).substring(1);inputs.each(function(idx){var value=0;switch(this.name){case'color[r]':value=color[0];break;case'color[g]':value=color[1];break;case'color[b]':value=color[2];break;case'color[hex]':value=hexstr;break;}
this.value=value;});}}
function _editorEvtCallback(evt,mouseCoords,edit_operation){switch(evt.type){case'mousemove':case'touchmove':case'pointermove':obj_moved=true;break;case'mousedown':case'touchstart':case'pointerdown':obj_moved=false;jQuery('#'+editorID+' .fls-editor-top-toolbar #editor-fontselector-list').hide();var color_focused_input=document.querySelector('#more-color-options-section input:focus');if(color_focused_input){color_focused_input.blur();}
var curtobj=editor.getCurrentObject();if(curtobj&&['op:doubletap','op:delete'].indexOf(edit_operation)==-1){editor.undoPush(curtobj);_updateUndoRedoButtons();}
if(lastSelectedObj!=curtobj){_handleInlineTextEditActions('hide');}
lastSelectedObj=curtobj;if(curtobj instanceof FLSEditorCore.CPathGroup){if(lastSelectedObjSubpath instanceof FLSEditorCore.CObject){lastSelectedObjSubpath.setActive(false);}
lastSelectedObjSubpath=curtobj.getCurrentPath();if(edit_operation=='op:lock_unlock'){_fls_events_add(curtobj.unlocked(!curtobj.unlocked())?'logo_editor_group_unlock':'logo_editor_group_lock');if(!curtobj.unlocked()){curtobj.calculateBoundingBox();}}
lastSelectedObjSubpath.setActive((typeof(lastSelectedObjSubpath.stringdata)!='undefined')&&curtobj.unlocked());}else{if(lastSelectedObjSubpath instanceof FLSEditorCore.CObject){lastSelectedObjSubpath.setActive(false);}
lastSelectedObjSubpath=null;}
validCurTextObj=_isValidTextObj(curtobj);_updateFontEditControls(curtobj);_updateColorEditingTools(curtobj);if(arc_text_toolbar){arc_text_toolbar.toggle(lastSelectedObj instanceof FLSEditorCore.CPathText);}
if(multiline_toolbar){multiline_toolbar.toggle(validCurTextObj.multiline_on);}
if(lastSelectedObj){if(edit_operation=='op:delete'&&curtobj.removable()&&edit_operation==curtobj.whichControl(mouseCoords)){GTrack.track(curtobj,'delete','Customize');editor.undoPush(curtobj);_updateUndoRedoButtons();editor.removeObject(curtobj);if(curtobj instanceof FLSEditorCore.CText){_setAddTextBtnStatus();}
curtobj=editor.getCurrentObject();_updateFontEditControls(curtobj);_updateColorEditingTools(curtobj);}
lastSelectedObj=curtobj;if(lastSelectedObj instanceof FLSEditorCore.CText&&['op:doubletap','op:textedit'].indexOf(edit_operation)>-1){if((lastSelectedObj instanceof FLSEditorCore.CMultiLineText)&&lastSelectedObj.multistyle_on()&&(ml_style_ed instanceof FLSMultiStyleTextEditDlg)){ml_style_ed.show();ml_style_ed.editTextObj(lastSelectedObj);}else if((inlineTextEditor instanceof FLSinLineTextEdit)&&!(lastSelectedObj instanceof FLSEditorCore.CMultiLineText)){if(((lastSelectedObj instanceof FLSEditorCore.CPathText)&&!lastSelectedObj.has_path())||(lastSelectedObj instanceof FLSEditorCore.CText)){inlineTextEditor.edit(lastSelectedObj);}}else{var tinput=jQuery('input[type=text][name="entered-text-edit"]',jQuery('#'+editorID));if(tinput.length){tinput.get(0).focus();}}}}
last_editor_op=edit_operation;UpdateVettingToolsWidgets();if(edit_operation=='op:none'){_handleInlineTextEditActions();}
break;case'mouseup':case'touchend':case'pointerup':if(last_editor_op!=edit_operation&&last_editor_op!='op:delete'){if(!((last_editor_op=='op:translate')&&(obj_moved===false))){GTrack.track(lastSelectedObj,last_editor_op.replace('op:',''),'Customize');}}
if(last_editor_op=='op:scale'){_handleScaleToFontSize()}
if(last_editor_op!='op:none'){productShowcase.refreshThumbs();}
break;case'keydown':if((edit_operation!=last_editor_op)&&(['op:kb_scale','op:translate'].includes(edit_operation))){editor.undoPush(lastSelectedObj);_updateUndoRedoButtons();}
last_editor_op=edit_operation;break;case'keyup':if(['op:translate','op:kb_scale'].includes(last_editor_op)){GTrack.track(lastSelectedObj,last_editor_op.replace('op:',''),'Customize');}
if(last_editor_op=='op:kb_scale'){_handleScaleToFontSize()}
if(last_editor_op!='op:none'){productShowcase.refreshThumbs();}}
if(use_multiselect&&multiSelectObj){var args=Array.prototype.slice.call(arguments,0);args.push(lastSelectedObj);var curtobj=multiSelectObj.exec.apply(multiSelectObj,args);if(curtobj!=lastSelectedObj){_updateFontEditControls(curtobj);_updateColorEditingTools(curtobj);lastSelectedObj=curtobj;}}
if(['op:rotate','op:scale','op:delete'].indexOf(last_editor_op)>-1){switch(last_editor_op){case'op:rotate':case'op:scale':_handleInlineTextEditActions('refresh');break;case'op:delete':_handleInlineTextEditActions()}}}
function _handleKeyboardCommands(evt){var reset_last_op=false;switch(last_editor_op){case'op:kb_open_advanced_color_options':if(enable_LMX_5715_features){var btn=document.querySelector('#'+editorID+' .color-action-button.more-options');var toggle=!!btn&&true;if(toggle&&(lastSelectedObj instanceof FLSEditorCore.CObject)){var color_section=document.querySelector('#'+editorID+' #more-color-options-section');if(color_section&&color_section.classList.contains('open-section')){toggle=false;}
setTimeout(function(){var hexinput=color_section.querySelector('input[name="color[hex]"');hexinput.focus();hexinput.select();},200);}}
if(toggle){_handleColorActionsTapImgBorder.apply(btn,[evt]);}
last_editor_op='op:none';break
case'op:kb_add_text':var saveLastSelect=lastSelectedObj;_handleAddNewText.apply(document.querySelector('#'+editorID+' .add-text-button'),[evt]);validCurTextObj=_isValidTextObj(lastSelectedObj);_updateUndoRedoButtons();if((inlineTextEditor instanceof FLSinLineTextEdit)&&(saveLastSelect!=lastSelectedObj)){if(((lastSelectedObj instanceof FLSEditorCore.CPathText)&&!lastSelectedObj.has_path())||(lastSelectedObj instanceof FLSEditorCore.CText)){inlineTextEditor.edit(lastSelectedObj);}}
reset_last_op=true;break;case'op:kb_edit_text':if(lastSelectedObj instanceof FLSEditorCore.CText){if((inlineTextEditor instanceof FLSinLineTextEdit)){inlineTextEditor.edit(lastSelectedObj);}else{var textinput=document.querySelector('#'+editorID+' input[type="text"][name="entered-text-edit"]');if(textinput){textinput.focus();textinput.select();}}}
reset_last_op=true;break;case'op:kb_select_all':console.log('select all')
reset_last_op=true;break;case'op:kb_undo':var undobtn=document.querySelector('#'+editorID+' .sidebutton.undo');if(undobtn){_hanndleSideButtonActions.apply(undobtn,[evt]);}
reset_last_op=true;break;case'op:kb_redo':var redobtn=document.querySelector('#'+editorID+' .sidebutton.redo');if(redobtn){_hanndleSideButtonActions.apply(redobtn,[evt]);}
reset_last_op=true;break;case'op:kb_reset':var resetbtn=document.querySelector('#'+editorID+' .sidebutton.reset');if(resetbtn){_hanndleSideButtonActions.apply(resetbtn,[evt]);}
reset_last_op=true;break;case'op:kb_open_add_logo_image':console.log('logo editor has no insert image/logo function');reset_last_op=true;break;case'op:translate':case'op:kb_scale':GTrack.track(lastSelectedObj,last_editor_op.replace('op:',''),'Customize');if(last_editor_op=='op:kb_scale'){_handleScaleToFontSize()}
break;case'op:none':if(evt.type=='keyup')
{switch(evt.which){case 27:_deselect();break;case 9:if((evt.target==document.body)||((evt.target instanceof HTMLCanvasElement)&&(evt.target.id=='FLSEditorEventCollectorOverlay'))){var objs=editor.getObjects();if(objs.length){var obj_idx=0;if(lastSelectedObj instanceof FLSEditorCore.CObject){obj_idx=objs.indexOf(lastSelectedObj);obj_idx++;if(obj_idx>=objs.length){obj_idx=0;}}
_select(objs[obj_idx])}}
break;}}
break;}
if(last_editor_op!='op:none'){productShowcase.refreshThumbs();if(reset_last_op===true){last_editor_op='op:none';}}}
function _select(obj){if(obj instanceof FLSEditorCore.CObject&&obj.selectable()){_deselect();editor.setCurrentObject(obj)
lastSelectedObj=editor.getCurrentObject();editor.undoPush(lastSelectedObj);_updateUndoRedoButtons();validCurTextObj=_isValidTextObj(lastSelectedObj);_updateColorEditingTools(lastSelectedObj);_updateFontEditControls(lastSelectedObj);}}
function _deselect(){if(lastSelectedObj){document.activeElement.blur();if(multiSelectObj){multiSelectObj.hide();}
lastSelectedObj.setActive(false);editor.deselect();lastSelectedObjSubpath=null;lastSelectedObj=editor.getCurrentObject();if(lastSelectedObj instanceof FLSEditorCore.CPathGroup){lastSelectedObjSubpath=lastSelectedObj.getCurrentPath();}
_updateColorEditingTools(lastSelectedObj);_updateFontEditControls(lastSelectedObj);}}
function _handleScaleToFontSize(){if(scale_to_font_size===true){if(lastSelectedObj instanceof FLSEditorCore.CText){if((lastSelectedObj instanceof FLSEditorCore.CPathText)&&(lastSelectedObj.has_path()===true)){lastSelectedObj.use_pivot(true);}
lastSelectedObj.applyScaleToFontSize();if(validCurTextObj){validCurTextObj.fontsize=lastSelectedObj.getFontSize();}
lastSelectedObj.use_pivot(false);_updateFontEditControls(lastSelectedObj);}else if((lastSelectedObj instanceof FLSEditorCore.CSelectionGroup)&&(selection_has_text===true)){var s_objs=lastSelectedObj.getElements();for(var i=0;i<s_objs.length;i++){if(s_objs[i]instanceof FLSEditorCore.CText){s_objs[i].applyScaleToFontSize();}}
lastSelectedObj.updateBox();_updateFontEditControls(lastSelectedObj);}}}
function updateUserCustomColorSwatch(color){if(typeof(swatchColorsIdx[color])=='boolean')return false;if(currentCustomColorIdx>swatchColors.length-1){currentCustomColorIdx=customColorIdx;}
swatchColorsIdx[color]=true;swatchColors[currentCustomColorIdx]=color;jQuery('#'+editorID+' #logo-swatch-'+currentCustomColorIdx).attr('data-color',color).css('background-color',color);currentCustomColorIdx++;}
var texttrack=null;function _handleTextInput(evt){var me=jQuery(this);var curtobj=editor.getCurrentObject();clearTimeout(texttrack);if(curtobj){switch(evt.type){case'focus':if(!validCurTextObj.valid){me.blur();}else{if((curtobj instanceof FLSEditorCore.CMultiLineText)&&curtobj.multistyle_on()&&(ml_style_ed instanceof FLSMultiStyleTextEditDlg)){ml_style_ed.show();ml_style_ed.editTextObj(curtobj);}else{me.val(validCurTextObj.text);if(validCurTextObj.text.trim()==validCurTextObj.default_text.trim()){setTimeout(function(){me.select();},50);}}}
break;case'keyup':if(!validCurTextObj.valid){alert('First select a text in the editor');}else{if([13,27].indexOf(evt.which)>-1){this.blur();GTrack.track('text','edit-text','Customize');_handleInlineTextEditActions();}else{if(validCurTextObj.istextobj){var txt_val=FLSUtil.removeEmojiCharacters(me.val());me.val(txt_val);var old_w=curtobj.getSize().width;if(FLSUtil.getExtendedCharsFromString(me.val())){if(fontPathObj){fontPathObj.loadFont(validCurTextObj.font_family,logofonts[validCurTextObj.font_family]);}}
curtobj.setText(me.val());apply_text_align(curtobj,old_w);validCurTextObj.fontsize=curtobj.getFontSize();;jQuery('#'+editorID+' .fls-editor-top-toolbar .font-size-label').html(validCurTextObj.fontsize);_handleInlineTextEditActions('refresh');}else{_updateStringPathObj({text:me.val()});}
validCurTextObj.text=me.val();texttrack=setTimeout(function(){GTrack.track('text','edit-text','Customize');},3000);}
productShowcase.refreshThumbs();}
break;}}
if(multiSelectObj){multiSelectObj.hide();}
if(evt.preventDefault){evt.preventDefault();}else{evt.returnValue=false;};return false;}
function _handleTextSize(evt){var me=jQuery(this);var curtobj=editor.getCurrentObject();var fsize=false;if((curtobj instanceof FLSEditorCore.CSelectionGroup)&&selection_has_text){var fs_step=0;if(me.hasClass('up')){fs_step=1;}else if(me.hasClass('down')){fs_step=-1;}
if(multiselect_text_font_size_control_idividual===true){var objs=curtobj.getElements();var stepscale=0;for(var i=0;i<objs.length;i++){if(objs[i]instanceof FLSEditorCore.CText){fsize=objs[i].getFontSize();var nfsize=(fsize+fs_step);var raw_scale=nfsize/fsize;var diff=Math.abs(raw_scale-1);stepscale=Math.max(stepscale,diff/FLSUtil.kbScaleStep);}}
stepscale*=fs_step;curtobj.kbscale(stepscale);_handleScaleToFontSize();fsize=false;}else{fsize=curtobj.getFontSize();var ffamily=curtobj.getFontFamily();if((logofonts[ffamily]['maxSize']>fsize)&&(logofonts[ffamily]['minSize']<fsize)){fsize+=fs_step;var ffamily=curtobj.getFontFamily();curtobj.setFontSize(fsize);fsize=curtobj.getFontSize();}}}else if(validCurTextObj.valid){fsize=validCurTextObj.fontsize;var ffamily=validCurTextObj.font_family;if(me.hasClass('up')&&logofonts[ffamily]['maxSize']>fsize){fsize+=1;}else{if(me.hasClass('down')&&logofonts[ffamily]['minSize']<fsize){fsize-=1;}}
if(validCurTextObj.istextobj){var old_w=curtobj.getSize().width;fsize=curtobj.setFontSize(fsize);apply_text_align(curtobj,old_w);}else{_updateStringPathObj({fontsize:fsize});}
validCurTextObj.fontsize=fsize;_handleInlineTextEditActions('refresh');}
GTrack.track('text','fontsize-change','Customize');if(fsize!==false){jQuery('#'+editorID+' .fls-editor-top-toolbar .font-size-label').html(fsize);}else{jQuery('#'+editorID+' .fls-editor-top-toolbar .font-size-label').html('-');}
if(evt.preventDefault){evt.preventDefault();}else{evt.returnValue=false;};return false;}
function _handleColorChangers(evt){var cobj=editor.getCurrentObject();if(cobj instanceof FLSEditorCore.CObject){var ctx=this.getContext('2d');var mcoords=getMousePos(evt,this);var color=ctx.getImageData(mcoords.x,mcoords.y,1,1).data;if(cobj instanceof FLSEditorCore.CObject){switch(evt.type){case'mousemove':case'touchmove':case'pointermove':if(color[3]){tempObjColor='rgb('+color[0]+','+color[1]+','+color[2]+')';cobj.setColor(tempObjColor);jQuery('#color-pick-canvas-color-sample').css('background-color',tempObjColor);jQuery('#apply-color-tool-button').removeClass('disabled');}else{cobj.setColor(orgObjColor);jQuery('#color-pick-canvas-color-sample').css('background-color',orgObjColor);jQuery('#apply-color-tool-button').addClass('disabled');}
break;case'mousedown':case'pointerdown':if((cobj instanceof FLSEditorCore.CMultiLineText)&&cobj.multistyle_on()&&(ml_style_ed instanceof FLSMultiStyleTextEditDlg)){ml_style_ed.show();ml_style_ed.editTextObj(cobj);}else{cobj.setColor(tempObjColor);jQuery('#color-pick-canvas-color-sample-orig').css('background-color',tempObjColor);orgObjColor=tempObjColor;updateUserCustomColorSwatch(orgObjColor);_updateDesktopExtraColorOptionInputs(cobj);jQuery('#apply-color-tool-button').addClass('disabled');GTrack.track(cobj,'color-change','Customize');}
break;case'mouseout':case'touchcancel':case'pointercancel':cobj.setColor(orgObjColor);jQuery('#color-pick-canvas-color-sample').css('background-color',orgObjColor);tempObjColor=orgObjColor;jQuery('#apply-color-tool-button').addClass('disabled');}}
_handleInlineTextEditActions('refresh');if(evt.preventDefault){evt.preventDefault();}else{evt.returnValue=false;};return false;}}
function _handleTempColorTap(evt){var cobj=editor.getCurrentObject();if(cobj instanceof FLSEditorCore.CObject){cobj.setColor(tempObjColor);jQuery('#color-pick-canvas-color-sample-orig').css('background-color',tempObjColor);orgObjColor=tempObjColor;updateUserCustomColorSwatch(orgObjColor);}
if(evt.preventDefault){evt.preventDefault();}else{evt.returnValue=false;};return false;}
var help_buble_timers={};function _handleHelpButtons(evt){var me=jQuery(this);var key=me.attr('data-message-key');var cssqry='#'+editorID+' #editor-help-'+key;var bubble=jQuery(cssqry);if(help_buble_timers[key]){clearTimeout(help_buble_timers[key]);help_buble_timers[key]=null;}
if(!bubble.length){bubble=jQuery('<div id="editor-help-'+key+'" class="fls-editor-help-bubble">'+uiTexts[key]['help']+'</div>');var pos=me.offset();var ppos=jQuery('#'+editorID).offset();pos.left=pos.left-ppos.left;pos.top=pos.top-ppos.top;bubble.css({left:pos.left-65,'top':pos.top+45});jQuery('#'+editorID).prepend(bubble);help_buble_timers[key]=setTimeout(function(){bubble.hide();},10000);}else{if(bubble.is(':visible')){bubble.hide();}else{bubble.show();help_buble_timers[key]=setTimeout(function(){bubble.hide();},10000);}}}
function _handleColorSwatch(evt){var color=jQuery(this).attr('data-color');var cobj=editor.getCurrentObject();if(color!=''&&cobj instanceof FLSEditorCore.CObject){if((cobj instanceof FLSEditorCore.CMultiLineText)&&cobj.multistyle_on()&&(ml_style_ed instanceof FLSMultiStyleTextEditDlg)){ml_style_ed.show();ml_style_ed.editTextObj(cobj);}else{cobj.setColor(color);jQuery('#color-pick-canvas-color-sample').css('background-color',color);tempObjColor=color;jQuery('#apply-color-tool-button').removeClass('disabled');if(!mobile){orgObjColor=tempObjColor;_updateDesktopExtraColorOptionInputs(cobj);updateUserCustomColorSwatch(orgObjColor);}
_handleInlineTextEditActions('refresh');}}
if(evt.preventDefault){evt.preventDefault();}else{evt.returnValue=false;};return false;}
function _addColorEditingControls(container){var colorcontrol=jQuery(document.createElement('div'));colorcontrol.css({margin:'0px',height:'99px'});var colorc_control_elements=jQuery('<div class="fls-logo-color-swatches-container"><h4 class="tool-ttl" style="width: 100%;text-align:center;">'+uiTexts['color_tool']['current_logo_color']+'<\/h4>'+'<div  id="color-pick-canvas-color-swatches" style="overflow: hidden;position: relative; margin: 0 auto; width:130px;"><\/div>'+'<\/div><div class="fls-logo-colors-custom-container">'+'<div class="custom-color-actions-container">'+'<div class="color-action-item right"><h4 class="tool-ttl" style="width: 100%;text-align:center;">'+uiTexts['color_tool']['new_color']+'<\/h4>'+'<div class="color-pick-sample" id="color-pick-canvas-color-sample"><\/div>'+'<span class="color-action-button blue-button disabled"  data-action="apply-color" id="apply-color-tool-button">'+uiTexts['html5_buttons']['apply_color']['label']+'<\/span>'+'<\/div>'+'<div class="color-action-item"><h4 class="tool-ttl" style="width: 100%;text-align:center;">'+uiTexts['color_tool']['current_color']+'<\/h4>'+'<div class="color-pick-sample" id="color-pick-canvas-color-sample-orig"><\/div>'+'<span class="color-action-button more-options" data-action="switch-color-optitons"><span class="more-less-sign">&nbsp;<\/span><\/span>'+'<\/div>'+'<\/div>'+'<div id="custom-color-canvas-picker-container" class="custom-color-option-container"  style="display:none;"><canvas class="color-pick-bg-all" style="cursor:crosshair; background-color: #000;" width="420" height="80"><\/canvas><\/div>'+'<div id="custom-color-swatches-picker-container" class="custom-color-option-container" style="display:block; margin-top: 12px;"><\/div>'+'<\/div>');for(var csi=0;csi<swatchColors.length;csi++){var swatch=jQuery(document.createElement('span'));swatch.attr('id','logo-swatch-'+csi);swatch.addClass('logo-color-swatch');swatch.attr('data-color','');swatch.html('&nbsp;');jQuery('#color-pick-canvas-color-swatches',colorc_control_elements).append(swatch);_bindEvents(mobile?['touchend']:['mouseup'],swatch[0],_handleColorSwatch);}
for(var csi=0;csi<48;csi++){var swatch=jQuery(document.createElement('span'));swatch.addClass('logo-color-swatch');swatch.attr('data-color','rgb('+swatches48[csi].join(',')+')');swatch.css('background-color','rgb('+swatches48[csi].join(',')+')');swatch.html('&nbsp;');jQuery('#custom-color-swatches-picker-container',colorc_control_elements).append(swatch);_bindEvents(mobile?['touchend']:['mouseup'],swatch[0],_handleColorSwatch);}
colorcontrol.append(colorc_control_elements);var colorbg=new Image();colorbg.onload=function(){var cpcanvas=jQuery('canvas.color-pick-bg-all',colorc_control_elements)[0];var cpctx=cpcanvas.getContext('2d');cpctx.drawImage(this,0,0,this.width,this.height);jQuery(cpcanvas).unbind('*');_bindEvents(mobile?['touchmove','touchcancel']:['mouseup','mousemove','mouseout','mousedown'],cpcanvas,_handleColorChangers);};_bindEvents(mobile?['touchstart']:['mousedown'],jQuery('.color-action-button',colorc_control_elements),_handleColorActionsTap);colorbg.src=resources.color_picker2;container.append(colorcontrol);}
function _addColorEditingControlsDesktop(container){var colorc_control_elements=jQuery('<div style="float:left; width:435px; border-right:1px solid #DCDCDC;margin-left:10px;"><div class="outer-border"><div class="inner-border">'+'<div style="width:100%; height:40px;padding-top:15px;"><span class="color-action-button more-options" data-action="switch-color-optitons" style="float:right; margin: 4px 22px; width:auto; padding:0 10px 0 0;"><span class="more-less-sign">&nbsp;</span><\/span><h4 class="tool-ttl" style="margin: 5px; font-size: 16px; float:left;font-weight:bold;"><!-- span class="fls-editor-help-button" data-message-key="color_tool" data-message-subkey="help_split_20141001" style="float:right;">?</span -->'+uiTexts['color_tool']['header']+'</h4></div>'+'<div style="">'+'<div class="fls-logo-color-swatches-container" id="color-pick-canvas-color-swatches"><\/div>'+'<div id="custom-color-canvas-picker-container" class="custom-color-option-container"><canvas class="color-pick-bg-all" style="cursor:crosshair; background-color: #000;" width="270" height="59"><\/canvas><\/div>'+'<div class="color-pick-sample-container"><span class="color-pick-sample" id="color-pick-canvas-color-sample"><\/span><\/div>'+'</div>'+'<\/div><\/div><\/div>'+'<div id="more-color-options-desktop" style="display:none;">'+'<table style="margin-left: 10px;"><tr><td>'+'<div class="more-options-rgb-inputs">'+'<label>'+uiTexts['color_tool']['r']+' <input type="text" name="color[r]"></label>'+'<label>'+uiTexts['color_tool']['g']+' <input type="text" name="color[g]"></label>'+'<label>'+uiTexts['color_tool']['b']+' <input type="text" name="color[b]"></label>'+'</div></td>'+'<td><div class="more-options-rgb-inputs hex">'+'<label>'+uiTexts['color_tool']['hex']+' <input type="text" name="color[hex]"></label>'+'</div></td>'+'<td><div class="more-options-popular-swatches">'+'<label style="float:left;">'+uiTexts['color_tool']['popular']+' </label><span id="desktop-popular-swatches"></span>'+'</div></td></tr>'+'<\/div>');var per_row_swatch=3;var swatch_rows=swatchColors.length/per_row_swatch;for(var csi=0;csi<swatchColors.length;csi++){var swatch=jQuery(document.createElement('span'));var cur_row=Math.floor(csi/per_row_swatch)+1;swatch.attr('id','logo-swatch-'+csi);swatch.addClass('logo-color-swatch');swatch.attr('data-color','');swatch.html('&nbsp;');jQuery('#color-pick-canvas-color-swatches',colorc_control_elements).append(swatch);if(!((csi+1)%per_row_swatch)){swatch.addClass('last-swatch');}
if(cur_row==swatch_rows){swatch.addClass('bottom-swatch');}
_bindEvents(mobile?['touchend']:['mouseup'],swatch[0],_handleColorSwatch);}
for(var ci=1;ci<=8;ci++){var clr=[Math.floor(Math.random()*(256-ci))+ci,Math.floor(Math.random()*(256-ci))+ci,Math.floor(Math.random()*(256-ci))+ci];var swatch=jQuery(document.createElement('span'));swatch.addClass('logo-color-swatch');swatch.attr('data-color','rgb('+clr.join(',')+')');swatch.css('background-color','rgb('+clr.join(',')+')');swatch.html('&nbsp;');jQuery('#desktop-popular-swatches',colorc_control_elements).append(swatch);_bindEvents(mobile?['touchend']:['mouseup'],swatch[0],_handleColorSwatch);}
var colorbg=new Image();colorbg.onload=function(){var cpcanvas=jQuery('canvas.color-pick-bg-all',colorc_control_elements)[0];var cpctx=cpcanvas.getContext('2d');cpctx.drawImage(this,0,0,this.width,this.height,0,0,cpcanvas.width,cpcanvas.height);jQuery(cpcanvas).unbind('*');_bindEvents(mobile?['touchmove','touchcancel']:['mouseup','mousemove','mouseout','mousedown'],cpcanvas,_handleColorChangers);};_bindEvents(mobile?['touchstart']:['mousedown'],jQuery('.color-action-button',colorc_control_elements),_handleColorActionsTapDesktop);_bindEvents(['change','blur'],jQuery('.more-options-rgb-inputs input',colorc_control_elements),_handleRgbHexColorInputs);colorbg.src=resources.color_picker2;container.append(colorc_control_elements);}
function _handleColorActionsTap(evt){var me=jQuery(this);var action=me.attr('data-action');switch(action){case'switch-color-optitons':var showid='#custom-color-canvas-picker-container';jQuery('.custom-color-option-container').hide();if(me.hasClass('more-options')){me.removeClass('more-options less-options').addClass('less-options');showid='#custom-color-canvas-picker-container';}else{me.removeClass('more-options less-options').addClass('more-options');showid='#custom-color-swatches-picker-container';}
GTrack.track('editor','color-options-change','UI');jQuery(showid).show();break;case'apply-color':var cobj=editor.getCurrentObject();if(cobj instanceof FLSEditorCore.CObject){cobj.setColor(tempObjColor);jQuery('#color-pick-canvas-color-sample-orig').css('background-color',tempObjColor);orgObjColor=tempObjColor;updateUserCustomColorSwatch(orgObjColor);jQuery('#apply-color-tool-button').addClass('disabled');GTrack.track(cobj,'color-change','Customize');}
break;}
if(evt.preventDefault){evt.preventDefault();}else{evt.returnValue=false;};return false;}
function _handleColorActionsTapImgBorder(evt){var me=jQuery(this);var action=me.attr('data-action');switch(action){case'switch-color-optitons':jQuery('#more-color-options-section').toggleClass('open-section')
jQuery('#more-color-options-section input').blur();GTrack.track('editor','color-options-change','UI');break;}
if(evt.preventDefault){evt.preventDefault();}else{evt.returnValue=false;};return false;}
function _handleColorActionsTapDesktop(evt){var me=jQuery(this);var action=me.attr('data-action');switch(action){case'switch-color-optitons':var showme=true;if(me.hasClass('more-options')){me.removeClass('more-options less-options').addClass('less-options');}else{me.removeClass('more-options less-options').addClass('more-options');showme=false;}
jQuery('#more-color-options-desktop').toggle(showme);jQuery('#'+editorID).toggleClass('more-color-options-on',showme);var ui_height=jQuery('#'+editorID).height();var mopt_height=jQuery('#more-color-options-desktop').height();mopt_height*=(showme?1:-1);jQuery('#'+editorID).css({height:(ui_height+mopt_height)+'px'});GTrack.track('editor','color-options-change','UI');break;}
if(evt.preventDefault){evt.preventDefault();}else{evt.returnValue=false;};return false;}
function _handleRgbHexColorInputs(evt){var me=jQuery(this);var val=me.val();var what={'color[r]':'r','color[g]':'g','color[b]':'b','color[hex]':'hex'};if(what[this.name]){var changed='';switch(this.name){case'color[hex]':val=val.replace(/[^0-9a-f]/ig,'').substring(0,6);break;case'color[r]':case'color[g]':case'color[b]':val=parseInt(val.replace(/[^0-9]/ig,'').substring(0,3),10);if(isNaN(val)||val>255){val=255;}}
changed=what[this.name];this.value=val;var color=[0,0,0];var hex=val;switch(changed){case'hex':color=FLSUtil.hexdec2rgb(parseInt(val,16));break;case'r':case'g':case'b':var inputs=jQuery('.more-options-rgb-inputs input[name*=color]');inputs.each(function(){switch(this.name){case'color[r]':color[0]=parseInt(this.value,10);break;case'color[g]':color[1]=parseInt(this.value,10);break;case'color[b]':color[2]=parseInt(this.value,10);break;}});}
if((lastSelectedObj instanceof FLSEditorCore.CObject)&&lastSelectedObj.colorEditable()){hex=color[0]<<16;hex+=color[1]<<8;hex+=color[2];var hexstr=(0x1000000|hex).toString(16).substring(1);jQuery('input[name="color[r]"]').val(color[0]);jQuery('input[name="color[g]"]').val(color[1]);jQuery('input[name="color[b]"]').val(color[3]);jQuery('input[name="color[hex]"]').val(hexstr);lastSelectedObj.setColor('rgb('+color.join(',')+')');_updateColorEditingTools(lastSelectedObj);}}
return false;}
function _hanndleSideButtonActions(evt){var me=jQuery(this)
if(!me.hasClass('disabled')){switch(evt.type){case'mouseup':case'touchend':case'pointerup':case'keyup':_handleInlineTextEditActions();var action=me.attr('data-action');switch(action){case'save':case'preview':_showPreview(true,true);jQuery('.fls-editor-bottom-button-container').hide();break;case'tips':break;case'undo':editor.undo();if(lastSelectedObj instanceof FLSEditorCore.CSelectionGroup){lastSelectedObj.updateBox()}
_updateUndoRedoButtons();_setAddTextBtnStatus();break;case'redo':editor.redo();if(lastSelectedObj instanceof FLSEditorCore.CSelectionGroup){lastSelectedObj.updateBox()}
_updateUndoRedoButtons();_setAddTextBtnStatus();break;case'reset':if(view_frame_image_border===true){addLoading(editorID).style.backgroundColor='rgba(0,0,0,0.8)';jQuery('#'+loadingOverlayID).show().html(FlsFlashErrorMessageFlat(uiTexts['mobile_editor']['reset_logo_warning']['title'],uiTexts['mobile_editor']['reset_logo_warning']['message'],function(){var dlgchoice=jQuery(this).attr('data-choice');if(dlgchoice=='ok'){_handleResetLogo();}
jQuery('#'+loadingOverlayID).empty().remove();},true,uiTexts['dynamic']['yes'],uiTexts['dynamic']['no']));}else{_handleResetLogo();}
break;}
_updateColorEditingTools(lastSelectedObj);_updateFontEditControls(lastSelectedObj);GTrack.track('editor',action,'UI');break;default:}}
if(evt.preventDefault){evt.preventDefault();}else{evt.returnValue=false;};return false;}
function _addSideButtonControls(container){var tbtns=[];tbtns.push(jQuery('<span class="sidebutton save" data-action="save" title="'+uiTexts['left_menu']['save']['label']+'">&nbsp;</span>'));if(logoCfg.lang=='en'){}
tbtns.push(jQuery('<span class="sidebutton preview" data-action="preview" title="'+uiTexts['left_menu']['preview']['label']+'">&nbsp;</span>'));for(var i=0;i<tbtns.length;i++){container.append(tbtns[i]);}
var bottombtns=jQuery(document.createElement('div'));bottombtns.css({position:'absolute',bottom:'5px',width:'100%'});var undobtn=jQuery('<span class="sidebutton undo disabled" data-action="undo" title="'+uiTexts['left_menu']['undo']['label']+'">&nbsp;</span>');var redobtn=jQuery('<span class="sidebutton redo disabled" data-action="redo" title="'+uiTexts['left_menu']['redo']['label']+'">&nbsp;</span>');var resetbtn=jQuery('<span class="sidebutton reset" data-action="reset" title="'+uiTexts['left_menu']['reset']['label']+'">&nbsp;</span>');bottombtns.append(undobtn);bottombtns.append(redobtn);bottombtns.append(resetbtn);container.append(bottombtns);_bindEvents(mobile?['touchend']:['mouseup'],jQuery('.sidebutton',container),_hanndleSideButtonActions);}
function _addFontEditingControls(container){var fontcontrol=jQuery(document.createElement('div'));fontcontrol.css({margin:'0',height:'39px',width:'100%',borderBottom:'1px solid #DCDCDC',paddingTop:'11px'});var fontc_control_elements=jQuery('<table class="tool-table"><tr>'+'<td style="width:60px;"><h4 class="tool-ttl" style="padding-left:5px; width:55px" title="'+uiTexts.text_tool.entered_text+'">'+uiTexts.text_tool.entered_text_html5+'<\/h4><\/td>'+'<td style="width:270px;padding-top: 2px;"><input autocomplete="off" disabled="disabled" type="text" style="margin: 0px 10px 0 0; border: 1px solid #CACACA; font-size: 16px; height: 21px;padding: 2px; width: 250px; font-weight: bold; color: #666; font-family: verdana, arial;" name="entered-text-edit" value="" maxlength="'+logoline_max_length+'"  ><\/td>'+'<td style="width:60px;"><h4 class="tool-ttl" style="width:55px" title="'+uiTexts.text_tool.select_font+'">'+uiTexts.text_tool.select_font_html5+'<\/h4><\/td>'+'<td class="logo-fonts-dropdown-container" style="padding-top: 2px;"><\/td>'+'<td style="width: 60px;"><h4 class="tool-ttl" style="width: 55px; padding-left:5px;" title="'+uiTexts.text_tool.size+'">'+uiTexts.text_tool.size+'<\/h4><\/td>'+'<td class="logo-fonts-size-change-container" style="padding-top: 2px;"><span class="resizebuttons"><span class="font-size-label">-</span><span class="resizebutton up">&nbsp;</span><span class="resizebutton down">&nbsp;</span></span><\/td>'+'<td><span class="add-text-button" style="position: absolute; right: 13px;top: 9px; width: auto; padding:0 5px 0 20px; text-align:left;" title="'+uiTexts.buttons.text_tool.add_text_enabled+'"><span class="more-less-sign">&nbsp;</span>'+uiTexts.buttons.text_tool.add_text_enabled+'</span><\/td>'+'<\/tr><\/table>');fontcontrol.append(fontc_control_elements);jQuery('[name="entered-text-edit"]',fontc_control_elements).bind('focus keyup',_handleTextInput);_bindEvents(mobile?['touchstart']:['mousedown'],jQuery('.resizebutton',fontc_control_elements),_handleTextSize);_bindEvents(mobile?['touchstart']:['mousedown'],jQuery('.add-text-button',fontc_control_elements),_handleAddNewText);container.append(fontcontrol);}
function _addFontEditingControlsDesktop(container){var fontc_control_elements=jQuery('<div style="float:right; width:480px;"> <div class="outer-border"><div class="inner-border">'+'<div style="width:100%; height: 45px;padding-top:15px;"><h4 class="tool-ttl" title="'+uiTexts.text_tool.select_font+'" style="margin:5px; font-size:16px; float:left;font-weight:bold;">'+uiTexts.text_tool.header+' <!-- span class="fls-editor-help-button" data-message-key="text_tool" data-message-subkey="help_split_20141001" style="margin: 0 5px;">?</span --><\/h4><span class="add-text-button" style="float:right; margin: 4px 20px; padding:0 10px 0 20px; width: auto;" title="'+uiTexts.buttons.text_tool.add_text_enabled+'"><span class="more-less-sign">&nbsp;</span>'+uiTexts.buttons.text_tool.add_text_enabled+'</span></div>'+'<div style=""><table class="tool-table" style="margin:5px;"><tr>'+'<td style="width:185px;"><h4 class="tool-ttl" title="'+uiTexts.text_tool.entered_text+'">'+uiTexts.text_tool.entered_text+'<\/h4><\/td>'+'<td style=""><h4 class="tool-ttl" style="max-width:165px;" title="'+uiTexts.text_tool.select_font+'">'+uiTexts.text_tool.select_font+'<\/h4></td>'+'<td style="width: 100px;"><h4 class="tool-ttl" title="'+uiTexts.text_tool.size+'">'+uiTexts.text_tool.size+'<\/h4></td>'+'</tr><tr>'+'<td><input autocomplete="off" disabled="disabled" type="text" style="margin: 0px; border: 1px solid #CACACA; font-size: 16px; height: 22px;padding: 2px; width: 175px; font-weight: bold; color: #666; font-family: verdana, arial;" name="entered-text-edit" value="" maxlength="'+logoline_max_length+'"  ><\/td>'+'<td class="logo-fonts-dropdown-container"></td>'+'<td class="logo-fonts-size-change-container"><span class="resizebuttons"><span class="font-size-label">-</span><span class="resizebutton up">&nbsp;</span><span class="resizebutton down">&nbsp;</span></span></td>'+'<\/tr><\/table><\/div>'+'<\/div><\/div><\/div>');jQuery('[name="entered-text-edit"]',fontc_control_elements).bind('focus keyup input blur',_handleTextInput);_bindEvents(mobile?['touchstart']:['mousedown'],jQuery('.resizebutton',fontc_control_elements),_handleTextSize);_bindEvents(mobile?['touchstart']:['mousedown'],jQuery('.add-text-button',fontc_control_elements),_handleAddNewText);container.append(fontc_control_elements);}
function _setAddTextBtnStatus(){var elements=editor.getObjects();var tcnt=0;for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CText){tcnt++;}}
jQuery('#'+editorID+' .add-text-button').toggleClass('disabled',tcnt>=maxTextObjCnt);}
function _handleAddNewText(evt){var elements=editor.getObjects();var tcnt=0;for(var i=0;i<elements.length;i++){if(elements[i]instanceof FLSEditorCore.CText){tcnt++;}}
if(!textprops.length){var fontname='Helvetica';for(var i in logofonts){fontname=i;break;}
textprops.push({color:'rgb(0,0,0)',text:uiTexts['dynamic']['enter_text'],fontsize:20,font_family:fontname});}
if(tcnt<maxTextObjCnt){_handleInlineTextEditActions();var to=new FLSEditorCore.CPathText();to.setProperties(textprops[textprops.length-1]);to.removable(true);to.xmlspace='preserve';to.setMatrix([1,0,0,1,0,0]);to.default_text(to.getText());editor.addObject(to);var center=to.objCenter();var vs=editor.viewsize();to.translate(vs.width/2-center.x,vs.height/2-center.y);editor.setCurrentObject(to);editor.undoPush(to,false,'op:addtext');lastSelectedObjSubpath=null;textprops.push(textprops.shift());_updateFontEditControls(to);_updateColorEditingTools(to);to.hastextedit(true);lastSelectedObj=to;GTrack.track('editor','add-text','UI');tcnt++;}
jQuery(this).toggleClass('disabled',tcnt>=maxTextObjCnt);if(evt.preventDefault){evt.preventDefault();}else{evt.returnValue=false;};return false;}
function _insertEditorCss(){var previewtopcorner=editor.viewtopleft();var previewsize=editor.viewsize();var _top=previewtopcorner.y+118-60;var editorpos=jQuery('#'+editorID).offset();jQuery('style#'+editorID+'-CSS').remove();var editor_css='<style type="text/css" id="'+editorID+'-CSS">\n'+'body.html5-editor-active{margin:0;position:relative;display:table;width:100%;}\n'+'#'+editorID+'{border-bottom:1px solid #DCDCDC;border-top:1px solid #DCDCDC; background-color : '+uiColors['panels']['backgroundColor']+';position: relative;margin-bottom: 30px;-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;-o-user-select: none; user-select: none;}\n'+'::-ms-clear{width:0px;height:0px;display:none;}\n'+'.fls-editor-top-toolbar{display: block; height: 150px; clear: both;border-bottom: 1px solid #DCDCDC;position:relative;}'+'.fls-editor-top-toolbar .container{background-color: '+uiColors['panels']['backgroundColor']+';height: 150px; overflow: hidden;text-align:left;position:relative;}\n'+'.fls-editor-top-toolbar .outer-border{height: 150px;}'+'.fls-editor-top-toolbar .inner-border{height: 150px;}'+'.fls-editor-top-toolbar .tool-ttl{display:inline-block;font-weight:normal;line-height: 32px; text-align:right; margin: 0 10px 0 0; text-overflow: ellipsis; font-size: 14px; font-family: arial, verdana; color:'+uiColors['panels']['fontColor']+';white-space: nowrap; width: 125px; overflow:hidden;}'+'.fls-editor-side-toolbar{width: 95px; display: block; float: left;}'+'.fls-editor-side-toolbar .container{background-color: '+uiColors['panels']['backgroundColor']+'; margin: 1px; overflow: hidden; position: relative;}'+'.fls-editor-top-toolbar table{border-collapse: collapse;}'+'.fls-editor-top-toolbar table td{padding: 0px;line-height: 1em; vertical-align:top;}'+'.fls-logo-color-swatches-container{height:100%;border-right: 1px solid #DCDCDC;text-align: center;width: 175px;float:left;}'+'.fls-logo-colors-custom-container{height:100%;;width: 728px;float:left;}'+'.custom-color-option-container{width:425px;height:80px;margin: 10px 24px; float:left;}'+'.custom-color-actions-container{float:right;width:255px;}'+'.color-action-item{float:left; width:127px; margin:0px;padding:0;text-align:center;}'+'.color-action-item.right{float:right;}'+'.color-action-button, .add-text-button{position:relative; width:110px; height: 24px; border: 1px solid #8C8C8C; text-align:center; font-size: 11px;line-height: 24px; margin: 5px auto; font-family: verdana,arial; color: #464646; display:block;cursor:pointer;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;'+'background-color: #f3f3f3;'+'}'+'.color-action-button.more-options:after, .add-text-button.more-options:after{content: "'+uiTexts['buttons']['color_tool']['more_options']+'"}'+'.color-action-button.less-options:after{content: "'+uiTexts['buttons']['color_tool']['less_options']+'"}'+'.color-action-button.blue-button{'+'background-color: rgb(67,154,211);'+'color: #FFF;'+'}'+'.color-action-button:ACTIVE{'+'color:#FFF;'+'background-color: rgb(64,201,73);'+'}'+'.color-action-button.disabled,.color-action-button.disabled:ACTIVE{'+'color:#FFF;'+'background-color: #ECECEC;'+'text-shadow: 0px 0px 1px #000;'+'box-shadow: 0 0 1px #000000 inset;'+'}\n'+'.add-text-button.disabled,.add-text-button.disabled:HOVER{color:#CCC; cursor:default;background-color:#fefefe;}\n'+'.color-action-button:HOVER, .add-text-button:HOVER{color:#FFF;background-color:#2674ad;}\n'+'.more-less-sign{background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAoCAYAAADHVmuAAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAK6wAACusBgosNWgAAABZ0RVh0Q3JlYXRpb24gVGltZQAwMy8yNi8xNRnvNI8AAAAcdEVYdFNvZnR3YXJlAEFkb2JlIEZpcmV3b3JrcyBDUzVxteM2AAAA3ElEQVQ4jdVTsW4CMRRzqnwhX4C6MTH2Gxi7dYBKHWBl4e+I7Q6EXBIO6SQolLecEvv5OU4uoKr19mBZsARJWMxn4YzFmkgS9olkqYZ6YipEyQ0xfP3sbTuDw9jagiREiZA8kNw22CflyMQOzE3uPFJsRsgG3PoDgFAvVp/fDeNj+V7wt4vWKzWZGDzi5ybFycS42R18joZkjil/y1qIJCESHCFQKpnGdDzmTUJUUewPGRNTVhkUx+qJ8TSPwp2PEMIfP4pJx77/6FeJ576K0/8ZAP/9ZiK623nc6F/smviFD7L4QAAAAABJRU5ErkJggg=="); background-repeat: no-repeat; width:10px; height:10px; display:block; margin: -5px 5px 0 0;background-position: 0 0;position:absolute;top:50%; left: 5px;}'+'.more-options:HOVER .more-less-sign, .add-text-button:HOVER .more-less-sign, .add-text-button.disabled .more-less-sign{background-position: 0 -20px;}'+'.less-options .more-less-sign{background-position: 0 -10px;}'+'.less-options:HOVER .more-less-sign{background-position: 0 -30px;}'+'.color-pick-sample{width:110px;height: 18px;border:1px solid #C5C5C5; margin: 0px auto; top: -5px; position: relative;}'+'.logo-color-swatch{border : 1px solid #C5C5C5; width: 18px;height: 18px;float: left;display: block;text-decoration: none;cursor: pointer;margin:3px;}'+'.resizebuttons{border-bottom: 1px solid #FFF; overflow: hidden;}\n'+'.resizebutton{-webkit-user-select: none;-moz-user-select: none;user-select: none;cursor:pointer;text-decoration: none; background-image: url('+resources.fontsizeupdown+'); background-repeat: no-repeat; width: 26px; height: 26px; display: block; border: 1px solid #CACACA; float: left;}\n'+'.resizebutton:ACTIVE{background-image: url('+resources.fontsizeupdown_a+');}\n'+'.resizebutton:HOVER{background-image: url('+resources.fontsizeupdown_a+');}\n'+'.resizebutton.up{background-position: -2px -2px;}\n'+'.logo-fonts-size-change-container .font-size-label{color: #666666;display: block;font-family: arial;font-size: 20px;line-height: 26px; height:26px;position: relative; float:left;text-align: center;width: 40px; border: 1px solid #CACACA; border-right:0;background-color: #FFF;}\n'+'.resizebutton.down{background-position: -33px -2px; border-left: 0;}\n'+'.sidebutton{-webkit-user-select: none;-moz-user-select: none;user-select: none;cursor:pointer; overflow:hidden;position: relative; color: #888; background-color:#FEFEFE; border: 1px solid #C5C5C5; box-shadow: 0px 1px 0 #FFF; margin: 10px auto; width: 54px; height: 52px; display: block; text-decoration: none; text-align: center; background-image: url('+resources.sidebuttons+'); background-repeat: no-repeat;}\n'+'.sidebutton:AFTER{margin: 0 2px;text-overflow:ellipsis; white-space:nowrap;content: " "; position: absolute; display: block; font-size: 10px; line-height: 11px; font-family: verdana, arial; font-weight: normal;display: block; bottom: 3px; left: 0; width: 50px;}\n'+'.sidebutton:ACTIVE,.sidebutton:HOVER{background-color:#2E70A4; color: #FFF; border-color: #104D81;}\n'+'.sidebutton.save,.sidebutton.save.disabled:ACTIVE,.sidebutton.save.disabled:HOVER{background-position: -246px 4px;}\n'+'.sidebutton.save:ACTIVE,.sidebutton.save:HOVER{background-position: -290px 4px;}\n'+'.sidebutton.save:AFTER{content: "'+uiTexts['left_menu']['save']['label']+'"}\n'+'.sidebutton.tips,.sidebutton.tips.disabled:ACTIVE,.sidebutton.tips.disabled:HOVER{background-position: -75px 4px;}\n'+'.sidebutton.tips:ACTIVE,.sidebutton.tips:HOVER{background-position: -116px 4px;}\n'+'.sidebutton.tips:AFTER{content: "'+uiTexts['left_menu']['tips']['label']+'"}\n'+'.sidebutton.preview,.sidebutton.preview.disabled:ACTIVE,.sidebutton.preview.disabled:HOVER{background-position: -332px 4px;}\n'+'.sidebutton.preview:ACTIVE,.sidebutton.preview:HOVER{background-position: -375px 4px;}\n'+'.sidebutton.preview:AFTER{content: "'+uiTexts['left_menu']['preview']['label']+'"}\n'+'.sidebutton.undo,.sidebutton.undo.disabled:ACTIVE,.sidebutton.undo.disabled:HOVER{background-position: 10px 8px;}\n'+'.sidebutton.undo:ACTIVE,.sidebutton.undo:HOVER{background-position: -32px 8px;}\n'+'.sidebutton.undo:AFTER{content: "'+uiTexts['left_menu']['undo']['label']+'"}\n'+'.sidebutton.redo,.sidebutton.redo.disabled:ACTIVE,.sidebutton.redo.disabled:HOVER{background-position: -159px 8px;}\n'+'.sidebutton.redo:ACTIVE,.sidebutton.redo:HOVER{background-position: -201px 8px;}\n'+'.sidebutton.redo:AFTER{content: "'+uiTexts['left_menu']['redo']['label']+'"}\n'+'.sidebutton.reset, .sidebutton.reset.disabled:ACTIVE{background-position: -417px 5px;}\n'+'.sidebutton.reset:ACTIVE,.sidebutton.reset:HOVER{background-position: -462px 5px;}\n'+'.sidebutton.reset:AFTER{content: "'+uiTexts['left_menu']['reset']['label']+'"}\n'+'.sidebutton.disabled,.sidebutton.disabled:ACTIVE,.sidebutton.disabled:HOVER{color: #888; background-color:#FEFEFE; border: 1px solid #C5C5C5; opacity: 0.6;}\n'+'#FLSPreviewOverlay{overflow:hidden;color: #FFF; background-color:rgba(0,0,0,0.7);position:absolute; display:block; width:100%; height:100%;top:0px;left:0px;z-index:110;min-height:100vh;}\n'+'#FLSPreviewOverlay #FLSPreviewContainer{position:relative;left:'+editorpos.left+'px;top:'+editorpos.top+'px;text-align:center;}\n'+'#FLSPreviewOverlay #FLSPreviewMsg{color: #FFF; top:'+_top+'px;position: relative;font-size:22px;font-weight:bold;font-family:verdana,arial;width:80%; margin:0 auto; display:block;}\n'+'#FLSPreviewOverlay #FLSPreview{border:3px solid #CCC; width:'+(previewsize.width+3)+'px;height:'+(previewsize.height+3)+'px;position: absolute;left:'+(previewtopcorner.x+78-3)+'px;top:'+(previewtopcorner.y+118-3)+'px;background-color:#FFF;}\n'+'#FLSPreviewOverlay #FLSPreviewbttons{position:absolute; width: 100%; bottom: 5px;}\n'+'.fls-button{text-align:center;min-width: 130px;position:relative;-webkit-user-select: none;-moz-user-select: none;user-select: none;'+'background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(255,255,255,0.25)), color-stop(100%,rgba(255,255,255,0)));'+'background-image:-webkit-linear-gradient(top, rgba(255,255,255,0.25) 0%,rgba(255,255,255,0) 100%);'+'background-image:linear-gradient(to bottom, rgba(255,255,255,0.25) 0%,rgba(255,255,255,0) 100%);'+'cursor:pointer;font-weight: normal;font-family: arial,verdana,sans-serif;font-size: 18px;line-height:22px; '+'display:inline-block;white-space: nowrap;color: #FFF; border-radius: 25px; padding: 8px 30px; border: 1px solid #104d81; margin: 5px !important;text-transform:capitalize;}\n'+'.fls-button.bold{font-weight: bold;}\n'+'.lmx_secondary_button{background-color: #104d81;border-color:#104d81;}\n'+'.lmx_secondary_button:ACTIVE,.lmx_secondary_button:HOVER{background-color: #2e70a4;background-image: none;}\n'+'.lmx_primary_button{'+'background: -moz-linear-gradient(top, rgba(243,172,79,1) 0%, rgba(243,172,79,0) 100%);'+'background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(243,172,79,1)), color-stop(100%,rgba(243,172,79,0)));'+'background: -webkit-linear-gradient(top, rgba(243,172,79,1) 0%,rgba(243,172,79,0) 100%);'+'background: -o-linear-gradient(top, rgba(243,172,79,1) 0%,rgba(243,172,79,0) 100%);'+'background: -ms-linear-gradient(top, rgba(243,172,79,1) 0%,rgba(243,172,79,0) 100%);'+'background: linear-gradient(to bottom, rgba(243,172,79,1) 0%,rgba(243,172,79,0) 100%);'+'background-color:#E54D19;border-color:#e64e18;box-shadow: 0px 0px 1px #f9c231 inset;}\n'+'.lmx_primary_button:ACTIVE,.lmx_primary_button:HOVER{background-color:#59aa06;border-color:#59aa06;box-shadow: 0px 0px 1px #c5e64c inset;'+'background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(255,255,255,0.25)), color-stop(100%,rgba(255,255,255,0)));background-image:-webkit-linear-gradient(top, rgba(255,255,255,0.25) 0%,rgba(255,255,255,0) 100%);background-image:linear-gradient(to bottom, rgba(255,255,255,0.25) 0%,rgba(255,255,255,0) 100%);'+'}\n'+'#FLS_PageLoadingOverlay{background-color: rgba(0,0,0,0.7); position: absolute; top:0; left:0; width: 100%; height:100%;z-index:200;}\n'+'.FLS-Overlay-Message{color: #FFFFFF !important;font-family: verdana,arial;font-size: 12px;height: 30px;top: 50%;padding-top: 20px;position: relative;text-align: center;background-position: center top;background-repeat: no-repeat;}\n'+'.FLS-Flash-Message{margin: 0  auto; line-height: 1.2em !important; box-shadow: 0 -1px 0 #FFF;color: #FFFFFF !important;font-family: verdana,arial;font-size: 11px;top: 40%;padding: 0 0 10px;position: relative;text-align: center;background-color: #666; border-radius: 5px; width: 300px;}\n'+'.FLS-Flash-Message .title{font-weight: bold; padding: 10px; display:block;}\n'+'.FLS-Flash-Message .message{color: #FFF; box-shadow: -1px -1px 1px #FFFFFF inset;background-color: #333333;border-radius:5px;clear: both;display: block;margin: 0 10px;padding: 10px;}\n'+'.FLS-Flash-Message .button{color: #FFF; text-shadow: 1px 1px #000; -webkit-user-select: none;-moz-user-select: none;user-select: none;cursor: pointer; background-color: #CCC; border: 2px solid #3399FF; border-radius: 3px;clear: both;display: block;font-weight: bold;margin: 20px auto 0;padding: 3px 10px;width: 40px;}\n'+'.FLS-Flash-Message .button:active{background-color: #666;}\n'+'.fls-editor-help-button {box-shadow: 0 1px 0 #FFF;-webkit-user-select: none;-moz-user-select: none;user-select: none; cursor:pointer; background-color: #F5F5F5; color: #666; border-radius: 10px; border: 1px solid #666; width: 20px; height: 20px; line-height: 21px; font-weight: bold; font-size: 16px; text-align:center; display: inline-block; margin: 0 10px; font-family: arial;}\n'+'.fls-editor-help-button:ACTIVE,.fls-editor-help-button:HOVER {background-color: #2E70A4; color: #FFF;}\n'+'.fls-editor-help-bubble {text-align:left; color: #666; background-color: #FFFFFF; border: 5px solid #2E70A4;border-radius: 10px;font-family: arial;font-size: 12px;line-height: 1.2em;padding: 10px;position: absolute;width: 200px;z-index: 100;box-shadow: 0 0 4px rgba(0,0,0,0.5);}\n'+'.fls-editor-help-bubble::before {content: "";position: absolute;top: -20px;left: 50px;border-width: 0 20px 20px;border-style: solid;border-color: #2E70A4 transparent;display: block;width: 0;}\n'+'.fls-editor-help-bubble::after {content: "";position: absolute;top: -13px;left: 50px;border-width: 0 20px 20px;border-style: solid;border-color: #fff transparent;display: block;width: 0;}\n'+'.fls-editor-bottom-button-container{bottom: -20px;height: 40px;position: absolute;right: 30px;z-index: 110;}'+'.fls-editor-bottom-button-container .fls-button.preview{padding: 7px 20px; font-size:18px;box-shadow:0 3px 6px rgba(0,0,0,0.8);}'+'#FLSPreviewbttons .fls-button.preview{padding: 7px 20px;font-weight:bold;}'+'.fls-editor-bottom-button-container .fls-button.preview:before{content:" ";background-image: url('+resources.bottom_butns_icons+'); width: 23px; height:18px; display:inline-block; position:relative; top:3px;background-position: 0 center;background-repeat:no-repeat;}'+'.fls-editor-bottom-button-container .fls-button.save{padding: 7px 20px; font-size:18px;box-shadow: 0 3px 6px rgba(0,0,0,0.8);}'+'#FLSPreviewbttons .fls-button.save{padding: 7px 20px;font-weight:bold;}'+'.fls-editor-bottom-button-container .fls-button.save:after,#FLSPreviewbttons .fls-button.save:after{content:" ";background-image: url('+resources.bottom_butns_icons+'); width: 18px; height:18px; display:inline-block; position:relative; top:3px;background-position: -25px center;background-repeat:no-repeat;}'+'.fls-editor-bottom-button-container .fls-button.continue{padding: 7px 20px;}'+'#FLSPreviewbttons .fls-button.continue{padding: 7px 20px;font-weight:bold;}'+'.fls-editor-bottom-button-container .fls-button.continue:before,#FLSPreviewbttons .fls-button.continue:before{content:" ";background-image: url('+resources.bottom_butns_icons+'); width: 18px; height:18px; display:inline-block; position:relative; top:3px;background-position: -57px center;background-repeat:no-repeat;}'+'#flash_container{height: 635px !important;}'+'.html5-desktop .color-action-button,.html5-desktop .add-text-button{text-align: left; width:auto; padding: 0 4px 0 0;}\n'+'.color-action-button:after{padding-left:20px; text-align:left;}\n'+'.html5-desktop .fls-editor-top-toolbar{height: 132px;}\n'+'.html5-desktop .fls-editor-top-toolbar .container{height: 132px;}\n'+'.html5-desktop .fls-editor-top-toolbar .outer-border{height: 132px;}'+'.html5-desktop .fls-editor-top-toolbar .inner-border{height: 132px;}'+'.html5-desktop .add-logo-or-image-button, .html5-desktop .save-print-product-button{margin: 3px; top:0;}'+'.html5-desktop .fls-editor-top-toolbar .tool-ttl{text-align: left; line-height: 20px; width: auto; font-size:15px;text-overflow:ellipsis;}'+'.html5-desktop .fls-logo-color-swatches-container{margin: 5px; border:none; text-align: left;width: 60px;float:left; background-color: #F4F4F4; box-shadow: inset 0px 0px 6px rgba(0,0,0, 0.4);}\n'+'.html5-desktop .logo-color-swatch{border : 1px solid #000; border-width: 0 1px 1px 0; margin:0px;width: 19px; height:19px; overflow:hidden;}\n'+'.html5-desktop .logo-color-swatch.last-swatch{border-right-width:0}\n'+'.html5-desktop .logo-color-swatch.bottom-swatch{border-bottom-width:0}\n'+'.html5-desktop .custom-color-option-container{width:270px;height:60px;margin: 5px;}\n'+'.html5-desktop .color-pick-sample-container{overflow:hidden;background-color: #F4F4F4; width:59px;height: 59px;margin: 5px; float:left; position: relative;box-shadow: inset 0px 0px 6px rgba(0,0,0, 0.4);}'+'.html5-desktop .color-pick-sample-container::BEFORE{content: "";width: 90px;height: 0px;border-top: 1px solid #000;position: absolute;top: 29px;left: -15px;transform:rotate(-7deg);-ms-transform:rotate(-45deg);-moz-transform:rotate(-45deg);-webkit-transform:rotate(-45deg);-o-transform:rotate(-45deg);}'+'.html5-desktop .color-pick-sample-container .color-pick-sample{width:100%;height: 100%;border:0; margin: 0; position: relative; display:block; top:0; left:0;}'+'.html5-desktop #more-color-options-desktop{clear: both; float: left; width: 100%; height: 33px; display:none;border-top:1px solid #DCDCDC;}'+'.html5-desktop.more-color-options-on #more-color-options-desktop{display:block;}'+'.html5-desktop.more-color-options-on .fls-editor-top-toolbar{height: 165px;}'+'.html5-desktop.more-color-options-on .fls-editor-top-toolbar .container{height: 165px;}'+'.html5-desktop .more-options-rgb-inputs,.html5-desktop .more-options-popular-swatches{white-space:nowrap;line-height: 33px;float:left;border-right: 1px solid #DCDCDC; margin: 0;color: #666;font-family: arial,verdana,sans-serif;font-size: 14px;}'+'.html5-desktop .more-options-rgb-inputs label,.html5-desktop .more-options-popular-swatches label{margin: 0 5px;}'+'.html5-desktop .more-options-rgb-inputs input[type=text]{width: 22px;border: 1px solid #C5C5C5;font-size: 13px;color: #666;padding: 2px;}'+'.html5-desktop .more-options-rgb-inputs.hex{}'+'.html5-desktop .more-options-rgb-inputs.hex input[type=text]{width: 50px;}'+'.html5-desktop .more-options-popular-swatches{border-right: 0; overflow:hidden;}'+'.html5-desktop #more-color-options-desktop .logo-color-swatch{float:left; margin: 2px; border:1px solid #000; width:16px; height: 16px;}'+'.html5-desktop #more-color-options-desktop #desktop-popular-swatches{overflow: hidden;display: block;max-height: 22px;position:relative; top:5px;}'+'.non-en .sidebutton:AFTER{display:none !important;}\n'+'.non-en .sidebutton.save,.non-en .sidebutton.save.disabled:ACTIVE,.non-en .sidebutton.save.disabled:HOVER{background-position: -246px 12px;}\n'+'.non-en .sidebutton.save:ACTIVE,.non-en .sidebutton.save:HOVER{background-position: -290px 12px;}\n'+'.non-en .sidebutton.tips,.non-en .sidebutton.tips.disabled:ACTIVE,.non-en .sidebutton.tips.disabled:HOVER{background-position: -75px 12px;}\n'+'.non-en .sidebutton.tips:ACTIVE,.non-en .sidebutton.tips:HOVER{background-position: -116px 12px;}\n'+'.non-en .sidebutton.preview,.non-en .sidebutton.preview.disabled:ACTIVE,.non-en .sidebutton.preview.disabled:HOVER{background-position: -332px 12px;}\n'+'.non-en .sidebutton.preview:ACTIVE,.non-en .sidebutton.preview:HOVER{background-position: -375px 12px;}\n'+'.non-en .sidebutton.undo,.non-en .sidebutton.undo.disabled:ACTIVE,.non-en .sidebutton.undo.disabled:HOVER{background-position: 10px 12px;}\n'+'.non-en .sidebutton.undo:ACTIVE,.non-en .sidebutton.undo:HOVER{background-position: -32px 12px;}\n'+'.non-en .sidebutton.redo,.non-en .sidebutton.redo.disabled:ACTIVE,.non-en .sidebutton.redo.disabled:HOVER{background-position: -159px 12px;}\n'+'.non-en .sidebutton.redo:ACTIVE,.non-en .sidebutton.redo:HOVER{background-position: -201px 12px;}\n'+'.non-en .sidebutton.reset,.non-en .sidebutton.reset.disabled:ACTIVE,.non-en .sidebutton.reset.disabled:HOVER{background-position: -417px 11px;}\n'+'.non-en .sidebutton.reset:ACTIVE,.non-en .sidebutton.reset:HOVER{background-position: -462px 11px;}\n'+'.editor-has-product-showcase-block {margin-bottom: 10px !important;}\n'+'.editor-has-product-showcase-block .fls-editor-bottom-button-container{bottom: 20px; left: 95px; right: initial; text-align: center; width: 840px;}\n'+'.font-size-slider-control-wrapper{position:relative; width:auto; margin:0 10px;}\n'+'.font-size-slider-control-wrapper .font-size-slider-controls{position:relative; width:100%;margin:5px 0 15px 0;}\n'+'.font-size-slider-control-wrapper .font-size-slider-strip{margin: 0 50px; position:relative; height: 32px;}\n'+'.font-size-slider-control-wrapper .font-size-slider-strip-line{position:relative; border-top:1px solid #DDD;border-bottom:1px solid #FFF; width:100%; height:0px;font-size:0;top:50%;margin-top:-1px;}\n'+'.font-size-slider-control-wrapper .font-size-slider-knob{position:absolute; width:25px; height:25px; border-radius:25px; border:1px solid #DDD; background-color:#FFF;top:-13px;cursor:pointer;}\n'+'.font-size-slider-control-wrapper .font-size-slider-knob .font-size-slider-knob-inner{widt:11px; height:11px; border-radius:6px; border:1px solid #004D89; background-color:#03609E;margin:6px;}\n'+'.font-size-slider-control-wrapper .font-size-slider-btn{position:absolute; width:30px; height:30px; border-radius:30px; background-color:#FFF; border:1px solid #ddd;top:0;cursor:pointer;font-size:28px;line-height:30px;text-align:center;}\n'+'.font-size-slider-control-wrapper .font-size-slider-btn.slider-increment{right:0;}\n'+'.font-size-slider-control-wrapper .font-size-slider-btn.slider-decrement{left:0;}\n'+'.font-size-slider-control-wrapper .font-size-slider-btn.slider-increment::AFTER,'+'.font-size-slider-control-wrapper .font-size-slider-btn.slider-decrement::AFTER{font-family: verdana,arial,sans-serif;font-size: 28px;font-weight: bold;color: #03609E;width: 100%;height: 100%;line-height: 1em;position: absolute;top: 0;left: 0;}\n'+'.font-size-slider-control-wrapper .font-size-slider-btn.slider-increment::AFTER{content:"+"}\n'+'.font-size-slider-control-wrapper .font-size-slider-btn.slider-decrement::AFTER{content:"-"}\n'+'.font-size-slider-control-wrapper .font-size-slider-label{position:relative; margin:5px 0;font-size:12px;color:#A4A4A4; font-size:13px;font-family: arial,verdana,sans-serif;}\n'+'.font-size-slider-control-wrapper .font-size-slider-label .font-size-value-label{color: #666;}\n'+'\n';editor_css+='</style>\n';jQuery(editor_css).appendTo('head');}
function _handleErrorDlgOkButton(){if(typeof(Drupal)=='object'){window.location.href=Drupal.settings.baseUrl+'/step1';}}
function _handleResetLogo(){var txtedit=jQuery('[name="entered-text-edit"]',jQuery('#'+editorID));txtedit.attr('disabled',true);txtedit.val('');jQuery('#'+editorID+' .fls-editor-top-toolbar .font-size-label').html('-');var selector=jQuery('#'+editorID+' .fls-editor-top-toolbar .logo-fonts-dropdown-container');jQuery('.font-name',selector).html('&nbsp;');jQuery('.sidebutton.undo, .sidebutton.redo, #apply-color-tool-button').addClass('disabled');jQuery('#'+editorID+' #color-pick-canvas-color-sample').css('background-color','transparent');jQuery('#'+editorID+' #color-pick-canvas-color-sample-orig').css('background-color','transparent');editor.clearObjects();editor.clearUndoStacks();var act_save=logoCfg['act'];logoCfg['act']='update';parseSvgData(orgSVG);logoCfg['act']=act_save;if(reset_transforms.length){var objcts=editor.getObjects();for(var i=0;i<objcts.length;i++){objcts[i].setMatrix(reset_transforms[i]);}}
_setAddTextBtnStatus();}
function FlsFlashErrorMessageOld(title,message,callback){var dlg=jQuery('<div class="FLS-Flash-Message">'+'<span class="title">'+title+'</span>'+'<div class="message">'+
message+'<span class="button">OK</span>'+'</div></div>');_bindEvents((mobile?['touchstart']:['mousedown']),jQuery('.button',dlg),typeof(callback)==='function'?callback:_handleErrorDlgOkButton);return dlg;}
function FlsFlashErrorMessage(title,message,callback,cancelbutton,okLabel,cancelLabel){if(typeof(cancelbutton)!=='boolean'){cancelbutton=false;}
okLabel=okLabel?okLabel:uiTexts['dynamic']['ok'];cancelLabel=cancelLabel?cancelLabel:uiTexts['dynamic']['cancel'];var dlg=jQuery('<div class="FLS-Flash-Message">'+'<span class="title">'+title+'</span>'+'<div class="message">'+
message+'<div class="buttons'+(cancelbutton?' hascancel':'')+'">'+'<span class="button" data-choice="ok" style="cursor:pointer;" tabindex="0">'+okLabel+'</span>'+
(cancelbutton?'<span class="button" data-choice="cancel" tabindex="1">'+cancelLabel+'</span>':'')+'</div></div></div>');_bindEvents((mobile?['touchstart']:['mousedown']),jQuery('.button',dlg),typeof(callback)==='function'?callback:_handleErrorDlgOkButton);return dlg;}
function FlsFlashErrorMessageFlat(title,message,callback,cancelbutton,okLabel,cancelLabel){if(typeof(cancelbutton)!=='boolean'){cancelbutton=false;}
okLabel=okLabel?okLabel:uiTexts['dynamic']['ok'];cancelLabel=cancelLabel?cancelLabel:uiTexts['dynamic']['cancel'];var dlg=jQuery('<div class="FLS-Flash-Message-Flat">'+'<span class="title">'+title+'</span>'+'<div class="message">'+
message+'<div class="buttons'+(cancelbutton?' hascancel':'')+'">'+
(cancelbutton?'<span class="fls-button button lmx_secondary_button" data-choice="cancel" >'+cancelLabel+'</span>':'')+'<span class="fls-button button active lmx_primary_button" data-choice="ok" style="cursor:pointer;">'+okLabel+'</span>'+'</div></div></div>');_bindEvents((mobile?['touchstart']:['mousedown']),jQuery('.button',dlg),typeof(callback)==='function'?callback:_handleErrorDlgOkButton);return dlg;}
function addLoading(canvasId){loadingOverlayID='FLSLoading-'+canvasId;var ovrlay=document.getElementById(loadingOverlayID);if(!ovrlay){ovrlay=document.createElement('div');ovrlay.style.position='absolute';ovrlay.style.left='0';ovrlay.style.top='0';ovrlay.style.width='100%';ovrlay.style.height='100%';ovrlay.style.zIndex='130';ovrlay.style.color='#FFF';ovrlay.style.backgroundColor='#000';ovrlay.style.textAlign='center';ovrlay.style.fontSize='11px';ovrlay.style.fontFamily='verdana, arial';ovrlay.id=loadingOverlayID;ovrlay.style.display='block';ovrlay.style.backgroundRepeat='no-repeat';ovrlay.style.backgroundPosition='center center';document.getElementById(canvasId).parentNode.insertBefore(ovrlay,document.getElementById(canvasId));if(typeof(FLSProgressBar)==='function'){var pparams={};if(logoCfg.brand){pparams.brand=logoCfg.brand;}
if(logoCfg.brand_src){pparams.brand_src=logoCfg.brand_src;}
progress_bar=new FLSProgressBar(loadingOverlayID,pparams);ovrlay.style.minHeight='300px';}else{if(typeof(Drupal)=='object'){ovrlay.style.backgroundImage='url("'+Drupal.settings.baseUrl+'/sites/all/modules/thickbox/loading_animation.gif")';}else{ovrlay.style.backgroundImage='url("css/img/loading_animation.gif")';}
ovrlay.innerHTML='<span class="fls-loading-msg" style="top:50%; height: 30px; line-height: 30px; margin:0 0 0 50%;left: -100px;position: absolute;width:200px;"></span>';}}
return ovrlay;}
function loadProgress(msg){if(usingFakeProgress)return false;msg=msg&&msg.length?msg:logoCfg.loading+'...'
if(progress_bar){var percent=parseInt(((total_steps-loadSteps.length)/total_steps)*100,10);var next_percent=parseInt((((total_steps-loadSteps.length)+1)/total_steps)*100,10);progress_bar.progress(percent,msg);return[percent,next_percent];}else{jQuery('#'+loadingOverlayID+' .fls-loading-msg').html(msg);}}
function _LoadUiTexts(canvasId,scallback){var parsed=FLSUtil.parseUri(texts_url);var url=texts_url;var data={};if(parsed.host!=document.domain){url='resources.php';data.url=texts_url;}
loadProgress(logoCfg.loading+'...');jQuery.ajax({url:url,data:data,dataType:'xml',success:function(xml){var texts=jQuery('resources texts',xml);texts.children().each(function(idx){uiTexts[this.nodeName]=jQuery(this).text();});texts=jQuery('resources errors',xml);texts.children().each(function(idx){uiTexts['errors'][this.nodeName]=jQuery(this).text();});xml=null;if(typeof(scallback)=='function'){scallback(canvasId);}else{_LoadUiPropertiesTexts(canvasId);}},error:function(resp){throw"Error loading configurations";}});}
function _LoadUiPropertiesTexts(canvasId,scallback){var parsed=FLSUtil.parseUri(properties_url);var url=properties_url;var data={};if(parsed.host!=document.domain){url='resources.php';data.url=properties_url;}
loadProgress(logoCfg.loading+'...');jQuery.ajax({url:url,data:data,dataType:'xml',success:function(xml){var texts=jQuery('properties ui application color_tool',xml);texts.children().each(function(idx){uiTexts['color_tool'][this.nodeName]=jQuery(this).text();});texts=jQuery('properties ui application text_tool',xml);texts.children().each(function(idx){uiTexts['text_tool'][this.nodeName]=jQuery(this).text();});texts=jQuery('properties ui application multistyle_tool',xml);texts.children().each(function(idx){uiTexts['multistyle_tool'][this.nodeName]=jQuery(this).text();});texts=jQuery('properties buttons application left_menu',xml);texts.children().each(function(idx){uiTexts['left_menu'][this.nodeName]['label']=jQuery('label',this).text();uiTexts['left_menu'][this.nodeName]['tip']=jQuery('tip',this).text();});uiTexts['buttons']['continue_editing']=jQuery('properties buttons preview continue_editing label',xml).text();uiTexts['buttons']['preview']=jQuery(jQuery('properties buttons application preview label',xml).get(0)).text();uiTexts['buttons']['save']=jQuery('properties buttons preview save label',xml).text();uiTexts['buttons']['color_tool']['help']=jQuery('properties buttons application color_tool help label',xml).text();uiTexts['buttons']['color_tool']['more_options']=jQuery('properties buttons application color_tool more_options label',xml).text();uiTexts['buttons']['color_tool']['less_options']=jQuery('properties buttons application color_tool less_options label',xml).text();uiTexts['buttons']['text_tool']['help']=jQuery('properties buttons application text_tool help label',xml).text();uiTexts['buttons']['text_tool']['add_text_enabled']=jQuery('properties buttons application text_tool add_text_enabled label',xml).text();uiTexts['buttons']['text_tool']['add_text_disabled']=jQuery('properties buttons application text_tool add_text_disabled label',xml).text();uiTexts['buttons']['text_tool']['size_up']=jQuery('properties buttons application text_tool size_up label',xml).text();uiTexts['buttons']['text_tool']['size_down']=jQuery('properties buttons application text_tool size_down label',xml).text();uiTexts['warn']['preview']=jQuery('properties ui preview',xml).text();uiTexts['warn']['tips']=jQuery('properties ui tips',xml).text();uiTexts['warn']['suggestions']['heading']=jQuery('properties ui suggestions heading',xml).text();uiTexts['warn']['suggestions']['save']=jQuery('properties ui suggestions save',xml).text();uiTexts['warn']['align']['heading']=jQuery('properties ui align heading',xml).text();uiTexts['warn']['align']['layout']=jQuery('properties ui align layout',xml).text();uiTexts['warn']['align']['action']=jQuery('properties ui align action',xml).text();uiTexts['kb_tip_msg']=jQuery('properties ui application tips move_tip',xml).text();texts=jQuery('properties buttons application left_menu',xml);texts.children().each(function(idx){uiTexts['left_menu'][this.nodeName]['tip']=jQuery('tip',this).text();});texts=jQuery('properties >dynamic',xml);texts.children().each(function(idx){if(this.nodeName=='print_products'){jQuery(this).children().each(function(idx2){uiTexts['dynamic']['print_products'][this.nodeName]=jQuery(this).text();});}else if(this.nodeName=='back_designs'){jQuery(this).children().each(function(idx2){uiTexts['dynamic']['back_designs'][this.nodeName]=jQuery(this).text();});}else{uiTexts['dynamic'][this.nodeName]=jQuery(this).text();}});texts=jQuery('properties >html5_buttons',xml);texts.children().each(function(idx){var nname=this.nodeName;uiTexts['html5_buttons'][nname]={};jQuery(this).children().each(function(idx2){uiTexts['html5_buttons'][nname][this.nodeName]=jQuery(this).text();});});texts=jQuery('properties >html5_ui',xml);texts.children().each(function(idx){var nname=this.nodeName;uiTexts['html5_ui'][nname]={};jQuery(this).children().each(function(idx2){uiTexts['html5_ui'][nname][this.nodeName]=jQuery(this).text();});});texts=jQuery('properties ui suggestions',xml);texts.children().each(function(idx){uiTexts['suggestions'][this.nodeName]=jQuery(this).text();});texts=jQuery('properties >errors',xml);texts.children().each(function(idx){var nname=this.nodeName;uiTexts['errors'][nname]=[];jQuery(this).children().each(function(idx2){uiTexts['errors'][nname][this.nodeName]=jQuery(this).text();});});texts=jQuery('properties >mobile_editor',xml);texts.children().each(function(idx){var nname=this.nodeName;if(this.childNodes.length>1){if(typeof(uiTexts['mobile_editor'][nname])=='undefined'){uiTexts['mobile_editor'][nname]={};}
jQuery(this).children().each(function(idx2){uiTexts['mobile_editor'][nname][this.nodeName]=jQuery(this).text();});}else{uiTexts['mobile_editor'][nname]=jQuery(this).text();}});uiTexts['color_tool']['current_logo_color']=uiTexts['html5_ui']['used_colors']['label'];uiTexts['color_tool']['new_color']=uiTexts['html5_ui']['new_color']['label'];uiTexts['color_tool']['current_color']=uiTexts['html5_ui']['current_color']['label'];uiTexts['text_tool']['select_font_html5']=uiTexts['html5_ui']['font_label']['label'];uiTexts['text_tool']['entered_text_html5']=uiTexts['html5_ui']['text_label']['label'];uiTexts['dynamic']['enter_text']=uiTexts['html5_ui']['enter_text']['label']?uiTexts['html5_ui']['enter_text']['label']:uiTexts['dynamic']['enter_text'];texts=jQuery('properties >ui >font_load',xml);texts.children().each(function(idx){var nname=this.nodeName;if(jQuery(this).children().length){jQuery(this).children().each(function(idx2){uiTexts['errors']['font_load'][nname][this.nodeName]=jQuery(this).text();});}else{uiTexts['errors']['font_load'][nname]=jQuery(this).text();}});texts=jQuery('properties >ui >font_non_english_chars',xml);texts.children().each(function(idx){var nname=this.nodeName;if(jQuery(this).children().length){jQuery(this).children().each(function(idx2){uiTexts['errors']['font_non_english_chars'][nname][this.nodeName]=jQuery(this).text();});}else{uiTexts['errors']['font_non_english_chars'][nname]=jQuery(this).text();}});xml=null;if(typeof(scallback)=='function'){scallback(canvasId);}else{_BuildUI(canvasId);}},error:function(resp){throw"Error loading configurations";}});}
function _LoadConfig(canvasId,scallback){if(logoCfg.config){addLoading(canvasId);var parsed=FLSUtil.parseUri(logoCfg.config);var url=logoCfg.config;var data={};if(parsed.host!=document.domain){url='resources.php';data.url=logoCfg.config;}
loadProgress(logoCfg.loading+'...');jQuery.ajax({url:url,data:data,dataType:'xml',success:function(xml){var protocol=document.location.protocol.replace(':','')+'://';apiRoot=jQuery('apiUrl',xml).attr('root').replace('http://',protocol);jQuery('skinConfig',xml).children().each(function(idx){switch(this.nodeName){case'application':break;case'rightPanel':break;case'combobox':break;}});jQuery('apiUrl',xml).children().each(function(idx){apiUrl[this.nodeName]=jQuery(this).text();if(logoCfg.font_language){apiUrl[this.nodeName]=apiUrl[this.nodeName].replace(/flashdata.php\?/g,'flashdata.php?font_language='+logoCfg.font_language+'&');}
if(fltype_param.length&&/flashdata\.php\?/.test(apiUrl[this.nodeName])){apiUrl[this.nodeName]=apiUrl[this.nodeName].replace(/flashdata.php\?/g,'flashdata.php?'+fltype_param+'&');}});texts_url=jQuery('urls textsXML',xml).text().replace('http://',protocol);properties_url=texts_url.replace(/resources.xml/i,'properties.xml');texts_url=texts_url.replace(/.xml/i,'_'+logoCfg.lang+'.xml');properties_url=properties_url.replace(/.xml/i,'_'+logoCfg.lang+'.xml');if(typeof(scallback)=='function'){scallback(canvasId);}else{_LoadUiTexts(canvasId);}},error:function(resp){throw"Error loading configurations";}});}}
function _stepLogoFontsLoaded(canvasId,scallback){if(svg_fonts.length){var all_loaded=true;for(var i=0;i<svg_fonts.length;i++){if(logofonts[svg_fonts[i]]){all_loaded=all_loaded&&FLSUtil.isFontAvailable(svg_fonts[i]);}else{console.log(svg_fonts[i],'is not in the fonts list => SKIPPING');}
if(!all_loaded)break;}
font_loaded_check_iteration+=1;if(!all_loaded&&scallback&&(font_loaded_check_iteration<font_loaded_check_max_iterations)){setTimeout(function(){_stepLogoFontsLoaded(canvasId,scallback);},100);}else{if(typeof(scallback)=='function'){console.log('fonts loaded checked',font_loaded_check_iteration,'times every 100 ms. All Loaded:',all_loaded)
font_loaded_check_iteration=0;scallback(canvasId);}}}else{if(typeof(scallback)=='function'){font_loaded_check_iteration=0;scallback(canvasId);}}
return all_loaded;}
function _stepLoadLogo(canvasId,scallback){loadProgress(uiTexts.preloaderMessage_LoadLogo+'...');jQuery.ajax({type:'GET',url:(apiRoot==_apiRoot?apiRoot:_apiRoot)+apiUrl.logoUrl+logoCfg.logoID,success:function(xml){if(parseSvgData(xml)){initColorSwatchColors();if(typeof(scallback)=='function'){scallback(canvasId);}else{_handleLoadComplete();}}},contentType:'xml',data:{},dataFilter:svgFilter});}
function _stepInitFontPathObj(canvasId,callback){var svgfonts_cpy=[];function parseSvgFontsCopy(){if(svgfonts_cpy.length){if(fontPathObj){var font_family=svgfonts_cpy.pop();fontPathObj.initFont(font_family,logofonts[font_family],parseSvgFontsCopy);}else{if(typeof(callback)=='function'){callback(canvasId);}}}else{if(typeof(callback)=='function'){callback(canvasId);}}}
if(needsFontpath&&(svg_fonts.length)){_initFontPathObj();svgfonts_cpy=svg_fonts.slice(0);parseSvgFontsCopy();}else{if(typeof(callback)=='function'){callback();}}}
function _BuildUI(canvasId,scallback){var canvasSettings={};if(view_frame_image_border===true){canvasSettings.viewFrame={image_border:true,lcolor:'#BABABA',lwidth:4};canvasSettings.width=canvasSettings.min_width=937;}
if(typeof(logoCfg.watermark_str)=='string'&&logoCfg.watermark_str.length){canvasSettings.watermark_str=logoCfg.watermark_str;}
editor=new FLSEditorCore(canvasId,canvasSettings);editorID=canvasId+'-EditorUI';editor.product='logo';if(plugins.length){for(var i=0;i<plugins.length;i++){editor.registerPlugin(plugins[i]);}}
if(mobile){BuildUIMobile(canvasId);}else{if(view_frame_image_border===true){BuildUIImgBorderDesktop(canvasId);}else{BuildUIDesktop(canvasId);}}
if(show_arc_text_buttons){arc_text_toolbar=FLSArcTextButtonsBar(editor,_generateTextPath,true);editor.getCanvasWrapper().appendChild(arc_text_toolbar[0]);arc_text_toolbar.hide();}
if(use_multiselect){multiSelectObj=new FLSMultiselect(editor);multiSelectObj.intersection_select=intersection_select;multiSelectObj.scalable(true);}
if(use_inline_text_edit){inlineTextEditor=new FLSinLineTextEdit(editor,_inlineTextEditCallback);inlineTextEditor.inline_text_edit_keep_controls=inline_text_edit_keep_controls;}
jQuery('body').addClass('html5-editor-active');loadProgress(uiTexts.preloaderMessage_LoadFontsList+'...');var product_type=logoCfg.product_type?'&product_type='+logoCfg.product_type:'';jQuery.get((apiRoot==_apiRoot?apiRoot:_apiRoot)+apiUrl.fontsList+logoCfg.logoID+langparam+product_type,function(xml){var parsed_fontcount=parseFontsData(xml);if(!parsed_fontcount)return false;var fontloader=document.createElement('div');fontloader.style.position='absolute';fontloader.style.right='110%';fontloader.style.top='-200px';fontloader.style.overflow='hidden';fontloader.style.display='block';fontloader.style.width='100px';fontloader.style.height='100px';document.body.appendChild(fontloader);var fontCnt=0;for(var fnt in logofonts){var fontspan=document.createElement('span');fontspan.style.fontFamily='"'+fnt+'"';fontspan.innerHTML=fnt;fontloader.appendChild(fontspan);fontCnt++;var imul=1;try{if(logofonts[fnt].bold_src.length){fontspan=document.createElement('span');fontspan.style.fontFamily='"'+fnt+'"';fontspan.style.fontWeight='bold';fontspan.innerHTML=fnt;fontloader.appendChild(fontspan);fontCnt++;imul++;}
if(logofonts[fnt].italic_src.length){fontspan=document.createElement('span');fontspan.style.fontFamily='"'+fnt+'"';fontspan.style.fontStyle='italic';fontspan.innerHTML=fnt;fontloader.appendChild(fontspan);fontCnt++;imul++;}
if(logofonts[fnt].bolditalic_src.length){fontspan=document.createElement('span');fontspan.style.fontFamily='"'+fnt+'"';fontspan.style.fontWeight='bold';fontspan.style.fontStyle='italic';fontspan.innerHTML=fnt;fontloader.appendChild(fontspan);fontCnt++;imul++;}}catch(e){}}
fontCnt=svg_fonts.length?svg_fonts.length:fontCnt;var timeout=fontCnt*font_load_wait_time;console.log('Waiting:',(timeout/1000),'seconds for fonts to load');setTimeout(function(){if(typeof(scallback)=='function'){scallback(canvasId);}else{_stepLoadLogo(canvasId);}},timeout);},'xml');}
function BuildUIMobile(canvasId){var $cwrapper=jQuery(editor.getCanvasWrapper());var $cnvs=jQuery('#'+canvasId,$cwrapper);var $editorUI=jQuery(document.createElement('div'));$editorUI.css({width:($cnvs.width()+ui_side_bar_width)+'px',height:($cnvs.height()+152)+'px'});$editorUI.attr('id',editorID);if(logoCfg.lang!='en'){$editorUI.addClass('non-en');}
var top_toolbar=jQuery('<div class="fls-editor-top-toolbar"><div class="container"><div class="outer-border"><div class="inner-border"><\/div><\/div><\/div><\/div>');_addFontEditingControls(jQuery('.inner-border',top_toolbar));_addColorEditingControls(jQuery('.inner-border',top_toolbar));$editorUI.append(top_toolbar);var sh=($cnvs.height()-2);var side_toolbar=jQuery('<div class="fls-editor-side-toolbar"><div class="container" style="height:'+(sh-2)+'px;"><\/div><\/div>');side_toolbar.css({height:sh+'px'});$editorUI.append(side_toolbar);$editorUI.insertBefore($cwrapper);$editorUI.append($cwrapper);_addSideButtonControls(jQuery('.container',side_toolbar));_addBottomButtonControls();_insertEditorCss();editor.setEventCallback(_editorEvtCallback);editor.render();}
function BuildUIDesktop(canvasId){var $cwrapper=jQuery(editor.getCanvasWrapper());var $cnvs=jQuery('#'+canvasId,$cwrapper);var $editorUI=jQuery(document.createElement('div'));$editorUI.css({width:($cnvs.width()+ui_side_bar_width)+'px',height:($cnvs.height()+ui_top_bar_height)+'px'});$editorUI.attr('id',editorID);$editorUI.addClass('html5-desktop');if(logoCfg.lang!='en'){$editorUI.addClass('non-en');}
var top_toolbar=jQuery('<div class="fls-editor-top-toolbar"><div class="container"><\/div><\/div>');_addFontEditingControlsDesktop(jQuery('.container',top_toolbar));_addColorEditingControlsDesktop(jQuery('.container',top_toolbar));$editorUI.append(top_toolbar);var sh=($cnvs.height()-2);var side_toolbar=jQuery('<div class="fls-editor-side-toolbar"><div class="container" style="height:'+(sh-2)+'px;"><\/div><\/div>');side_toolbar.css({height:sh+'px'});$editorUI.append(side_toolbar);$editorUI.insertBefore($cwrapper);$editorUI.append($cwrapper);_addSideButtonControls(jQuery('.container',side_toolbar));_addBottomButtonControls();_insertEditorCss();editor.setEventCallback(_editorEvtCallback);editor.render();}
function _addBottomButtonControls(){var bottombtns=jQuery('<div class="fls-editor-bottom-button-container"><span class="fls-bottom-buttons-background">'+'<span class="fls-button lmx_secondary_button preview" data-action="preview">'+uiTexts['buttons']['preview']+'</span>'+'<span class="fls-button lmx_primary_button save" data-action="save" style="min-width:200px;">'+uiTexts['buttons']['save']+'</span>'+'</span><\/div>');jQuery('#'+editorID).append(bottombtns);_bindEvents(mobile?['touchend']:['mouseup'],jQuery('.fls-button',bottombtns),_hanndleSideButtonActions);}
function _generateInputNames(basename,params,retarr){if(typeof(params)=='object'){for(var iname in params){var namestr=iname.toString();if(basename){namestr=basename+'['+namestr+']';}
if((params[iname]instanceof Array)||(params[iname]instanceof Object)){_generateInputNames(namestr,params[iname],retarr);}else{retarr[namestr]=params[iname];}}}else{retarr[basename]=params;}}
function submiteSaveData(data){data['editor_platform']='html5';if(typeof(logoCfg.post_back_data)!='undefined'){data['post_back_data']=logoCfg.post_back_data;}
data['psize']=FLSUtil.pSize(data);var action=logoCfg.act=='update'?apiUrl.updateUrl:apiUrl.saveUrl;_showPageLoadingOverlay();jQuery('body').css({cursor:'wait'});if(typeof(logoCfg['on_before_save_callback'])=='function'){logoCfg['on_before_save_callback']();}
if(apiRoot==_apiRoot){jQuery.ajax({type:"POST",url:apiRoot+action+logoCfg.logoID,success:_handleFormSaveDone,data:data,error:_handleFormSaveFail});}else{var submitted=false;var submitframe=jQuery('iframe#step3-html5-iframe');if(!submitframe.length){submitframe=jQuery(document.createElement('iframe'));submitframe.css({position:'absolute',width:'1px',height:'1px',left:'-200px','top':'-200px'});submitframe.attr({name:'step3-html5-iframe',id:'step3-html5-iframe'});jQuery('body').prepend(submitframe);submitframe.bind('load',function(){if(!submitted)return false;var response;try{response=JSON.parse(jQuery(this).contents().text());}catch(e){console.log(e)}
_handleFormSaveDone(response);});}
var submitform=jQuery(document.createElement('form'));submitform.attr('action',apiRoot+action+logoCfg.logoID);submitform.attr('method','post');submitform.attr('target','step3-html5-iframe');for(var ii in data){if(ii=='post_back_data'){var pbData={};_generateInputNames('post_back_data',data.post_back_data,pbData)
for(var pdi in pbData){var input=jQuery(document.createElement('input'));input.attr('name',pdi);input.attr('type','hidden');input.val(pbData[pdi]);submitform.append(input);}}else{var input=jQuery(document.createElement('input'));input.attr('name',ii);input.attr('type','hidden');input.val(data[ii]);submitform.append(input);}}
jQuery('body').prepend(submitform);submitted=true;if(typeof(logoCfg['on_before_save_callback'])=='function'){logoCfg['on_before_save_callback']();}
submitform.submit();submitform.remove();}}
function _handleFormSaveDone(response){jQuery('body').css({cursor:'default'});if((typeof(response)==='object')&&(response.status==0)){jQuery('body').css({cursor:'default'});var savehtml=jQuery('#FLS_PageLoadingOverlay').html();var dlg=FlsFlashErrorMessage(uiTexts['errors']['errJSTitle'],uiTexts['errors']['errSave'],function(){jQuery('#FLS_PageLoadingOverlay').html(savehtml);_hidePageLoadingOverlay();});jQuery('#FLS_PageLoadingOverlay').html(dlg);return false;}
GTrack.track('save_success',{product_id:response.new_logo_id},'PreviewOverlay');if(typeof(logoCfg['on_save_callback'])=='function'){logoCfg['on_save_callback'](response);}
if(typeof(flash_redirect_step4)=='function'){flash_redirect_step4(response);}else{if(typeof(Drupal)=='object'){var url=Drupal.settings.baseUrl+'/step4';window.onbeforeunload=null;window.location.href=url;}else{console.log(FLSUtil.parseUri(window.location.href));}}}
function _handleFormSaveFail(){jQuery('body').css({cursor:'default'});var savehtml=jQuery('#FLS_PageLoadingOverlay').html();var dlg=FlsFlashErrorMessage(uiTexts['errors']['errJSTitle'],uiTexts['errors']['errSave'],function(){jQuery('#FLS_PageLoadingOverlay').html(savehtml);_hidePageLoadingOverlay();jQuery('.fls-editor-bottom-button-container').show();});jQuery('#FLS_PageLoadingOverlay').html(dlg);}
function _checkCharsOk(){var chars_noke=[];if(fontPathObj){var objs=editor.getObjects();for(var i=0;i<objs.length;i++){if(objs[i]instanceof FLSEditorCore.CText){var sp_chars=FLSUtil.getExtendedCharsFromString(objs[i].getText());if(sp_chars&&sp_chars.length){var found_unsupported=fontPathObj.charUnSupported(sp_chars,objs[i].getFontFamily(),objs[i].bold(),objs[i].italic());if(found_unsupported.length){chars_noke=chars_noke.concat(found_unsupported);}}}}}
return chars_noke;}
function _doOverlaySaveButtonAction(){var svg=_toSVG();var raster=editor.getViewFrameData(false,true);var now=new Date();var logo_directsave;var data={raster_file:_getRasterFileData().replace(/data:image\/png;base64,/ig,''),img_file:raster.replace(/data:image\/png;base64,/ig,''),svg_file:svg,log:'<log_'+now.getFullYear()+'_'+(now.getMonth()+1)+'_'+now.getDate()+'_'+now.getHours()+'-'+now.getMinutes()+'-'+now.getSeconds()+' lid="'+logoCfg.logoID+'"/>',version:editor_version,svg_file_ai:svg,xml_file:_generateXmlFileContent()};if(layoutXML){data.layout=new XMLSerializer().serializeToString(layoutXML);}
if(!data['xml_file']){_showPageLoadingOverlay();jQuery('#FLS_PageLoadingOverlay').html(FlsFlashErrorMessage(uiTexts['errors']['errJSTitle'],uiTexts['errors']['errSave']));}else if(missing_save_fonts.length){var msg=FlsFlashErrorMessage(uiTexts['errors']['font_load']['title'],uiTexts['errors']['font_load']['message'].replace(/\$FONTS\$/,missing_save_fonts.join(',')),function(){_hidePageLoadingOverlay();});var fromLoadTime=new Date().getTime();GTrack.track('editor','save-failed-font-not-loaded','UI',(fromLoadTime-loadEndTime)/1000);_showPageLoadingOverlay(msg);}else{if(logoCfg.act!='update'){if(logoCfg.logo_directsave!='undefined'&&logoCfg.logo_directsave){logo_directsave=logoCfg.logo_directsave;}else if(typeof(check_logo_direct_save)=='function'){logo_directsave=parseInt(check_logo_direct_save());}else{logo_directsave=parseInt(_check_logo_direct_save());}
if(!isNaN(logo_directsave)&&logo_directsave){data['logo_directsave']=logo_directsave;}}
if(cardSuggestSelector){_hidePreview();cardSuggestSelector.show(function(chosen_bc_data){for(var bsi in chosen_bc_data){data[bsi]=chosen_bc_data[bsi];}
submiteSaveData(data);});}else{submiteSaveData(data);}}}
function _handleOverlayButtonActions(evt){var action=jQuery(this).attr('data-action');switch(evt.type){case'mouseup':case'touchend':case'pointerup':switch(action){case'return':_hidePreview();jQuery('.fls-editor-bottom-button-container').show();GTrack.track('editor','continue','PreviewOverlay');break;case'save':var wrong_chars=_checkCharsOk();if(wrong_chars.length){var msg=FlsFlashErrorMessage(uiTexts['errors']['font_non_english_chars']['title'],uiTexts['errors']['font_non_english_chars']['message']+'<br>('+wrong_chars.join(', ')+')',function(){_hidePageLoadingOverlay();});var fromLoadTime=new Date().getTime();GTrack.track('editor','save-failed-font-non-english-chars','UI',(fromLoadTime-loadEndTime)/1000);_showPageLoadingOverlay(msg);console.log(wrong_chars);}else{GTrack.track('editor','save','PreviewOverlay');_doOverlaySaveButtonAction();}
break;}
break;}
if(evt.preventDefault){evt.preventDefault();}else{evt.returnValue=false;};return false;}
function _getRasterFileData(){var size=editor.viewsize();var cvs=document.createElement('canvas');cvs.width=size.width;cvs.height=size.height;var cvsctx=cvs.getContext('2d');cvsctx.clearRect(0,0,size.width,size.height);var elements=editor.getObjects();for(var i in elements){if(elements[i]instanceof FLSEditorCore.CPathGroup){var is_active=elements[i].getActive();if(is_active)elements[i].setActive(false);elements[i].render(cvsctx);if(is_active)elements[i].setActive(true);}}
return cvs.toDataURL();}
function _generateXmlFileContent(){var now=new Date();var shape='';var textField='';var elements=editor.getObjects();var txtidx=0;if(['badge'].indexOf(logo_mode)>-1){for(var i in elements){if(elements[i]instanceof FLSEditorCore.CPathGroup){var paths=elements[i].getPaths();for(var pi1=0;pi1<paths.length;pi1++){if(paths[pi1].lyt_name&&paths[pi1]['stringdata']){var strdta=paths[pi1]['stringdata'];var ppos=paths[pi1].getPosition();var ttf_src=logofonts[strdta.font_family]['ttf_src'];var style=0;style|=strdta.bold?1:0;style|=strdta.italic?2:0;switch(style){case 3:ttf_src=logofonts[strdta.font_family]['bolditalic_src']?logofonts[strdta.font_family]['bolditalic_src']:ttf_src;break;case 2:ttf_src=logofonts[strdta.font_family]['italic_src']?logofonts[strdta.font_family]['italic_src']:ttf_src;break;case 1:ttf_src=logofonts[strdta.font_family]['bold_src']?logofonts[strdta.font_family]['bold_src']:ttf_src;break;default:ttf_src=logofonts[strdta.font_family]['ttf_src'];}
textField+='<TextField id="t'+txtidx+'" x="'+paths[pi1].x+'" y="'+paths[pi1].y+'" xBottom="0" yBottom="0" fontFamily="'+logofonts[strdta.font_family]['name']+'" fontSize="'+strdta.fontsize+'" bold="'+(strdta.bold?'true':'false')+'" italic="'+(strdta.italic?'true':'false')+'" color="'+paths[pi1].getColor()+'" ttfSrc="'+ttf_src+'" anchor="center">\n\t\t\t';textField+='<text><![CDATA['+strdta.text+']]></text>\n\t\t';textField+='</TextField>\n\t\t';txtidx++;}}
break;}}}
for(var i in elements){if(elements[i]instanceof FLSEditorCore.CPathGroup){var pathscnt=elements[i].getPaths().length;for(var pi=0;pi<pathscnt;pi++){shape+='<Shape x="" y="" width="" height="" color=""/>\n\t\t';}}
if(elements[i]instanceof FLSEditorCore.CText){var ff=elements[i].getFontFamily();var pos=elements[i].getPosition();if(typeof(logofonts[ff])=='undefined'){return false;}
var style=0;style|=elements[i].bold()?1:0;style|=elements[i].italic()?2:0;var ttf_src=logofonts[ff]['ttf_src'];switch(style){case 3:ttf_src=logofonts[ff]['bolditalic_src']?logofonts[ff]['bolditalic_src']:ttf_src;break;case 2:ttf_src=logofonts[ff]['italic_src']?logofonts[ff]['italic_src']:ttf_src;break;case 1:ttf_src=logofonts[ff]['bold_src']?logofonts[ff]['bold_src']:ttf_src;break;default:ttf_src=logofonts[ff]['ttf_src'];}
textField+='<TextField id="t'+txtidx+'" x="'+pos.x+'" y="'+pos.y+'" xBottom="0" yBottom="0" fontFamily="'+logofonts[ff]['name']+'" fontSize="'+elements[i].getFontSize()+'" bold="'+(elements[i].bold()?'true':'false')+'" italic="'+(elements[i].italic()?'true':'false')+'" color="'+elements[i].getColor()+'" ttfSrc="'+ttf_src+'" anchor="center">\n\t\t\t';textField+='<text><![CDATA['+elements[i].getText()+']]></text>\n\t\t';textField+='</TextField>\n\t\t';txtidx++;}}
var xml='<logo>\n\t<autoscalling>1</autoscalling>\n\t';xml+='<ContainerItems>\n\t\t';xml+=shape;xml+=textField.slice(0,-1);xml+='</ContainerItems>\n\t';xml+='<TextFonts/>\n\t';xml+='<logs>\n\t\t';xml+='<log_'+now.getFullYear()+'_'+(now.getMonth()+1)+'_'+now.getDate()+'_'+now.getHours()+'-'+now.getMinutes()+'-'+now.getSeconds()+' lid="'+logoCfg.logoID+'"/>\n\t';xml+='</logs>\n';xml+='</logo>';return xml;}
function _positionPreviewContent(){var overlay=jQuery('#FLSPreviewOverlay');if(overlay.length){var container=jQuery('#FLSPreviewContainer',overlay);if(container.length){var cnvaspos=jQuery('#'+canvasID).offset();container.css({top:cnvaspos.top+'px',left:cnvaspos.left+'px'});}}}
function _showPreview(wmrk,as_url){var overlay=jQuery('#FLSPreviewOverlay');if(!overlay.length){overlay=jQuery(document.createElement('div'));overlay.attr('id','FLSPreviewOverlay');overlay.append('<div id="FLSPreviewContainer"><\/div>');}
var previewholder=jQuery('#FLSPreview');var previewtopcorner=editor.viewtopleft();if(!previewholder.length){var container=jQuery('#FLSPreviewContainer',overlay);var previewsize=editor.viewsize();var cnvaspos=jQuery('#'+canvasID).offset();cnvaspos['width']=jQuery('#'+canvasID).width();cnvaspos['height']=jQuery('#'+canvasID).height();container.css({top:cnvaspos.top+'px',left:cnvaspos.left+'px',width:cnvaspos.width+'px',height:cnvaspos.height+'px'});previewholder=jQuery(document.createElement('div'));previewholder.attr('id','FLSPreview');previewholder.css({width:previewsize.width+'px',height:previewsize.height+'px',top:(previewtopcorner.y-3)+'px',left:(previewtopcorner.x-3)+'px'});previewholder.append(document.createElement("img"));container.append(previewholder);container.prepend('<span id="FLSPreviewMsg" style="top:'+(previewtopcorner.y-80)+'px">'+uiTexts.warn.preview+'<\/span>');container.append('<div id="FLSPreviewbttons"><span class="fls-button lmx_secondary_button continue" data-action="return">'+uiTexts['buttons']['continue_editing']+'<\/span> <span class="fls-button lmx_primary_button save" data-action="save">'+uiTexts['buttons']['save']+'<\/span><\/div>');_bindEvents(mobile?['touchend','touchstart']:['mouseup'],jQuery('.fls-button',container),_handleOverlayButtonActions);_bindEvents(['resize'],window,_positionPreviewContent);jQuery('body').prepend(overlay);if(typeof(logoCfg['on_preview_callback'])=='function'){logoCfg['on_preview_callback']['apply'](null);}}else{previewholder.css({top:(previewtopcorner.y-3)+'px',left:(previewtopcorner.x-3)+'px'});}
overlay.show();jQuery('img',previewholder).attr('src',editor.getViewFrameData(wmrk,as_url));}
function _hidePreview(){var overlay=jQuery('#FLSPreviewOverlay');if(overlay.length){overlay.hide();}
return false;}
function _toSVG(){var svg=document.createElementNS('http://www.w3.org/2000/svg','svg');var logolayer=document.createElementNS('http://www.w3.org/2000/svg','g');var textlayer=document.createElementNS('http://www.w3.org/2000/svg','g');logolayer.setAttribute('id','surface2');textlayer.setAttribute('id','surface4');var viewsize=editor.viewsize();svg.setAttribute('width',viewsize.width+'pt');svg.setAttribute('height',viewsize.height+'pt');svg.setAttribute('viewBox','0 0 '+viewsize.width+' '+viewsize.height);svg.setAttribute('version','1.1');svg.setAttribute('xmlns','http://www.w3.org/2000/svg');svg.setAttribute('xmlns:xlink','http://www.w3.org/1999/xlink');svg.appendChild(document.createTextNode('\n  '));svg.appendChild(logolayer);svg.appendChild(document.createTextNode('\n  '));svg.appendChild(textlayer);svg.appendChild(document.createTextNode('\n'));var elements=editor.getObjects();for(var i in elements){if(elements[i]instanceof FLSEditorCore.CPathGroup){elements[i].toSVG(logolayer);}
if(elements[i]instanceof FLSEditorCore.CText&&elements[i].getText().trim().length){elements[i].toSVG(textlayer);}}
textlayer.appendChild(document.createTextNode('\n  '));logolayer.appendChild(document.createTextNode('\n  '));if(test_fonts){while(missing_save_fonts.length){missing_save_fonts.shift();}
var svgtxts=jQuery('text',svg);for(var sti=0;sti<svgtxts.length;sti++){var metxt=jQuery(svgtxts[sti]);var cfntname=metxt.attr('font-family');if((missing_save_fonts.indexOf(cfntname)==-1)&&(!FLSUtil.isFontAvailable(cfntname))){missing_save_fonts.push(cfntname);}}}
var grad_ids=editor.getGradientIds();if(grad_ids.length){var gardDefsNode=document.createElementNS('http://www.w3.org/2000/svg','defs');while(grad_ids.length){gardDefsNode.appendChild(svg_defs.gradients[grad_ids.shift()].getGradDomNode());gardDefsNode.appendChild(document.createTextNode('\n  '))}
svg.appendChild(gardDefsNode);}
var svgstr=new XMLSerializer().serializeToString(svg);return FLSUtil.fixLocalCommaFormattedNumbers(svgFilter(svgstr));}
function _LoadLogoLayout(canvasId,scallback){var layoutUrl=(apiRoot==_apiRoot?apiRoot:_apiRoot)+apiUrl.logoUrl.replace('method=svg','method=layout')+logoCfg.logoID+'&uniq='+Math.floor(Math.random()*10000);var parsed=FLSUtil.parseUri(layoutUrl);var url=layoutUrl;var data={};if(parsed.host!=document.domain){url='resources.php';data.url=logoCfg.config;}
loadProgress(logoCfg.loading+'...');jQuery.ajax({url:url,data:data,dataType:'xml',success:function(xml){jQuery('layout >areas area',xml).each(function(index){var area=jQuery(this);layout.areas[area.attr('name').toLowerCase()]={x:parseFloat(area.attr('x')),y:parseFloat(area.attr('y')),w:parseFloat(area.attr('w')),h:parseFloat(area.attr('h')),type:area.attr('type'),align:area.attr('align')};var vAlign=area.attr('vAlign');if(vAlign){layout.areas[area.attr('name').toLowerCase()]['vAlign']=vAlign;}});jQuery('layout >groups',xml).children().each(function(index){var gn=jQuery(this);layout.groups[this.nodeName.toLowerCase()]={type:gn.attr('type'),group:gn.attr('group')};});layoutXML=xml;if(typeof(scallback)=='function'){scallback(canvasId);}else{_LoadUiTexts(canvasId);}},error:function(resp){throw"Error loading layout";}});}
function _handleInlineTextEditActions(what,opt){if((lastSelectedObj instanceof FLSEditorCore.CText)&&(inlineTextEditor instanceof FLSinLineTextEdit)){switch(what){case'refresh':inlineTextEditor.refresh(opt);break;case'hide':default:inlineTextEditor.hide();if(['op:textedit','op:doubletap'].includes(last_editor_op)){GTrack.track('text','edit-text','Customize');}}}}
function _addSideButtonImgBorderControls(container){var tbtns=[jQuery('<span class="sidebutton undo disabled" data-action="undo" title="'+uiTexts['left_menu']['undo']['label']+'">&nbsp;</span>'),jQuery('<span class="sidebutton redo disabled" data-action="redo" title="'+uiTexts['left_menu']['redo']['label']+'">&nbsp;</span>'),jQuery('<span class="sidebutton reset" data-action="reset" title="'+uiTexts['left_menu']['reset']['label']+'">&nbsp;</span>')];for(var i=0;i<tbtns.length;i++){container.append(tbtns[i]);}
_bindEvents(mobile?['touchend']:['mouseup'],jQuery('.sidebutton',container),_hanndleSideButtonActions);}
function _addMoreOptionsImgBorder(container){var more_options=jQuery('<div class="more-options-container">'+'<div id="more-color-options-section">'+'<div class="more-color-options-anim-container">'+'<div class="more-color-options" id="more-color-options-desktop">'+'<span class="tool-ttl">'+uiTexts['color_tool']['advanced_colors']+'</span>'+'<span class="tool-ttl more-options">'+uiTexts['color_tool']['hex']+'</span>'+'<div class="more-options-rgb-inputs hex"><input type="text" name="color[hex]"  placeholder="#"></div>'+'<span class="tool-ttl more-options" style="margin-top:10px;">RGB:</span>'+'<div class="more-options-rgb-inputs rgb">'+'<input type="text" name="color[r]" placeholder="'+uiTexts['color_tool']['r'].replace(':','')+'"  maxlength="3">'+'<input type="text" name="color[g]" placeholder="'+uiTexts['color_tool']['g'].replace(':','')+'"  maxlength="3">'+'<input type="text" name="color[b]" placeholder="'+uiTexts['color_tool']['b'].replace(':','')+'"  maxlength="3">'+'</div>'+'<span class="tool-ttl more-options"  style="margin:10px 0;">'+uiTexts['color_tool']['popular']+'</span>'+'<div class="more-options-popular-swatches"><span id="desktop-popular-swatches"></span></div>'+'</div>'+'</div>'+'<span class="color-action-button more-options" data-action="switch-color-optitons">&nbsp;</span>'+'</div>'+'<span class="add-text-button" title="'+uiTexts.buttons.text_tool.add_text_enabled+'"><span class="more-less-sign">&nbsp;</span>'+uiTexts.buttons.text_tool.add_text_enabled+'</span>'+'</div>');for(var ci=1;ci<=8;ci++){var clr=[Math.floor(Math.random()*(256-ci))+ci,Math.floor(Math.random()*(256-ci))+ci,Math.floor(Math.random()*(256-ci))+ci];var swatch=jQuery(document.createElement('span'));swatch.addClass('logo-color-swatch');swatch.attr('data-color','rgb('+clr.join(',')+')');swatch.css('background-color','rgb('+clr.join(',')+')');swatch.html('&nbsp;');if(!(ci%4)){swatch.css('margin-right','0');}
jQuery('#desktop-popular-swatches',more_options).append(swatch);_bindEvents(mobile?['touchend']:['mouseup'],swatch[0],_handleColorSwatch);}
container.append(more_options);_bindEvents(mobile?['touchstart']:['mousedown'],jQuery('.color-action-button',more_options),_handleColorActionsTapImgBorder);_bindEvents(['change','blur'],jQuery('.more-options-rgb-inputs input',more_options),_handleRgbHexColorInputs);_bindEvents(mobile?['touchstart']:['mousedown'],jQuery('.add-text-button',more_options),_handleAddNewText);}
function _addFontEditingControlsImgBorderDesktop(container){var fontc_control_elements=jQuery('<div class="side-right">'+'<div style="width:100%;"><h4 class="tool-ttl main" title="'+uiTexts.text_tool.select_font+'">'+uiTexts.text_tool.header+'<\/h4></div>'+'<div style=""><table class="tool-table"><tr>'+'<td style="width:185px;"><h4 class="tool-ttl" title="'+uiTexts.text_tool.entered_text+'">'+uiTexts.text_tool.entered_text+'<\/h4><\/td>'+'<td style=""><h4 class="tool-ttl" style="max-width:165px;" title="'+uiTexts.text_tool.select_font+'">'+uiTexts.text_tool.select_font+'<\/h4></td>'+'<td style="width: 100px;"><h4 class="tool-ttl" title="'+uiTexts.text_tool.size+'">'+uiTexts.text_tool.size+'<\/h4></td>'+'</tr><tr>'+'<td><input autocomplete="off" disabled="disabled" type="text" style="margin: 0px 5px 0 0; border: 1px solid #CACACA; font-size: 14px; height: 22px;padding: 2px; width: 175px; font-weight: normal; color: #666; font-family: verdana, arial;border-radius:3px;" name="entered-text-edit" value="" maxlength="'+logoline_max_length+'"  ><\/td>'+'<td class="logo-fonts-dropdown-container"></td>'+'<td class="logo-fonts-size-change-container"><span class="resizebuttons"><span class="font-size-label">-</span><span class="resizebutton down"></span><span class="resizebutton up"></span></span></td>'+'<\/tr><\/table><\/div>'+'<\/div>');jQuery('[name="entered-text-edit"]',fontc_control_elements).bind('focus keyup input blur',_handleTextInput);_bindEvents(mobile?['touchstart']:['mousedown'],jQuery('.resizebutton',fontc_control_elements),_handleTextSize);_bindEvents(mobile?['touchstart']:['mousedown'],jQuery('.add-text-button',fontc_control_elements),_handleAddNewText);container.append(fontc_control_elements);}
function _addColorEditingControlsImgBorderDesktop(container){var colorc_control_elements=jQuery('<div  class="side-left">'+'<div style="width:100%;overflow:hidden;"><span class="color-action-button more-options" data-action="switch-color-optitons" style="display:none; float:right; margin: 4px 22px; width:auto; padding:0 10px 0 0;"><span class="more-less-sign">&nbsp;</span><\/span><h4 class="tool-ttl main">'+uiTexts['color_tool']['header']+'</h4></div>'+'<div style="">'+'<div class="fls-logo-color-swatches-container" id="color-pick-canvas-color-swatches"><\/div>'+'<div id="custom-color-canvas-picker-container" class="custom-color-option-container"><canvas class="color-pick-bg-all" style="cursor:crosshair; background-color: #000;" width="270" height="59"><\/canvas><\/div>'+'<div class="color-pick-sample-container"><span class="color-pick-sample" id="color-pick-canvas-color-sample"><\/span><\/div>'+'</div>'+'<\/div>'+'<\/div>');var per_row_swatch=3;var swatch_rows=swatchColors.length/per_row_swatch;for(var csi=0;csi<swatchColors.length;csi++){var swatch=jQuery(document.createElement('span'));var cur_row=Math.floor(csi/per_row_swatch)+1;swatch.attr('id','logo-swatch-'+csi);swatch.addClass('logo-color-swatch');swatch.attr('data-color','');swatch.html('&nbsp;');jQuery('#color-pick-canvas-color-swatches',colorc_control_elements).append(swatch);if(!((csi+1)%per_row_swatch)){swatch.addClass('last-swatch');}
if(cur_row==swatch_rows){swatch.addClass('bottom-swatch');}
_bindEvents(mobile?['touchend']:['mouseup'],swatch[0],_handleColorSwatch);}
for(var ci=1;ci<=8;ci++){var clr=[Math.floor(Math.random()*(256-ci))+ci,Math.floor(Math.random()*(256-ci))+ci,Math.floor(Math.random()*(256-ci))+ci];var swatch=jQuery(document.createElement('span'));swatch.addClass('logo-color-swatch');swatch.attr('data-color','rgb('+clr.join(',')+')');swatch.css('background-color','rgb('+clr.join(',')+')');swatch.html('&nbsp;');jQuery('#desktop-popular-swatches',colorc_control_elements).append(swatch);_bindEvents(mobile?['touchend']:['mouseup'],swatch[0],_handleColorSwatch);}
var colorbg=new Image();colorbg.onload=function(){var cpcanvas=jQuery('canvas.color-pick-bg-all',colorc_control_elements)[0];var cpctx=cpcanvas.getContext('2d');cpctx.drawImage(this,0,0,this.width,this.height,0,0,cpcanvas.width,cpcanvas.height);jQuery(cpcanvas).unbind('*');_bindEvents(mobile?['touchmove','touchcancel']:['mouseup','mousemove','mouseout','mousedown'],cpcanvas,_handleColorChangers);};_bindEvents(mobile?['touchstart']:['mousedown'],jQuery('.color-action-button',colorc_control_elements),_handleColorActionsTapDesktop);_bindEvents(['change','blur'],jQuery('.more-options-rgb-inputs input',colorc_control_elements),_handleRgbHexColorInputs);colorbg.src=resources.color_picker2;container.append(colorc_control_elements);}
function _insertEditorCSSGeneral(){jQuery('style#'+editorID+'-General-CSS').remove();var previewtopcorner=editor.viewtopleft();var previewsize=editor.viewsize();var _top=previewtopcorner.y+118-60;var editorpos=jQuery('#'+editorID).offset();var editor_css='<style type="text/css" id="'+editorID+'-General-CSS">\n'+'body.html5-editor-active{margin:0;position:relative;display:table;width:100%;}\n'+'::-ms-clear{width:0px;height:0px;display:none;}\n'+'#FLS_PageLoadingOverlay{background-color: rgba(0,0,0,0.7); position: absolute; top:0; left:0; width: 100%; height:100%;z-index:200;}\n'+'.FLS-Overlay-Message{color: #FFFFFF !important;font-family: verdana,arial;font-size: 12px;height: 30px;top: 50%;padding-top: 20px;position: relative;text-align: center;background-position: center top;background-repeat: no-repeat;}\n'+'.FLS-Flash-Message{margin: 0  auto; line-height: 1.2em !important; box-shadow: 0 -1px 0 #FFF;color: #FFFFFF !important;font-family: verdana,arial;font-size: 11px;top: 40%;padding: 0 0 10px;position: relative;text-align: center;background-color: #666; border-radius: 5px; width: 300px;}\n'+'.FLS-Flash-Message .title{font-weight: bold; padding: 10px; display:block;}\n'+'.FLS-Flash-Message .message{color: #FFF; box-shadow: -1px -1px 1px #FFFFFF inset;background-color: #333333;border-radius:5px;clear: both;display: block;margin: 0 10px;padding: 10px;}\n'+'.FLS-Flash-Message .button{color: #FFF; text-shadow: 1px 1px #000; -webkit-user-select: none;-moz-user-select: none;user-select: none;cursor: pointer; background-color: #CCC; border: 2px solid #3399FF; border-radius: 3px;clear: both;display: inline-block;font-weight: bold;margin: 20px 5px 0;padding: 3px 10px;width: 40px;}\n'+'.FLS-Flash-Message .button:active{background-color: #666;}\n'+'.FLS-Flash-Message-Flat{margin: 0  auto; line-height: 1.2em !important; color: #005596 !important;font-family: arial,verdana,sans-serif;font-size: 22px;top: 30%;padding: 0 0 10px;position: relative;text-align: center;background-color: #FFF; max-width: 770px;box-sizing:border-box;}\n'+'.FLS-Flash-Message-Flat .title{font-weight: bold; padding: 10px; display:block;}\n'+'.FLS-Flash-Message-Flat .message{color: #005596; background-color: #FFF;clear: both;display: block;margin: 0 50px;padding: 10px;font-size:22px;font-weigt:bold;line-height:1.1em;}\n'+'.FLS-Flash-Message-Flat .button{color: #EB772A; -webkit-user-select: none;-moz-user-select: none;user-select: none;cursor: pointer; background-color: #FFF; border: 1px solid #EB772A; border-radius: 3px;clear: both;display: inline-block;font-weight: bold; font-size:20px;margin: 30px 15px 20px 15px;padding:10px;max_width: 210px; min-width:100px !important; width:210px;}\n'+'.FLS-Flash-Message-Flat .button.active{color: #FFF;background-color:#EB772A;}\n'+'.font-size-slider-control-wrapper{position:relative; width:auto; margin:0 10px;}\n'+'.font-size-slider-control-wrapper .font-size-slider-controls{position:relative; width:100%;margin:5px 0 15px 0;}\n'+'.font-size-slider-control-wrapper .font-size-slider-strip{margin: 0 50px; position:relative; height: 32px;}\n'+'.font-size-slider-control-wrapper .font-size-slider-strip-line{position:relative; border-top:1px solid #DDD;border-bottom:1px solid #FFF; width:100%; height:0px;font-size:0;top:50%;margin-top:-1px;}\n'+'.font-size-slider-control-wrapper .font-size-slider-knob{position:absolute; width:25px; height:25px; border-radius:25px; border:1px solid #DDD; background-color:#FFF;top:-13px;cursor:pointer;}\n'+'.font-size-slider-control-wrapper .font-size-slider-knob .font-size-slider-knob-inner{widt:11px; height:11px; border-radius:6px; border:1px solid #004D89; background-color:#03609E;margin:6px;}\n'+'.font-size-slider-control-wrapper .font-size-slider-btn{position:absolute; width:30px; height:30px; border-radius:30px; background-color:#FFF; border:1px solid #ddd;top:0;cursor:pointer;font-size:28px;line-height:30px;text-align:center;}\n'+'.font-size-slider-control-wrapper .font-size-slider-btn.slider-increment{right:0;}\n'+'.font-size-slider-control-wrapper .font-size-slider-btn.slider-decrement{left:0;}\n'+'.font-size-slider-control-wrapper .font-size-slider-btn.slider-increment::AFTER,'+'.font-size-slider-control-wrapper .font-size-slider-btn.slider-decrement::AFTER{font-family: verdana,arial,sans-serif;font-size: 28px;font-weight: bold;color: #03609E;width: 100%;height: 100%;line-height: 1em;position: absolute;top: 0;left: 0;}\n'+'.font-size-slider-control-wrapper .font-size-slider-btn.slider-increment::AFTER{content:"+"}\n'+'.font-size-slider-control-wrapper .font-size-slider-btn.slider-decrement::AFTER{content:"-"}\n'+'.font-size-slider-control-wrapper .font-size-slider-label{position:relative; margin:5px 0;font-size:12px;color:#A4A4A4; font-size:13px;font-family: arial,verdana,sans-serif;}\n'+'.font-size-slider-control-wrapper .font-size-slider-label .font-size-value-label{color: #666;}\n'+'#FLSPreviewOverlay{overflow:hidden;color: #FFF; background-color:rgba(0,0,0,0.7);position:absolute; display:block; width:100%; height:100%;top:0px;left:0px;z-index:110;min-height:100vh;}\n'+'#FLSPreviewOverlay #FLSPreviewContainer{position:relative;left:'+editorpos.left+'px;top:'+editorpos.top+'px;text-align:center;}\n'+'#FLSPreviewOverlay #FLSPreviewMsg{color: #FFF; top:'+_top+'px;position: relative;font-size:22px;font-weight:bold;font-family:verdana,arial;width:80%; margin:0 auto; display:block;}\n'+'#FLSPreviewOverlay #FLSPreview{border:3px solid #CCC; width:'+(previewsize.width+3)+'px;height:'+(previewsize.height+3)+'px;position: absolute;left:'+(previewtopcorner.x+78-3)+'px;top:'+(previewtopcorner.y+118-3)+'px;background-color:#FFF;}\n'+'#FLSPreviewOverlay #FLSPreviewbttons{position:absolute; width: 100%; bottom: 5px;}\n'+'.fls-button{text-align:center;min-width: 130px;position:relative;-webkit-user-select: none;-moz-user-select: none;user-select: none;'+'cursor:pointer;font-weight: normal;font-family: arial,verdana,sans-serif;font-size: 18px;line-height:22px; '+'display:inline-block;white-space: nowrap;color: #FFF; border-radius: 5px; padding: 8px; border: 1px solid #104d81; text-transform:capitalize;}\n'+'.fls-logo-color-swatches-container{height:100%;border-right: 1px solid #DCDCDC;text-align: center;float:left;margin: 5px; border:none; text-align: left;width: 60px;float:left; background-color: #F4F4F4; box-shadow: inset 0px 0px 6px rgba(0,0,0, 0.4);}\n'+'.color-pick-sample{width:110px;height: 18px;border:1px solid #C5C5C5; margin: 0px auto; top: -5px; position: relative;}\n'+'.logo-color-swatch{border : 1px solid #D9D9D9;float: left;display: block;text-decoration: none;cursor: pointer;margin:3px;}\n'+'.logo-color-swatch{border-width: 0 1px 1px 0; margin:0px;width: 19px; height:19px; overflow:hidden;}\n'+'.logo-color-swatch.last-swatch{border-right-width:0}\n'+'.logo-color-swatch.bottom-swatch{border-bottom-width:0}\n'+'.custom-color-option-container{float:left; width:270px;height:60px;margin: 5px;}\n'+'.color-pick-sample-container{overflow:hidden;background-color: #F4F4F4; width:59px;height: 59px;margin: 5px; float:left; position: relative;box-shadow: inset 0px 0px 6px rgba(0,0,0, 0.4);}'+'.color-pick-sample-container::BEFORE{content: "";width: 90px;height: 0px;border-top: 1px solid #000;position: absolute;top: 29px;left: -15px;transform:rotate(-7deg);-ms-transform:rotate(-45deg);-moz-transform:rotate(-45deg);-webkit-transform:rotate(-45deg);-o-transform:rotate(-45deg);}'+'.color-pick-sample-container .color-pick-sample{width:100%;height: 100%;border:0; margin: 0; position: relative; display:block; top:0; left:0;}\n'+'.fls-image-border-editor-ui .fls-multi-line-toolbar,.fls-image-border-editor-ui .fls-arc-text-toolbar{left:auto; right:15px;}\n'+'.fls-image-border-editor-ui .fls-arc-text-toolbar .action-button.line_path{display:none !important;}\n'+'\n';editor_css+='</style>\n';jQuery(editor_css).appendTo('head');}
function _insertEditorCssImgBorder(){var previewtopcorner=editor.viewtopleft();var previewsize=editor.viewsize();var _top=previewtopcorner.y+118-60;var editorpos=jQuery('#'+editorID).offset();jQuery('style#'+editorID+'-CSS').remove();var editor_css='<style type="text/css" id="'+editorID+'-CSS">\n'+'.fls-image-border-editor-ui .wl_border{border: 0;}\n'+'.fls-image-border-editor-ui #flash_container{overflow:hidden !important;}\n'+'.fls-image-border-editor-ui .fls-product-showcase-container{margin-top:15px;}\n'+'#'+editorID+'{position:relative;}\n'+'#'+editorID+' canvas:focus{outline:none;}\n'+'#'+editorID+'-LayoutSelector .selector-wrap{width:952px;display:block;}\n'+'.fls-editor-top-toolbar{display: block; clear: both;background-color:#FFF; padding:5px 0px 10px 0px; box-sizing: border-box;position:relative;max-width:99.5%;min-width:937px; margin:0 auto;text-align:left;}\n'+'.fls-editor-top-toolbar .container{display: block; clear: both;background-color:#F4F4F4; padding:20px 15px 15px 15px; margin:0;border-radius:5px 5px 5px 0; width:100%;overflow:hidden;box-sizing:border-box;}\n'+'.fls-editor-top-toolbar .container *{font: initial;}\n'+'.fls-editor-top-toolbar .container table{border-collapse: initial !important;}\n'+'.fls-editor-top-toolbar .container .side-right{margin:0 0 0 10px;float:left; width:465px;}\n'+'.fls-editor-top-toolbar .container .side-left{margin:0;float:left; width:430px;}\n'+'.fls-editor-top-toolbar .tool-ttl{display:inline-block;font-weight:normal; text-align:left; margin: 2px 0 5px 0; text-overflow: ellipsis; font-size: 14px; font-family: arial, verdana; color:'+uiColors['panels']['fontColor']+';white-space: nowrap; width: 125px; overflow:hidden;}'+'.fls-editor-top-toolbar .tool-ttl.more-options{font-size:12px;}\n'+'.fls-editor-top-toolbar .tool-ttl.main{font-size:16px;font-weight:bold; width:auto;margin-top:0;}\n'+'.fls-editor-top-toolbar input[type:text],.fls-editor-top-toolbar .font-selector-drop{border-radius:3px;}\n'+'.fls-editor-top-toolbar .font-size-label{border-radius:3px 0 0 3px;}\n'+'.fls-editor-top-toolbar.img-border .font-selector-drop:HOVER .down-arrow,.fls-editor-top-toolbar.img-border .font-selector-drop .down-arrow{background-color:#FFF !important;border:0 !important;}\n'+'.fls-editor-top-toolbar.img-border .font-selector-drop.disabled .down-arrow{background-color:#f6f6f6 !important;}\n'+'.fls-editor-top-toolbar.img-border .font-selector-drop:HOVER .down-arrow:AFTER,.fls-editor-top-toolbar.img-border .font-selector-drop .down-arrow:AFTER{background-image:url("'+resources.image_border_fn_arrow+'");background-position:center center;}\n'+'.resizebuttons{border-bottom: 1px solid #FFF; overflow: hidden;}\n'+'.resizebutton{-webkit-user-select: none;-moz-user-select: none;user-select: none;cursor:pointer;text-decoration: none; width: 26px; height: 26px; display: block; border: 1px solid #CACACA; float: left;text-align:center;vertical-align:middle;}\n'+'.resizebutton:AFTER{background-image:url("'+resources.image_border_fsupdown+'");background-repeat:no-repeat;background-position:center 0; position:relative;content:"";display:block;height:11px;width:11px;margin:50% auto; top:-5px;}\n'+'.resizebutton:ACTIVE{}\n'+'.resizebutton:HOVER{}\n'+'.resizebutton.up:AFTER{background-position:center -22px;}\n'+'.resizebutton.up{border-left: 0;}\n'+'.fls-image-border-editor-ui .font-selector-drop{top:2px;border-radius:3px;font-weight:normal;}\n'+'.logo-fonts-size-change-container .font-size-label{color: #666666;display: block;font-family: arial;font-size: 14px;line-height: 26px; height:26px;position: relative; float:left;text-align: center;width: 40px; border: 1px solid #CACACA; border-right:0;background-color: #FFF;}\n'+'.more-options-container{position: absolute;top: 100%;background-color: #FFF;width: 150px;left: 0;padding: 0 0 10px;box-sizing: border-box;margin-top: -10px;z-index: 35;}\n'+'.more-options-container .more-color-options{background-color: #F4F4F4;border-radius: 0 0 5px 0;padding:15px 20px 10px 20px;position: relative;overflow: hidden;}\n'+'.more-options-container .color-action-button.more-options:AFTER{width:18px;height:18px;display:block;position:absolute;content:"";background-repeat:no-repeat;background-position:center -28px;background-image:url("'+resources.image_border_pallete+'");margin: -9px 0 0 -9px;top: 50%;left: 50%;}\n'+'.more-options-container .more-color-options-anim-container{padding:0px;position: relative;overflow: hidden;max-height:0; transition: max-height 1s ease;-webkit-transition: max-height 1s ease;-moz-transition: max-height 1s ease;transform: translate3d(0, 0, 0);-webkit-transform: translate3d(0, 0, 0);-moz-transform: translate3d(0, 0, 0);will-change:max-height;}\n'+'.open-section .more-color-options-anim-container{max-height:300px;}\n'+'.open-section .color-action-button.more-options:AFTER{background-position:center 0;}\n'+'.color-action-button.more-options{background-color: #F4F4F4;border-radius: 0 0 5px 5px;background-repeat:no-repeat;background-position:center 0px;width:50px; height:40px; display:block;position:relative; left:0;cursor:pointer;}\n'+'.more-options-rgb-inputs input[type=text]{border: 1px solid #D9D9D9;border-radius: 3px;background-color:#FFF;font-family:arial,verdana,sans-serif;font-size:14px;color:#666;text-align:center;width: 30px;margin: 0 0 0 10px;box-sizing:border-box;padding:1px;}\n'+'.more-options-rgb-inputs input:first-child[type=text]{margin: 0;}\n'+'.more-options-rgb-inputs.hex, .more-options-rgb-inputs.rgb{margin-bottom:10px;}\n'+'.more-options-rgb-inputs.hex input[type=text]{text-align:left;width:100%;}\n'+'#desktop-popular-swatches .logo-color-swatch{width:20px; height:20px; margin: 0 9px 9px 0;border: 1px solid #D9D9D9; box-sizing:border-box;}'+'.fls-editor-top-toolbar.img-border #color-pick-canvas-color-swatches{margin-left:0;margin-right:15px;}\n'+'.add-text-button{background-color: #F4F4F4;border-radius: 3px;box-sizing:border-box;color:#666; font-size:14px !important; font-family:arial,verdana,sans-serif !important;display:block;padding:10px 25px 10px 10px; margin:17px 0 10px 0;cursor:pointer;user-select: none;position:relative;text-overflow: ellipsis;white-space: nowrap;overflow: hidden;}\n'+'.add-text-button:AFTER{width:14px;height:14px; display:block;content:"";background-repeat:no-repeat;background-position:center center;background-image:url("'+resources.image_border_add_text+'");position:absolute;right:10px; margin-top:-7px; top:50%;}\n'+'.add-text-button.disabled{opacity:0.6}\n'+'.fls-editor-side-toolbar{position:absolute; top:'+(previewtopcorner.y-39)+'px;left:'+previewtopcorner.x+'px;overflow:hidden; z-index:100;}\n'+'#'+editorID+' .sidebutton{width:40px; height:30px;border-radius:3px;background-color:#F4F4F4; display:inline-block; margin:0 5px 0 0;cursor:pointer;position:relative;}\n'+'#'+editorID+' .sidebutton:after{content:""; width:22px; height:20px;background-repeat:no-repeat; background-position:center 0;background-image:url("'+resources.image_border_side_icons+'");position: absolute;top: 50%;display: block;left: 50%;margin: -10px 0 0 -11px;}\n'+'.fls-editor-bottom-button-container .fls-button:AFTER{content:"\\e01F"; width:22px; height:20px;text-align:center;background-image:none;position: absolute;top: 50%;display: block;left: 50%;margin: -10px 0 0 -11px;font-family:"FlsObjectEditIcons";font-size:20px;}\n'+'#'+editorID+' .sidebutton.undo:after{background-position:center -97px;}\n'+'#'+editorID+' .sidebutton.undo.disabled:after{background-position:center -117px;}\n'+'#'+editorID+' .sidebutton.redo:after{background-position:center -57px;}\n'+'#'+editorID+' .sidebutton.redo.disabled:after{background-position:center -77px;}\n'+'#'+editorID+' .sidebutton.reset:after{background-position:center -37px;}\n'+'.fls-editor-bottom-button-container{position: relative;top: -30px;z-index: 100;margin: 0 auto;width: 100%;text-align: center;}\n'+'.fls-img-border-ui #FLSPreviewbttons .fls-button,.fls-img-border-ui .fls-editor-bottom-button-container .fls-button{border:1px solid #EB772A; border-radius:3px;padding:13px 35px 13px 20px !important; text-align:left;font-size:16px;font-weight:normal;color:#EB772A; font-family:arial,verdana,sans-serif;background-color:#FFF;min-width:210px !important;box-sizing:border-box;margin:0 15px !important;}\n'+'.fls-editor-bottom-button-container .fls-button:AFTER{left: auto;right: 0px; margin: -10px 10px 0 -11px;background-position: center 3px;display:block !important;}\n'+'.fls-editor-bottom-button-container .fls-button.save:AFTER{content:"\\E020"}\n'+'#FLSPreviewbttons .fls-button.lmx_primary_button,.fls-editor-bottom-button-container .fls-button.lmx_primary_button{font-weight:bold;color:#FFF;background-color:#EB772A;}\n'+'#FLSPreviewbttons .fls-button{text-align:center;font-size:16px;margin:0 5px;font-weight:normal;}\n'+'.fls-bottom-buttons-background{background-color:#FFF;display:inline-block;padding:5px 0;}\n'+'.macos-safari input[name="entered-text-edit"]{top: 3px !important;position:relative;}\n'+'.macos-safari .font-selector-drop{top: 3px !important;}\n'+'.macos-safari .resizebuttons{position:relative;display:inline-block;top:6px;}\n'+'.macos-firefox input[name="entered-text-edit"]{top: -3px !important;position:relative;}\n'+'.macos-firefox .font-selector-drop{top: 0px !important;}\n'+'.macos-firefox .resizebuttons{position:relative;display:inline-block;top: 0px;}\n'+'\n';editor_css+='</style>\n';jQuery(editor_css).appendTo('head');}
function _onresizeImgBorder(evt){if(macos_safari){var editorUI=document.querySelector('#'+editorID);if(editorUI){var bg_canvas=document.querySelector('canvas#FLSEditorBackgroundCanvas');if(bg_canvas){bg_canvas.width=editorUI.clientWidth;bg_canvas.height=editorUI.clientHeight;}}}
editor.updateOnResize();var framepos=editor.viewtopleft();jQuery('.fls-editor-side-toolbar').css({left:(framepos.x-2)+'px',top:(framepos.y-39)});if(inlineTextEditor instanceof FLSinLineTextEdit){inlineTextEditor.onWindowResize();}
var previewContainer=jQuery('#FLSPreviewContainer');if(previewContainer.length){var previewtopcorner=editor.viewtopleft();var previewsize=editor.viewsize();var cnvaspos=jQuery('#'+canvasID).offset();cnvaspos['width']=jQuery('#'+canvasID).width();cnvaspos['height']=jQuery('#'+canvasID).height();var previewImg=jQuery('#FLSPreview',previewContainer);previewContainer.css({top:cnvaspos.top+'px',left:cnvaspos.left+'px',width:cnvaspos.width+'px',height:cnvaspos.height+'px'});previewImg.css({top:(previewtopcorner.y-3)+'px',left:(previewtopcorner.x-3)+'px'});}}
function BuildUIImgBorderDesktop(canvasId){var $cwrapper=jQuery(editor.getCanvasWrapper());var $cnvs=jQuery('#'+canvasId,$cwrapper);var $editorUI=jQuery(document.createElement('div'));$editorUI.css({width:'100%',height:($cnvs.height()+157+37)+'px',backgroundColor:'#FFF',});jQuery('body').addClass('fls-image-border-editor-ui');$editorUI.attr('id',editorID);$editorUI.addClass('html5-desktop');$editorUI.addClass('fls-img-border-ui');if(logoCfg.lang!='en'){$editorUI.addClass('non-en');}
$cwrapper.css({width:$cnvs.width()+'px',height:$cnvs.height()+'px',margin:'0px auto'});var top_toolbar=jQuery('<div class="fls-editor-top-toolbar img-border"><div class="container"><\/div><\/div>');$editorUI.append(top_toolbar);$editorUI.insertBefore($cwrapper);$editorUI.append($cwrapper);_addColorEditingControlsImgBorderDesktop(jQuery('.container',top_toolbar));_addFontEditingControlsImgBorderDesktop(jQuery('.container',top_toolbar));_addMoreOptionsImgBorder(jQuery('.container',top_toolbar));var side_toolbar=jQuery('<div class="fls-editor-side-toolbar"><div class="container"><\/div><\/div>');$cwrapper.append(side_toolbar);_addSideButtonImgBorderControls(jQuery('.container',side_toolbar));_addBottomButtonControls();_insertEditorCSSGeneral();_insertEditorCssImgBorder();editor.setEventCallback(_editorEvtCallback);_bindEvents(['resize'],[window],_onresizeImgBorder);if(macos_safari===true){var bg_canvas=document.createElement('canvas');bg_canvas.width=$editorUI.get(0).clientWidth;bg_canvas.height=$editorUI.get(0).clientHeight;bg_canvas.style.position='absolute';bg_canvas.style.left=0;bg_canvas.style.top=0;bg_canvas.id='FLSEditorBackgroundCanvas';$editorUI.prepend(bg_canvas);$editorUI.addClass('macos-safari');}
if(macos_firefox===true){$editorUI.addClass('macos-firefox');}
_onresizeImgBorder();editor.render();}
this.updateUserCustomColorSwatch=function(color){return updateUserCustomColorSwatch(color)}
this.showPageLoadOverlay=function(){_showPageLoadingOverlay();};this.toggleMultiselect=function(){use_multiselect=!use_multiselect;if(use_multiselect&&!multiSelectObj){multiSelectObj=new FLSMultiselect(editor);multiSelectObj.scalable(true);this.registerOnSwitchCallback(multiSelectObj.hide);}
if(!use_multiselect&&multiSelectObj){multiSelectObj.hide();}
return use_multiselect;};this.Init=function(canvasId,_logodata){use_multiselect=_logodata.vetting_tools?true:use_multiselect;if(!_logodata.logoID){throw"Missing logo id in config data";}
if(typeof(_logodata.enable_LMX_5715_features)==='boolean'){enable_LMX_5715_features=mobile?false:_logodata.enable_LMX_5715_features;}else{enable_LMX_5715_features=mobile?false:enable_LMX_5715_features;}
use_inline_text_edit=enable_LMX_5715_features;select_logo_by_bbox=enable_LMX_5715_features;scale_to_font_size=enable_LMX_5715_features;intersection_select=enable_LMX_5715_features;use_multiselect=enable_LMX_5715_features;view_frame_image_border=enable_LMX_5715_features;ui_side_bar_width=view_frame_image_border?0:95;ui_top_bar_height=view_frame_image_border?0:133;if((typeof(_logodata['report'])!='object')){delete _logodata['report'];}
if(typeof(_logodata['font_language'])!='string'){delete _logodata['font_language'];}
if(typeof(_logodata['on_preview_callback'])!='undefined'){_logodata['on_preview_callback']=eval('('+_logodata['on_preview_callback']+')');}
if(typeof(_logodata.iconset)!='undefined'){FLSUtil.objIconStyle=_logodata.iconset;}
if(typeof(_logodata.logo_mode)!='undefined'){if(logo_modes.indexOf(_logodata.logo_mode)>-1){logo_mode=_logodata.logo_mode;}else{logo_mode=_logodata.logo_mode=logo_modes[0];}
switch(logo_mode){case'initial':case'badge':editor_version=(logo_mode=='initial')?61:62;needsFontpath=true;if((typeof(window.opentype)=='undefined')||(typeof(window.opentype.Font)=='undefined')){needsFontpath=false;console.error('missing Opentype.js library.');}
break;default:}}
if((typeof(_logodata.svg_fonts)=='object')&&(_logodata.svg_fonts instanceof Array)&&_logodata.svg_fonts.length){svg_fonts=_logodata.svg_fonts.slice(0);}else{svg_fonts=[];}
if(!(_logodata.suggest_svg_fonts instanceof Array)||!_logodata.suggest_svg_fonts.length){delete _logodata.suggest_svg_fonts}
if(typeof(_logodata.single_font_logo)=='boolean'){single_font_logo=_logodata.single_font_logo;}
if(typeof(_logodata.replace_logo_fonts)=='boolean'){replace_logo_fonts=_logodata.replace_logo_fonts;}
if(typeof(_logodata.suggest_use_logo_fonts)!='boolean'){_logodata.suggest_use_logo_fonts=false;}
if(typeof(_logodata.inline_text_edit_keep_controls)=='boolean'){inline_text_edit_keep_controls=_logodata.inline_text_edit_keep_controls;}
if(typeof(_logodata.inline_text_edit_keep_alignment)=='boolean'){inline_text_edit_keep_alignment=_logodata.inline_text_edit_keep_alignment;}
if(typeof(_logodata.use_inline_text_edit)=='boolean'){use_inline_text_edit=_logodata.use_inline_text_edit;}
if(typeof(_logodata.select_logo_by_bbox)=='boolean'){select_logo_by_bbox=_logodata.select_logo_by_bbox;}
if(typeof(_logodata.scale_to_font_size)=='boolean'){scale_to_font_size=_logodata.scale_to_font_size;}
if(typeof(_logodata.intersection_select)=='boolean'){intersection_select=_logodata.intersection_select;}
if(_logodata.act!=''){single_font_logo=_logodata.single_font_logo=replace_logo_fonts=_logodata.replace_logo_fonts=false;fltype_param='fltype=logo';}else{fltype_param='fltype=parent';}
if(view_frame_image_border===true){FLSUtil.objIconStyle='imgbg';}
if(typeof(_logodata.enable_arc_text_toolbar)=='boolean'){show_arc_text_buttons=_logodata.enable_arc_text_toolbar;}
logoCfg=_logodata;canvasID=canvasId;jQuery('#'+canvasID).parents('form').on('submit',function(){return false;});if(logoCfg.lang=='jp'||logoCfg.lang=='zh-hans'){langparam='&lang='+logoCfg.lang;}
logoCfg.suggestCards=parseInt(logoCfg.suggestCards);if(isNaN(logoCfg.suggestCards)){logoCfg.suggestCards=0;}
logoCfg.showLogoLayouts=parseInt(logoCfg.showLogoLayouts);if(isNaN(logoCfg.showLogoLayouts)||(['badge','text'].indexOf(logo_mode)>-1)){logoCfg.showLogoLayouts=0;delete logoCfg['generate_layout'];}
if(logoCfg.product_showcase!=undefined){if((logoCfg.product_showcase.items instanceof Array)&&logoCfg.product_showcase.items.length){if(!logoCfg.product_showcase.twidth||!logoCfg.product_showcase.theight){logoCfg.product_showcase.twidth=300;logoCfg.product_showcase.theight=200;}else{logoCfg.product_showcase.twidth=parseInt(logoCfg.product_showcase.twidth,10);logoCfg.product_showcase.theight=parseInt(logoCfg.product_showcase.theight,10);if(isNaN(logoCfg.product_showcase.twidth)||isNaN(logoCfg.product_showcase.theight)){logoCfg.product_showcase.twidth=300;logoCfg.product_showcase.theight=200;}}}else{delete logoCfg.product_showcase;}}
if(typeof(logoCfg.generate_layout)!='undefined'){if(logoCfg.act!=''){delete logoCfg['generate_layout'];}else{logoCfg.showLogoLayouts=0;}}
text_align=(logoCfg.act=='update'?'left':'center');if(typeof(FLS_Font_Family_Name_Map[logoCfg.lang])=='undefined'){FLS_Font_Family_Name_Map[logoCfg.lang]={};}
if(!editor){loadSteps.push(_LoadConfig);if(logo_mode!='normal'){loadSteps.push(_LoadLogoLayout);}
loadSteps.push(_LoadUiTexts);loadSteps.push(_LoadUiPropertiesTexts);loadSteps.push(_BuildUI);loadSteps.push(_stepLogoFontsLoaded);if(needsFontpath&&logoCfg.showLogoLayouts){loadSteps.push(_stepInitFontPathObj);}
loadSteps.push(_stepLoadLogo);loadSteps.push(_handleLoadComplete);total_steps=loadSteps.length;execLoadSteps(canvasId)
displayFakeProgress();}else{this.LoadSvg();}};this.LoadSvg=function(onlysvg){if(typeof(onlysvg)!='boolean'){onlysvg=false;}
jQuery.ajax({url:(apiRoot==_apiRoot?apiRoot:_apiRoot)+apiUrl.logoUrl+logoCfg.logoID,success:parseSvgData,contentType:'xml',data:{},dataFilter:svgFilter});if(!onlysvg){var product_type=logoCfg.product_type?'&product_type='+logoCfg.product_type:'';jQuery.get((apiRoot==_apiRoot?apiRoot:_apiRoot)+apiUrl.fontsList+logoCfg.logoID+langparam+product_type,parseFontsData,'xml');}};this.testSVG=function(){var svgstr=_toSVG();var svgdiv=document.getElementById('SVGDIVTEST');if(!svgdiv){svgdiv=document.createElement('div');svgdiv.id='SVGDIVTEST';svgdiv.style.margin='10px auto';svgdiv.style.textAlign='center';document.body.appendChild(svgdiv);}
svgdiv.innerHTML=svgstr;console.log(svgstr);};this.showPreview=function(){_showPreview(true,true);};this.getEditor=function(){return editor;};this.BindEvents=function(events,elements,callback){_bindEvents(events,elements,callback);};this.setResetTransforms=function(transforms){if(transforms instanceof Array){reset_transforms.length=0;reset_transforms=transforms;}};this.apiRoot=function(){return[apiRoot,_apiRoot];};this.mobile=function(){return mobile;};this.showProductShowcaseBlock=function(){productShowcase.show();};this.replaceOrgSvg=function(){orgSVG=jQuery.parseXML(_toSVG());};this.track=function(_action,_label,_category,_value){GTrack.track(_action,_label,_category,_value);};this.flushEventReport=function(){GTrack.flushEvents();};this.onCheckDirectSaveCallback=function(_logo_directsave){if(_logo_directsave){logoCfg.logo_directsave=_logo_directsave;}};};var FLSLogoEditor=new _FLSLogoEditor();_FLSLogoEditor.prototype.FLSLayoutSuggest=function(_editor,containerID,settings,colors,mobile,_this){var layout_choices={'current':[],'left-logo':[],'arc-logo':[],'bottom-logo':[],'right-logo':[],};var layout_choice_text_anchors={'left-logo':'left','right-logo':'right','bottom-logo':'center','arc-logo':'center','current':'center','middle-logo':'center',};var lobjs=_editor.getObjects();var _first_line_tmp=false;for(var li=0;li<lobjs.length;li++){if((lobjs[li]instanceof FLSEditorCore.CMultiLineText)&&!_first_line_tmp){delete layout_choices['arc-logo'];layout_choices['middle-logo']=[];break;}
_first_line_tmp=lobjs[li]instanceof FLSEditorCore.CText?true:_first_line_tmp;}
var arc_logo_choice_data=[];var original_logo_props=[];var cur_layout_w=327;var layout_w=244;var max_selector_wrap_width=895;var _vs=_editor.viewsize();var viewSize=[_vs.width,_vs.height];var cch=Math.ceil(viewSize[1]*cur_layout_w/viewSize[0]);var och=Math.ceil(viewSize[1]*layout_w/viewSize[0]);var layselectorID=containerID+'-LayoutSelector';var container=jQuery('#'+containerID);var pmsize=pickMeSize(settings['action'],190,14);var layouts_selector_height=Math.min(565,container.height())-180;var layouts_selector_width=Math.min(935,container.width())-102;var sec_layout_holder_width=(layouts_selector_width-cur_layout_w-2)/2;var sec_layout_holder_height=layouts_selector_height/2;var selectorcss='<style type="text/css" id="'+layselectorID+'-CSS">\n'+'#'+layselectorID+' .selector-title{font-size:26px;font-family: arial,verdana,sans-serif; margin: 15px; padding:0;}\n'+'#'+layselectorID+' .selector-wrap{background-color:#FFF;color: #015697;margin:20px auto 30px auto;text-align:center;font-family:arial,verdana,sans-serif;font-size:20px;overflow:hidden;max-width:'+max_selector_wrap_width+'px;border-radius:5px;}\n'+'#'+layselectorID+' .layouts-selector{background-color:#FFF;color:#3F3F3F;margin:0px 30px 30px 30px;font-family:arial,verdana,sans-serif;font-size:20px;height:'+layouts_selector_height+'px; min-height: 375px; border: 1px solid #DCDCDC;}\n'+'#'+layselectorID+' .layout-holder{float:left; margin: 0; display:table-cell; width:'+sec_layout_holder_width+'px; height:50% ;text-align: center; position:relative;border-color:#DCDCDC;border-style:solid; border-width:0 1px 1px 0;}\n'+'#'+layselectorID+' .layout-holder.last{border-right:0}\n'+'#'+layselectorID+' .layout-holder.bottom{border-bottom:0}\n'+'#'+layselectorID+' .layout-holder h3{font-family: arial,verdana,sans-serif; color: #000;font-size: 24px;margin:24px 0;}\n'+'#'+layselectorID+' .layout-holder.current-layout{width: '+cur_layout_w+'px; height:100%;margin:0px; border:0; border-right:1px solid #DCDCDC;overflow:hidden;}\n'+'#'+layselectorID+' .layout-choice{width: 100%; height:'+(och+55)+'px; text-align: center; overflow: visible; display: block; position: absolute; left:0; top:0; z-index: 2; padding: 0;}\n'+'#'+layselectorID+' .layout-choice canvas{width:'+layout_w+'px; height: '+och+'px;  background-color:#FFF; display: block; margin:15px auto;cursor:pointer;}\n'+'#'+layselectorID+' .current-layout .layout-choice{border-top:1px solid #DCDCDC;width: 100%; height:'+(layouts_selector_height-64)+'px; margin-top:65px;}\n'+'#'+layselectorID+' .current-layout canvas{width: 327px; height:'+cch+'px;margin:20px auto;}\n'+'#'+layselectorID+' .layout-choice .pick-me-container{position:absolute; border-top:1px solid #DCDCDC; background-color: #F1F2F2; display:none;bottom:0;width:100%;height:70px;}\n'+'#'+layselectorID+' .layout-holder.secondary .pick-me-container{height:50px;}\n'+'#'+layselectorID+' .layout-choice:HOVER .pick-me-container,#'+layselectorID+' .layout-choice.tapped .pick-me-container{display:block;}\n'+'#'+layselectorID+' .layout-choice:HOVER .pick-me,#'+layselectorID+' .layout-choice.tapped .pick-me{display:inline-block; min-width:170px; text-align:center; padding: 5px 10px; line-height: 23px; margin: 0px auto; color: #FFF; '+'background-color: #EA762B; '+'border-radius: 3px; font-size: '+pmsize+'px; white-space: nowrap; font-family:arial,verdana,sans-serif;font-weight:normal;'+'-webkit-user-select: none;-moz-user-select: none;user-select: none;cursor:pointer;text-decoration: none;'+'margin-top: 20px; top:50%;'+'}\n'+'#'+layselectorID+' .layout-choice:HOVER,#'+layselectorID+' .layout-choice.tapped  {z-index:3;}\n'+'#'+layselectorID+' .layout-choice:HOVER .pick-me:ACTIVE, #'+layselectorID+' .layout-choice.tapped .pick-me:ACTIVE{background-color:#59AA06;}\n'+'#'+layselectorID+' .layout-holder.secondary .layout-choice:HOVER .pick-me,  #'+layselectorID+' .layout-holder.secondary .layout-choice.tapped .pick-me{margin-top: 8px;}\n'+'#'+layselectorID+' .layout-holder.secondary .layout-choice:HOVER ,  #'+layselectorID+' .layout-holder.secondary .layout-choice.tapped {box-shadow: 0 3px 3px rgba(0,0,0,0.2); width:'+(sec_layout_holder_width+9)+'px; height:'+(sec_layout_holder_height+25)+'px; left:-5px; top: -5px; text-align:center;background-color: #FFF;border-radius:0 0 3px 3px;border: 1px solid #DCDCDC;}\n'+'</style>\n';jQuery(selectorcss).appendTo('head');var ovrly=jQuery(document.createElement('div'));ovrly.attr('id',layselectorID);ovrly.css({'background-color':'rgba(0,0,0,0.7)','display':'block','position':'absolute','z-index':150,'width':'100%','height':'100%'});container.prepend(ovrly);jQuery('.fls-editor-bottom-button-container',container).hide();var selector_wrap=jQuery('<div class="selector-wrap"><h2 class="selector-title">'+settings['heading']+'<\/h2><\/div>');ovrly.append(selector_wrap);var layouts_table='';var layout_counter=1;for(var chcs in layout_choices){if(chcs=='current'){layouts_table+='<div class="layout-holder current-layout"><h3>'+settings['layout']+'<\/h3>'+'<span class="layout-choice">'+'<canvas data-choice="current" width="'+cur_layout_w+'" height="'+cch+'"><\/canvas>'+'<div class="pick-me-container"><span class="pick-me" data-choice="current">'+settings['action']+'<\/span></div>'+'<\/span>'+'<\/div>';}else{var classes=!(layout_counter%2)?' last':'';classes+=(layout_counter>2)?' bottom':'';layout_counter+=1;layouts_table+='<div class="layout-holder secondary'+classes+'">'+'<span class="layout-choice">'+'<canvas data-choice="'+chcs+'"  width="'+layout_w+'" height="'+och+'"><\/canvas>'+'<div class="pick-me-container"><span class="pick-me" data-choice="'+chcs+'">'+settings['action']+'<\/span></div>'+'<\/span>'+'<\/div>';}}
var selector=jQuery('<div class="layouts-selector"><\/div>');selector_wrap.append(selector);selector.append(layouts_table);_this.BindEvents(mobile?['touchend']:['mouseup'],jQuery('.pick-me, canvas',selector),_handleLayoutChoice);renderChoices();function pickMeSize(text,tw,cfsize){var span=jQuery('<span style="position:absolute; right: 100%; display:inline; text-align:center; padding: 5px 10px; line-height: 23px;font-size: '+cfsize+'px; white-space: nowrap; font-family:arial,verdana,sans-serif;font-weight:bold;">'+text+'<\/span>');jQuery('body').append(span);var w=parseInt(span.width(),10);if(w>tw){cfsize=Math.floor((tw/w)*cfsize);}
span.remove();return cfsize;}
function _handleLayoutChoice(evt){var choice=jQuery(this).attr('data-choice');jQuery('#'+layselectorID+', style#'+layselectorID+'-CSS').remove();jQuery('.fls-editor-bottom-button-container',container).show();var objects=_editor.getObjects();for(var oi=0;oi<objects.length;oi++){objects[oi].setMatrix(layout_choices[choice][oi]);if(objects[oi]instanceof FLSEditorCore.CText){if(choice=='arc-logo'){objects[oi].setProperties(arc_logo_choice_data.shift());}else{objects[oi].setText(objects[oi].getText());}
if(layout_choice_text_anchors[choice]&&!objects[oi].has_path()){objects[oi].align_point=layout_choice_text_anchors[choice];if((objects[oi]instanceof FLSEditorCore.CMultiLineText)&&objects[oi].multiline_on()){objects[oi].updateMeasurements();}}}}
if(choice!='current'){_this.setResetTransforms(layout_choices[choice]);}
_this.showProductShowcaseBlock();_this.replaceOrgSvg();_this.track('click',choice,'LayoutSuggest');return false;}
function updateMultilineForThumb(to,lyt){if((to instanceof FLSEditorCore.CMultiLineText)&&to.multiline_on()){if(layout_choice_text_anchors[lyt]){to.align_point=layout_choice_text_anchors[lyt];}else{to.align_point='center';}
to.updateMeasurements();}}
function renderChoices(){var viewframeCenterY=viewSize[1]/2;var viewframeCenterX=viewSize[0]/2;var objects=_editor.getObjects();var objln=objects.length;var lr_ratio=1;var lr_ratio_found=false;var lr_center_dx=0;var t_idx=1;for(var i=0;i<objln;i++){var tmp_mtrx=objects[i].getMatrix();var tmp_data=[tmp_mtrx[0],tmp_mtrx[1],tmp_mtrx[2],tmp_mtrx[3],tmp_mtrx[4],tmp_mtrx[5]];layout_choices['current'].push(tmp_data);original_logo_props.push(objects[i].getProperties());}
for(var lch in layout_choices){if(lch!='current'){for(var i=0;i<objln;i++){objects[i].setMatrix([1,0,0,1,0,0]);}
switch(lch){case'left-logo':case'right-logo':var corners=[];var lcorners=[];if(lr_ratio_found===false){objects[0].objCenter(corners);var lw=corners[1]['x']-corners[0]['x'];objects[1].objCenter(corners);var tw=corners[1]['x']-corners[0]['x'];if(objln>2){objects[2].objCenter(corners);var tw2=corners[1]['x']-corners[0]['x'];if(tw2>tw){tw=tw2;t_idx=2;}}
if((tw+lw)>viewSize[0]){var wttl=tw+lw;var dif=wttl-(viewSize[0]-20);lr_ratio=1-(dif/wttl);}
lr_ratio_found==true;}
if(lch=='left-logo'){var lcenter=objects[0].objCenter(lcorners);for(var i=0;i<objln;i++){objects[i].scaleUniform(lr_ratio);var center=objects[i].objCenter(corners);if(i==0){objects[i].translate((-corners[0]['x'])/lr_ratio,(viewframeCenterY-center.y)/lr_ratio);lcenter=objects[0].objCenter(lcorners);}else if(i==1){if(objln>2){objects[i].translate((-corners[0]['x']+lcorners[1]['x'])/lr_ratio,(lcenter.y-corners[1]['y'])/lr_ratio);}else{objects[i].translate((-corners[0]['x']+lcorners[1]['x'])/lr_ratio,(viewframeCenterY-center.y)/lr_ratio);}
updateMultilineForThumb(objects[i],lch);}else{objects[i].translate((-corners[0]['x']+lcorners[1]['x'])/lr_ratio,(lcenter.y-corners[0]['y'])/lr_ratio);}}
objects[t_idx].objCenter(corners);lr_center_dx=(viewSize[0]-corners[1]['x'])/2;}else{var lcenter=objects[0].objCenter(lcorners);for(var i=0;i<objln;i++){objects[i].scaleUniform(lr_ratio);var center=objects[i].objCenter(corners);if(i==0){objects[i].translate((viewSize[0]-corners[1]['x'])/lr_ratio,(viewframeCenterY-center.y)/lr_ratio);lcenter=objects[0].objCenter(lcorners);}else if(i==1){if(objln>2){objects[i].translate((-corners[1]['x']+lcorners[0]['x'])/lr_ratio,(lcenter.y-corners[1]['y'])/lr_ratio);}else{objects[i].translate((-corners[1]['x']+lcorners[0]['x'])/lr_ratio,(viewframeCenterY-center.y)/lr_ratio);}
updateMultilineForThumb(objects[i],lch);}else{objects[i].translate((-corners[1]['x']+lcorners[0]['x'])/lr_ratio,(lcenter.y-corners[0]['y'])/lr_ratio);}}
objects[t_idx].objCenter(corners);lr_center_dx=-corners[0]['x']/2;}
for(var i=0;i<objln;i++){objects[i].translateX(lr_center_dx);}
break;case'bottom-logo':var ref_tl_y=0;var corners=[];var center=objects[1].objCenter(corners);objects[1].translate(viewframeCenterX-center.x,ref_tl_y-corners[0]['y']);updateMultilineForThumb(objects[1],lch);if(objects.length>2){objects[1].objCenter(corners);ref_tl_y=corners[1]['y'];center=objects[2].objCenter(corners);objects[2].translate(viewframeCenterX-center.x,ref_tl_y-corners[0]['y']);objects[2].objCenter(corners);}else{objects[1].objCenter(corners);}
ref_tl_y=corners[1]['y'];center=objects[0].objCenter(corners);objects[0].translate(viewframeCenterX-center.x,ref_tl_y-corners[0]['y']);objects[0].objCenter(corners);ref_tl_y=(viewSize[1]-corners[1]['y'])/2;objects[0].translateY(ref_tl_y);objects[1].translateY(ref_tl_y);if(objln>2){objects[2].translateY(ref_tl_y);}
break;case'middle-logo':var center=objects[0].objCenter();objects[0].translate(viewframeCenterX-center.x,viewframeCenterY-center.y);var corners=[];objects[0].objCenter(corners);var ref_tl_y=corners[0]['y'];center=objects[1].objCenter(corners);objects[1].translate(viewframeCenterX-center.x,ref_tl_y-corners[1]['y']);updateMultilineForThumb(objects[1],lch);if(objects.length>2){objects[0].objCenter(corners);ref_tl_y=corners[1]['y'];center=objects[2].objCenter(corners);objects[2].translate(viewframeCenterX-center.x,ref_tl_y-corners[0]['y']);}
var y_min=0,y_max=0;var ordered_obj_arr=[];for(var oi=0;oi<objects.length;oi++){objects[oi].objCenter(corners);ordered_obj_arr.push({obj:objects[oi],corners:corners.slice(0)});y_min=y_min>corners[0]['y']?corners[0]['y']:y_min;y_max=y_max<corners[1]['y']?corners[1]['y']:y_max;}
if(y_min<0||y_max>viewSize[1]){ordered_obj_arr.sort(function(a,b){return a.corners[0]['y']>=b.corners[0]['y'];});var lcontent_hght=y_max-y_min;if(lcontent_hght>viewSize[1]){var scale_factor=viewSize[1]/lcontent_hght;for(var oi=0;oi<ordered_obj_arr.length;oi++){ordered_obj_arr[oi].obj.use_pivot(true);ordered_obj_arr[oi].obj.scaleUniform(scale_factor);ordered_obj_arr[oi].obj.use_pivot(false);ordered_obj_arr[oi].obj.objCenter(corners);ordered_obj_arr[oi].corners=corners.slice(0);}
for(var oi=1;oi<ordered_obj_arr.length;oi++){var dy=ordered_obj_arr[oi-1].corners[1]['y']-ordered_obj_arr[oi].corners[0]['y'];ordered_obj_arr[oi].obj.translateY(dy);ordered_obj_arr[oi].obj.objCenter(corners);ordered_obj_arr[oi].corners=corners.slice(0);}}
y_max=ordered_obj_arr[ordered_obj_arr.length-1].corners[1]['y'];lcontent_hght=y_max-y_min;var c_dy=(viewSize[1]-lcontent_hght)/2;c_dy-=y_min;while(ordered_obj_arr.length){var oobj=ordered_obj_arr.shift();oobj.obj.translateY(c_dy);}}
break;case'arc-logo':var corners=[];var center=objects[0].objCenter();objects[0].translate(viewframeCenterX-center.x,viewframeCenterY-center.y);_this.generateTextPath('arc_top',true,objects[1])
if(objects.length>2){objects[0].objCenter(corners);ref_tl_y=corners[1]['y'];center=objects[2].objCenter(corners);objects[2].translate(viewframeCenterX-center.x,ref_tl_y-corners[0]['y']);}
var min_arctext_logo_distance=10;var arccorners=[];objects[1].objCenter(arccorners);objects[0].objCenter(corners);var arcdy=(corners[0]['y']-arccorners[1]['y']);if(arcdy>min_arctext_logo_distance){objects[1].translateY(arcdy-min_arctext_logo_distance);}
var temp_logo_group=new FLSEditorCore.CLogoObjectGroup();temp_logo_group.editor(_editor);temp_logo_group.addElement(objects[0]);temp_logo_group.addElement(objects[1]);if(objects.length>2){temp_logo_group.addElement(objects[2]);}
temp_logo_group.calculateBoundingBox();var grp_size=temp_logo_group.getSize();if((grp_size.width>viewSize[0])||(grp_size.height>viewSize[1])){var gscale=Math.min(viewSize[0]/grp_size.width,viewSize[1]/grp_size.height);temp_logo_group.use_pivot(true);temp_logo_group.scaleUniform(gscale);temp_logo_group.use_pivot(false);}
var lg_center=temp_logo_group.objCenter();temp_logo_group.translate(viewframeCenterX-lg_center.x,viewframeCenterY-lg_center.y);temp_logo_group.clearElements();break;};}
var ctx=jQuery('canvas[data-choice="'+lch+'"]').get(0).getContext('2d');ctx.setTransform(1,0,0,1,0,0);var scale=layout_w/viewSize[0];if(lch=='current'){scale=cur_layout_w/viewSize[0];}
ctx.scale(scale,scale);for(var oi=0;oi<objects.length;oi++){var tmp_mtrx=objects[oi].getMatrix();var tmp_data=[tmp_mtrx[0],tmp_mtrx[1],tmp_mtrx[2],tmp_mtrx[3],tmp_mtrx[4],tmp_mtrx[5]];if(lch!='current'){layout_choices[lch].push(tmp_data);}
objects[oi].render(ctx,ctx);if((lch=='arc-logo')){if(objects[oi]instanceof FLSEditorCore.CText){arc_logo_choice_data.push(objects[oi].getProperties());objects[oi].setProperties(original_logo_props[oi]);objects[oi].updateMeasurements();}else{objects[oi].setMatrix(layout_choices['current'][oi]);}}else{objects[oi].setMatrix(layout_choices['current'][oi]);}}}}};_FLSLogoEditor.prototype.FLSCardsSuggest=function(toolcfg,containerID,logoCfg,apiUrl,fonts_list){var bc_sizes={'businessCardStandard':{zoom:1.9,w:[259,263],h:[151,155],trim:[3.5,2.0],editor_version:54},'businessCardStandardEU':{zoom:1.9,w:[250,254],h:[165,169],trim:[3.15,1.97],editor_version:56},};var active_bc_key=['eu','EU'].indexOf(logoCfg.card_type)>-1?'businessCardStandardEU':'businessCardStandard';var bc_ws={width:(bc_sizes[active_bc_key]['w'][0]+bc_sizes[active_bc_key]['w'][1])/2,height:(bc_sizes[active_bc_key]['h'][0]+bc_sizes[active_bc_key]['h'][1])/2};var preview_sz={'businessCardStandard':{w:272,h:160},'businessCardStandardEU':{w:241,h:160}};var preview_zoom={'businessCardStandard':preview_sz['businessCardStandard']['w']/((bc_sizes['businessCardStandard']['w'][0]+bc_sizes['businessCardStandard']['w'][1])/2),'businessCardStandardEU':preview_sz['businessCardStandardEU']['w']/((bc_sizes['businessCardStandardEU']['w'][0]+bc_sizes['businessCardStandardEU']['w'][1])/2)};var bc_suggest_ids=logoCfg.bc_suggestion_ids;var loading=false;var logo_copy=null;var backDesignDlgID=containerID+'-BackDesignDlg';var container=jQuery('#'+containerID);var body=jQuery('body');var l_ids;var editor=this.getEditor();var logo_colors=[];var logo_colors_uint=[];var logo_font='';var logo_font_is_serif=false;var logo_font_filename='';var choiceCallback=function(saveparams){};var evt_bound=false;var bcfonts={};var use_suggest_font=((logoCfg.suggest_svg_fonts instanceof Array)&&logoCfg.suggest_svg_fonts.length);if(bc_suggest_ids){l_ids=decodeURI(bc_suggest_ids.toString()).split('|');for(var lidx=0;lidx<l_ids.length;lidx++){l_ids[lidx]=parseInt(l_ids[lidx],10).toString();}}else{return false;}
var _this=this;var apiroot=this.apiRoot();var logourl=(apiroot[0]==apiroot[1]?apiroot[0]:apiroot[1])+'flashdata.php?method=svg&lid=';var layoutUrl=logourl.replace('method=svg','method=layout');if(logoCfg.font_language){logourl=logourl.replace(/flashdata.php\?/g,'flashdata.php?font_language='+logoCfg.font_language+'&');}
var designs=[];var design_ids=[];var layouts={};function updateEuBcLayout(scl_x,scl_y,target_w,target_h,width,height,bcid){var zoom=editor.zoom();var new_pw=target_w*zoom;var new_ph=target_h*zoom;var new_scale_xml=target_w/new_pw;var lx=jQuery('layout',layouts[bcid]['xml']);var max_scale=Math.max(scl_x,scl_y)
if(lx.length){lx.attr('previewWidth',new_pw);lx.attr('previewHeight',new_ph);lx.attr('width',target_w);lx.attr('height',target_h);lx.attr('scale',new_scale_xml);jQuery('areas area',lx).each(function(index){var area=jQuery(this);var a_name=area.attr('name').toLowerCase();var ax=parseFloat(area.attr('x'));var ay=parseFloat(area.attr('y'));var aw=parseFloat(area.attr('w'));var ah=parseFloat(area.attr('h'));switch(a_name){case'area_logo':ay*=scl_y;ax*=scl_x;aw*=scl_x;ah*=scl_y;break;default:ax*=scl_x;ay*=scl_y;aw*=scl_x;ah*=scl_y;}
layouts[bcid].areas[a_name]['x']=Math.ceil(ax);layouts[bcid].areas[a_name]['y']=Math.ceil(ay);layouts[bcid].areas[a_name]['w']=Math.ceil(aw);layouts[bcid].areas[a_name]['h']=Math.ceil(ah);area.attr({x:layouts[bcid].areas[a_name]['x'],y:layouts[bcid].areas[a_name]['y'],w:layouts[bcid].areas[a_name]['w'],h:layouts[bcid].areas[a_name]['h']})});}}
function setEuBCSize(bcid,cw,ch){var w,h,wfsz,scl_x,scl_y,tw,th;function copy_and_crop_bg_image(img_obj){img_obj.onload=null;var dpi_mul=300/72;var target_w=tw*dpi_mul;var target_h=th*dpi_mul;var img_sz=img_obj.getImgSize();var min_ratio=Math.min(img_sz.width/target_w,img_sz.height/target_h)
target_w=Math.round(target_w*min_ratio);target_h=Math.round(target_h*min_ratio);var top_x=Math.round((img_sz.width-target_w)/2);var top_y=Math.round((img_sz.height-target_h)/2);var crop_canvas=document.createElement('canvas');crop_canvas.width=target_w;crop_canvas.height=target_h;var cc_ctx=crop_canvas.getContext('2d');var img=img_obj.getImageTag();var oldsrc=img.src;var old_xlinkhref=img_obj.xlinkhref;var isjpeg=/(data:image\/jpeg;base64,)|(\.(jpg|jpeg))/i.test(old_xlinkhref)
img_obj.mimetype=isjpeg?'image/jpeg':'image/png'
cc_ctx.fillStyle='#FFF';cc_ctx.fillRect(0,0,target_w,target_h);cc_ctx.drawImage(img,top_x,top_y,target_w,target_h,0,0,target_w,target_h);var new_src=crop_canvas.toDataURL(img_obj.mimetype,1);img_obj.is_new(true);img_obj.setSize(tw,th);img_obj.setMatrix([1,0,0,1,0,0]);img_obj.base64src=true;img_obj.xlinkhref=img_obj.xlinkhref.replace(/\.(jpg|jpeg|png)/i,'_cropped.$1');img_obj.src(new_src);}
if(logoCfg.card_type&&(logoCfg.card_type=='EU')){w=bc_sizes['businessCardStandardEU']['w'];h=bc_sizes['businessCardStandardEU']['h'];if(!(cw>=w[0]&&cw<=w[1]&&ch>=h[0]&&ch<=h[1])){var imageDesign=false;tw=(w[0]+w[1])/2;th=(h[0]+h[1])/2;scl_x=tw/cw;scl_y=th/ch;updateEuBcLayout(scl_x,scl_y,tw,th,cw,ch,bcid);var design_idx=design_ids.indexOf(bcid);if(design_idx==-1)return false;var objs=designs[design_idx];var breakme=0;for(var oi=0;oi<objs.length;oi++){if((objs[oi]instanceof FLSEditorCore.CRect)&&objs[oi].id=='backgroundColor'){objs[oi].setSize(tw,th);}else if((objs[oi]instanceof FLSEditorCore.CPathGroup)&&objs[oi].getPaths().length){objs[oi].scale(scl_x,scl_y);}else if((objs[oi]instanceof FLSEditorCore.CImage)&&objs[oi].xlinktype=='templateBackground'){if(logoCfg.backgr_keep_ratio){var max_scl=Math.max(scl_x,scl_y);objs[oi].scaleUniform(max_scl);old_bg_xlinkhref[sc]=objs[oi].xlinkhref;if(objs[oi].loaded()){copy_and_crop_bg_image(objs[oi]);}else{if(typeof(objs[oi].onload)=='function'){var onload_org=objs[oi].onload;objs[oi].onload=function(){onload_org.apply(null,arguments)
copy_and_crop_bg_image.apply(null,arguments);}}else{objs[oi].onload=copy_and_crop_bg_image;}}
imageDesign=true;}else{objs[oi].scale(scl_x,scl_y);}}else{if(objs[oi]instanceof Array){for(var ti=0;ti<objs[oi].length;ti++){var opos=objs[oi][ti].getPosition();var new_x=opos.x*scl_x;var new_y=opos.y*scl_y;objs[oi][ti].setPosition(new_x,new_y);}}else{var opos=objs[oi].getPosition();var new_x=opos.x*scl_x;var new_y=opos.y*scl_y;objs[oi].setPosition(new_x,new_y);}}
if(breakme==3){break;}}}}}
function _choiceToRaster(bc_design){var rcanvas=document.createElement('canvas');rcanvas.width=bc_ws.width*bc_sizes[active_bc_key]['zoom'];rcanvas.height=bc_ws.height*bc_sizes[active_bc_key]['zoom'];var rctx=rcanvas.getContext('2d');rctx.setTransform(1,0,0,1,0,0)
rctx.fillStyle='#FFF';rctx.fillRect(0,0,rcanvas.width,rcanvas.height);rctx.setTransform(bc_sizes[active_bc_key]['zoom'],0,0,bc_sizes[active_bc_key]['zoom'],0,0);rctx.save();for(var i=0;i<bc_design.length;i++){if(bc_design[i]instanceof FLSEditorCore.CObject){bc_design[i].for_preview=true;bc_design[i].render(rctx);bc_design[i].for_preview=false;}else{if(bc_design[i]instanceof Array){for(var j=0;j<bc_design[i].length;j++){bc_design[i][j].for_preview=true;bc_design[i][j].render(rctx);bc_design[i][j].for_preview=false;}}}}
rctx.restore();return rcanvas.toDataURL().replace(/data:image\/png;base64,/ig,'');}
function _choiceToSvg(bc_design){var svg=document.createElementNS('http://www.w3.org/2000/svg','svg');var logolayer=document.createElementNS('http://www.w3.org/2000/svg','g');var textlayer=document.createElementNS('http://www.w3.org/2000/svg','g');logolayer.setAttribute('id','surface2');textlayer.setAttribute('id','surface4');svg.setAttribute('width',bc_ws.width+'pt');svg.setAttribute('height',bc_ws.height+'pt');svg.setAttribute('viewBox','0 0 '+bc_ws.width+' '+bc_ws.height);svg.setAttribute('version','1.1');svg.setAttribute('xmlns','http://www.w3.org/2000/svg');svg.setAttribute('xmlns:xlink','http://www.w3.org/1999/xlink');svg.appendChild(document.createTextNode('\n  '));svg.appendChild(logolayer);svg.appendChild(document.createTextNode('\n  '));svg.appendChild(textlayer);svg.appendChild(document.createTextNode('\n'));if(bc_design[0]instanceof FLSEditorCore.CPathGroup){bc_design[0].toSVG(logolayer);}
var telements=bc_design[1];for(var i=0;i<telements.length;i++){if(telements[i]instanceof FLSEditorCore.CText&&telements[i].getText()!=telements[i].default_text()){telements[i].toSVG(textlayer);}}
if(bc_design[2]instanceof FLSEditorCore.CLogoObjectGroup){var embedlogo=document.createElementNS('http://www.w3.org/2000/svg','g');embedlogo.setAttribute('id','logo');svg.appendChild(document.createTextNode('\n  '));svg.appendChild(embedlogo);bc_design[2].toSVG(embedlogo);}
textlayer.appendChild(document.createTextNode('\n  '));logolayer.appendChild(document.createTextNode('\n  '));var svgstr=new XMLSerializer().serializeToString(svg);return svgstr;}
function colorDistOk(color1,color2){var c1=FLSUtil.hexdec2rgb(color1);var c2=FLSUtil.hexdec2rgb(color2);var mr=(c1[0]+c2[0])/2;var dr=c1[0]-c2[0];var dg=c1[1]-c2[1];var db=c1[2]-c2[2];var _dr=((512+mr)*dr*dr)>>8;var _dg=4*dg*dg;var _db=((767-mr)*db*db)>>8;var color_dist=Math.sqrt(_dr+_dg+_db);return color_dist>60;}
function _findLogoColors(){logo_font='';logo_font_is_serif=false;logo_font_filename='';while(logo_colors.length){logo_colors.pop();logo_colors_uint.pop();}
var eobjs=editor.getObjects();var font_style_set=false;var first_ff='';for(var li=0;li<eobjs.length;li++){if(eobjs[li]instanceof FLSEditorCore.CPathGroup){var lpaths=eobjs[li].getPaths();for(var pi=0;pi<lpaths.length;pi++){if(lpaths[pi].stringdata){var ff=lpaths[pi].stringdata.font_family;if(fonts_list[ff]){font_style_set=typeof(fonts_list[ff]['font_style'])!='undefined';if(font_style_set&&['serif','sansserif'].indexOf(fonts_list[ff]['font_style'])>-1){logo_font=ff;logo_font_is_serif=true;logo_font_filename=fonts_list[ff]['ttf_src'];}
first_ff=first_ff?first_ff:ff;}}
var colortmp=lpaths[pi].getColor();if(!colortmp)continue;var badclr=/rgb\(\s*?(100(\.\d+)?%|255)\s*?,\s*?(100(\.\d+)?%|255)\s*?,\s*?(100(\.\d+)?%|255)\s*?\)|rgba\(\s*?(0)s*?,\s*?(0)\s*?,\s*?(0)\s*?,\s*?(0)\s*?\)/i.test(colortmp);var colortmp_n=FLSUtil.normalizeCssColor(colortmp);if((logo_colors.indexOf(colortmp)==-1)&&!badclr&&colortmp_n.uint<16770000){for(var uidx=0;uidx<logo_colors_uint.length;uidx++){if(!colorDistOk(logo_colors_uint[uidx],colortmp_n.uint)){badclr=true;break;}}
if(!badclr){logo_colors.push(colortmp);logo_colors_uint.push(colortmp_n.uint);}}}}else{if((logoCfg.suggest_use_logo_fonts===true)&&!logo_font.length){var txt=eobjs[li].getText();if(txt.length&&(txt!==eobjs[li].default_text())){var ff=eobjs[li].getFontFamily();if(fonts_list[ff]){font_style_set=typeof(fonts_list[ff]['font_style'])!='undefined';if(font_style_set&&['serif','sansserif'].indexOf(fonts_list[ff]['font_style'])>-1){logo_font=ff;logo_font_is_serif=true;logo_font_filename=fonts_list[ff]['ttf_src'];}}
first_ff=first_ff?first_ff:ff;}}
if(logo_colors.length<2){var colortmp=eobjs[li].getColor();if(!colortmp)continue;var badclr=/rgb\(\s*?(100(\.\d+)?%|255)\s*?,\s*?(100(\.\d+)?%|255)\s*?,\s*?(100(\.\d+)?%|255)\s*?\)|rgba\(\s*?(0)s*?,\s*?(0)\s*?,\s*?(0)\s*?,\s*?(0)\s*?\)/i.test(colortmp);var colortmp_n=FLSUtil.normalizeCssColor(colortmp);if((logo_colors.indexOf(colortmp)==-1)&&!badclr&&colortmp_n.uint<16770000){for(var uidx=0;uidx<logo_colors_uint.length;uidx++){if(!colorDistOk(logo_colors_uint[uidx],colortmp_n.uint)){badclr=true;break;}}
if(!badclr){logo_colors.push(colortmp);logo_colors_uint.push(colortmp_n.uint);}}}}}
if((logo_font.length==0)&&(font_style_set===false)){logo_font=first_ff;}
if(use_suggest_font){if(fonts_list[logoCfg.suggest_svg_fonts[0]]){logo_font=logoCfg.suggest_svg_fonts[0];logo_font_filename=fonts_list[logo_font]['ttf_src'];logo_font_is_serif=['serif','sansserif'].indexOf(fonts_list[logo_font]['font_style'])>-1;}}}
var selectorcss='<style type="text/css" id="'+backDesignDlgID+'-CSS">\n'+'#'+backDesignDlgID+' .selector-title{font-size:26px;font-family: arial,verdana,sans-serif; margin: 15px; color:#015697; text-align:center; padding:0;}\n'+'#'+backDesignDlgID+' .selector-dlg-wrapper{padding:0;background-color: #F1F2F2;display: block;position: relative;width: 925px; height: 486px;overflow:hidden;}\n'+'#'+backDesignDlgID+' .selector-dlg-wrapper.eu-preview{width: 812px !important;}\n'+'#'+backDesignDlgID+' .selector-dlg-wrapper .inner-wrapper{padding:0; margin:10px 14px; overflow:hidden; position: relative; height: 367px; background-color:#FFF;}\n'+'#'+backDesignDlgID+' .selector-dlg-wrapper .logo-choices{margin-right:0; border-right: 2px solid #666; width: 285px;}\n'+'#'+backDesignDlgID+' .selector-close-dlg-btn{cursor:pointer; user-select:none; -moz-user-select:none;color:#256CA2; border-radius:20px;text-align:center; line-height:27px;position:absolute; z-index:2; font-size:25px; font-family: verdana,arial,sans-serif; width:30px; height:30px; font-weight:bold; top:-16px; right:-16px; background-color:#fff; border:3px solid #9F9F9F;}\n'+'#'+backDesignDlgID+' .selector-close-dlg-btn:active, selector-close-dlg-btn:hover{background-color:#d6d6d6;}\n'+'#'+backDesignDlgID+' .selector-carousel{width:auto; margin:0 40px; height:100%;position:relative}\n'+'#'+backDesignDlgID+' .selector-carousel .selector-slider{position:absolute; left:0; top:0; height: 100%; -webkit-transition: left 0.3s;transition: left 0.3s; -webkit-transform: translate3d(0,0,0); transform: translate3d(0,0,0);}\n'+'#'+backDesignDlgID+' .selector-carousel .selector-slider .design-item{padding:0; float:left; display:inline-block; width: '+preview_sz[active_bc_key]['w']+'px; height:'+preview_sz[active_bc_key]['h']+'px; margin: 15px 12px 0 3px;position:relative;}\n'+'#'+backDesignDlgID+' .selector-carousel .selector-slider .design-item canvas{cursor:pointer;position:absolute; width: '+preview_sz[active_bc_key]['w']+'px; height:'+preview_sz[active_bc_key]['h']+'px; box-shadow: 0px 0px 3px rgba(0,0,0,0.5); background-color: #FFF;}\n'+'#'+backDesignDlgID+' .selector-navigate{background-image: url("data:image/png;base64,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");'+'background-repeat:no-repeat; width:30px; height:30px; dispaly:block;position:absolute; bottom:200px;cursor:pointer;}\n'+'#'+backDesignDlgID+' .selector-navigate.left{left:5px;}\n'+'#'+backDesignDlgID+' .selector-navigate.right{right:5px; background-position:-33px 0;}\n'+'#'+backDesignDlgID+' .selector-dlg-wrapper .selector-action{border-radius:20px;font-weight:bold;display:inline-block;}\n'+'#'+backDesignDlgID+' .selector-dlg-wrapper.no-navigation{width:905px;}\n'+'#'+backDesignDlgID+' .no-navigation .selector-navigate{display:none;}\n'+'#'+backDesignDlgID+' .no-navigation .selector-carousel{margin:0 12px;}\n'+'#'+backDesignDlgID+' .selector-slider .top{background:none;}\n'+'#'+backDesignDlgID+' .selector-slider .bottom{background:none;}\n'+'#'+backDesignDlgID+' .selector-dlg-wrapper .close-suggest-dlg{font-family:arial,verdana,sans-serif;text-transform:uppercase;cursor:pointer;position:absolute; right:0;top:0; font-size:16px; font-weight:normal;color:#005598;background-color:#E0E0E0; padding:5px 10px;margin:0;}\n'+'#'+backDesignDlgID+' .selector-carousel .selector-slider .design-item .select-item-button-container{display:none; position:absolute; width: 100%; height:37px; left:0px; bottom:0px; background-color:rgba(192,192,192,0.8);text-align:center;}\n'+'#'+backDesignDlgID+' .selector-carousel .selector-slider .design-item:HOVER .select-item-button-container{display:block;}\n'+'#'+backDesignDlgID+' .selector-carousel .selector-slider .design-item  .select-item-button-container .choose-this-button{display:none;cursor:pointer; background-color:#eb772a; color: #FFF;  font-weight:normal; line-height:1.2em !important; white-space:nowrap;text-align:center; font-family:arial,verdana,sans-serif;   position: relative; box-shadow: none; font-size:14px; padding:7px 20px !important; margin:2px auto;-moz-border-radius:3px;-webkit-border-radius:3px;-ms-border-radius:3px;-o-border-radius:3px;border-radius:3px;}\n'+'#'+backDesignDlgID+' .selector-carousel .selector-slider .design-item:HOVER  .select-item-button-container .choose-this-button{display:inline-block;}\n'+'#'+backDesignDlgID+' .selector-carousel .selector-slider .design-item  .select-item-button-container .choose-this-button:HOVER{background-color:#F5A742;}\n'+'</style>\n';jQuery(selectorcss).appendTo('head');var ovrly=jQuery(document.createElement('div'));ovrly.attr('id',backDesignDlgID);ovrly.css({'background-color':'rgba(0,0,0,0.7)','display':'none','position':'absolute','z-index':150,'width':'100%','height':'100%'});body.prepend(ovrly);var selector_wrap=jQuery('<div class="selector-dlg-wrapper no-navigation">'+'<span class="close-suggest-dlg" data-action="remove-cancel">X</span>'+'<h2 class="selector-title">'+toolcfg.suggestions.heading+'<\/h2>'+'<div class="inner-wrapper">'+'<span class="selector-navigate left" data-action="left">&nbsp;</span>'+'<span class="selector-navigate right" data-action="right">&nbsp;</span>'+'<div class="selector-carousel" id="BackDesignSelectorCarousel">'+'<div class="selector-slider"><div class="top"></div><div class="bottom"></div></div>'+'</div>'+'</div>'+'<div style="text-align:center;"><span class="fls-button lmx_primary_button selector-action" data-action="remove-cancel">'+toolcfg.suggestions.save+'</span></div>'+'<\/div>');if(active_bc_key=='businessCardStandardEU'){selector_wrap.addClass('eu-preview');}
var cntpos=container.offset();ovrly.append(selector_wrap);var cntw=container.width();var left=cntpos.left+((cntw-selector_wrap.width())/2);var top=cntpos.top+45;selector_wrap.css({left:left+'px',top:top+'px'});var do_slide=true;function _handleSlideEnd(){do_slide=true;}
function _handleDlgChoice(evt){var me=jQuery(this);var action=me.attr('data-action');switch(action){case'left':case'right':if(do_slide){var slider=jQuery('#BackDesignSelectorCarousel .selector-slider',selector_wrap);var cw=jQuery('#BackDesignSelectorCarousel',selector_wrap).width();var csw=slider.width();if(csw>cw){var pos=slider.position();var left=pos.left;if(action=='left'){left+=preview_sz[active_bc_key]['w']+20;}else{left-=preview_sz[active_bc_key]['w']+20;}
var diff=left+csw;if(left<=0&&diff>=cw){do_slide=false;slider.css('left',left+'px');}}}
break;case'remove-cancel':default:action=parseInt(action,10);var bc_choice={};if(!isNaN(action)&&designs[action]){var bcid=me.attr('data-bcid');bc_choice.bc_parent_id=bcid;bc_choice.bc_layout=new XMLSerializer().serializeToString(layouts[bcid]['xml']);bc_choice.bc_svg=_choiceToSvg(designs[action]);bc_choice.bc_raster=_choiceToRaster(designs[action]);if(((use_suggest_font===true)||(logoCfg.suggest_use_logo_fonts===true))&&logo_font.length&&logo_font_is_serif){bc_choice.bc_serif_fontname=logo_font;bc_choice.bc_serif_fontfilename=logo_font_filename;}}
choiceCallback(bc_choice);_hideDlg();}}
function displayDesignItem(bc_data,bcid){var idx=designs.indexOf(bc_data);var dsgn_data=bc_data[0];var item=jQuery('.design-item canvas[data-action='+idx+']');bcid=parseInt(bcid,10);if(isNaN(bcid)){bcid=design_ids[idx];}
if(!item.length){item=jQuery('<canvas data-action="'+idx+'" data-bcid="'+bcid+'" width="'+preview_sz[active_bc_key]['w']+'" height="'+preview_sz[active_bc_key]['h']+'"></canvas>');var div=jQuery('<div class="design-item"><div class="select-item-button-container"><span class="choose-this-button" data-action="'+idx+'" data-bcid="'+bcid+'">'+(toolcfg.suggestions.select)+'</span></div></div>');var stripe=idx%2?'.bottom':'.top';var slider=jQuery('#BackDesignSelectorCarousel .selector-slider',selector_wrap);div.prepend(item);jQuery(stripe,slider).append(div);var total_side_margins=23;slider.css({width:(Math.ceil(designs.length/2)*(preview_sz[active_bc_key]['w']+total_side_margins))+'px'});_this.BindEvents(_this.mobile()?['touchend']:['mouseup'],jQuery('canvas, .choose-this-button, img',div),_handleDlgChoice);}
var cnvs=item.get(0);var ctx=cnvs.getContext('2d');ctx.setTransform(1,0,0,1,0,0);ctx.clearRect(0,0,cnvs.width,cnvs.height);ctx.setTransform(preview_zoom[active_bc_key],0,0,preview_zoom[active_bc_key],0,0);var design_paths=dsgn_data.getPaths();var to=Math.min(logo_colors.length,design_paths.length);var last_color=null;var color_maps={};var cclridx=0;for(var i=0;i<to;i++){var pcolor=design_paths[i].getColor();if(!color_maps[pcolor]){color_maps[pcolor]=logo_colors[cclridx];cclridx++;}
last_color=color_maps[pcolor];design_paths[i].setColor(color_maps[pcolor]);}
if(i<design_paths.length&&last_color){for(var i=to;i<design_paths.length;i++){var pcolor=design_paths[i].getColor();if(pcolor){if(!color_maps[pcolor]){color_maps[pcolor]=logo_colors[cclridx]?logo_colors[cclridx]:(logo_colors[i]?logo_colors[i]:last_color);cclridx++;}
design_paths[i].setColor(color_maps[pcolor]);}}}
dsgn_data.render(ctx);var tos=bc_data[1];if(((use_suggest_font===true)||(logoCfg.suggest_use_logo_fonts===true))&&logo_font.length>0){for(var tidx=0;tidx<tos.length;tidx++){tos[tidx].setFontFamily(logo_font);}
LayoutBCTexts(bcid,tos);}
for(var ti=0;ti<tos.length;ti++){tos[ti].render(ctx);}
bc_data[2]=_getLogoEmbed(bcid);bc_data[2].render(ctx);}
function _hideDlg(){ovrly.hide();}
function _displayDlg(){logo_copy=null;ovrly.show();for(var i=0;i<designs.length;i++){displayDesignItem(designs[i]);}
if(typeof(logoCfg.on_bc_suggest_show)=='function'){logoCfg.on_bc_suggest_show();}}
function _getLogoEmbed(lid){var copied=logo_copy!=null;var nlogo=new FLSEditorCore.CLogoObjectGroup();nlogo.id='logo';var edobjcts=editor.getObjects();for(var nlid=0;nlid<edobjcts.length;nlid++){if(edobjcts[nlid]instanceof FLSEditorCore.CPathGroup){var cpg=new FLSEditorCore.CPathGroup();cpg.setMatrix(edobjcts[nlid].getMatrix().slice(0));var cpgp=edobjcts[nlid].getPaths();for(var pi=0;pi<cpgp.length;pi++){cpg.addPath(cpgp[pi]);}
nlogo.addElement(cpg);}
if(edobjcts[nlid]instanceof FLSEditorCore.CText){if(edobjcts[nlid].getText()!=edobjcts[nlid].default_text()){var CtxTCls=(edobjcts[nlid]instanceof FLSEditorCore.CPathText)?FLSEditorCore.CPathText:new FLSEditorCore.CText;CtxTCls=(edobjcts[nlid]instanceof FLSEditorCore.CMultiLineText)?FLSEditorCore.CMultiLineText:CtxTCls;var ctxt=new CtxTCls();ctxt.setProperties(edobjcts[nlid].getProperties());if((ctxt instanceof FLSEditorCore.CMultiLineText)&&edobjcts[nlid].multistyle_on()){ctxt.multistyle_on(true);ctxt.multistyle_cfg(edobjcts[nlid].multistyle_cfg());}
nlogo.addElement(ctxt);}}}
nlogo.editor(editor);if(!copied){nlogo.calculateBoundingBox();logo_copy=nlogo;}else{var bbpos=logo_copy.bboxpos();var sz=logo_copy.getSize();var pivot=logo_copy.pivot();nlogo.bboxpos(bbpos.x,bbpos.y);nlogo.setSize(sz.width,sz.height);nlogo.pivot(pivot);nlogo.center(pivot);}
LayoutBCLogo(lid,nlogo);return nlogo;}
function _loadDesigns(){if(l_ids.length){loading=true;var lid=l_ids.shift();LoadLayout(lid,function(lid){jQuery.get(logourl+lid,function(xml){_loadDesigns();var svg=jQuery('svg',xml);var surface2=jQuery('>#surface2',svg);if(surface2.length){var pg=parseLogoImage(surface2);var tos=parseBCTextObjects(jQuery('>#surface4 text',svg),lid);var bc_data=0||[pg,tos];designs.push(bc_data);design_ids.push(lid);if(logoCfg.card_type=='EU'){var cl_sz=svg.attr('viewBox').split(' ');setEuBCSize(lid,parseFloat(cl_sz[2],10),parseFloat(cl_sz[3],10));}
LayoutBCTexts(lid,tos);displayDesignItem(bc_data,lid);}},'xml').fail(function(resp,type,error){_loadDesigns();});});}else{loading=false;}}
function _show(_choiceCallback){_findLogoColors();if(typeof(_choiceCallback)=='function'){choiceCallback=_choiceCallback;}
if(!designs.length){_loadDesigns();}
if(!evt_bound){_this.BindEvents(_this.mobile()?['touchend']:['mouseup'],jQuery('.selector-close-dlg-btn',selector_wrap),_hideDlg);_this.BindEvents(_this.mobile()?['touchend']:['mouseup'],jQuery('.selector-action, .selector-navigate, .close-suggest-dlg',selector_wrap),_handleDlgChoice);_this.BindEvents(['transitionend','webkitTransitionEnd','oTransitionEnd','otransitionend','MSTransitionEnd'],jQuery('.selector-slider',selector_wrap),_handleSlideEnd);evt_bound=true;}
_displayDlg();return false;};function LoadLayout(bc_id,donecallback){var parsed=FLSUtil.parseUri(layoutUrl);var url=layoutUrl+bc_id;var data={};if(parsed.host!=document.domain){url='resources.php';data.url=logoCfg.config;}
jQuery.ajax({url:url,data:data,dataType:'xml',success:function(xml){layouts[bc_id]={areas:{},groups:{}},jQuery('layout >areas area',xml).each(function(index){var area=jQuery(this);layouts[bc_id].areas[area.attr('name').toLowerCase()]={x:parseFloat(area.attr('x')),y:parseFloat(area.attr('y')),w:parseFloat(area.attr('w')),h:parseFloat(area.attr('h')),type:area.attr('type'),align:area.attr('align')};});jQuery('layout >groups',xml).children().each(function(index){var gn=jQuery(this);layouts[bc_id].groups[this.nodeName.toLowerCase()]={type:gn.attr('type'),group:gn.attr('group')};});layouts[bc_id]['xml']=xml;if(typeof(donecallback)=='function'){donecallback(bc_id);}},error:function(resp){}});}
function parseLogoImage(logoimage){var cpg=new FLSEditorCore.CPathGroup();logoimage.find('path').each(function(index){var pn=jQuery(this);var pth=new FLSEditorCore.CPath();pth.setPathStr(pn.attr('d'));pth.inGroup(true);pth.editor(editor);var styles=pn.attr('style').trim().split(';');for(var i=0;i<styles.length;i++){var stmp=styles[i].split(':');if(stmp.length==2){switch(stmp[0]){case'fill':if(stmp[1]!='none'){pth.setColor(stmp[1]);}
break;case'stroke':if(stmp[1]!='none'){pth.setStroke(stmp[1]);}else{pth.setStroke();}
break;case'stroke-width':if(stmp[1]!='none'){pth.setStrokeWidth(stmp[1]);}else{pth.setStrokeWidth();}
break;case'stroke-linecap':if(stmp[1]!='none'){pth.setStrokeCap(stmp[1]);}else{pth.setStrokeCap();}
break;case'stroke-miterlimit':if(stmp[1]!='none'){pth.setStrokeMieter(stmp[1]);}else{pth.setStrokeMieter();}
break;case'stroke-linejoin':if(stmp[1]!='none'){pth.setStrokeJoin(stmp[1]);}else{pth.setStrokeJoin();}
break;case'fill-opacity':stmp[1]=parseFloat(stmp[1]);if(!isNaN(stmp[1])&&stmp[1]<1){pth.setFillOpacity(stmp[1]);}
break;default:}}}
var ptransform={};if(pn.attr('transform')){var ptransforms=pn.attr('transform').trim().split(') ');if(ptransforms.length){for(var l=0;l<ptransforms.length;l++){var fn=ptransforms[l].split('(');if(fn.length==2){fn[1]=fn[1].replace(/\)/g,'').replace(/\s+/g,',').replace(/,+/g,',').split(',');ptransform[fn[0]]=[];if(fn[1].length){for(var fi=0;fi<fn[1].length;fi++){ptransform[fn[0]].push(parseFloat(fn[1][fi]));}}}}}
if(ptransform['matrix']){pth.setMatrix(ptransform['matrix']);}}
cpg.addPath(pth);});var transform={};if(logoimage.attr('transform')){var transforms=logoimage.attr('transform').trim().split(') ');if(transforms.length){for(var l=0;l<transforms.length;l++){var fn=transforms[l].split('(');if(fn.length==2){fn[1]=fn[1].replace(/\)/g,'').replace(/\s+/g,',').replace(/,+/g,',').split(',');transform[fn[0]]=[];if(fn[1].length){for(var fi=0;fi<fn[1].length;fi++){transform[fn[0]].push(parseFloat(fn[1][fi]));}}}}}}
if(transform['matrix']){cpg.setMatrix(transform['matrix']);}
return cpg;}
function parseBCTextObjects(textnodes,bc_id){var tos=[];textnodes.each(function(index){var tn=jQuery(this);var txt=tn.text();var usrtxt='t'+tn.attr('id');var cfgkey=typeof(layouts[bc_id].groups[usrtxt])!=='undefined'?layouts[bc_id].groups[usrtxt]['type']:'';if(cfgkey=='name'){cfgkey='first_name';}
var scfgkey="suggested_"+cfgkey;if(cfgkey&&typeof(logoCfg[scfgkey])!=='undefined'){if(cfgkey=='first_name'){txt=decodeURIComponent(logoCfg[scfgkey].toString().replace(/\+/ig,'%20')).trim();txt+=' '+decodeURIComponent(logoCfg['suggested_last_name'].toString().replace(/\+/ig,'%20')).trim();txt=txt.trim();}else{txt=decodeURIComponent(logoCfg[scfgkey].toString().replace(/\+/ig,'%20')).trim();}}else{txt='';}
var to=new FLSEditorCore.CText(txt);var ff=tn.attr('font-family');to.setFontFamily(ff);var fs=parseFloat(tn.attr('font-size'));fs=fs<to.minscale()?to.minscale():fs;to.setFontSize(fs);var styles=tn.attr('style').trim().split(';');for(var i=0;i<styles.length;i++){var stmp=styles[i].split(':');if(stmp.length==2){switch(stmp[0]){case'fill':to.setColor(stmp[1]);break;default:}}}
var transform={};if(tn.attr('transform')){var transforms=tn.attr('transform').trim().split(') ');if(transforms.length){for(var l=0;l<transforms.length;l++){var fn=transforms[l].split('(');if(fn.length==2){fn[1]=fn[1].replace(/\)/g,'').replace(/\s+/g,',').replace(/,+/g,',').split(',');transform[fn[0]]=[];if(fn[1].length){for(var fi=0;fi<fn[1].length;fi++){transform[fn[0]].push(parseFloat(fn[1][fi]));}}}}}
if(transform['matrix']){to.setMatrix(transform['matrix']);}
if(transform['translate']){to.translate(transform['translate'][0],transform['translate'][1]);}
to.id=tn.attr('id');}
tos.push(to);});return tos;}
function LayoutBCTexts(bc_id,tos,vertical){for(var i=0;i<tos.length;i++){var id='t'+tos[i].id;if(layouts[bc_id].groups[id]){for(var lyi in layouts[bc_id].areas){if(layouts[bc_id].areas[lyi]['type']==layouts[bc_id].groups[id]['type']){var to=tos[i];_repositionTextObject(layouts[bc_id].areas[lyi],to,vertical);}}}}}
function _parseFontsData(xml){bcfonts={};jQuery('style#FLSEditorBcSuggestFonts').remove();var fontface_css='<style type="text/css" id="FLSEditorBcSuggestFonts">\n';var fontcount=0;var fonts_base_url=jQuery('TextFonts',xml).attr('base_path');fonts_base_url=fonts_base_url?fonts_base_url:'';var formats={'.ttf':'truetype','.otf':'opentype'};var ext,font_format;jQuery('font',xml).each(function(index){var me=jQuery(this);var fontfamily=me.attr('fontfamily');if(['Helvetica','helvetica'].indexOf(fontfamily)==-1||FLSUtil.isFontAvailable(fontfamily)){return true;}
bcfonts[fontfamily]={ttf_src:me.attr('ttf_src'),};ext=bcfonts[fontfamily]['ttf_src'].match(/(\.ttf)|(.otf)/ig);ext=(ext instanceof Array)?ext[0].toLowerCase():'.ttf';font_format=formats[ext];var fonturl=(fonts_base_url+'html5/'+bcfonts[fontfamily]['ttf_src']);fontface_css+='@font-face{\n\t';fontface_css+='font-family: "'+fontfamily+'";\n\t';fontface_css+='src: url("'+fonturl+'") format("'+font_format+'") ;\n\t';fontface_css+='font-weight: normal;\n\t';fontface_css+='font-style: normal;\n\t';fontface_css+='}\n\n';fontcount+=1;});fontface_css+='</style>';jQuery(fontface_css).appendTo('head');return true;}
function _repositionTextObject(cfg,to,vertical){if(typeof(vertical)!=='boolean'){vertical=false;}
if(!to)return false;to.setText(to.getText());to.resetScale();var sz=to.getSize();var fsz=to.getFontSize();var dx=0;var dy=0;var multiline_txt=false;if((to instanceof FLSEditorCore.CMultiLineText)&&to.multiline_on()){var fs_scale=Math.min(cfg.w/sz.width,cfg.h/to.pixel_height);fsz=Math.ceil(fsz*fs_scale);to.setFontSize(fsz);multiline_txt=true;}else{if(sz.width>cfg.w){var fs=to.getFontSize();fs=Math.ceil(fs*(cfg.w/sz.width));to.setFontSize(fs);sz=to.getSize();fsz=fs;}}
var pos=to.getPosition();switch(cfg.align){case'center':var tcx=sz.width/2;var acx=cfg.x+(cfg.w/2);dx=acx-(tcx+pos.x);break;case'right':var oldx=pos.x+sz.width;dx=cfg.x+cfg.w-oldx;break;case'left':dx=cfg.x-pos.x;default:}
switch(cfg.vAlign){case'top':if(multiline_txt){dy=cfg.y-pos.y+to.line1_px_ascent;}else{dy=cfg.y-pos.y+to.pixel_height-to.descent;}
break;case'middle':if(multiline_txt){var tcy=pos.y-(to.line1_px_ascent/2);var acy=cfg.y+(cfg.h/2);dy=acy-tcy;dy-=(to.extra_line_height/2);}else{var tcy=pos.y-((to.pixel_height-to.descent)/2);var acy=cfg.y+(cfg.h/2);dy=acy-tcy;}
break;case'bottom':var aby=cfg.y+cfg.h;dy=aby-pos.y-to.descent;if(multiline_txt){dy-=to.extra_line_height;}
break
default:if(vertical){var tcy=pos.y-fsz/2;var acy=cfg.y+(cfg.h/2);dy=acy-tcy;}}
to.align_point=cfg.align;to.translate(dx,dy);if(multiline_txt){to.updateMeasurements();}}
function LayoutBCLogo(bc_id,nlogo){if(nlogo instanceof FLSEditorCore.CLogoObjectGroup){nlogo.setMatrix([1,0,0,1,0,0]);var logoarea=layouts[bc_id].areas.area_logo?layouts[bc_id].areas.area_logo:{x:0,y:0,w:261,h:153};var logosize=nlogo.getSize();var area_center={x:(logoarea.w/2)+logoarea.x,y:(logoarea.h/2)+logoarea.y};var logocenter=nlogo.center();var tx=area_center.x-logocenter.x;var ty=area_center.y-logocenter.y;var scale=1;scale=Math.min(logoarea.w/logosize.width,logoarea.h/logosize.height);nlogo.translate(tx,ty);nlogo.use_pivot(true);nlogo.scaleUniform(scale);nlogo.use_pivot(false);}
return nlogo;};if(l_ids.length){loading=true;var lid=l_ids[0];var product_type='&product_type=bussiness-cards';jQuery.get((apiroot[0]==apiroot[1]?apiroot[0]:apiroot[1])+apiUrl.fontsList+lid+product_type,function(xml){if(!_parseFontsData(xml)){_loadDesigns();return false;}
var fontloader=document.createElement('div');fontloader.style.position='absolute';fontloader.style.right='110%';fontloader.style.top='-200px';fontloader.style.overflow='hidden';fontloader.style.display='block';fontloader.style.width='100px';fontloader.style.height='100px';document.body.appendChild(fontloader);var fontCnt=0;for(var fnt in bcfonts){var fontspan=document.createElement('span');fontspan.style.fontFamily='"'+fnt+'"';fontspan.innerHTML=fnt;fontloader.appendChild(fontspan);fontCnt++;}
var timeout=fontCnt*50;setTimeout(function(){_loadDesigns();},timeout);},'xml');}else{setTimeout(function(){_loadDesigns();},200);}
return{show:_show};};;(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?factory(exports):typeof define==='function'&&define.amd?define(['exports'],factory):(factory((global.opentype=global.opentype||{})));}(this,(function(exports){'use strict';var TINF_OK=0;var TINF_DATA_ERROR=-3;function Tree(){this.table=new Uint16Array(16);this.trans=new Uint16Array(288);}
function Data(source,dest){this.source=source;this.sourceIndex=0;this.tag=0;this.bitcount=0;this.dest=dest;this.destLen=0;this.ltree=new Tree();this.dtree=new Tree();}
var sltree=new Tree();var sdtree=new Tree();var length_bits=new Uint8Array(30);var length_base=new Uint16Array(30);var dist_bits=new Uint8Array(30);var dist_base=new Uint16Array(30);var clcidx=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);var code_tree=new Tree();var lengths=new Uint8Array(288+32);function tinf_build_bits_base(bits,base,delta,first){var i,sum;for(i=0;i<delta;++i){bits[i]=0;}
for(i=0;i<30-delta;++i){bits[i+delta]=i/delta|0;}
for(sum=first,i=0;i<30;++i){base[i]=sum;sum+=1<<bits[i];}}
function tinf_build_fixed_trees(lt,dt){var i;for(i=0;i<7;++i){lt.table[i]=0;}
lt.table[7]=24;lt.table[8]=152;lt.table[9]=112;for(i=0;i<24;++i){lt.trans[i]=256+i;}
for(i=0;i<144;++i){lt.trans[24+i]=i;}
for(i=0;i<8;++i){lt.trans[24+144+i]=280+i;}
for(i=0;i<112;++i){lt.trans[24+144+8+i]=144+i;}
for(i=0;i<5;++i){dt.table[i]=0;}
dt.table[5]=32;for(i=0;i<32;++i){dt.trans[i]=i;}}
var offs=new Uint16Array(16);function tinf_build_tree(t,lengths,off,num){var i,sum;for(i=0;i<16;++i){t.table[i]=0;}
for(i=0;i<num;++i){t.table[lengths[off+i]]++;}
t.table[0]=0;for(sum=0,i=0;i<16;++i){offs[i]=sum;sum+=t.table[i];}
for(i=0;i<num;++i){if(lengths[off+i]){t.trans[offs[lengths[off+i]]++]=i;}}}
function tinf_getbit(d){if(!d.bitcount--){d.tag=d.source[d.sourceIndex++];d.bitcount=7;}
var bit=d.tag&1;d.tag>>>=1;return bit;}
function tinf_read_bits(d,num,base){if(!num)
{return base;}
while(d.bitcount<24){d.tag|=d.source[d.sourceIndex++]<<d.bitcount;d.bitcount+=8;}
var val=d.tag&(0xffff>>>(16-num));d.tag>>>=num;d.bitcount-=num;return val+base;}
function tinf_decode_symbol(d,t){while(d.bitcount<24){d.tag|=d.source[d.sourceIndex++]<<d.bitcount;d.bitcount+=8;}
var sum=0,cur=0,len=0;var tag=d.tag;do{cur=2*cur+(tag&1);tag>>>=1;++len;sum+=t.table[len];cur-=t.table[len];}while(cur>=0);d.tag=tag;d.bitcount-=len;return t.trans[sum+cur];}
function tinf_decode_trees(d,lt,dt){var hlit,hdist,hclen;var i,num,length;hlit=tinf_read_bits(d,5,257);hdist=tinf_read_bits(d,5,1);hclen=tinf_read_bits(d,4,4);for(i=0;i<19;++i){lengths[i]=0;}
for(i=0;i<hclen;++i){var clen=tinf_read_bits(d,3,0);lengths[clcidx[i]]=clen;}
tinf_build_tree(code_tree,lengths,0,19);for(num=0;num<hlit+hdist;){var sym=tinf_decode_symbol(d,code_tree);switch(sym){case 16:var prev=lengths[num-1];for(length=tinf_read_bits(d,2,3);length;--length){lengths[num++]=prev;}
break;case 17:for(length=tinf_read_bits(d,3,3);length;--length){lengths[num++]=0;}
break;case 18:for(length=tinf_read_bits(d,7,11);length;--length){lengths[num++]=0;}
break;default:lengths[num++]=sym;break;}}
tinf_build_tree(lt,lengths,0,hlit);tinf_build_tree(dt,lengths,hlit,hdist);}
function tinf_inflate_block_data(d,lt,dt){while(1){var sym=tinf_decode_symbol(d,lt);if(sym===256){return TINF_OK;}
if(sym<256){d.dest[d.destLen++]=sym;}else{var length,dist,offs;var i;sym-=257;length=tinf_read_bits(d,length_bits[sym],length_base[sym]);dist=tinf_decode_symbol(d,dt);offs=d.destLen-tinf_read_bits(d,dist_bits[dist],dist_base[dist]);for(i=offs;i<offs+length;++i){d.dest[d.destLen++]=d.dest[i];}}}}
function tinf_inflate_uncompressed_block(d){var length,invlength;var i;while(d.bitcount>8){d.sourceIndex--;d.bitcount-=8;}
length=d.source[d.sourceIndex+1];length=256*length+d.source[d.sourceIndex];invlength=d.source[d.sourceIndex+3];invlength=256*invlength+d.source[d.sourceIndex+2];if(length!==(~invlength&0x0000ffff))
{return TINF_DATA_ERROR;}
d.sourceIndex+=4;for(i=length;i;--i)
{d.dest[d.destLen++]=d.source[d.sourceIndex++];}
d.bitcount=0;return TINF_OK;}
function tinf_uncompress(source,dest){var d=new Data(source,dest);var bfinal,btype,res;do{bfinal=tinf_getbit(d);btype=tinf_read_bits(d,2,0);switch(btype){case 0:res=tinf_inflate_uncompressed_block(d);break;case 1:res=tinf_inflate_block_data(d,sltree,sdtree);break;case 2:tinf_decode_trees(d,d.ltree,d.dtree);res=tinf_inflate_block_data(d,d.ltree,d.dtree);break;default:res=TINF_DATA_ERROR;}
if(res!==TINF_OK)
{throw new Error('Data error');}}while(!bfinal);if(d.destLen<d.dest.length){if(typeof d.dest.slice==='function')
{return d.dest.slice(0,d.destLen);}
else
{return d.dest.subarray(0,d.destLen);}}
return d.dest;}
tinf_build_fixed_trees(sltree,sdtree);tinf_build_bits_base(length_bits,length_base,4,3);tinf_build_bits_base(dist_bits,dist_base,2,1);length_bits[28]=0;length_base[28]=258;var tinyInflate=tinf_uncompress;function derive(v0,v1,v2,v3,t){return Math.pow(1-t,3)*v0+
3*Math.pow(1-t,2)*t*v1+
3*(1-t)*Math.pow(t,2)*v2+
Math.pow(t,3)*v3;}
function BoundingBox(){this.x1=Number.NaN;this.y1=Number.NaN;this.x2=Number.NaN;this.y2=Number.NaN;}
BoundingBox.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2);};BoundingBox.prototype.addPoint=function(x,y){if(typeof x==='number'){if(isNaN(this.x1)||isNaN(this.x2)){this.x1=x;this.x2=x;}
if(x<this.x1){this.x1=x;}
if(x>this.x2){this.x2=x;}}
if(typeof y==='number'){if(isNaN(this.y1)||isNaN(this.y2)){this.y1=y;this.y2=y;}
if(y<this.y1){this.y1=y;}
if(y>this.y2){this.y2=y;}}};BoundingBox.prototype.addX=function(x){this.addPoint(x,null);};BoundingBox.prototype.addY=function(y){this.addPoint(null,y);};BoundingBox.prototype.addBezier=function(x0,y0,x1,y1,x2,y2,x,y){var this$1=this;var p0=[x0,y0];var p1=[x1,y1];var p2=[x2,y2];var p3=[x,y];this.addPoint(x0,y0);this.addPoint(x,y);for(var i=0;i<=1;i++){var b=6*p0[i]-12*p1[i]+6*p2[i];var a=-3*p0[i]+9*p1[i]-9*p2[i]+3*p3[i];var c=3*p1[i]-3*p0[i];if(a===0){if(b===0){continue;}
var t=-c/b;if(0<t&&t<1){if(i===0){this$1.addX(derive(p0[i],p1[i],p2[i],p3[i],t));}
if(i===1){this$1.addY(derive(p0[i],p1[i],p2[i],p3[i],t));}}
continue;}
var b2ac=Math.pow(b,2)-4*c*a;if(b2ac<0){continue;}
var t1=(-b+Math.sqrt(b2ac))/(2*a);if(0<t1&&t1<1){if(i===0){this$1.addX(derive(p0[i],p1[i],p2[i],p3[i],t1));}
if(i===1){this$1.addY(derive(p0[i],p1[i],p2[i],p3[i],t1));}}
var t2=(-b-Math.sqrt(b2ac))/(2*a);if(0<t2&&t2<1){if(i===0){this$1.addX(derive(p0[i],p1[i],p2[i],p3[i],t2));}
if(i===1){this$1.addY(derive(p0[i],p1[i],p2[i],p3[i],t2));}}}};BoundingBox.prototype.addQuad=function(x0,y0,x1,y1,x,y){var cp1x=x0+2/3*(x1-x0);var cp1y=y0+2/3*(y1-y0);var cp2x=cp1x+1/3*(x-x0);var cp2y=cp1y+1/3*(y-y0);this.addBezier(x0,y0,cp1x,cp1y,cp2x,cp2y,x,y);};function Path(){this.commands=[];this.fill='black';this.stroke=null;this.strokeWidth=1;}
Path.prototype.moveTo=function(x,y){this.commands.push({type:'M',x:x,y:y});};Path.prototype.lineTo=function(x,y){this.commands.push({type:'L',x:x,y:y});};Path.prototype.curveTo=Path.prototype.bezierCurveTo=function(x1,y1,x2,y2,x,y){this.commands.push({type:'C',x1:x1,y1:y1,x2:x2,y2:y2,x:x,y:y});};Path.prototype.quadTo=Path.prototype.quadraticCurveTo=function(x1,y1,x,y){this.commands.push({type:'Q',x1:x1,y1:y1,x:x,y:y});};Path.prototype.close=Path.prototype.closePath=function(){this.commands.push({type:'Z'});};Path.prototype.extend=function(pathOrCommands){if(pathOrCommands.commands){pathOrCommands=pathOrCommands.commands;}else if(pathOrCommands instanceof BoundingBox){var box=pathOrCommands;this.moveTo(box.x1,box.y1);this.lineTo(box.x2,box.y1);this.lineTo(box.x2,box.y2);this.lineTo(box.x1,box.y2);this.close();return;}
Array.prototype.push.apply(this.commands,pathOrCommands);};Path.prototype.getBoundingBox=function(){var this$1=this;var box=new BoundingBox();var startX=0;var startY=0;var prevX=0;var prevY=0;for(var i=0;i<this.commands.length;i++){var cmd=this$1.commands[i];switch(cmd.type){case'M':box.addPoint(cmd.x,cmd.y);startX=prevX=cmd.x;startY=prevY=cmd.y;break;case'L':box.addPoint(cmd.x,cmd.y);prevX=cmd.x;prevY=cmd.y;break;case'Q':box.addQuad(prevX,prevY,cmd.x1,cmd.y1,cmd.x,cmd.y);prevX=cmd.x;prevY=cmd.y;break;case'C':box.addBezier(prevX,prevY,cmd.x1,cmd.y1,cmd.x2,cmd.y2,cmd.x,cmd.y);prevX=cmd.x;prevY=cmd.y;break;case'Z':prevX=startX;prevY=startY;break;default:throw new Error('Unexpected path command '+cmd.type);}}
if(box.isEmpty()){box.addPoint(0,0);}
return box;};Path.prototype.draw=function(ctx){var this$1=this;ctx.beginPath();for(var i=0;i<this.commands.length;i+=1){var cmd=this$1.commands[i];if(cmd.type==='M'){ctx.moveTo(cmd.x,cmd.y);}else if(cmd.type==='L'){ctx.lineTo(cmd.x,cmd.y);}else if(cmd.type==='C'){ctx.bezierCurveTo(cmd.x1,cmd.y1,cmd.x2,cmd.y2,cmd.x,cmd.y);}else if(cmd.type==='Q'){ctx.quadraticCurveTo(cmd.x1,cmd.y1,cmd.x,cmd.y);}else if(cmd.type==='Z'){ctx.closePath();}}
if(this.fill){ctx.fillStyle=this.fill;ctx.fill();}
if(this.stroke){ctx.strokeStyle=this.stroke;ctx.lineWidth=this.strokeWidth;ctx.stroke();}};Path.prototype.toPathData=function(decimalPlaces){var this$1=this;decimalPlaces=decimalPlaces!==undefined?decimalPlaces:2;function floatToString(v){if(Math.round(v)===v){return''+Math.round(v);}else{return v.toFixed(decimalPlaces);}}
function packValues(){var arguments$1=arguments;var s='';for(var i=0;i<arguments.length;i+=1){var v=arguments$1[i];if(v>=0&&i>0){s+=' ';}
s+=floatToString(v);}
return s;}
var d='';for(var i=0;i<this.commands.length;i+=1){var cmd=this$1.commands[i];if(cmd.type==='M'){d+='M'+packValues(cmd.x,cmd.y);}else if(cmd.type==='L'){d+='L'+packValues(cmd.x,cmd.y);}else if(cmd.type==='C'){d+='C'+packValues(cmd.x1,cmd.y1,cmd.x2,cmd.y2,cmd.x,cmd.y);}else if(cmd.type==='Q'){d+='Q'+packValues(cmd.x1,cmd.y1,cmd.x,cmd.y);}else if(cmd.type==='Z'){d+='Z';}}
return d;};Path.prototype.toSVG=function(decimalPlaces){var svg='<path d="';svg+=this.toPathData(decimalPlaces);svg+='"';if(this.fill&&this.fill!=='black'){if(this.fill===null){svg+=' fill="none"';}else{svg+=' fill="'+this.fill+'"';}}
if(this.stroke){svg+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"';}
svg+='/>';return svg;};Path.prototype.toDOMElement=function(decimalPlaces){var temporaryPath=this.toPathData(decimalPlaces);var newPath=document.createElementNS('http://www.w3.org/2000/svg','path');newPath.setAttribute('d',temporaryPath);return newPath;};function fail(message){throw new Error(message);}
function argument(predicate,message){if(!predicate){fail(message);}}
var check={fail:fail,argument:argument,assert:argument};var LIMIT16=32768;var LIMIT32=2147483648;var decode={};var encode={};var sizeOf={};function constant(v){return function(){return v;};}
encode.BYTE=function(v){check.argument(v>=0&&v<=255,'Byte value should be between 0 and 255.');return[v];};sizeOf.BYTE=constant(1);encode.CHAR=function(v){return[v.charCodeAt(0)];};sizeOf.CHAR=constant(1);encode.CHARARRAY=function(v){var b=[];for(var i=0;i<v.length;i+=1){b[i]=v.charCodeAt(i);}
return b;};sizeOf.CHARARRAY=function(v){return v.length;};encode.USHORT=function(v){return[(v>>8)&0xFF,v&0xFF];};sizeOf.USHORT=constant(2);encode.SHORT=function(v){if(v>=LIMIT16){v=-(2*LIMIT16-v);}
return[(v>>8)&0xFF,v&0xFF];};sizeOf.SHORT=constant(2);encode.UINT24=function(v){return[(v>>16)&0xFF,(v>>8)&0xFF,v&0xFF];};sizeOf.UINT24=constant(3);encode.ULONG=function(v){return[(v>>24)&0xFF,(v>>16)&0xFF,(v>>8)&0xFF,v&0xFF];};sizeOf.ULONG=constant(4);encode.LONG=function(v){if(v>=LIMIT32){v=-(2*LIMIT32-v);}
return[(v>>24)&0xFF,(v>>16)&0xFF,(v>>8)&0xFF,v&0xFF];};sizeOf.LONG=constant(4);encode.FIXED=encode.ULONG;sizeOf.FIXED=sizeOf.ULONG;encode.FWORD=encode.SHORT;sizeOf.FWORD=sizeOf.SHORT;encode.UFWORD=encode.USHORT;sizeOf.UFWORD=sizeOf.USHORT;encode.LONGDATETIME=function(v){return[0,0,0,0,(v>>24)&0xFF,(v>>16)&0xFF,(v>>8)&0xFF,v&0xFF];};sizeOf.LONGDATETIME=constant(8);encode.TAG=function(v){check.argument(v.length===4,'Tag should be exactly 4 ASCII characters.');return[v.charCodeAt(0),v.charCodeAt(1),v.charCodeAt(2),v.charCodeAt(3)];};sizeOf.TAG=constant(4);encode.Card8=encode.BYTE;sizeOf.Card8=sizeOf.BYTE;encode.Card16=encode.USHORT;sizeOf.Card16=sizeOf.USHORT;encode.OffSize=encode.BYTE;sizeOf.OffSize=sizeOf.BYTE;encode.SID=encode.USHORT;sizeOf.SID=sizeOf.USHORT;encode.NUMBER=function(v){if(v>=-107&&v<=107){return[v+139];}else if(v>=108&&v<=1131){v=v-108;return[(v>>8)+247,v&0xFF];}else if(v>=-1131&&v<=-108){v=-v-108;return[(v>>8)+251,v&0xFF];}else if(v>=-32768&&v<=32767){return encode.NUMBER16(v);}else{return encode.NUMBER32(v);}};sizeOf.NUMBER=function(v){return encode.NUMBER(v).length;};encode.NUMBER16=function(v){return[28,(v>>8)&0xFF,v&0xFF];};sizeOf.NUMBER16=constant(3);encode.NUMBER32=function(v){return[29,(v>>24)&0xFF,(v>>16)&0xFF,(v>>8)&0xFF,v&0xFF];};sizeOf.NUMBER32=constant(5);encode.REAL=function(v){var value=v.toString();var m=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(value);if(m){var epsilon=parseFloat('1e'+((m[2]?+m[2]:0)+m[1].length));value=(Math.round(v*epsilon)/epsilon).toString();}
var nibbles='';for(var i=0,ii=value.length;i<ii;i+=1){var c=value[i];if(c==='e'){nibbles+=value[++i]==='-'?'c':'b';}else if(c==='.'){nibbles+='a';}else if(c==='-'){nibbles+='e';}else{nibbles+=c;}}
nibbles+=(nibbles.length&1)?'f':'ff';var out=[30];for(var i$1=0,ii$1=nibbles.length;i$1<ii$1;i$1+=2){out.push(parseInt(nibbles.substr(i$1,2),16));}
return out;};sizeOf.REAL=function(v){return encode.REAL(v).length;};encode.NAME=encode.CHARARRAY;sizeOf.NAME=sizeOf.CHARARRAY;encode.STRING=encode.CHARARRAY;sizeOf.STRING=sizeOf.CHARARRAY;decode.UTF8=function(data,offset,numBytes){var codePoints=[];var numChars=numBytes;for(var j=0;j<numChars;j++,offset+=1){codePoints[j]=data.getUint8(offset);}
return String.fromCharCode.apply(null,codePoints);};decode.UTF16=function(data,offset,numBytes){var codePoints=[];var numChars=numBytes/2;for(var j=0;j<numChars;j++,offset+=2){codePoints[j]=data.getUint16(offset);}
return String.fromCharCode.apply(null,codePoints);};encode.UTF16=function(v){var b=[];for(var i=0;i<v.length;i+=1){var codepoint=v.charCodeAt(i);b[b.length]=(codepoint>>8)&0xFF;b[b.length]=codepoint&0xFF;}
return b;};sizeOf.UTF16=function(v){return v.length*2;};var eightBitMacEncodings={'x-mac-croatian':''+'','x-mac-cyrillic':''+'','x-mac-gaelic':''+'','x-mac-greek':''+'\u00AD','x-mac-icelandic':''+'','x-mac-inuit':''+'','x-mac-ce':''+'',macintosh:''+'','x-mac-romanian':''+'','x-mac-turkish':''+''};decode.MACSTRING=function(dataView,offset,dataLength,encoding){var table=eightBitMacEncodings[encoding];if(table===undefined){return undefined;}
var result='';for(var i=0;i<dataLength;i++){var c=dataView.getUint8(offset+i);if(c<=0x7F){result+=String.fromCharCode(c);}else{result+=table[c&0x7F];}}
return result;};var macEncodingTableCache=typeof WeakMap==='function'&&new WeakMap();var macEncodingCacheKeys;var getMacEncodingTable=function(encoding){if(!macEncodingCacheKeys){macEncodingCacheKeys={};for(var e in eightBitMacEncodings){macEncodingCacheKeys[e]=new String(e);}}
var cacheKey=macEncodingCacheKeys[encoding];if(cacheKey===undefined){return undefined;}
if(macEncodingTableCache){var cachedTable=macEncodingTableCache.get(cacheKey);if(cachedTable!==undefined){return cachedTable;}}
var decodingTable=eightBitMacEncodings[encoding];if(decodingTable===undefined){return undefined;}
var encodingTable={};for(var i=0;i<decodingTable.length;i++){encodingTable[decodingTable.charCodeAt(i)]=i+0x80;}
if(macEncodingTableCache){macEncodingTableCache.set(cacheKey,encodingTable);}
return encodingTable;};encode.MACSTRING=function(str,encoding){var table=getMacEncodingTable(encoding);if(table===undefined){return undefined;}
var result=[];for(var i=0;i<str.length;i++){var c=str.charCodeAt(i);if(c>=0x80){c=table[c];if(c===undefined){return undefined;}}
result[i]=c;}
return result;};sizeOf.MACSTRING=function(str,encoding){var b=encode.MACSTRING(str,encoding);if(b!==undefined){return b.length;}else{return 0;}};function isByteEncodable(value){return value>=-128&&value<=127;}
function encodeVarDeltaRunAsZeroes(deltas,pos,result){var runLength=0;var numDeltas=deltas.length;while(pos<numDeltas&&runLength<64&&deltas[pos]===0){++pos;++runLength;}
result.push(0x80|(runLength-1));return pos;}
function encodeVarDeltaRunAsBytes(deltas,offset,result){var runLength=0;var numDeltas=deltas.length;var pos=offset;while(pos<numDeltas&&runLength<64){var value=deltas[pos];if(!isByteEncodable(value)){break;}
if(value===0&&pos+1<numDeltas&&deltas[pos+1]===0){break;}
++pos;++runLength;}
result.push(runLength-1);for(var i=offset;i<pos;++i){result.push((deltas[i]+256)&0xff);}
return pos;}
function encodeVarDeltaRunAsWords(deltas,offset,result){var runLength=0;var numDeltas=deltas.length;var pos=offset;while(pos<numDeltas&&runLength<64){var value=deltas[pos];if(value===0){break;}
if(isByteEncodable(value)&&pos+1<numDeltas&&isByteEncodable(deltas[pos+1])){break;}
++pos;++runLength;}
result.push(0x40|(runLength-1));for(var i=offset;i<pos;++i){var val=deltas[i];result.push(((val+0x10000)>>8)&0xff,(val+0x100)&0xff);}
return pos;}
encode.VARDELTAS=function(deltas){var pos=0;var result=[];while(pos<deltas.length){var value=deltas[pos];if(value===0){pos=encodeVarDeltaRunAsZeroes(deltas,pos,result);}else if(value>=-128&&value<=127){pos=encodeVarDeltaRunAsBytes(deltas,pos,result);}else{pos=encodeVarDeltaRunAsWords(deltas,pos,result);}}
return result;};encode.INDEX=function(l){var offset=1;var offsets=[offset];var data=[];for(var i=0;i<l.length;i+=1){var v=encode.OBJECT(l[i]);Array.prototype.push.apply(data,v);offset+=v.length;offsets.push(offset);}
if(data.length===0){return[0,0];}
var encodedOffsets=[];var offSize=(1+Math.floor(Math.log(offset)/Math.log(2))/8)|0;var offsetEncoder=[undefined,encode.BYTE,encode.USHORT,encode.UINT24,encode.ULONG][offSize];for(var i$1=0;i$1<offsets.length;i$1+=1){var encodedOffset=offsetEncoder(offsets[i$1]);Array.prototype.push.apply(encodedOffsets,encodedOffset);}
return Array.prototype.concat(encode.Card16(l.length),encode.OffSize(offSize),encodedOffsets,data);};sizeOf.INDEX=function(v){return encode.INDEX(v).length;};encode.DICT=function(m){var d=[];var keys=Object.keys(m);var length=keys.length;for(var i=0;i<length;i+=1){var k=parseInt(keys[i],0);var v=m[k];d=d.concat(encode.OPERAND(v.value,v.type));d=d.concat(encode.OPERATOR(k));}
return d;};sizeOf.DICT=function(m){return encode.DICT(m).length;};encode.OPERATOR=function(v){if(v<1200){return[v];}else{return[12,v-1200];}};encode.OPERAND=function(v,type){var d=[];if(Array.isArray(type)){for(var i=0;i<type.length;i+=1){check.argument(v.length===type.length,'Not enough arguments given for type'+type);d=d.concat(encode.OPERAND(v[i],type[i]));}}else{if(type==='SID'){d=d.concat(encode.NUMBER(v));}else if(type==='offset'){d=d.concat(encode.NUMBER32(v));}else if(type==='number'){d=d.concat(encode.NUMBER(v));}else if(type==='real'){d=d.concat(encode.REAL(v));}else{throw new Error('Unknown operand type '+type);}}
return d;};encode.OP=encode.BYTE;sizeOf.OP=sizeOf.BYTE;var wmm=typeof WeakMap==='function'&&new WeakMap();encode.CHARSTRING=function(ops){if(wmm){var cachedValue=wmm.get(ops);if(cachedValue!==undefined){return cachedValue;}}
var d=[];var length=ops.length;for(var i=0;i<length;i+=1){var op=ops[i];d=d.concat(encode[op.type](op.value));}
if(wmm){wmm.set(ops,d);}
return d;};sizeOf.CHARSTRING=function(ops){return encode.CHARSTRING(ops).length;};encode.OBJECT=function(v){var encodingFunction=encode[v.type];check.argument(encodingFunction!==undefined,'No encoding function for type '+v.type);return encodingFunction(v.value);};sizeOf.OBJECT=function(v){var sizeOfFunction=sizeOf[v.type];check.argument(sizeOfFunction!==undefined,'No sizeOf function for type '+v.type);return sizeOfFunction(v.value);};encode.TABLE=function(table){var d=[];var length=table.fields.length;var subtables=[];var subtableOffsets=[];for(var i=0;i<length;i+=1){var field=table.fields[i];var encodingFunction=encode[field.type];check.argument(encodingFunction!==undefined,'No encoding function for field type '+field.type+' ('+field.name+')');var value=table[field.name];if(value===undefined){value=field.value;}
var bytes=encodingFunction(value);if(field.type==='TABLE'){subtableOffsets.push(d.length);d=d.concat([0,0]);subtables.push(bytes);}else{d=d.concat(bytes);}}
for(var i$1=0;i$1<subtables.length;i$1+=1){var o=subtableOffsets[i$1];var offset=d.length;check.argument(offset<65536,'Table '+table.tableName+' too big.');d[o]=offset>>8;d[o+1]=offset&0xff;d=d.concat(subtables[i$1]);}
return d;};sizeOf.TABLE=function(table){var numBytes=0;var length=table.fields.length;for(var i=0;i<length;i+=1){var field=table.fields[i];var sizeOfFunction=sizeOf[field.type];check.argument(sizeOfFunction!==undefined,'No sizeOf function for field type '+field.type+' ('+field.name+')');var value=table[field.name];if(value===undefined){value=field.value;}
numBytes+=sizeOfFunction(value);if(field.type==='TABLE'){numBytes+=2;}}
return numBytes;};encode.RECORD=encode.TABLE;sizeOf.RECORD=sizeOf.TABLE;encode.LITERAL=function(v){return v;};sizeOf.LITERAL=function(v){return v.length;};function Table(tableName,fields,options){var this$1=this;for(var i=0;i<fields.length;i+=1){var field=fields[i];this$1[field.name]=field.value;}
this.tableName=tableName;this.fields=fields;if(options){var optionKeys=Object.keys(options);for(var i$1=0;i$1<optionKeys.length;i$1+=1){var k=optionKeys[i$1];var v=options[k];if(this$1[k]!==undefined){this$1[k]=v;}}}}
Table.prototype.encode=function(){return encode.TABLE(this);};Table.prototype.sizeOf=function(){return sizeOf.TABLE(this);};function ushortList(itemName,list,count){if(count===undefined){count=list.length;}
var fields=new Array(list.length+1);fields[0]={name:itemName+'Count',type:'USHORT',value:count};for(var i=0;i<list.length;i++){fields[i+1]={name:itemName+i,type:'USHORT',value:list[i]};}
return fields;}
function tableList(itemName,records,itemCallback){var count=records.length;var fields=new Array(count+1);fields[0]={name:itemName+'Count',type:'USHORT',value:count};for(var i=0;i<count;i++){fields[i+1]={name:itemName+i,type:'TABLE',value:itemCallback(records[i],i)};}
return fields;}
function recordList(itemName,records,itemCallback){var count=records.length;var fields=[];fields[0]={name:itemName+'Count',type:'USHORT',value:count};for(var i=0;i<count;i++){fields=fields.concat(itemCallback(records[i],i));}
return fields;}
function Coverage(coverageTable){if(coverageTable.format===1){Table.call(this,'coverageTable',[{name:'coverageFormat',type:'USHORT',value:1}].concat(ushortList('glyph',coverageTable.glyphs)));}else{check.assert(false,'Can\'t create coverage table format 2 yet.');}}
Coverage.prototype=Object.create(Table.prototype);Coverage.prototype.constructor=Coverage;function ScriptList(scriptListTable){Table.call(this,'scriptListTable',recordList('scriptRecord',scriptListTable,function(scriptRecord,i){var script=scriptRecord.script;var defaultLangSys=script.defaultLangSys;check.assert(!!defaultLangSys,'Unable to write GSUB: script '+scriptRecord.tag+' has no default language system.');return[{name:'scriptTag'+i,type:'TAG',value:scriptRecord.tag},{name:'script'+i,type:'TABLE',value:new Table('scriptTable',[{name:'defaultLangSys',type:'TABLE',value:new Table('defaultLangSys',[{name:'lookupOrder',type:'USHORT',value:0},{name:'reqFeatureIndex',type:'USHORT',value:defaultLangSys.reqFeatureIndex}].concat(ushortList('featureIndex',defaultLangSys.featureIndexes)))}].concat(recordList('langSys',script.langSysRecords,function(langSysRecord,i){var langSys=langSysRecord.langSys;return[{name:'langSysTag'+i,type:'TAG',value:langSysRecord.tag},{name:'langSys'+i,type:'TABLE',value:new Table('langSys',[{name:'lookupOrder',type:'USHORT',value:0},{name:'reqFeatureIndex',type:'USHORT',value:langSys.reqFeatureIndex}].concat(ushortList('featureIndex',langSys.featureIndexes)))}];})))}];}));}
ScriptList.prototype=Object.create(Table.prototype);ScriptList.prototype.constructor=ScriptList;function FeatureList(featureListTable){Table.call(this,'featureListTable',recordList('featureRecord',featureListTable,function(featureRecord,i){var feature=featureRecord.feature;return[{name:'featureTag'+i,type:'TAG',value:featureRecord.tag},{name:'feature'+i,type:'TABLE',value:new Table('featureTable',[{name:'featureParams',type:'USHORT',value:feature.featureParams}].concat(ushortList('lookupListIndex',feature.lookupListIndexes)))}];}));}
FeatureList.prototype=Object.create(Table.prototype);FeatureList.prototype.constructor=FeatureList;function LookupList(lookupListTable,subtableMakers){Table.call(this,'lookupListTable',tableList('lookup',lookupListTable,function(lookupTable){var subtableCallback=subtableMakers[lookupTable.lookupType];check.assert(!!subtableCallback,'Unable to write GSUB lookup type '+lookupTable.lookupType+' tables.');return new Table('lookupTable',[{name:'lookupType',type:'USHORT',value:lookupTable.lookupType},{name:'lookupFlag',type:'USHORT',value:lookupTable.lookupFlag}].concat(tableList('subtable',lookupTable.subtables,subtableCallback)));}));}
LookupList.prototype=Object.create(Table.prototype);LookupList.prototype.constructor=LookupList;var table={Table:Table,Record:Table,Coverage:Coverage,ScriptList:ScriptList,FeatureList:FeatureList,LookupList:LookupList,ushortList:ushortList,tableList:tableList,recordList:recordList,};function getByte(dataView,offset){return dataView.getUint8(offset);}
function getUShort(dataView,offset){return dataView.getUint16(offset,false);}
function getShort(dataView,offset){return dataView.getInt16(offset,false);}
function getULong(dataView,offset){return dataView.getUint32(offset,false);}
function getFixed(dataView,offset){var decimal=dataView.getInt16(offset,false);var fraction=dataView.getUint16(offset+2,false);return decimal+fraction/65535;}
function getTag(dataView,offset){var tag='';for(var i=offset;i<offset+4;i+=1){tag+=String.fromCharCode(dataView.getInt8(i));}
return tag;}
function getOffset(dataView,offset,offSize){var v=0;for(var i=0;i<offSize;i+=1){v<<=8;v+=dataView.getUint8(offset+i);}
return v;}
function getBytes(dataView,startOffset,endOffset){var bytes=[];for(var i=startOffset;i<endOffset;i+=1){bytes.push(dataView.getUint8(i));}
return bytes;}
function bytesToString(bytes){var s='';for(var i=0;i<bytes.length;i+=1){s+=String.fromCharCode(bytes[i]);}
return s;}
var typeOffsets={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function Parser(data,offset){this.data=data;this.offset=offset;this.relativeOffset=0;}
Parser.prototype.parseByte=function(){var v=this.data.getUint8(this.offset+this.relativeOffset);this.relativeOffset+=1;return v;};Parser.prototype.parseChar=function(){var v=this.data.getInt8(this.offset+this.relativeOffset);this.relativeOffset+=1;return v;};Parser.prototype.parseCard8=Parser.prototype.parseByte;Parser.prototype.parseUShort=function(){var v=this.data.getUint16(this.offset+this.relativeOffset);this.relativeOffset+=2;return v;};Parser.prototype.parseCard16=Parser.prototype.parseUShort;Parser.prototype.parseSID=Parser.prototype.parseUShort;Parser.prototype.parseOffset16=Parser.prototype.parseUShort;Parser.prototype.parseShort=function(){var v=this.data.getInt16(this.offset+this.relativeOffset);this.relativeOffset+=2;return v;};Parser.prototype.parseF2Dot14=function(){var v=this.data.getInt16(this.offset+this.relativeOffset)/16384;this.relativeOffset+=2;return v;};Parser.prototype.parseULong=function(){var v=getULong(this.data,this.offset+this.relativeOffset);this.relativeOffset+=4;return v;};Parser.prototype.parseOffset32=Parser.prototype.parseULong;Parser.prototype.parseFixed=function(){var v=getFixed(this.data,this.offset+this.relativeOffset);this.relativeOffset+=4;return v;};Parser.prototype.parseString=function(length){var dataView=this.data;var offset=this.offset+this.relativeOffset;var string='';this.relativeOffset+=length;for(var i=0;i<length;i++){string+=String.fromCharCode(dataView.getUint8(offset+i));}
return string;};Parser.prototype.parseTag=function(){return this.parseString(4);};Parser.prototype.parseLongDateTime=function(){var v=getULong(this.data,this.offset+this.relativeOffset+4);v-=2082844800;this.relativeOffset+=8;return v;};Parser.prototype.parseVersion=function(minorBase){var major=getUShort(this.data,this.offset+this.relativeOffset);var minor=getUShort(this.data,this.offset+this.relativeOffset+2);this.relativeOffset+=4;if(minorBase===undefined){minorBase=0x1000;}
return major+minor/minorBase/10;};Parser.prototype.skip=function(type,amount){if(amount===undefined){amount=1;}
this.relativeOffset+=typeOffsets[type]*amount;};Parser.prototype.parseULongList=function(count){if(count===undefined){count=this.parseULong();}
var offsets=new Array(count);var dataView=this.data;var offset=this.offset+this.relativeOffset;for(var i=0;i<count;i++){offsets[i]=dataView.getUint32(offset);offset+=4;}
this.relativeOffset+=count*4;return offsets;};Parser.prototype.parseOffset16List=Parser.prototype.parseUShortList=function(count){if(count===undefined){count=this.parseUShort();}
var offsets=new Array(count);var dataView=this.data;var offset=this.offset+this.relativeOffset;for(var i=0;i<count;i++){offsets[i]=dataView.getUint16(offset);offset+=2;}
this.relativeOffset+=count*2;return offsets;};Parser.prototype.parseShortList=function(count){var list=new Array(count);var dataView=this.data;var offset=this.offset+this.relativeOffset;for(var i=0;i<count;i++){list[i]=dataView.getInt16(offset);offset+=2;}
this.relativeOffset+=count*2;return list;};Parser.prototype.parseByteList=function(count){var list=new Array(count);var dataView=this.data;var offset=this.offset+this.relativeOffset;for(var i=0;i<count;i++){list[i]=dataView.getUint8(offset++);}
this.relativeOffset+=count;return list;};Parser.prototype.parseList=function(count,itemCallback){var this$1=this;if(!itemCallback){itemCallback=count;count=this.parseUShort();}
var list=new Array(count);for(var i=0;i<count;i++){list[i]=itemCallback.call(this$1);}
return list;};Parser.prototype.parseList32=function(count,itemCallback){var this$1=this;if(!itemCallback){itemCallback=count;count=this.parseULong();}
var list=new Array(count);for(var i=0;i<count;i++){list[i]=itemCallback.call(this$1);}
return list;};Parser.prototype.parseRecordList=function(count,recordDescription){var this$1=this;if(!recordDescription){recordDescription=count;count=this.parseUShort();}
var records=new Array(count);var fields=Object.keys(recordDescription);for(var i=0;i<count;i++){var rec={};for(var j=0;j<fields.length;j++){var fieldName=fields[j];var fieldType=recordDescription[fieldName];rec[fieldName]=fieldType.call(this$1);}
records[i]=rec;}
return records;};Parser.prototype.parseRecordList32=function(count,recordDescription){var this$1=this;if(!recordDescription){recordDescription=count;count=this.parseULong();}
var records=new Array(count);var fields=Object.keys(recordDescription);for(var i=0;i<count;i++){var rec={};for(var j=0;j<fields.length;j++){var fieldName=fields[j];var fieldType=recordDescription[fieldName];rec[fieldName]=fieldType.call(this$1);}
records[i]=rec;}
return records;};Parser.prototype.parseStruct=function(description){var this$1=this;if(typeof description==='function'){return description.call(this);}else{var fields=Object.keys(description);var struct={};for(var j=0;j<fields.length;j++){var fieldName=fields[j];var fieldType=description[fieldName];struct[fieldName]=fieldType.call(this$1);}
return struct;}};Parser.prototype.parsePointer=function(description){var structOffset=this.parseOffset16();if(structOffset>0){return new Parser(this.data,this.offset+structOffset).parseStruct(description);}
return undefined;};Parser.prototype.parsePointer32=function(description){var structOffset=this.parseOffset32();if(structOffset>0){return new Parser(this.data,this.offset+structOffset).parseStruct(description);}
return undefined;};Parser.prototype.parseListOfLists=function(itemCallback){var this$1=this;var offsets=this.parseOffset16List();var count=offsets.length;var relativeOffset=this.relativeOffset;var list=new Array(count);for(var i=0;i<count;i++){var start=offsets[i];if(start===0){list[i]=undefined;continue;}
this$1.relativeOffset=start;if(itemCallback){var subOffsets=this$1.parseOffset16List();var subList=new Array(subOffsets.length);for(var j=0;j<subOffsets.length;j++){this$1.relativeOffset=start+subOffsets[j];subList[j]=itemCallback.call(this$1);}
list[i]=subList;}else{list[i]=this$1.parseUShortList();}}
this.relativeOffset=relativeOffset;return list;};Parser.prototype.parseCoverage=function(){var this$1=this;var startOffset=this.offset+this.relativeOffset;var format=this.parseUShort();var count=this.parseUShort();if(format===1){return{format:1,glyphs:this.parseUShortList(count)};}else if(format===2){var ranges=new Array(count);for(var i=0;i<count;i++){ranges[i]={start:this$1.parseUShort(),end:this$1.parseUShort(),index:this$1.parseUShort()};}
return{format:2,ranges:ranges};}
throw new Error('0x'+startOffset.toString(16)+': Coverage format must be 1 or 2.');};Parser.prototype.parseClassDef=function(){var startOffset=this.offset+this.relativeOffset;var format=this.parseUShort();if(format===1){return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};}else if(format===2){return{format:2,ranges:this.parseRecordList({start:Parser.uShort,end:Parser.uShort,classId:Parser.uShort})};}
throw new Error('0x'+startOffset.toString(16)+': ClassDef format must be 1 or 2.');};Parser.list=function(count,itemCallback){return function(){return this.parseList(count,itemCallback);};};Parser.list32=function(count,itemCallback){return function(){return this.parseList32(count,itemCallback);};};Parser.recordList=function(count,recordDescription){return function(){return this.parseRecordList(count,recordDescription);};};Parser.recordList32=function(count,recordDescription){return function(){return this.parseRecordList32(count,recordDescription);};};Parser.pointer=function(description){return function(){return this.parsePointer(description);};};Parser.pointer32=function(description){return function(){return this.parsePointer32(description);};};Parser.tag=Parser.prototype.parseTag;Parser.byte=Parser.prototype.parseByte;Parser.uShort=Parser.offset16=Parser.prototype.parseUShort;Parser.uShortList=Parser.prototype.parseUShortList;Parser.uLong=Parser.offset32=Parser.prototype.parseULong;Parser.uLongList=Parser.prototype.parseULongList;Parser.struct=Parser.prototype.parseStruct;Parser.coverage=Parser.prototype.parseCoverage;Parser.classDef=Parser.prototype.parseClassDef;var langSysTable={reserved:Parser.uShort,reqFeatureIndex:Parser.uShort,featureIndexes:Parser.uShortList};Parser.prototype.parseScriptList=function(){return this.parsePointer(Parser.recordList({tag:Parser.tag,script:Parser.pointer({defaultLangSys:Parser.pointer(langSysTable),langSysRecords:Parser.recordList({tag:Parser.tag,langSys:Parser.pointer(langSysTable)})})}))||[];};Parser.prototype.parseFeatureList=function(){return this.parsePointer(Parser.recordList({tag:Parser.tag,feature:Parser.pointer({featureParams:Parser.offset16,lookupListIndexes:Parser.uShortList})}))||[];};Parser.prototype.parseLookupList=function(lookupTableParsers){return this.parsePointer(Parser.list(Parser.pointer(function(){var lookupType=this.parseUShort();check.argument(1<=lookupType&&lookupType<=8,'GSUB lookup type '+lookupType+' unknown.');var lookupFlag=this.parseUShort();var useMarkFilteringSet=lookupFlag&0x10;return{lookupType:lookupType,lookupFlag:lookupFlag,subtables:this.parseList(Parser.pointer(lookupTableParsers[lookupType])),markFilteringSet:useMarkFilteringSet?this.parseUShort():undefined};})))||[];};Parser.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var majorVersion=this.parseUShort();var minorVersion=this.parseUShort();check.argument(majorVersion===1&&minorVersion<1,'GSUB feature variations table unknown.');var featureVariations=this.parseRecordList32({conditionSetOffset:Parser.offset32,featureTableSubstitutionOffset:Parser.offset32});return featureVariations;})||[];};var parse={getByte:getByte,getCard8:getByte,getUShort:getUShort,getCard16:getUShort,getShort:getShort,getULong:getULong,getFixed:getFixed,getTag:getTag,getOffset:getOffset,getBytes:getBytes,bytesToString:bytesToString,Parser:Parser,};function parseCmapTableFormat12(cmap,p){p.parseUShort();cmap.length=p.parseULong();cmap.language=p.parseULong();var groupCount;cmap.groupCount=groupCount=p.parseULong();cmap.glyphIndexMap={};for(var i=0;i<groupCount;i+=1){var startCharCode=p.parseULong();var endCharCode=p.parseULong();var startGlyphId=p.parseULong();for(var c=startCharCode;c<=endCharCode;c+=1){cmap.glyphIndexMap[c]=startGlyphId;startGlyphId++;}}}
function parseCmapTableFormat4(cmap,p,data,start,offset){cmap.length=p.parseUShort();cmap.language=p.parseUShort();var segCount;cmap.segCount=segCount=p.parseUShort()>>1;p.skip('uShort',3);cmap.glyphIndexMap={};var endCountParser=new parse.Parser(data,start+offset+14);var startCountParser=new parse.Parser(data,start+offset+16+segCount*2);var idDeltaParser=new parse.Parser(data,start+offset+16+segCount*4);var idRangeOffsetParser=new parse.Parser(data,start+offset+16+segCount*6);var glyphIndexOffset=start+offset+16+segCount*8;for(var i=0;i<segCount-1;i+=1){var glyphIndex=(void 0);var endCount=endCountParser.parseUShort();var startCount=startCountParser.parseUShort();var idDelta=idDeltaParser.parseShort();var idRangeOffset=idRangeOffsetParser.parseUShort();for(var c=startCount;c<=endCount;c+=1){if(idRangeOffset!==0){glyphIndexOffset=(idRangeOffsetParser.offset+idRangeOffsetParser.relativeOffset-2);glyphIndexOffset+=idRangeOffset;glyphIndexOffset+=(c-startCount)*2;glyphIndex=parse.getUShort(data,glyphIndexOffset);if(glyphIndex!==0){glyphIndex=(glyphIndex+idDelta)&0xFFFF;}}else{glyphIndex=(c+idDelta)&0xFFFF;}
cmap.glyphIndexMap[c]=glyphIndex;}}}
function parseCmapTable(data,start){var cmap={};cmap.version=parse.getUShort(data,start);check.argument(cmap.version===0,'cmap table version should be 0.');cmap.numTables=parse.getUShort(data,start+2);var offset=-1;for(var i=cmap.numTables-1;i>=0;i-=1){var platformId=parse.getUShort(data,start+4+(i*8));var encodingId=parse.getUShort(data,start+4+(i*8)+2);if(platformId===3&&(encodingId===0||encodingId===1||encodingId===10)){offset=parse.getULong(data,start+4+(i*8)+4);break;}}
if(offset===-1){throw new Error('No valid cmap sub-tables found.');}
var p=new parse.Parser(data,start+offset);cmap.format=p.parseUShort();if(cmap.format===12){parseCmapTableFormat12(cmap,p);}else if(cmap.format===4){parseCmapTableFormat4(cmap,p,data,start,offset);}else{throw new Error('Only format 4 and 12 cmap tables are supported (found format '+cmap.format+').');}
return cmap;}
function addSegment(t,code,glyphIndex){t.segments.push({end:code,start:code,delta:-(code-glyphIndex),offset:0,glyphIndex:glyphIndex});}
function addTerminatorSegment(t){t.segments.push({end:0xFFFF,start:0xFFFF,delta:1,offset:0});}
function makeCmapTable(glyphs){var isPlan0Only=true;var i;for(i=glyphs.length-1;i>0;i-=1){var g=glyphs.get(i);if(g.unicode>65535){console.log('Adding CMAP format 12 (needed!)');isPlan0Only=false;break;}}
var cmapTable=[{name:'version',type:'USHORT',value:0},{name:'numTables',type:'USHORT',value:isPlan0Only?1:2},{name:'platformID',type:'USHORT',value:3},{name:'encodingID',type:'USHORT',value:1},{name:'offset',type:'ULONG',value:isPlan0Only?12:(12+8)}];if(!isPlan0Only)
{cmapTable=cmapTable.concat([{name:'cmap12PlatformID',type:'USHORT',value:3},{name:'cmap12EncodingID',type:'USHORT',value:10},{name:'cmap12Offset',type:'ULONG',value:0}]);}
cmapTable=cmapTable.concat([{name:'format',type:'USHORT',value:4},{name:'cmap4Length',type:'USHORT',value:0},{name:'language',type:'USHORT',value:0},{name:'segCountX2',type:'USHORT',value:0},{name:'searchRange',type:'USHORT',value:0},{name:'entrySelector',type:'USHORT',value:0},{name:'rangeShift',type:'USHORT',value:0}]);var t=new table.Table('cmap',cmapTable);t.segments=[];for(i=0;i<glyphs.length;i+=1){var glyph=glyphs.get(i);for(var j=0;j<glyph.unicodes.length;j+=1){addSegment(t,glyph.unicodes[j],i);}
t.segments=t.segments.sort(function(a,b){return a.start-b.start;});}
addTerminatorSegment(t);var segCount=t.segments.length;var segCountToRemove=0;var endCounts=[];var startCounts=[];var idDeltas=[];var idRangeOffsets=[];var glyphIds=[];var cmap12Groups=[];for(i=0;i<segCount;i+=1){var segment=t.segments[i];if(segment.end<=65535&&segment.start<=65535){endCounts=endCounts.concat({name:'end_'+i,type:'USHORT',value:segment.end});startCounts=startCounts.concat({name:'start_'+i,type:'USHORT',value:segment.start});idDeltas=idDeltas.concat({name:'idDelta_'+i,type:'SHORT',value:segment.delta});idRangeOffsets=idRangeOffsets.concat({name:'idRangeOffset_'+i,type:'USHORT',value:segment.offset});if(segment.glyphId!==undefined){glyphIds=glyphIds.concat({name:'glyph_'+i,type:'USHORT',value:segment.glyphId});}}else{segCountToRemove+=1;}
if(!isPlan0Only&&segment.glyphIndex!==undefined){cmap12Groups=cmap12Groups.concat({name:'cmap12Start_'+i,type:'ULONG',value:segment.start});cmap12Groups=cmap12Groups.concat({name:'cmap12End_'+i,type:'ULONG',value:segment.end});cmap12Groups=cmap12Groups.concat({name:'cmap12Glyph_'+i,type:'ULONG',value:segment.glyphIndex});}}
t.segCountX2=(segCount-segCountToRemove)*2;t.searchRange=Math.pow(2,Math.floor(Math.log((segCount-segCountToRemove))/Math.log(2)))*2;t.entrySelector=Math.log(t.searchRange/2)/Math.log(2);t.rangeShift=t.segCountX2-t.searchRange;t.fields=t.fields.concat(endCounts);t.fields.push({name:'reservedPad',type:'USHORT',value:0});t.fields=t.fields.concat(startCounts);t.fields=t.fields.concat(idDeltas);t.fields=t.fields.concat(idRangeOffsets);t.fields=t.fields.concat(glyphIds);t.cmap4Length=14+
endCounts.length*2+
2+
startCounts.length*2+
idDeltas.length*2+
idRangeOffsets.length*2+
glyphIds.length*2;if(!isPlan0Only){var cmap12Length=16+
cmap12Groups.length*4;t.cmap12Offset=12+(2*2)+4+t.cmap4Length;t.fields=t.fields.concat([{name:'cmap12Format',type:'USHORT',value:12},{name:'cmap12Reserved',type:'USHORT',value:0},{name:'cmap12Length',type:'ULONG',value:cmap12Length},{name:'cmap12Language',type:'ULONG',value:0},{name:'cmap12nGroups',type:'ULONG',value:cmap12Groups.length/3}]);t.fields=t.fields.concat(cmap12Groups);}
return t;}
var cmap={parse:parseCmapTable,make:makeCmapTable};var cffStandardStrings=['.notdef','space','exclam','quotedbl','numbersign','dollar','percent','ampersand','quoteright','parenleft','parenright','asterisk','plus','comma','hyphen','period','slash','zero','one','two','three','four','five','six','seven','eight','nine','colon','semicolon','less','equal','greater','question','at','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z','bracketleft','backslash','bracketright','asciicircum','underscore','quoteleft','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z','braceleft','bar','braceright','asciitilde','exclamdown','cent','sterling','fraction','yen','florin','section','currency','quotesingle','quotedblleft','guillemotleft','guilsinglleft','guilsinglright','fi','fl','endash','dagger','daggerdbl','periodcentered','paragraph','bullet','quotesinglbase','quotedblbase','quotedblright','guillemotright','ellipsis','perthousand','questiondown','grave','acute','circumflex','tilde','macron','breve','dotaccent','dieresis','ring','cedilla','hungarumlaut','ogonek','caron','emdash','AE','ordfeminine','Lslash','Oslash','OE','ordmasculine','ae','dotlessi','lslash','oslash','oe','germandbls','onesuperior','logicalnot','mu','trademark','Eth','onehalf','plusminus','Thorn','onequarter','divide','brokenbar','degree','thorn','threequarters','twosuperior','registered','minus','eth','multiply','threesuperior','copyright','Aacute','Acircumflex','Adieresis','Agrave','Aring','Atilde','Ccedilla','Eacute','Ecircumflex','Edieresis','Egrave','Iacute','Icircumflex','Idieresis','Igrave','Ntilde','Oacute','Ocircumflex','Odieresis','Ograve','Otilde','Scaron','Uacute','Ucircumflex','Udieresis','Ugrave','Yacute','Ydieresis','Zcaron','aacute','acircumflex','adieresis','agrave','aring','atilde','ccedilla','eacute','ecircumflex','edieresis','egrave','iacute','icircumflex','idieresis','igrave','ntilde','oacute','ocircumflex','odieresis','ograve','otilde','scaron','uacute','ucircumflex','udieresis','ugrave','yacute','ydieresis','zcaron','exclamsmall','Hungarumlautsmall','dollaroldstyle','dollarsuperior','ampersandsmall','Acutesmall','parenleftsuperior','parenrightsuperior','266 ff','onedotenleader','zerooldstyle','oneoldstyle','twooldstyle','threeoldstyle','fouroldstyle','fiveoldstyle','sixoldstyle','sevenoldstyle','eightoldstyle','nineoldstyle','commasuperior','threequartersemdash','periodsuperior','questionsmall','asuperior','bsuperior','centsuperior','dsuperior','esuperior','isuperior','lsuperior','msuperior','nsuperior','osuperior','rsuperior','ssuperior','tsuperior','ff','ffi','ffl','parenleftinferior','parenrightinferior','Circumflexsmall','hyphensuperior','Gravesmall','Asmall','Bsmall','Csmall','Dsmall','Esmall','Fsmall','Gsmall','Hsmall','Ismall','Jsmall','Ksmall','Lsmall','Msmall','Nsmall','Osmall','Psmall','Qsmall','Rsmall','Ssmall','Tsmall','Usmall','Vsmall','Wsmall','Xsmall','Ysmall','Zsmall','colonmonetary','onefitted','rupiah','Tildesmall','exclamdownsmall','centoldstyle','Lslashsmall','Scaronsmall','Zcaronsmall','Dieresissmall','Brevesmall','Caronsmall','Dotaccentsmall','Macronsmall','figuredash','hypheninferior','Ogoneksmall','Ringsmall','Cedillasmall','questiondownsmall','oneeighth','threeeighths','fiveeighths','seveneighths','onethird','twothirds','zerosuperior','foursuperior','fivesuperior','sixsuperior','sevensuperior','eightsuperior','ninesuperior','zeroinferior','oneinferior','twoinferior','threeinferior','fourinferior','fiveinferior','sixinferior','seveninferior','eightinferior','nineinferior','centinferior','dollarinferior','periodinferior','commainferior','Agravesmall','Aacutesmall','Acircumflexsmall','Atildesmall','Adieresissmall','Aringsmall','AEsmall','Ccedillasmall','Egravesmall','Eacutesmall','Ecircumflexsmall','Edieresissmall','Igravesmall','Iacutesmall','Icircumflexsmall','Idieresissmall','Ethsmall','Ntildesmall','Ogravesmall','Oacutesmall','Ocircumflexsmall','Otildesmall','Odieresissmall','OEsmall','Oslashsmall','Ugravesmall','Uacutesmall','Ucircumflexsmall','Udieresissmall','Yacutesmall','Thornsmall','Ydieresissmall','001.000','001.001','001.002','001.003','Black','Bold','Book','Light','Medium','Regular','Roman','Semibold'];var cffStandardEncoding=['','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','space','exclam','quotedbl','numbersign','dollar','percent','ampersand','quoteright','parenleft','parenright','asterisk','plus','comma','hyphen','period','slash','zero','one','two','three','four','five','six','seven','eight','nine','colon','semicolon','less','equal','greater','question','at','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z','bracketleft','backslash','bracketright','asciicircum','underscore','quoteleft','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z','braceleft','bar','braceright','asciitilde','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','exclamdown','cent','sterling','fraction','yen','florin','section','currency','quotesingle','quotedblleft','guillemotleft','guilsinglleft','guilsinglright','fi','fl','','endash','dagger','daggerdbl','periodcentered','','paragraph','bullet','quotesinglbase','quotedblbase','quotedblright','guillemotright','ellipsis','perthousand','','questiondown','','grave','acute','circumflex','tilde','macron','breve','dotaccent','dieresis','','ring','cedilla','','hungarumlaut','ogonek','caron','emdash','','','','','','','','','','','','','','','','','AE','','ordfeminine','','','','','Lslash','Oslash','OE','ordmasculine','','','','','','ae','','','','dotlessi','','','lslash','oslash','oe','germandbls'];var cffExpertEncoding=['','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','space','exclamsmall','Hungarumlautsmall','','dollaroldstyle','dollarsuperior','ampersandsmall','Acutesmall','parenleftsuperior','parenrightsuperior','twodotenleader','onedotenleader','comma','hyphen','period','fraction','zerooldstyle','oneoldstyle','twooldstyle','threeoldstyle','fouroldstyle','fiveoldstyle','sixoldstyle','sevenoldstyle','eightoldstyle','nineoldstyle','colon','semicolon','commasuperior','threequartersemdash','periodsuperior','questionsmall','','asuperior','bsuperior','centsuperior','dsuperior','esuperior','','','isuperior','','','lsuperior','msuperior','nsuperior','osuperior','','','rsuperior','ssuperior','tsuperior','','ff','fi','fl','ffi','ffl','parenleftinferior','','parenrightinferior','Circumflexsmall','hyphensuperior','Gravesmall','Asmall','Bsmall','Csmall','Dsmall','Esmall','Fsmall','Gsmall','Hsmall','Ismall','Jsmall','Ksmall','Lsmall','Msmall','Nsmall','Osmall','Psmall','Qsmall','Rsmall','Ssmall','Tsmall','Usmall','Vsmall','Wsmall','Xsmall','Ysmall','Zsmall','colonmonetary','onefitted','rupiah','Tildesmall','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','exclamdownsmall','centoldstyle','Lslashsmall','','','Scaronsmall','Zcaronsmall','Dieresissmall','Brevesmall','Caronsmall','','Dotaccentsmall','','','Macronsmall','','','figuredash','hypheninferior','','','Ogoneksmall','Ringsmall','Cedillasmall','','','','onequarter','onehalf','threequarters','questiondownsmall','oneeighth','threeeighths','fiveeighths','seveneighths','onethird','twothirds','','','zerosuperior','onesuperior','twosuperior','threesuperior','foursuperior','fivesuperior','sixsuperior','sevensuperior','eightsuperior','ninesuperior','zeroinferior','oneinferior','twoinferior','threeinferior','fourinferior','fiveinferior','sixinferior','seveninferior','eightinferior','nineinferior','centinferior','dollarinferior','periodinferior','commainferior','Agravesmall','Aacutesmall','Acircumflexsmall','Atildesmall','Adieresissmall','Aringsmall','AEsmall','Ccedillasmall','Egravesmall','Eacutesmall','Ecircumflexsmall','Edieresissmall','Igravesmall','Iacutesmall','Icircumflexsmall','Idieresissmall','Ethsmall','Ntildesmall','Ogravesmall','Oacutesmall','Ocircumflexsmall','Otildesmall','Odieresissmall','OEsmall','Oslashsmall','Ugravesmall','Uacutesmall','Ucircumflexsmall','Udieresissmall','Yacutesmall','Thornsmall','Ydieresissmall'];var standardNames=['.notdef','.null','nonmarkingreturn','space','exclam','quotedbl','numbersign','dollar','percent','ampersand','quotesingle','parenleft','parenright','asterisk','plus','comma','hyphen','period','slash','zero','one','two','three','four','five','six','seven','eight','nine','colon','semicolon','less','equal','greater','question','at','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z','bracketleft','backslash','bracketright','asciicircum','underscore','grave','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z','braceleft','bar','braceright','asciitilde','Adieresis','Aring','Ccedilla','Eacute','Ntilde','Odieresis','Udieresis','aacute','agrave','acircumflex','adieresis','atilde','aring','ccedilla','eacute','egrave','ecircumflex','edieresis','iacute','igrave','icircumflex','idieresis','ntilde','oacute','ograve','ocircumflex','odieresis','otilde','uacute','ugrave','ucircumflex','udieresis','dagger','degree','cent','sterling','section','bullet','paragraph','germandbls','registered','copyright','trademark','acute','dieresis','notequal','AE','Oslash','infinity','plusminus','lessequal','greaterequal','yen','mu','partialdiff','summation','product','pi','integral','ordfeminine','ordmasculine','Omega','ae','oslash','questiondown','exclamdown','logicalnot','radical','florin','approxequal','Delta','guillemotleft','guillemotright','ellipsis','nonbreakingspace','Agrave','Atilde','Otilde','OE','oe','endash','emdash','quotedblleft','quotedblright','quoteleft','quoteright','divide','lozenge','ydieresis','Ydieresis','fraction','currency','guilsinglleft','guilsinglright','fi','fl','daggerdbl','periodcentered','quotesinglbase','quotedblbase','perthousand','Acircumflex','Ecircumflex','Aacute','Edieresis','Egrave','Iacute','Icircumflex','Idieresis','Igrave','Oacute','Ocircumflex','apple','Ograve','Uacute','Ucircumflex','Ugrave','dotlessi','circumflex','tilde','macron','breve','dotaccent','ring','cedilla','hungarumlaut','ogonek','caron','Lslash','lslash','Scaron','scaron','Zcaron','zcaron','brokenbar','Eth','eth','Yacute','yacute','Thorn','thorn','minus','multiply','onesuperior','twosuperior','threesuperior','onehalf','onequarter','threequarters','franc','Gbreve','gbreve','Idotaccent','Scedilla','scedilla','Cacute','cacute','Ccaron','ccaron','dcroat'];function DefaultEncoding(font){this.font=font;}
DefaultEncoding.prototype.charToGlyphIndex=function(c){var code=c.charCodeAt(0);var glyphs=this.font.glyphs;if(glyphs){for(var i=0;i<glyphs.length;i+=1){var glyph=glyphs.get(i);for(var j=0;j<glyph.unicodes.length;j+=1){if(glyph.unicodes[j]===code){return i;}}}}
return null;};function CmapEncoding(cmap){this.cmap=cmap;}
CmapEncoding.prototype.charToGlyphIndex=function(c){return this.cmap.glyphIndexMap[c.charCodeAt(0)]||0;};function CffEncoding(encoding,charset){this.encoding=encoding;this.charset=charset;}
CffEncoding.prototype.charToGlyphIndex=function(s){var code=s.charCodeAt(0);var charName=this.encoding[code];return this.charset.indexOf(charName);};function GlyphNames(post){var this$1=this;switch(post.version){case 1:this.names=standardNames.slice();break;case 2:this.names=new Array(post.numberOfGlyphs);for(var i=0;i<post.numberOfGlyphs;i++){if(post.glyphNameIndex[i]<standardNames.length){this$1.names[i]=standardNames[post.glyphNameIndex[i]];}else{this$1.names[i]=post.names[post.glyphNameIndex[i]-standardNames.length];}}
break;case 2.5:this.names=new Array(post.numberOfGlyphs);for(var i$1=0;i$1<post.numberOfGlyphs;i$1++){this$1.names[i$1]=standardNames[i$1+post.glyphNameIndex[i$1]];}
break;case 3:this.names=[];break;default:this.names=[];break;}}
GlyphNames.prototype.nameToGlyphIndex=function(name){return this.names.indexOf(name);};GlyphNames.prototype.glyphIndexToName=function(gid){return this.names[gid];};function addGlyphNames(font){var glyph;var glyphIndexMap=font.tables.cmap.glyphIndexMap;var charCodes=Object.keys(glyphIndexMap);for(var i=0;i<charCodes.length;i+=1){var c=charCodes[i];var glyphIndex=glyphIndexMap[c];glyph=font.glyphs.get(glyphIndex);glyph.addUnicode(parseInt(c));}
for(var i$1=0;i$1<font.glyphs.length;i$1+=1){glyph=font.glyphs.get(i$1);if(font.cffEncoding){if(font.isCIDFont){glyph.name='gid'+i$1;}else{glyph.name=font.cffEncoding.charset[i$1];}}else if(font.glyphNames.names){glyph.name=font.glyphNames.glyphIndexToName(i$1);}}}
function line(ctx,x1,y1,x2,y2){ctx.beginPath();ctx.moveTo(x1,y1);ctx.lineTo(x2,y2);ctx.stroke();}
var draw={line:line};function parseGlyphCoordinate(p,flag,previousValue,shortVectorBitMask,sameBitMask){var v;if((flag&shortVectorBitMask)>0){v=p.parseByte();if((flag&sameBitMask)===0){v=-v;}
v=previousValue+v;}else{if((flag&sameBitMask)>0){v=previousValue;}else{v=previousValue+p.parseShort();}}
return v;}
function parseGlyph(glyph,data,start){var p=new parse.Parser(data,start);glyph.numberOfContours=p.parseShort();glyph._xMin=p.parseShort();glyph._yMin=p.parseShort();glyph._xMax=p.parseShort();glyph._yMax=p.parseShort();var flags;var flag;if(glyph.numberOfContours>0){var endPointIndices=glyph.endPointIndices=[];for(var i=0;i<glyph.numberOfContours;i+=1){endPointIndices.push(p.parseUShort());}
glyph.instructionLength=p.parseUShort();glyph.instructions=[];for(var i$1=0;i$1<glyph.instructionLength;i$1+=1){glyph.instructions.push(p.parseByte());}
var numberOfCoordinates=endPointIndices[endPointIndices.length-1]+1;flags=[];for(var i$2=0;i$2<numberOfCoordinates;i$2+=1){flag=p.parseByte();flags.push(flag);if((flag&8)>0){var repeatCount=p.parseByte();for(var j=0;j<repeatCount;j+=1){flags.push(flag);i$2+=1;}}}
check.argument(flags.length===numberOfCoordinates,'Bad flags.');if(endPointIndices.length>0){var points=[];var point;if(numberOfCoordinates>0){for(var i$3=0;i$3<numberOfCoordinates;i$3+=1){flag=flags[i$3];point={};point.onCurve=!!(flag&1);point.lastPointOfContour=endPointIndices.indexOf(i$3)>=0;points.push(point);}
var px=0;for(var i$4=0;i$4<numberOfCoordinates;i$4+=1){flag=flags[i$4];point=points[i$4];point.x=parseGlyphCoordinate(p,flag,px,2,16);px=point.x;}
var py=0;for(var i$5=0;i$5<numberOfCoordinates;i$5+=1){flag=flags[i$5];point=points[i$5];point.y=parseGlyphCoordinate(p,flag,py,4,32);py=point.y;}}
glyph.points=points;}else{glyph.points=[];}}else if(glyph.numberOfContours===0){glyph.points=[];}else{glyph.isComposite=true;glyph.points=[];glyph.components=[];var moreComponents=true;while(moreComponents){flags=p.parseUShort();var component={glyphIndex:p.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};if((flags&1)>0){if((flags&2)>0){component.dx=p.parseShort();component.dy=p.parseShort();}else{component.matchedPoints=[p.parseUShort(),p.parseUShort()];}}else{if((flags&2)>0){component.dx=p.parseChar();component.dy=p.parseChar();}else{component.matchedPoints=[p.parseByte(),p.parseByte()];}}
if((flags&8)>0){component.xScale=component.yScale=p.parseF2Dot14();}else if((flags&64)>0){component.xScale=p.parseF2Dot14();component.yScale=p.parseF2Dot14();}else if((flags&128)>0){component.xScale=p.parseF2Dot14();component.scale01=p.parseF2Dot14();component.scale10=p.parseF2Dot14();component.yScale=p.parseF2Dot14();}
glyph.components.push(component);moreComponents=!!(flags&32);}
if(flags&0x100){glyph.instructionLength=p.parseUShort();glyph.instructions=[];for(var i$6=0;i$6<glyph.instructionLength;i$6+=1){glyph.instructions.push(p.parseByte());}}}}
function transformPoints(points,transform){var newPoints=[];for(var i=0;i<points.length;i+=1){var pt=points[i];var newPt={x:transform.xScale*pt.x+transform.scale01*pt.y+transform.dx,y:transform.scale10*pt.x+transform.yScale*pt.y+transform.dy,onCurve:pt.onCurve,lastPointOfContour:pt.lastPointOfContour};newPoints.push(newPt);}
return newPoints;}
function getContours(points){var contours=[];var currentContour=[];for(var i=0;i<points.length;i+=1){var pt=points[i];currentContour.push(pt);if(pt.lastPointOfContour){contours.push(currentContour);currentContour=[];}}
check.argument(currentContour.length===0,'There are still points left in the current contour.');return contours;}
function getPath(points){var p=new Path();if(!points){return p;}
var contours=getContours(points);for(var contourIndex=0;contourIndex<contours.length;++contourIndex){var contour=contours[contourIndex];var prev=null;var curr=contour[contour.length-1];var next=contour[0];if(curr.onCurve){p.moveTo(curr.x,curr.y);}else{if(next.onCurve){p.moveTo(next.x,next.y);}else{var start={x:(curr.x+next.x)*0.5,y:(curr.y+next.y)*0.5};p.moveTo(start.x,start.y);}}
for(var i=0;i<contour.length;++i){prev=curr;curr=next;next=contour[(i+1)%contour.length];if(curr.onCurve){p.lineTo(curr.x,curr.y);}else{var prev2=prev;var next2=next;if(!prev.onCurve){prev2={x:(curr.x+prev.x)*0.5,y:(curr.y+prev.y)*0.5};p.lineTo(prev2.x,prev2.y);}
if(!next.onCurve){next2={x:(curr.x+next.x)*0.5,y:(curr.y+next.y)*0.5};}
p.lineTo(prev2.x,prev2.y);p.quadraticCurveTo(curr.x,curr.y,next2.x,next2.y);}}
p.closePath();}
return p;}
function buildPath(glyphs,glyph){if(glyph.isComposite){for(var j=0;j<glyph.components.length;j+=1){var component=glyph.components[j];var componentGlyph=glyphs.get(component.glyphIndex);componentGlyph.getPath();if(componentGlyph.points){var transformedPoints=(void 0);if(component.matchedPoints===undefined){transformedPoints=transformPoints(componentGlyph.points,component);}else{if((component.matchedPoints[0]>glyph.points.length-1)||(component.matchedPoints[1]>componentGlyph.points.length-1)){throw Error('Matched points out of range in '+glyph.name);}
var firstPt=glyph.points[component.matchedPoints[0]];var secondPt=componentGlyph.points[component.matchedPoints[1]];var transform={xScale:component.xScale,scale01:component.scale01,scale10:component.scale10,yScale:component.yScale,dx:0,dy:0};secondPt=transformPoints([secondPt],transform)[0];transform.dx=firstPt.x-secondPt.x;transform.dy=firstPt.y-secondPt.y;transformedPoints=transformPoints(componentGlyph.points,transform);}
glyph.points=glyph.points.concat(transformedPoints);}}}
return getPath(glyph.points);}
function parseGlyfTable(data,start,loca,font){var glyphs=new glyphset.GlyphSet(font);for(var i=0;i<loca.length-1;i+=1){var offset=loca[i];var nextOffset=loca[i+1];if(offset!==nextOffset){glyphs.push(i,glyphset.ttfGlyphLoader(font,i,parseGlyph,data,start+offset,buildPath));}else{glyphs.push(i,glyphset.glyphLoader(font,i));}}
return glyphs;}
var glyf={getPath:getPath,parse:parseGlyfTable};function getPathDefinition(glyph,path){var _path=path||new Path();return{configurable:true,get:function(){if(typeof _path==='function'){_path=_path();}
return _path;},set:function(p){_path=p;}};}
function Glyph(options){this.bindConstructorValues(options);}
Glyph.prototype.bindConstructorValues=function(options){this.index=options.index||0;this.name=options.name||null;this.unicode=options.unicode||undefined;this.unicodes=options.unicodes||options.unicode!==undefined?[options.unicode]:[];if(options.xMin){this.xMin=options.xMin;}
if(options.yMin){this.yMin=options.yMin;}
if(options.xMax){this.xMax=options.xMax;}
if(options.yMax){this.yMax=options.yMax;}
if(options.advanceWidth){this.advanceWidth=options.advanceWidth;}
Object.defineProperty(this,'path',getPathDefinition(this,options.path));};Glyph.prototype.addUnicode=function(unicode){if(this.unicodes.length===0){this.unicode=unicode;}
this.unicodes.push(unicode);};Glyph.prototype.getBoundingBox=function(){return this.path.getBoundingBox();};Glyph.prototype.getPath=function(x,y,fontSize,options,font){x=x!==undefined?x:0;y=y!==undefined?y:0;fontSize=fontSize!==undefined?fontSize:72;var commands;var hPoints;if(!options){options={};}
var xScale=options.xScale;var yScale=options.yScale;if(options.hinting&&font&&font.hinting){hPoints=this.path&&font.hinting.exec(this,fontSize);}
if(hPoints){commands=glyf.getPath(hPoints).commands;x=Math.round(x);y=Math.round(y);xScale=yScale=1;}else{commands=this.path.commands;var scale=1/this.path.unitsPerEm*fontSize;if(xScale===undefined){xScale=scale;}
if(yScale===undefined){yScale=scale;}}
var p=new Path();for(var i=0;i<commands.length;i+=1){var cmd=commands[i];if(cmd.type==='M'){p.moveTo(x+(cmd.x*xScale),y+(-cmd.y*yScale));}else if(cmd.type==='L'){p.lineTo(x+(cmd.x*xScale),y+(-cmd.y*yScale));}else if(cmd.type==='Q'){p.quadraticCurveTo(x+(cmd.x1*xScale),y+(-cmd.y1*yScale),x+(cmd.x*xScale),y+(-cmd.y*yScale));}else if(cmd.type==='C'){p.curveTo(x+(cmd.x1*xScale),y+(-cmd.y1*yScale),x+(cmd.x2*xScale),y+(-cmd.y2*yScale),x+(cmd.x*xScale),y+(-cmd.y*yScale));}else if(cmd.type==='Z'){p.closePath();}}
return p;};Glyph.prototype.getContours=function(){var this$1=this;if(this.points===undefined){return[];}
var contours=[];var currentContour=[];for(var i=0;i<this.points.length;i+=1){var pt=this$1.points[i];currentContour.push(pt);if(pt.lastPointOfContour){contours.push(currentContour);currentContour=[];}}
check.argument(currentContour.length===0,'There are still points left in the current contour.');return contours;};Glyph.prototype.getMetrics=function(){var commands=this.path.commands;var xCoords=[];var yCoords=[];for(var i=0;i<commands.length;i+=1){var cmd=commands[i];if(cmd.type!=='Z'){xCoords.push(cmd.x);yCoords.push(cmd.y);}
if(cmd.type==='Q'||cmd.type==='C'){xCoords.push(cmd.x1);yCoords.push(cmd.y1);}
if(cmd.type==='C'){xCoords.push(cmd.x2);yCoords.push(cmd.y2);}}
var metrics={xMin:Math.min.apply(null,xCoords),yMin:Math.min.apply(null,yCoords),xMax:Math.max.apply(null,xCoords),yMax:Math.max.apply(null,yCoords),leftSideBearing:this.leftSideBearing};if(!isFinite(metrics.xMin)){metrics.xMin=0;}
if(!isFinite(metrics.xMax)){metrics.xMax=this.advanceWidth;}
if(!isFinite(metrics.yMin)){metrics.yMin=0;}
if(!isFinite(metrics.yMax)){metrics.yMax=0;}
metrics.rightSideBearing=this.advanceWidth-metrics.leftSideBearing-(metrics.xMax-metrics.xMin);return metrics;};Glyph.prototype.draw=function(ctx,x,y,fontSize,options){this.getPath(x,y,fontSize,options).draw(ctx);};Glyph.prototype.drawPoints=function(ctx,x,y,fontSize){function drawCircles(l,x,y,scale){var PI_SQ=Math.PI*2;ctx.beginPath();for(var j=0;j<l.length;j+=1){ctx.moveTo(x+(l[j].x*scale),y+(l[j].y*scale));ctx.arc(x+(l[j].x*scale),y+(l[j].y*scale),2,0,PI_SQ,false);}
ctx.closePath();ctx.fill();}
x=x!==undefined?x:0;y=y!==undefined?y:0;fontSize=fontSize!==undefined?fontSize:24;var scale=1/this.path.unitsPerEm*fontSize;var blueCircles=[];var redCircles=[];var path=this.path;for(var i=0;i<path.commands.length;i+=1){var cmd=path.commands[i];if(cmd.x!==undefined){blueCircles.push({x:cmd.x,y:-cmd.y});}
if(cmd.x1!==undefined){redCircles.push({x:cmd.x1,y:-cmd.y1});}
if(cmd.x2!==undefined){redCircles.push({x:cmd.x2,y:-cmd.y2});}}
ctx.fillStyle='blue';drawCircles(blueCircles,x,y,scale);ctx.fillStyle='red';drawCircles(redCircles,x,y,scale);};Glyph.prototype.drawMetrics=function(ctx,x,y,fontSize){var scale;x=x!==undefined?x:0;y=y!==undefined?y:0;fontSize=fontSize!==undefined?fontSize:24;scale=1/this.path.unitsPerEm*fontSize;ctx.lineWidth=1;ctx.strokeStyle='black';draw.line(ctx,x,-10000,x,10000);draw.line(ctx,-10000,y,10000,y);var xMin=this.xMin||0;var yMin=this.yMin||0;var xMax=this.xMax||0;var yMax=this.yMax||0;var advanceWidth=this.advanceWidth||0;ctx.strokeStyle='blue';draw.line(ctx,x+(xMin*scale),-10000,x+(xMin*scale),10000);draw.line(ctx,x+(xMax*scale),-10000,x+(xMax*scale),10000);draw.line(ctx,-10000,y+(-yMin*scale),10000,y+(-yMin*scale));draw.line(ctx,-10000,y+(-yMax*scale),10000,y+(-yMax*scale));ctx.strokeStyle='green';draw.line(ctx,x+(advanceWidth*scale),-10000,x+(advanceWidth*scale),10000);};function defineDependentProperty(glyph,externalName,internalName){Object.defineProperty(glyph,externalName,{get:function(){glyph.path;return glyph[internalName];},set:function(newValue){glyph[internalName]=newValue;},enumerable:true,configurable:true});}
function GlyphSet(font,glyphs){var this$1=this;this.font=font;this.glyphs={};if(Array.isArray(glyphs)){for(var i=0;i<glyphs.length;i++){this$1.glyphs[i]=glyphs[i];}}
this.length=(glyphs&&glyphs.length)||0;}
GlyphSet.prototype.get=function(index){if(typeof this.glyphs[index]==='function'){this.glyphs[index]=this.glyphs[index]();}
return this.glyphs[index];};GlyphSet.prototype.push=function(index,loader){this.glyphs[index]=loader;this.length++;};function glyphLoader(font,index){return new Glyph({index:index,font:font});}
function ttfGlyphLoader(font,index,parseGlyph,data,position,buildPath){return function(){var glyph=new Glyph({index:index,font:font});glyph.path=function(){parseGlyph(glyph,data,position);var path=buildPath(font.glyphs,glyph);path.unitsPerEm=font.unitsPerEm;return path;};defineDependentProperty(glyph,'xMin','_xMin');defineDependentProperty(glyph,'xMax','_xMax');defineDependentProperty(glyph,'yMin','_yMin');defineDependentProperty(glyph,'yMax','_yMax');return glyph;};}
function cffGlyphLoader(font,index,parseCFFCharstring,charstring){return function(){var glyph=new Glyph({index:index,font:font});glyph.path=function(){var path=parseCFFCharstring(font,glyph,charstring);path.unitsPerEm=font.unitsPerEm;return path;};return glyph;};}
var glyphset={GlyphSet:GlyphSet,glyphLoader:glyphLoader,ttfGlyphLoader:ttfGlyphLoader,cffGlyphLoader:cffGlyphLoader};function equals(a,b){if(a===b){return true;}else if(Array.isArray(a)&&Array.isArray(b)){if(a.length!==b.length){return false;}
for(var i=0;i<a.length;i+=1){if(!equals(a[i],b[i])){return false;}}
return true;}else{return false;}}
function calcCFFSubroutineBias(subrs){var bias;if(subrs.length<1240){bias=107;}else if(subrs.length<33900){bias=1131;}else{bias=32768;}
return bias;}
function parseCFFIndex(data,start,conversionFn){var offsets=[];var objects=[];var count=parse.getCard16(data,start);var objectOffset;var endOffset;if(count!==0){var offsetSize=parse.getByte(data,start+2);objectOffset=start+((count+1)*offsetSize)+2;var pos=start+3;for(var i=0;i<count+1;i+=1){offsets.push(parse.getOffset(data,pos,offsetSize));pos+=offsetSize;}
endOffset=objectOffset+offsets[count];}else{endOffset=start+2;}
for(var i$1=0;i$1<offsets.length-1;i$1+=1){var value=parse.getBytes(data,objectOffset+offsets[i$1],objectOffset+offsets[i$1+1]);if(conversionFn){value=conversionFn(value);}
objects.push(value);}
return{objects:objects,startOffset:start,endOffset:endOffset};}
function parseFloatOperand(parser){var s='';var eof=15;var lookup=['0','1','2','3','4','5','6','7','8','9','.','E','E-',null,'-'];while(true){var b=parser.parseByte();var n1=b>>4;var n2=b&15;if(n1===eof){break;}
s+=lookup[n1];if(n2===eof){break;}
s+=lookup[n2];}
return parseFloat(s);}
function parseOperand(parser,b0){var b1;var b2;var b3;var b4;if(b0===28){b1=parser.parseByte();b2=parser.parseByte();return b1<<8|b2;}
if(b0===29){b1=parser.parseByte();b2=parser.parseByte();b3=parser.parseByte();b4=parser.parseByte();return b1<<24|b2<<16|b3<<8|b4;}
if(b0===30){return parseFloatOperand(parser);}
if(b0>=32&&b0<=246){return b0-139;}
if(b0>=247&&b0<=250){b1=parser.parseByte();return(b0-247)*256+b1+108;}
if(b0>=251&&b0<=254){b1=parser.parseByte();return-(b0-251)*256-b1-108;}
throw new Error('Invalid b0 '+b0);}
function entriesToObject(entries){var o={};for(var i=0;i<entries.length;i+=1){var key=entries[i][0];var values=entries[i][1];var value=(void 0);if(values.length===1){value=values[0];}else{value=values;}
if(o.hasOwnProperty(key)&&!isNaN(o[key])){throw new Error('Object '+o+' already has key '+key);}
o[key]=value;}
return o;}
function parseCFFDict(data,start,size){start=start!==undefined?start:0;var parser=new parse.Parser(data,start);var entries=[];var operands=[];size=size!==undefined?size:data.length;while(parser.relativeOffset<size){var op=parser.parseByte();if(op<=21){if(op===12){op=1200+parser.parseByte();}
entries.push([op,operands]);operands=[];}else{operands.push(parseOperand(parser,op));}}
return entriesToObject(entries);}
function getCFFString(strings,index){if(index<=390){index=cffStandardStrings[index];}else{index=strings[index-391];}
return index;}
function interpretDict(dict,meta,strings){var newDict={};var value;for(var i=0;i<meta.length;i+=1){var m=meta[i];if(Array.isArray(m.type)){var values=[];values.length=m.type.length;for(var j=0;j<m.type.length;j++){value=dict[m.op]!==undefined?dict[m.op][j]:undefined;if(value===undefined){value=m.value!==undefined&&m.value[j]!==undefined?m.value[j]:null;}
if(m.type[j]==='SID'){value=getCFFString(strings,value);}
values[j]=value;}
newDict[m.name]=values;}else{value=dict[m.op];if(value===undefined){value=m.value!==undefined?m.value:null;}
if(m.type==='SID'){value=getCFFString(strings,value);}
newDict[m.name]=value;}}
return newDict;}
function parseCFFHeader(data,start){var header={};header.formatMajor=parse.getCard8(data,start);header.formatMinor=parse.getCard8(data,start+1);header.size=parse.getCard8(data,start+2);header.offsetSize=parse.getCard8(data,start+3);header.startOffset=start;header.endOffset=start+4;return header;}
var TOP_DICT_META=[{name:'version',op:0,type:'SID'},{name:'notice',op:1,type:'SID'},{name:'copyright',op:1200,type:'SID'},{name:'fullName',op:2,type:'SID'},{name:'familyName',op:3,type:'SID'},{name:'weight',op:4,type:'SID'},{name:'isFixedPitch',op:1201,type:'number',value:0},{name:'italicAngle',op:1202,type:'number',value:0},{name:'underlinePosition',op:1203,type:'number',value:-100},{name:'underlineThickness',op:1204,type:'number',value:50},{name:'paintType',op:1205,type:'number',value:0},{name:'charstringType',op:1206,type:'number',value:2},{name:'fontMatrix',op:1207,type:['real','real','real','real','real','real'],value:[0.001,0,0,0.001,0,0]},{name:'uniqueId',op:13,type:'number'},{name:'fontBBox',op:5,type:['number','number','number','number'],value:[0,0,0,0]},{name:'strokeWidth',op:1208,type:'number',value:0},{name:'xuid',op:14,type:[],value:null},{name:'charset',op:15,type:'offset',value:0},{name:'encoding',op:16,type:'offset',value:0},{name:'charStrings',op:17,type:'offset',value:0},{name:'private',op:18,type:['number','offset'],value:[0,0]},{name:'ros',op:1230,type:['SID','SID','number']},{name:'cidFontVersion',op:1231,type:'number',value:0},{name:'cidFontRevision',op:1232,type:'number',value:0},{name:'cidFontType',op:1233,type:'number',value:0},{name:'cidCount',op:1234,type:'number',value:8720},{name:'uidBase',op:1235,type:'number'},{name:'fdArray',op:1236,type:'offset'},{name:'fdSelect',op:1237,type:'offset'},{name:'fontName',op:1238,type:'SID'}];var PRIVATE_DICT_META=[{name:'subrs',op:19,type:'offset',value:0},{name:'defaultWidthX',op:20,type:'number',value:0},{name:'nominalWidthX',op:21,type:'number',value:0}];function parseCFFTopDict(data,strings){var dict=parseCFFDict(data,0,data.byteLength);return interpretDict(dict,TOP_DICT_META,strings);}
function parseCFFPrivateDict(data,start,size,strings){var dict=parseCFFDict(data,start,size);return interpretDict(dict,PRIVATE_DICT_META,strings);}
function gatherCFFTopDicts(data,start,cffIndex,strings){var topDictArray=[];for(var iTopDict=0;iTopDict<cffIndex.length;iTopDict+=1){var topDictData=new DataView(new Uint8Array(cffIndex[iTopDict]).buffer);var topDict=parseCFFTopDict(topDictData,strings);topDict._subrs=[];topDict._subrsBias=0;var privateSize=topDict.private[0];var privateOffset=topDict.private[1];if(privateSize!==0&&privateOffset!==0){var privateDict=parseCFFPrivateDict(data,privateOffset+start,privateSize,strings);topDict._defaultWidthX=privateDict.defaultWidthX;topDict._nominalWidthX=privateDict.nominalWidthX;if(privateDict.subrs!==0){var subrOffset=privateOffset+privateDict.subrs;var subrIndex=parseCFFIndex(data,subrOffset+start);topDict._subrs=subrIndex.objects;topDict._subrsBias=calcCFFSubroutineBias(topDict._subrs);}
topDict._privateDict=privateDict;}
topDictArray.push(topDict);}
return topDictArray;}
function parseCFFCharset(data,start,nGlyphs,strings){var sid;var count;var parser=new parse.Parser(data,start);nGlyphs-=1;var charset=['.notdef'];var format=parser.parseCard8();if(format===0){for(var i=0;i<nGlyphs;i+=1){sid=parser.parseSID();charset.push(getCFFString(strings,sid));}}else if(format===1){while(charset.length<=nGlyphs){sid=parser.parseSID();count=parser.parseCard8();for(var i$1=0;i$1<=count;i$1+=1){charset.push(getCFFString(strings,sid));sid+=1;}}}else if(format===2){while(charset.length<=nGlyphs){sid=parser.parseSID();count=parser.parseCard16();for(var i$2=0;i$2<=count;i$2+=1){charset.push(getCFFString(strings,sid));sid+=1;}}}else{throw new Error('Unknown charset format '+format);}
return charset;}
function parseCFFEncoding(data,start,charset){var code;var enc={};var parser=new parse.Parser(data,start);var format=parser.parseCard8();if(format===0){var nCodes=parser.parseCard8();for(var i=0;i<nCodes;i+=1){code=parser.parseCard8();enc[code]=i;}}else if(format===1){var nRanges=parser.parseCard8();code=1;for(var i$1=0;i$1<nRanges;i$1+=1){var first=parser.parseCard8();var nLeft=parser.parseCard8();for(var j=first;j<=first+nLeft;j+=1){enc[j]=code;code+=1;}}}else{throw new Error('Unknown encoding format '+format);}
return new CffEncoding(enc,charset);}
function parseCFFCharstring(font,glyph,code){var c1x;var c1y;var c2x;var c2y;var p=new Path();var stack=[];var nStems=0;var haveWidth=false;var open=false;var x=0;var y=0;var subrs;var subrsBias;var defaultWidthX;var nominalWidthX;if(font.isCIDFont){var fdIndex=font.tables.cff.topDict._fdSelect[glyph.index];var fdDict=font.tables.cff.topDict._fdArray[fdIndex];subrs=fdDict._subrs;subrsBias=fdDict._subrsBias;defaultWidthX=fdDict._defaultWidthX;nominalWidthX=fdDict._nominalWidthX;}else{subrs=font.tables.cff.topDict._subrs;subrsBias=font.tables.cff.topDict._subrsBias;defaultWidthX=font.tables.cff.topDict._defaultWidthX;nominalWidthX=font.tables.cff.topDict._nominalWidthX;}
var width=defaultWidthX;function newContour(x,y){if(open){p.closePath();}
p.moveTo(x,y);open=true;}
function parseStems(){var hasWidthArg;hasWidthArg=stack.length%2!==0;if(hasWidthArg&&!haveWidth){width=stack.shift()+nominalWidthX;}
nStems+=stack.length>>1;stack.length=0;haveWidth=true;}
function parse$$1(code){var b1;var b2;var b3;var b4;var codeIndex;var subrCode;var jpx;var jpy;var c3x;var c3y;var c4x;var c4y;var i=0;while(i<code.length){var v=code[i];i+=1;switch(v){case 1:parseStems();break;case 3:parseStems();break;case 4:if(stack.length>1&&!haveWidth){width=stack.shift()+nominalWidthX;haveWidth=true;}
y+=stack.pop();newContour(x,y);break;case 5:while(stack.length>0){x+=stack.shift();y+=stack.shift();p.lineTo(x,y);}
break;case 6:while(stack.length>0){x+=stack.shift();p.lineTo(x,y);if(stack.length===0){break;}
y+=stack.shift();p.lineTo(x,y);}
break;case 7:while(stack.length>0){y+=stack.shift();p.lineTo(x,y);if(stack.length===0){break;}
x+=stack.shift();p.lineTo(x,y);}
break;case 8:while(stack.length>0){c1x=x+stack.shift();c1y=y+stack.shift();c2x=c1x+stack.shift();c2y=c1y+stack.shift();x=c2x+stack.shift();y=c2y+stack.shift();p.curveTo(c1x,c1y,c2x,c2y,x,y);}
break;case 10:codeIndex=stack.pop()+subrsBias;subrCode=subrs[codeIndex];if(subrCode){parse$$1(subrCode);}
break;case 11:return;case 12:v=code[i];i+=1;switch(v){case 35:c1x=x+stack.shift();c1y=y+stack.shift();c2x=c1x+stack.shift();c2y=c1y+stack.shift();jpx=c2x+stack.shift();jpy=c2y+stack.shift();c3x=jpx+stack.shift();c3y=jpy+stack.shift();c4x=c3x+stack.shift();c4y=c3y+stack.shift();x=c4x+stack.shift();y=c4y+stack.shift();stack.shift();p.curveTo(c1x,c1y,c2x,c2y,jpx,jpy);p.curveTo(c3x,c3y,c4x,c4y,x,y);break;case 34:c1x=x+stack.shift();c1y=y;c2x=c1x+stack.shift();c2y=c1y+stack.shift();jpx=c2x+stack.shift();jpy=c2y;c3x=jpx+stack.shift();c3y=c2y;c4x=c3x+stack.shift();c4y=y;x=c4x+stack.shift();p.curveTo(c1x,c1y,c2x,c2y,jpx,jpy);p.curveTo(c3x,c3y,c4x,c4y,x,y);break;case 36:c1x=x+stack.shift();c1y=y+stack.shift();c2x=c1x+stack.shift();c2y=c1y+stack.shift();jpx=c2x+stack.shift();jpy=c2y;c3x=jpx+stack.shift();c3y=c2y;c4x=c3x+stack.shift();c4y=c3y+stack.shift();x=c4x+stack.shift();p.curveTo(c1x,c1y,c2x,c2y,jpx,jpy);p.curveTo(c3x,c3y,c4x,c4y,x,y);break;case 37:c1x=x+stack.shift();c1y=y+stack.shift();c2x=c1x+stack.shift();c2y=c1y+stack.shift();jpx=c2x+stack.shift();jpy=c2y+stack.shift();c3x=jpx+stack.shift();c3y=jpy+stack.shift();c4x=c3x+stack.shift();c4y=c3y+stack.shift();if(Math.abs(c4x-x)>Math.abs(c4y-y)){x=c4x+stack.shift();}else{y=c4y+stack.shift();}
p.curveTo(c1x,c1y,c2x,c2y,jpx,jpy);p.curveTo(c3x,c3y,c4x,c4y,x,y);break;default:console.log('Glyph '+glyph.index+': unknown operator '+1200+v);stack.length=0;}
break;case 14:if(stack.length>0&&!haveWidth){width=stack.shift()+nominalWidthX;haveWidth=true;}
if(open){p.closePath();open=false;}
break;case 18:parseStems();break;case 19:case 20:parseStems();i+=(nStems+7)>>3;break;case 21:if(stack.length>2&&!haveWidth){width=stack.shift()+nominalWidthX;haveWidth=true;}
y+=stack.pop();x+=stack.pop();newContour(x,y);break;case 22:if(stack.length>1&&!haveWidth){width=stack.shift()+nominalWidthX;haveWidth=true;}
x+=stack.pop();newContour(x,y);break;case 23:parseStems();break;case 24:while(stack.length>2){c1x=x+stack.shift();c1y=y+stack.shift();c2x=c1x+stack.shift();c2y=c1y+stack.shift();x=c2x+stack.shift();y=c2y+stack.shift();p.curveTo(c1x,c1y,c2x,c2y,x,y);}
x+=stack.shift();y+=stack.shift();p.lineTo(x,y);break;case 25:while(stack.length>6){x+=stack.shift();y+=stack.shift();p.lineTo(x,y);}
c1x=x+stack.shift();c1y=y+stack.shift();c2x=c1x+stack.shift();c2y=c1y+stack.shift();x=c2x+stack.shift();y=c2y+stack.shift();p.curveTo(c1x,c1y,c2x,c2y,x,y);break;case 26:if(stack.length%2){x+=stack.shift();}
while(stack.length>0){c1x=x;c1y=y+stack.shift();c2x=c1x+stack.shift();c2y=c1y+stack.shift();x=c2x;y=c2y+stack.shift();p.curveTo(c1x,c1y,c2x,c2y,x,y);}
break;case 27:if(stack.length%2){y+=stack.shift();}
while(stack.length>0){c1x=x+stack.shift();c1y=y;c2x=c1x+stack.shift();c2y=c1y+stack.shift();x=c2x+stack.shift();y=c2y;p.curveTo(c1x,c1y,c2x,c2y,x,y);}
break;case 28:b1=code[i];b2=code[i+1];stack.push(((b1<<24)|(b2<<16))>>16);i+=2;break;case 29:codeIndex=stack.pop()+font.gsubrsBias;subrCode=font.gsubrs[codeIndex];if(subrCode){parse$$1(subrCode);}
break;case 30:while(stack.length>0){c1x=x;c1y=y+stack.shift();c2x=c1x+stack.shift();c2y=c1y+stack.shift();x=c2x+stack.shift();y=c2y+(stack.length===1?stack.shift():0);p.curveTo(c1x,c1y,c2x,c2y,x,y);if(stack.length===0){break;}
c1x=x+stack.shift();c1y=y;c2x=c1x+stack.shift();c2y=c1y+stack.shift();y=c2y+stack.shift();x=c2x+(stack.length===1?stack.shift():0);p.curveTo(c1x,c1y,c2x,c2y,x,y);}
break;case 31:while(stack.length>0){c1x=x+stack.shift();c1y=y;c2x=c1x+stack.shift();c2y=c1y+stack.shift();y=c2y+stack.shift();x=c2x+(stack.length===1?stack.shift():0);p.curveTo(c1x,c1y,c2x,c2y,x,y);if(stack.length===0){break;}
c1x=x;c1y=y+stack.shift();c2x=c1x+stack.shift();c2y=c1y+stack.shift();x=c2x+stack.shift();y=c2y+(stack.length===1?stack.shift():0);p.curveTo(c1x,c1y,c2x,c2y,x,y);}
break;default:if(v<32){console.log('Glyph '+glyph.index+': unknown operator '+v);}else if(v<247){stack.push(v-139);}else if(v<251){b1=code[i];i+=1;stack.push((v-247)*256+b1+108);}else if(v<255){b1=code[i];i+=1;stack.push(-(v-251)*256-b1-108);}else{b1=code[i];b2=code[i+1];b3=code[i+2];b4=code[i+3];i+=4;stack.push(((b1<<24)|(b2<<16)|(b3<<8)|b4)/65536);}}}}
parse$$1(code);glyph.advanceWidth=width;return p;}
function parseCFFFDSelect(data,start,nGlyphs,fdArrayCount){var fdSelect=[];var fdIndex;var parser=new parse.Parser(data,start);var format=parser.parseCard8();if(format===0){for(var iGid=0;iGid<nGlyphs;iGid++){fdIndex=parser.parseCard8();if(fdIndex>=fdArrayCount){throw new Error('CFF table CID Font FDSelect has bad FD index value '+fdIndex+' (FD count '+fdArrayCount+')');}
fdSelect.push(fdIndex);}}else if(format===3){var nRanges=parser.parseCard16();var first=parser.parseCard16();if(first!==0){throw new Error('CFF Table CID Font FDSelect format 3 range has bad initial GID '+first);}
var next;for(var iRange=0;iRange<nRanges;iRange++){fdIndex=parser.parseCard8();next=parser.parseCard16();if(fdIndex>=fdArrayCount){throw new Error('CFF table CID Font FDSelect has bad FD index value '+fdIndex+' (FD count '+fdArrayCount+')');}
if(next>nGlyphs){throw new Error('CFF Table CID Font FDSelect format 3 range has bad GID '+next);}
for(;first<next;first++){fdSelect.push(fdIndex);}
first=next;}
if(next!==nGlyphs){throw new Error('CFF Table CID Font FDSelect format 3 range has bad final GID '+next);}}else{throw new Error('CFF Table CID Font FDSelect table has unsupported format '+format);}
return fdSelect;}
function parseCFFTable(data,start,font){font.tables.cff={};var header=parseCFFHeader(data,start);var nameIndex=parseCFFIndex(data,header.endOffset,parse.bytesToString);var topDictIndex=parseCFFIndex(data,nameIndex.endOffset);var stringIndex=parseCFFIndex(data,topDictIndex.endOffset,parse.bytesToString);var globalSubrIndex=parseCFFIndex(data,stringIndex.endOffset);font.gsubrs=globalSubrIndex.objects;font.gsubrsBias=calcCFFSubroutineBias(font.gsubrs);var topDictArray=gatherCFFTopDicts(data,start,topDictIndex.objects,stringIndex.objects);if(topDictArray.length!==1){throw new Error('CFF table has too many fonts in \'FontSet\' - count of fonts NameIndex.length = '+topDictArray.length);}
var topDict=topDictArray[0];font.tables.cff.topDict=topDict;if(topDict._privateDict){font.defaultWidthX=topDict._privateDict.defaultWidthX;font.nominalWidthX=topDict._privateDict.nominalWidthX;}
if(topDict.ros[0]!==undefined&&topDict.ros[1]!==undefined){font.isCIDFont=true;}
if(font.isCIDFont){var fdArrayOffset=topDict.fdArray;var fdSelectOffset=topDict.fdSelect;if(fdArrayOffset===0||fdSelectOffset===0){throw new Error('Font is marked as a CID font, but FDArray and/or FDSelect information is missing');}
fdArrayOffset+=start;var fdArrayIndex=parseCFFIndex(data,fdArrayOffset);var fdArray=gatherCFFTopDicts(data,start,fdArrayIndex.objects,stringIndex.objects);topDict._fdArray=fdArray;fdSelectOffset+=start;topDict._fdSelect=parseCFFFDSelect(data,fdSelectOffset,font.numGlyphs,fdArray.length);}
var privateDictOffset=start+topDict.private[1];var privateDict=parseCFFPrivateDict(data,privateDictOffset,topDict.private[0],stringIndex.objects);font.defaultWidthX=privateDict.defaultWidthX;font.nominalWidthX=privateDict.nominalWidthX;if(privateDict.subrs!==0){var subrOffset=privateDictOffset+privateDict.subrs;var subrIndex=parseCFFIndex(data,subrOffset);font.subrs=subrIndex.objects;font.subrsBias=calcCFFSubroutineBias(font.subrs);}else{font.subrs=[];font.subrsBias=0;}
var charStringsIndex=parseCFFIndex(data,start+topDict.charStrings);font.nGlyphs=charStringsIndex.objects.length;var charset=parseCFFCharset(data,start+topDict.charset,font.nGlyphs,stringIndex.objects);if(topDict.encoding===0){font.cffEncoding=new CffEncoding(cffStandardEncoding,charset);}else if(topDict.encoding===1){font.cffEncoding=new CffEncoding(cffExpertEncoding,charset);}else{font.cffEncoding=parseCFFEncoding(data,start+topDict.encoding,charset);}
font.encoding=font.encoding||font.cffEncoding;font.glyphs=new glyphset.GlyphSet(font);for(var i=0;i<font.nGlyphs;i+=1){var charString=charStringsIndex.objects[i];font.glyphs.push(i,glyphset.cffGlyphLoader(font,i,parseCFFCharstring,charString));}}
function encodeString(s,strings){var sid;var i=cffStandardStrings.indexOf(s);if(i>=0){sid=i;}
i=strings.indexOf(s);if(i>=0){sid=i+cffStandardStrings.length;}else{sid=cffStandardStrings.length+strings.length;strings.push(s);}
return sid;}
function makeHeader(){return new table.Record('Header',[{name:'major',type:'Card8',value:1},{name:'minor',type:'Card8',value:0},{name:'hdrSize',type:'Card8',value:4},{name:'major',type:'Card8',value:1}]);}
function makeNameIndex(fontNames){var t=new table.Record('Name INDEX',[{name:'names',type:'INDEX',value:[]}]);t.names=[];for(var i=0;i<fontNames.length;i+=1){t.names.push({name:'name_'+i,type:'NAME',value:fontNames[i]});}
return t;}
function makeDict(meta,attrs,strings){var m={};for(var i=0;i<meta.length;i+=1){var entry=meta[i];var value=attrs[entry.name];if(value!==undefined&&!equals(value,entry.value)){if(entry.type==='SID'){value=encodeString(value,strings);}
m[entry.op]={name:entry.name,type:entry.type,value:value};}}
return m;}
function makeTopDict(attrs,strings){var t=new table.Record('Top DICT',[{name:'dict',type:'DICT',value:{}}]);t.dict=makeDict(TOP_DICT_META,attrs,strings);return t;}
function makeTopDictIndex(topDict){var t=new table.Record('Top DICT INDEX',[{name:'topDicts',type:'INDEX',value:[]}]);t.topDicts=[{name:'topDict_0',type:'TABLE',value:topDict}];return t;}
function makeStringIndex(strings){var t=new table.Record('String INDEX',[{name:'strings',type:'INDEX',value:[]}]);t.strings=[];for(var i=0;i<strings.length;i+=1){t.strings.push({name:'string_'+i,type:'STRING',value:strings[i]});}
return t;}
function makeGlobalSubrIndex(){return new table.Record('Global Subr INDEX',[{name:'subrs',type:'INDEX',value:[]}]);}
function makeCharsets(glyphNames,strings){var t=new table.Record('Charsets',[{name:'format',type:'Card8',value:0}]);for(var i=0;i<glyphNames.length;i+=1){var glyphName=glyphNames[i];var glyphSID=encodeString(glyphName,strings);t.fields.push({name:'glyph_'+i,type:'SID',value:glyphSID});}
return t;}
function glyphToOps(glyph){var ops=[];var path=glyph.path;ops.push({name:'width',type:'NUMBER',value:glyph.advanceWidth});var x=0;var y=0;for(var i=0;i<path.commands.length;i+=1){var dx=(void 0);var dy=(void 0);var cmd=path.commands[i];if(cmd.type==='Q'){var _13=1/3;var _23=2/3;cmd={type:'C',x:cmd.x,y:cmd.y,x1:_13*x+_23*cmd.x1,y1:_13*y+_23*cmd.y1,x2:_13*cmd.x+_23*cmd.x1,y2:_13*cmd.y+_23*cmd.y1};}
if(cmd.type==='M'){dx=Math.round(cmd.x-x);dy=Math.round(cmd.y-y);ops.push({name:'dx',type:'NUMBER',value:dx});ops.push({name:'dy',type:'NUMBER',value:dy});ops.push({name:'rmoveto',type:'OP',value:21});x=Math.round(cmd.x);y=Math.round(cmd.y);}else if(cmd.type==='L'){dx=Math.round(cmd.x-x);dy=Math.round(cmd.y-y);ops.push({name:'dx',type:'NUMBER',value:dx});ops.push({name:'dy',type:'NUMBER',value:dy});ops.push({name:'rlineto',type:'OP',value:5});x=Math.round(cmd.x);y=Math.round(cmd.y);}else if(cmd.type==='C'){var dx1=Math.round(cmd.x1-x);var dy1=Math.round(cmd.y1-y);var dx2=Math.round(cmd.x2-cmd.x1);var dy2=Math.round(cmd.y2-cmd.y1);dx=Math.round(cmd.x-cmd.x2);dy=Math.round(cmd.y-cmd.y2);ops.push({name:'dx1',type:'NUMBER',value:dx1});ops.push({name:'dy1',type:'NUMBER',value:dy1});ops.push({name:'dx2',type:'NUMBER',value:dx2});ops.push({name:'dy2',type:'NUMBER',value:dy2});ops.push({name:'dx',type:'NUMBER',value:dx});ops.push({name:'dy',type:'NUMBER',value:dy});ops.push({name:'rrcurveto',type:'OP',value:8});x=Math.round(cmd.x);y=Math.round(cmd.y);}}
ops.push({name:'endchar',type:'OP',value:14});return ops;}
function makeCharStringsIndex(glyphs){var t=new table.Record('CharStrings INDEX',[{name:'charStrings',type:'INDEX',value:[]}]);for(var i=0;i<glyphs.length;i+=1){var glyph=glyphs.get(i);var ops=glyphToOps(glyph);t.charStrings.push({name:glyph.name,type:'CHARSTRING',value:ops});}
return t;}
function makePrivateDict(attrs,strings){var t=new table.Record('Private DICT',[{name:'dict',type:'DICT',value:{}}]);t.dict=makeDict(PRIVATE_DICT_META,attrs,strings);return t;}
function makeCFFTable(glyphs,options){var t=new table.Table('CFF ',[{name:'header',type:'RECORD'},{name:'nameIndex',type:'RECORD'},{name:'topDictIndex',type:'RECORD'},{name:'stringIndex',type:'RECORD'},{name:'globalSubrIndex',type:'RECORD'},{name:'charsets',type:'RECORD'},{name:'charStringsIndex',type:'RECORD'},{name:'privateDict',type:'RECORD'}]);var fontScale=1/options.unitsPerEm;var attrs={version:options.version,fullName:options.fullName,familyName:options.familyName,weight:options.weightName,fontBBox:options.fontBBox||[0,0,0,0],fontMatrix:[fontScale,0,0,fontScale,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]};var privateAttrs={};var glyphNames=[];var glyph;for(var i=1;i<glyphs.length;i+=1){glyph=glyphs.get(i);glyphNames.push(glyph.name);}
var strings=[];t.header=makeHeader();t.nameIndex=makeNameIndex([options.postScriptName]);var topDict=makeTopDict(attrs,strings);t.topDictIndex=makeTopDictIndex(topDict);t.globalSubrIndex=makeGlobalSubrIndex();t.charsets=makeCharsets(glyphNames,strings);t.charStringsIndex=makeCharStringsIndex(glyphs);t.privateDict=makePrivateDict(privateAttrs,strings);t.stringIndex=makeStringIndex(strings);var startOffset=t.header.sizeOf()+
t.nameIndex.sizeOf()+
t.topDictIndex.sizeOf()+
t.stringIndex.sizeOf()+
t.globalSubrIndex.sizeOf();attrs.charset=startOffset;attrs.encoding=0;attrs.charStrings=attrs.charset+t.charsets.sizeOf();attrs.private[1]=attrs.charStrings+t.charStringsIndex.sizeOf();topDict=makeTopDict(attrs,strings);t.topDictIndex=makeTopDictIndex(topDict);return t;}
var cff={parse:parseCFFTable,make:makeCFFTable};function parseHeadTable(data,start){var head={};var p=new parse.Parser(data,start);head.version=p.parseVersion();head.fontRevision=Math.round(p.parseFixed()*1000)/1000;head.checkSumAdjustment=p.parseULong();head.magicNumber=p.parseULong();check.argument(head.magicNumber===0x5F0F3CF5,'Font header has wrong magic number.');head.flags=p.parseUShort();head.unitsPerEm=p.parseUShort();head.created=p.parseLongDateTime();head.modified=p.parseLongDateTime();head.xMin=p.parseShort();head.yMin=p.parseShort();head.xMax=p.parseShort();head.yMax=p.parseShort();head.macStyle=p.parseUShort();head.lowestRecPPEM=p.parseUShort();head.fontDirectionHint=p.parseShort();head.indexToLocFormat=p.parseShort();head.glyphDataFormat=p.parseShort();return head;}
function makeHeadTable(options){var timestamp=Math.round(new Date().getTime()/1000)+2082844800;var createdTimestamp=timestamp;if(options.createdTimestamp){createdTimestamp=options.createdTimestamp+2082844800;}
return new table.Table('head',[{name:'version',type:'FIXED',value:0x00010000},{name:'fontRevision',type:'FIXED',value:0x00010000},{name:'checkSumAdjustment',type:'ULONG',value:0},{name:'magicNumber',type:'ULONG',value:0x5F0F3CF5},{name:'flags',type:'USHORT',value:0},{name:'unitsPerEm',type:'USHORT',value:1000},{name:'created',type:'LONGDATETIME',value:createdTimestamp},{name:'modified',type:'LONGDATETIME',value:timestamp},{name:'xMin',type:'SHORT',value:0},{name:'yMin',type:'SHORT',value:0},{name:'xMax',type:'SHORT',value:0},{name:'yMax',type:'SHORT',value:0},{name:'macStyle',type:'USHORT',value:0},{name:'lowestRecPPEM',type:'USHORT',value:0},{name:'fontDirectionHint',type:'SHORT',value:2},{name:'indexToLocFormat',type:'SHORT',value:0},{name:'glyphDataFormat',type:'SHORT',value:0}],options);}
var head={parse:parseHeadTable,make:makeHeadTable};function parseHheaTable(data,start){var hhea={};var p=new parse.Parser(data,start);hhea.version=p.parseVersion();hhea.ascender=p.parseShort();hhea.descender=p.parseShort();hhea.lineGap=p.parseShort();hhea.advanceWidthMax=p.parseUShort();hhea.minLeftSideBearing=p.parseShort();hhea.minRightSideBearing=p.parseShort();hhea.xMaxExtent=p.parseShort();hhea.caretSlopeRise=p.parseShort();hhea.caretSlopeRun=p.parseShort();hhea.caretOffset=p.parseShort();p.relativeOffset+=8;hhea.metricDataFormat=p.parseShort();hhea.numberOfHMetrics=p.parseUShort();return hhea;}
function makeHheaTable(options){return new table.Table('hhea',[{name:'version',type:'FIXED',value:0x00010000},{name:'ascender',type:'FWORD',value:0},{name:'descender',type:'FWORD',value:0},{name:'lineGap',type:'FWORD',value:0},{name:'advanceWidthMax',type:'UFWORD',value:0},{name:'minLeftSideBearing',type:'FWORD',value:0},{name:'minRightSideBearing',type:'FWORD',value:0},{name:'xMaxExtent',type:'FWORD',value:0},{name:'caretSlopeRise',type:'SHORT',value:1},{name:'caretSlopeRun',type:'SHORT',value:0},{name:'caretOffset',type:'SHORT',value:0},{name:'reserved1',type:'SHORT',value:0},{name:'reserved2',type:'SHORT',value:0},{name:'reserved3',type:'SHORT',value:0},{name:'reserved4',type:'SHORT',value:0},{name:'metricDataFormat',type:'SHORT',value:0},{name:'numberOfHMetrics',type:'USHORT',value:0}],options);}
var hhea={parse:parseHheaTable,make:makeHheaTable};function parseHmtxTable(data,start,numMetrics,numGlyphs,glyphs){var advanceWidth;var leftSideBearing;var p=new parse.Parser(data,start);for(var i=0;i<numGlyphs;i+=1){if(i<numMetrics){advanceWidth=p.parseUShort();leftSideBearing=p.parseShort();}
var glyph=glyphs.get(i);glyph.advanceWidth=advanceWidth;glyph.leftSideBearing=leftSideBearing;}}
function makeHmtxTable(glyphs){var t=new table.Table('hmtx',[]);for(var i=0;i<glyphs.length;i+=1){var glyph=glyphs.get(i);var advanceWidth=glyph.advanceWidth||0;var leftSideBearing=glyph.leftSideBearing||0;t.fields.push({name:'advanceWidth_'+i,type:'USHORT',value:advanceWidth});t.fields.push({name:'leftSideBearing_'+i,type:'SHORT',value:leftSideBearing});}
return t;}
var hmtx={parse:parseHmtxTable,make:makeHmtxTable};function makeLtagTable(tags){var result=new table.Table('ltag',[{name:'version',type:'ULONG',value:1},{name:'flags',type:'ULONG',value:0},{name:'numTags',type:'ULONG',value:tags.length}]);var stringPool='';var stringPoolOffset=12+tags.length*4;for(var i=0;i<tags.length;++i){var pos=stringPool.indexOf(tags[i]);if(pos<0){pos=stringPool.length;stringPool+=tags[i];}
result.fields.push({name:'offset '+i,type:'USHORT',value:stringPoolOffset+pos});result.fields.push({name:'length '+i,type:'USHORT',value:tags[i].length});}
result.fields.push({name:'stringPool',type:'CHARARRAY',value:stringPool});return result;}
function parseLtagTable(data,start){var p=new parse.Parser(data,start);var tableVersion=p.parseULong();check.argument(tableVersion===1,'Unsupported ltag table version.');p.skip('uLong',1);var numTags=p.parseULong();var tags=[];for(var i=0;i<numTags;i++){var tag='';var offset=start+p.parseUShort();var length=p.parseUShort();for(var j=offset;j<offset+length;++j){tag+=String.fromCharCode(data.getInt8(j));}
tags.push(tag);}
return tags;}
var ltag={make:makeLtagTable,parse:parseLtagTable};function parseMaxpTable(data,start){var maxp={};var p=new parse.Parser(data,start);maxp.version=p.parseVersion();maxp.numGlyphs=p.parseUShort();if(maxp.version===1.0){maxp.maxPoints=p.parseUShort();maxp.maxContours=p.parseUShort();maxp.maxCompositePoints=p.parseUShort();maxp.maxCompositeContours=p.parseUShort();maxp.maxZones=p.parseUShort();maxp.maxTwilightPoints=p.parseUShort();maxp.maxStorage=p.parseUShort();maxp.maxFunctionDefs=p.parseUShort();maxp.maxInstructionDefs=p.parseUShort();maxp.maxStackElements=p.parseUShort();maxp.maxSizeOfInstructions=p.parseUShort();maxp.maxComponentElements=p.parseUShort();maxp.maxComponentDepth=p.parseUShort();}
return maxp;}
function makeMaxpTable(numGlyphs){return new table.Table('maxp',[{name:'version',type:'FIXED',value:0x00005000},{name:'numGlyphs',type:'USHORT',value:numGlyphs}]);}
var maxp={parse:parseMaxpTable,make:makeMaxpTable};var nameTableNames=['copyright','fontFamily','fontSubfamily','uniqueID','fullName','version','postScriptName','trademark','manufacturer','designer','description','manufacturerURL','designerURL','license','licenseURL','reserved','preferredFamily','preferredSubfamily','compatibleFullName','sampleText','postScriptFindFontName','wwsFamily','wwsSubfamily'];var macLanguages={0:'en',1:'fr',2:'de',3:'it',4:'nl',5:'sv',6:'es',7:'da',8:'pt',9:'no',10:'he',11:'ja',12:'ar',13:'fi',14:'el',15:'is',16:'mt',17:'tr',18:'hr',19:'zh-Hant',20:'ur',21:'hi',22:'th',23:'ko',24:'lt',25:'pl',26:'hu',27:'es',28:'lv',29:'se',30:'fo',31:'fa',32:'ru',33:'zh',34:'nl-BE',35:'ga',36:'sq',37:'ro',38:'cz',39:'sk',40:'si',41:'yi',42:'sr',43:'mk',44:'bg',45:'uk',46:'be',47:'uz',48:'kk',49:'az-Cyrl',50:'az-Arab',51:'hy',52:'ka',53:'mo',54:'ky',55:'tg',56:'tk',57:'mn-CN',58:'mn',59:'ps',60:'ks',61:'ku',62:'sd',63:'bo',64:'ne',65:'sa',66:'mr',67:'bn',68:'as',69:'gu',70:'pa',71:'or',72:'ml',73:'kn',74:'ta',75:'te',76:'si',77:'my',78:'km',79:'lo',80:'vi',81:'id',82:'tl',83:'ms',84:'ms-Arab',85:'am',86:'ti',87:'om',88:'so',89:'sw',90:'rw',91:'rn',92:'ny',93:'mg',94:'eo',128:'cy',129:'eu',130:'ca',131:'la',132:'qu',133:'gn',134:'ay',135:'tt',136:'ug',137:'dz',138:'jv',139:'su',140:'gl',141:'af',142:'br',143:'iu',144:'gd',145:'gv',146:'ga',147:'to',148:'el-polyton',149:'kl',150:'az',151:'nn'};var macLanguageToScript={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0};var windowsLanguages={0x0436:'af',0x041C:'sq',0x0484:'gsw',0x045E:'am',0x1401:'ar-DZ',0x3C01:'ar-BH',0x0C01:'ar',0x0801:'ar-IQ',0x2C01:'ar-JO',0x3401:'ar-KW',0x3001:'ar-LB',0x1001:'ar-LY',0x1801:'ary',0x2001:'ar-OM',0x4001:'ar-QA',0x0401:'ar-SA',0x2801:'ar-SY',0x1C01:'aeb',0x3801:'ar-AE',0x2401:'ar-YE',0x042B:'hy',0x044D:'as',0x082C:'az-Cyrl',0x042C:'az',0x046D:'ba',0x042D:'eu',0x0423:'be',0x0845:'bn',0x0445:'bn-IN',0x201A:'bs-Cyrl',0x141A:'bs',0x047E:'br',0x0402:'bg',0x0403:'ca',0x0C04:'zh-HK',0x1404:'zh-MO',0x0804:'zh',0x1004:'zh-SG',0x0404:'zh-TW',0x0483:'co',0x041A:'hr',0x101A:'hr-BA',0x0405:'cs',0x0406:'da',0x048C:'prs',0x0465:'dv',0x0813:'nl-BE',0x0413:'nl',0x0C09:'en-AU',0x2809:'en-BZ',0x1009:'en-CA',0x2409:'en-029',0x4009:'en-IN',0x1809:'en-IE',0x2009:'en-JM',0x4409:'en-MY',0x1409:'en-NZ',0x3409:'en-PH',0x4809:'en-SG',0x1C09:'en-ZA',0x2C09:'en-TT',0x0809:'en-GB',0x0409:'en',0x3009:'en-ZW',0x0425:'et',0x0438:'fo',0x0464:'fil',0x040B:'fi',0x080C:'fr-BE',0x0C0C:'fr-CA',0x040C:'fr',0x140C:'fr-LU',0x180C:'fr-MC',0x100C:'fr-CH',0x0462:'fy',0x0456:'gl',0x0437:'ka',0x0C07:'de-AT',0x0407:'de',0x1407:'de-LI',0x1007:'de-LU',0x0807:'de-CH',0x0408:'el',0x046F:'kl',0x0447:'gu',0x0468:'ha',0x040D:'he',0x0439:'hi',0x040E:'hu',0x040F:'is',0x0470:'ig',0x0421:'id',0x045D:'iu',0x085D:'iu-Latn',0x083C:'ga',0x0434:'xh',0x0435:'zu',0x0410:'it',0x0810:'it-CH',0x0411:'ja',0x044B:'kn',0x043F:'kk',0x0453:'km',0x0486:'quc',0x0487:'rw',0x0441:'sw',0x0457:'kok',0x0412:'ko',0x0440:'ky',0x0454:'lo',0x0426:'lv',0x0427:'lt',0x082E:'dsb',0x046E:'lb',0x042F:'mk',0x083E:'ms-BN',0x043E:'ms',0x044C:'ml',0x043A:'mt',0x0481:'mi',0x047A:'arn',0x044E:'mr',0x047C:'moh',0x0450:'mn',0x0850:'mn-CN',0x0461:'ne',0x0414:'nb',0x0814:'nn',0x0482:'oc',0x0448:'or',0x0463:'ps',0x0415:'pl',0x0416:'pt',0x0816:'pt-PT',0x0446:'pa',0x046B:'qu-BO',0x086B:'qu-EC',0x0C6B:'qu',0x0418:'ro',0x0417:'rm',0x0419:'ru',0x243B:'smn',0x103B:'smj-NO',0x143B:'smj',0x0C3B:'se-FI',0x043B:'se',0x083B:'se-SE',0x203B:'sms',0x183B:'sma-NO',0x1C3B:'sms',0x044F:'sa',0x1C1A:'sr-Cyrl-BA',0x0C1A:'sr',0x181A:'sr-Latn-BA',0x081A:'sr-Latn',0x046C:'nso',0x0432:'tn',0x045B:'si',0x041B:'sk',0x0424:'sl',0x2C0A:'es-AR',0x400A:'es-BO',0x340A:'es-CL',0x240A:'es-CO',0x140A:'es-CR',0x1C0A:'es-DO',0x300A:'es-EC',0x440A:'es-SV',0x100A:'es-GT',0x480A:'es-HN',0x080A:'es-MX',0x4C0A:'es-NI',0x180A:'es-PA',0x3C0A:'es-PY',0x280A:'es-PE',0x500A:'es-PR',0x0C0A:'es',0x040A:'es',0x540A:'es-US',0x380A:'es-UY',0x200A:'es-VE',0x081D:'sv-FI',0x041D:'sv',0x045A:'syr',0x0428:'tg',0x085F:'tzm',0x0449:'ta',0x0444:'tt',0x044A:'te',0x041E:'th',0x0451:'bo',0x041F:'tr',0x0442:'tk',0x0480:'ug',0x0422:'uk',0x042E:'hsb',0x0420:'ur',0x0843:'uz-Cyrl',0x0443:'uz',0x042A:'vi',0x0452:'cy',0x0488:'wo',0x0485:'sah',0x0478:'ii',0x046A:'yo'};function getLanguageCode(platformID,languageID,ltag){switch(platformID){case 0:if(languageID===0xFFFF){return'und';}else if(ltag){return ltag[languageID];}
break;case 1:return macLanguages[languageID];case 3:return windowsLanguages[languageID];}
return undefined;}
var utf16='utf-16';var macScriptEncodings={0:'macintosh',1:'x-mac-japanese',2:'x-mac-chinesetrad',3:'x-mac-korean',6:'x-mac-greek',7:'x-mac-cyrillic',9:'x-mac-devanagai',10:'x-mac-gurmukhi',11:'x-mac-gujarati',12:'x-mac-oriya',13:'x-mac-bengali',14:'x-mac-tamil',15:'x-mac-telugu',16:'x-mac-kannada',17:'x-mac-malayalam',18:'x-mac-sinhalese',19:'x-mac-burmese',20:'x-mac-khmer',21:'x-mac-thai',22:'x-mac-lao',23:'x-mac-georgian',24:'x-mac-armenian',25:'x-mac-chinesesimp',26:'x-mac-tibetan',27:'x-mac-mongolian',28:'x-mac-ethiopic',29:'x-mac-ce',30:'x-mac-vietnamese',31:'x-mac-extarabic'};var macLanguageEncodings={15:'x-mac-icelandic',17:'x-mac-turkish',18:'x-mac-croatian',24:'x-mac-ce',25:'x-mac-ce',26:'x-mac-ce',27:'x-mac-ce',28:'x-mac-ce',30:'x-mac-icelandic',37:'x-mac-romanian',38:'x-mac-ce',39:'x-mac-ce',40:'x-mac-ce',143:'x-mac-inuit',146:'x-mac-gaelic'};function getEncoding(platformID,encodingID,languageID){switch(platformID){case 0:return utf16;case 1:return macLanguageEncodings[languageID]||macScriptEncodings[encodingID];case 3:if(encodingID===1||encodingID===10){return utf16;}
break;}
return undefined;}
function parseNameTable(data,start,ltag){var name={};var p=new parse.Parser(data,start);var format=p.parseUShort();var count=p.parseUShort();var stringOffset=p.offset+p.parseUShort();for(var i=0;i<count;i++){var platformID=p.parseUShort();var encodingID=p.parseUShort();var languageID=p.parseUShort();var nameID=p.parseUShort();var property=nameTableNames[nameID]||nameID;var byteLength=p.parseUShort();var offset=p.parseUShort();var language=getLanguageCode(platformID,languageID,ltag);var encoding=getEncoding(platformID,encodingID,languageID);if(encoding!==undefined&&language!==undefined){var text=(void 0);if(encoding===utf16){text=decode.UTF16(data,stringOffset+offset,byteLength);}else{text=decode.MACSTRING(data,stringOffset+offset,byteLength,encoding);}
if(text){var translations=name[property];if(translations===undefined){translations=name[property]={};}
translations[language]=text;}}}
var langTagCount=0;if(format===1){langTagCount=p.parseUShort();}
return name;}
function reverseDict(dict){var result={};for(var key in dict){result[dict[key]]=parseInt(key);}
return result;}
function makeNameRecord(platformID,encodingID,languageID,nameID,length,offset){return new table.Record('NameRecord',[{name:'platformID',type:'USHORT',value:platformID},{name:'encodingID',type:'USHORT',value:encodingID},{name:'languageID',type:'USHORT',value:languageID},{name:'nameID',type:'USHORT',value:nameID},{name:'length',type:'USHORT',value:length},{name:'offset',type:'USHORT',value:offset}]);}
function findSubArray(needle,haystack){var needleLength=needle.length;var limit=haystack.length-needleLength+1;loop:for(var pos=0;pos<limit;pos++){for(;pos<limit;pos++){for(var k=0;k<needleLength;k++){if(haystack[pos+k]!==needle[k]){continue loop;}}
return pos;}}
return-1;}
function addStringToPool(s,pool){var offset=findSubArray(s,pool);if(offset<0){offset=pool.length;var i=0;var len=s.length;for(;i<len;++i){pool.push(s[i]);}}
return offset;}
function makeNameTable(names,ltag){var nameID;var nameIDs=[];var namesWithNumericKeys={};var nameTableIds=reverseDict(nameTableNames);for(var key in names){var id=nameTableIds[key];if(id===undefined){id=key;}
nameID=parseInt(id);if(isNaN(nameID)){throw new Error('Name table entry "'+key+'" does not exist, see nameTableNames for complete list.');}
namesWithNumericKeys[nameID]=names[key];nameIDs.push(nameID);}
var macLanguageIds=reverseDict(macLanguages);var windowsLanguageIds=reverseDict(windowsLanguages);var nameRecords=[];var stringPool=[];for(var i=0;i<nameIDs.length;i++){nameID=nameIDs[i];var translations=namesWithNumericKeys[nameID];for(var lang in translations){var text=translations[lang];var macPlatform=1;var macLanguage=macLanguageIds[lang];var macScript=macLanguageToScript[macLanguage];var macEncoding=getEncoding(macPlatform,macScript,macLanguage);var macName=encode.MACSTRING(text,macEncoding);if(macName===undefined){macPlatform=0;macLanguage=ltag.indexOf(lang);if(macLanguage<0){macLanguage=ltag.length;ltag.push(lang);}
macScript=4;macName=encode.UTF16(text);}
var macNameOffset=addStringToPool(macName,stringPool);nameRecords.push(makeNameRecord(macPlatform,macScript,macLanguage,nameID,macName.length,macNameOffset));var winLanguage=windowsLanguageIds[lang];if(winLanguage!==undefined){var winName=encode.UTF16(text);var winNameOffset=addStringToPool(winName,stringPool);nameRecords.push(makeNameRecord(3,1,winLanguage,nameID,winName.length,winNameOffset));}}}
nameRecords.sort(function(a,b){return((a.platformID-b.platformID)||(a.encodingID-b.encodingID)||(a.languageID-b.languageID)||(a.nameID-b.nameID));});var t=new table.Table('name',[{name:'format',type:'USHORT',value:0},{name:'count',type:'USHORT',value:nameRecords.length},{name:'stringOffset',type:'USHORT',value:6+nameRecords.length*12}]);for(var r=0;r<nameRecords.length;r++){t.fields.push({name:'record_'+r,type:'RECORD',value:nameRecords[r]});}
t.fields.push({name:'strings',type:'LITERAL',value:stringPool});return t;}
var _name={parse:parseNameTable,make:makeNameTable};var unicodeRanges=[{begin:0x0000,end:0x007F},{begin:0x0080,end:0x00FF},{begin:0x0100,end:0x017F},{begin:0x0180,end:0x024F},{begin:0x0250,end:0x02AF},{begin:0x02B0,end:0x02FF},{begin:0x0300,end:0x036F},{begin:0x0370,end:0x03FF},{begin:0x2C80,end:0x2CFF},{begin:0x0400,end:0x04FF},{begin:0x0530,end:0x058F},{begin:0x0590,end:0x05FF},{begin:0xA500,end:0xA63F},{begin:0x0600,end:0x06FF},{begin:0x07C0,end:0x07FF},{begin:0x0900,end:0x097F},{begin:0x0980,end:0x09FF},{begin:0x0A00,end:0x0A7F},{begin:0x0A80,end:0x0AFF},{begin:0x0B00,end:0x0B7F},{begin:0x0B80,end:0x0BFF},{begin:0x0C00,end:0x0C7F},{begin:0x0C80,end:0x0CFF},{begin:0x0D00,end:0x0D7F},{begin:0x0E00,end:0x0E7F},{begin:0x0E80,end:0x0EFF},{begin:0x10A0,end:0x10FF},{begin:0x1B00,end:0x1B7F},{begin:0x1100,end:0x11FF},{begin:0x1E00,end:0x1EFF},{begin:0x1F00,end:0x1FFF},{begin:0x2000,end:0x206F},{begin:0x2070,end:0x209F},{begin:0x20A0,end:0x20CF},{begin:0x20D0,end:0x20FF},{begin:0x2100,end:0x214F},{begin:0x2150,end:0x218F},{begin:0x2190,end:0x21FF},{begin:0x2200,end:0x22FF},{begin:0x2300,end:0x23FF},{begin:0x2400,end:0x243F},{begin:0x2440,end:0x245F},{begin:0x2460,end:0x24FF},{begin:0x2500,end:0x257F},{begin:0x2580,end:0x259F},{begin:0x25A0,end:0x25FF},{begin:0x2600,end:0x26FF},{begin:0x2700,end:0x27BF},{begin:0x3000,end:0x303F},{begin:0x3040,end:0x309F},{begin:0x30A0,end:0x30FF},{begin:0x3100,end:0x312F},{begin:0x3130,end:0x318F},{begin:0xA840,end:0xA87F},{begin:0x3200,end:0x32FF},{begin:0x3300,end:0x33FF},{begin:0xAC00,end:0xD7AF},{begin:0xD800,end:0xDFFF},{begin:0x10900,end:0x1091F},{begin:0x4E00,end:0x9FFF},{begin:0xE000,end:0xF8FF},{begin:0x31C0,end:0x31EF},{begin:0xFB00,end:0xFB4F},{begin:0xFB50,end:0xFDFF},{begin:0xFE20,end:0xFE2F},{begin:0xFE10,end:0xFE1F},{begin:0xFE50,end:0xFE6F},{begin:0xFE70,end:0xFEFF},{begin:0xFF00,end:0xFFEF},{begin:0xFFF0,end:0xFFFF},{begin:0x0F00,end:0x0FFF},{begin:0x0700,end:0x074F},{begin:0x0780,end:0x07BF},{begin:0x0D80,end:0x0DFF},{begin:0x1000,end:0x109F},{begin:0x1200,end:0x137F},{begin:0x13A0,end:0x13FF},{begin:0x1400,end:0x167F},{begin:0x1680,end:0x169F},{begin:0x16A0,end:0x16FF},{begin:0x1780,end:0x17FF},{begin:0x1800,end:0x18AF},{begin:0x2800,end:0x28FF},{begin:0xA000,end:0xA48F},{begin:0x1700,end:0x171F},{begin:0x10300,end:0x1032F},{begin:0x10330,end:0x1034F},{begin:0x10400,end:0x1044F},{begin:0x1D000,end:0x1D0FF},{begin:0x1D400,end:0x1D7FF},{begin:0xFF000,end:0xFFFFD},{begin:0xFE00,end:0xFE0F},{begin:0xE0000,end:0xE007F},{begin:0x1900,end:0x194F},{begin:0x1950,end:0x197F},{begin:0x1980,end:0x19DF},{begin:0x1A00,end:0x1A1F},{begin:0x2C00,end:0x2C5F},{begin:0x2D30,end:0x2D7F},{begin:0x4DC0,end:0x4DFF},{begin:0xA800,end:0xA82F},{begin:0x10000,end:0x1007F},{begin:0x10140,end:0x1018F},{begin:0x10380,end:0x1039F},{begin:0x103A0,end:0x103DF},{begin:0x10450,end:0x1047F},{begin:0x10480,end:0x104AF},{begin:0x10800,end:0x1083F},{begin:0x10A00,end:0x10A5F},{begin:0x1D300,end:0x1D35F},{begin:0x12000,end:0x123FF},{begin:0x1D360,end:0x1D37F},{begin:0x1B80,end:0x1BBF},{begin:0x1C00,end:0x1C4F},{begin:0x1C50,end:0x1C7F},{begin:0xA880,end:0xA8DF},{begin:0xA900,end:0xA92F},{begin:0xA930,end:0xA95F},{begin:0xAA00,end:0xAA5F},{begin:0x10190,end:0x101CF},{begin:0x101D0,end:0x101FF},{begin:0x102A0,end:0x102DF},{begin:0x1F030,end:0x1F09F}];function getUnicodeRange(unicode){for(var i=0;i<unicodeRanges.length;i+=1){var range=unicodeRanges[i];if(unicode>=range.begin&&unicode<range.end){return i;}}
return-1;}
function parseOS2Table(data,start){var os2={};var p=new parse.Parser(data,start);os2.version=p.parseUShort();os2.xAvgCharWidth=p.parseShort();os2.usWeightClass=p.parseUShort();os2.usWidthClass=p.parseUShort();os2.fsType=p.parseUShort();os2.ySubscriptXSize=p.parseShort();os2.ySubscriptYSize=p.parseShort();os2.ySubscriptXOffset=p.parseShort();os2.ySubscriptYOffset=p.parseShort();os2.ySuperscriptXSize=p.parseShort();os2.ySuperscriptYSize=p.parseShort();os2.ySuperscriptXOffset=p.parseShort();os2.ySuperscriptYOffset=p.parseShort();os2.yStrikeoutSize=p.parseShort();os2.yStrikeoutPosition=p.parseShort();os2.sFamilyClass=p.parseShort();os2.panose=[];for(var i=0;i<10;i++){os2.panose[i]=p.parseByte();}
os2.ulUnicodeRange1=p.parseULong();os2.ulUnicodeRange2=p.parseULong();os2.ulUnicodeRange3=p.parseULong();os2.ulUnicodeRange4=p.parseULong();os2.achVendID=String.fromCharCode(p.parseByte(),p.parseByte(),p.parseByte(),p.parseByte());os2.fsSelection=p.parseUShort();os2.usFirstCharIndex=p.parseUShort();os2.usLastCharIndex=p.parseUShort();os2.sTypoAscender=p.parseShort();os2.sTypoDescender=p.parseShort();os2.sTypoLineGap=p.parseShort();os2.usWinAscent=p.parseUShort();os2.usWinDescent=p.parseUShort();if(os2.version>=1){os2.ulCodePageRange1=p.parseULong();os2.ulCodePageRange2=p.parseULong();}
if(os2.version>=2){os2.sxHeight=p.parseShort();os2.sCapHeight=p.parseShort();os2.usDefaultChar=p.parseUShort();os2.usBreakChar=p.parseUShort();os2.usMaxContent=p.parseUShort();}
return os2;}
function makeOS2Table(options){return new table.Table('OS/2',[{name:'version',type:'USHORT',value:0x0003},{name:'xAvgCharWidth',type:'SHORT',value:0},{name:'usWeightClass',type:'USHORT',value:0},{name:'usWidthClass',type:'USHORT',value:0},{name:'fsType',type:'USHORT',value:0},{name:'ySubscriptXSize',type:'SHORT',value:650},{name:'ySubscriptYSize',type:'SHORT',value:699},{name:'ySubscriptXOffset',type:'SHORT',value:0},{name:'ySubscriptYOffset',type:'SHORT',value:140},{name:'ySuperscriptXSize',type:'SHORT',value:650},{name:'ySuperscriptYSize',type:'SHORT',value:699},{name:'ySuperscriptXOffset',type:'SHORT',value:0},{name:'ySuperscriptYOffset',type:'SHORT',value:479},{name:'yStrikeoutSize',type:'SHORT',value:49},{name:'yStrikeoutPosition',type:'SHORT',value:258},{name:'sFamilyClass',type:'SHORT',value:0},{name:'bFamilyType',type:'BYTE',value:0},{name:'bSerifStyle',type:'BYTE',value:0},{name:'bWeight',type:'BYTE',value:0},{name:'bProportion',type:'BYTE',value:0},{name:'bContrast',type:'BYTE',value:0},{name:'bStrokeVariation',type:'BYTE',value:0},{name:'bArmStyle',type:'BYTE',value:0},{name:'bLetterform',type:'BYTE',value:0},{name:'bMidline',type:'BYTE',value:0},{name:'bXHeight',type:'BYTE',value:0},{name:'ulUnicodeRange1',type:'ULONG',value:0},{name:'ulUnicodeRange2',type:'ULONG',value:0},{name:'ulUnicodeRange3',type:'ULONG',value:0},{name:'ulUnicodeRange4',type:'ULONG',value:0},{name:'achVendID',type:'CHARARRAY',value:'XXXX'},{name:'fsSelection',type:'USHORT',value:0},{name:'usFirstCharIndex',type:'USHORT',value:0},{name:'usLastCharIndex',type:'USHORT',value:0},{name:'sTypoAscender',type:'SHORT',value:0},{name:'sTypoDescender',type:'SHORT',value:0},{name:'sTypoLineGap',type:'SHORT',value:0},{name:'usWinAscent',type:'USHORT',value:0},{name:'usWinDescent',type:'USHORT',value:0},{name:'ulCodePageRange1',type:'ULONG',value:0},{name:'ulCodePageRange2',type:'ULONG',value:0},{name:'sxHeight',type:'SHORT',value:0},{name:'sCapHeight',type:'SHORT',value:0},{name:'usDefaultChar',type:'USHORT',value:0},{name:'usBreakChar',type:'USHORT',value:0},{name:'usMaxContext',type:'USHORT',value:0}],options);}
var os2={parse:parseOS2Table,make:makeOS2Table,unicodeRanges:unicodeRanges,getUnicodeRange:getUnicodeRange};function parsePostTable(data,start){var post={};var p=new parse.Parser(data,start);post.version=p.parseVersion();post.italicAngle=p.parseFixed();post.underlinePosition=p.parseShort();post.underlineThickness=p.parseShort();post.isFixedPitch=p.parseULong();post.minMemType42=p.parseULong();post.maxMemType42=p.parseULong();post.minMemType1=p.parseULong();post.maxMemType1=p.parseULong();switch(post.version){case 1:post.names=standardNames.slice();break;case 2:post.numberOfGlyphs=p.parseUShort();post.glyphNameIndex=new Array(post.numberOfGlyphs);for(var i=0;i<post.numberOfGlyphs;i++){post.glyphNameIndex[i]=p.parseUShort();}
post.names=[];for(var i$1=0;i$1<post.numberOfGlyphs;i$1++){if(post.glyphNameIndex[i$1]>=standardNames.length){var nameLength=p.parseChar();post.names.push(p.parseString(nameLength));}}
break;case 2.5:post.numberOfGlyphs=p.parseUShort();post.offset=new Array(post.numberOfGlyphs);for(var i$2=0;i$2<post.numberOfGlyphs;i$2++){post.offset[i$2]=p.parseChar();}
break;}
return post;}
function makePostTable(){return new table.Table('post',[{name:'version',type:'FIXED',value:0x00030000},{name:'italicAngle',type:'FIXED',value:0},{name:'underlinePosition',type:'FWORD',value:0},{name:'underlineThickness',type:'FWORD',value:0},{name:'isFixedPitch',type:'ULONG',value:0},{name:'minMemType42',type:'ULONG',value:0},{name:'maxMemType42',type:'ULONG',value:0},{name:'minMemType1',type:'ULONG',value:0},{name:'maxMemType1',type:'ULONG',value:0}]);}
var post={parse:parsePostTable,make:makePostTable};var subtableParsers=new Array(9);subtableParsers[1]=function parseLookup1(){var start=this.offset+this.relativeOffset;var substFormat=this.parseUShort();if(substFormat===1){return{substFormat:1,coverage:this.parsePointer(Parser.coverage),deltaGlyphId:this.parseUShort()};}else if(substFormat===2){return{substFormat:2,coverage:this.parsePointer(Parser.coverage),substitute:this.parseOffset16List()};}
check.assert(false,'0x'+start.toString(16)+': lookup type 1 format must be 1 or 2.');};subtableParsers[2]=function parseLookup2(){var substFormat=this.parseUShort();check.argument(substFormat===1,'GSUB Multiple Substitution Subtable identifier-format must be 1');return{substFormat:substFormat,coverage:this.parsePointer(Parser.coverage),sequences:this.parseListOfLists()};};subtableParsers[3]=function parseLookup3(){var substFormat=this.parseUShort();check.argument(substFormat===1,'GSUB Alternate Substitution Subtable identifier-format must be 1');return{substFormat:substFormat,coverage:this.parsePointer(Parser.coverage),alternateSets:this.parseListOfLists()};};subtableParsers[4]=function parseLookup4(){var substFormat=this.parseUShort();check.argument(substFormat===1,'GSUB ligature table identifier-format must be 1');return{substFormat:substFormat,coverage:this.parsePointer(Parser.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)};})};};var lookupRecordDesc={sequenceIndex:Parser.uShort,lookupListIndex:Parser.uShort};subtableParsers[5]=function parseLookup5(){var start=this.offset+this.relativeOffset;var substFormat=this.parseUShort();if(substFormat===1){return{substFormat:substFormat,coverage:this.parsePointer(Parser.coverage),ruleSets:this.parseListOfLists(function(){var glyphCount=this.parseUShort();var substCount=this.parseUShort();return{input:this.parseUShortList(glyphCount-1),lookupRecords:this.parseRecordList(substCount,lookupRecordDesc)};})};}else if(substFormat===2){return{substFormat:substFormat,coverage:this.parsePointer(Parser.coverage),classDef:this.parsePointer(Parser.classDef),classSets:this.parseListOfLists(function(){var glyphCount=this.parseUShort();var substCount=this.parseUShort();return{classes:this.parseUShortList(glyphCount-1),lookupRecords:this.parseRecordList(substCount,lookupRecordDesc)};})};}else if(substFormat===3){var glyphCount=this.parseUShort();var substCount=this.parseUShort();return{substFormat:substFormat,coverages:this.parseList(glyphCount,Parser.pointer(Parser.coverage)),lookupRecords:this.parseRecordList(substCount,lookupRecordDesc)};}
check.assert(false,'0x'+start.toString(16)+': lookup type 5 format must be 1, 2 or 3.');};subtableParsers[6]=function parseLookup6(){var start=this.offset+this.relativeOffset;var substFormat=this.parseUShort();if(substFormat===1){return{substFormat:1,coverage:this.parsePointer(Parser.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(lookupRecordDesc)};})};}else if(substFormat===2){return{substFormat:2,coverage:this.parsePointer(Parser.coverage),backtrackClassDef:this.parsePointer(Parser.classDef),inputClassDef:this.parsePointer(Parser.classDef),lookaheadClassDef:this.parsePointer(Parser.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(lookupRecordDesc)};})};}else if(substFormat===3){return{substFormat:3,backtrackCoverage:this.parseList(Parser.pointer(Parser.coverage)),inputCoverage:this.parseList(Parser.pointer(Parser.coverage)),lookaheadCoverage:this.parseList(Parser.pointer(Parser.coverage)),lookupRecords:this.parseRecordList(lookupRecordDesc)};}
check.assert(false,'0x'+start.toString(16)+': lookup type 6 format must be 1, 2 or 3.');};subtableParsers[7]=function parseLookup7(){var substFormat=this.parseUShort();check.argument(substFormat===1,'GSUB Extension Substitution subtable identifier-format must be 1');var extensionLookupType=this.parseUShort();var extensionParser=new Parser(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:extensionLookupType,extension:subtableParsers[extensionLookupType].call(extensionParser)};};subtableParsers[8]=function parseLookup8(){var substFormat=this.parseUShort();check.argument(substFormat===1,'GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1');return{substFormat:substFormat,coverage:this.parsePointer(Parser.coverage),backtrackCoverage:this.parseList(Parser.pointer(Parser.coverage)),lookaheadCoverage:this.parseList(Parser.pointer(Parser.coverage)),substitutes:this.parseUShortList()};};function parseGsubTable(data,start){start=start||0;var p=new Parser(data,start);var tableVersion=p.parseVersion(1);check.argument(tableVersion===1||tableVersion===1.1,'Unsupported GSUB table version.');if(tableVersion===1){return{version:tableVersion,scripts:p.parseScriptList(),features:p.parseFeatureList(),lookups:p.parseLookupList(subtableParsers)};}else{return{version:tableVersion,scripts:p.parseScriptList(),features:p.parseFeatureList(),lookups:p.parseLookupList(subtableParsers),variations:p.parseFeatureVariationsList()};}}
var subtableMakers=new Array(9);subtableMakers[1]=function makeLookup1(subtable){if(subtable.substFormat===1){return new table.Table('substitutionTable',[{name:'substFormat',type:'USHORT',value:1},{name:'coverage',type:'TABLE',value:new table.Coverage(subtable.coverage)},{name:'deltaGlyphID',type:'USHORT',value:subtable.deltaGlyphId}]);}else{return new table.Table('substitutionTable',[{name:'substFormat',type:'USHORT',value:2},{name:'coverage',type:'TABLE',value:new table.Coverage(subtable.coverage)}].concat(table.ushortList('substitute',subtable.substitute)));}
check.fail('Lookup type 1 substFormat must be 1 or 2.');};subtableMakers[3]=function makeLookup3(subtable){check.assert(subtable.substFormat===1,'Lookup type 3 substFormat must be 1.');return new table.Table('substitutionTable',[{name:'substFormat',type:'USHORT',value:1},{name:'coverage',type:'TABLE',value:new table.Coverage(subtable.coverage)}].concat(table.tableList('altSet',subtable.alternateSets,function(alternateSet){return new table.Table('alternateSetTable',table.ushortList('alternate',alternateSet));})));};subtableMakers[4]=function makeLookup4(subtable){check.assert(subtable.substFormat===1,'Lookup type 4 substFormat must be 1.');return new table.Table('substitutionTable',[{name:'substFormat',type:'USHORT',value:1},{name:'coverage',type:'TABLE',value:new table.Coverage(subtable.coverage)}].concat(table.tableList('ligSet',subtable.ligatureSets,function(ligatureSet){return new table.Table('ligatureSetTable',table.tableList('ligature',ligatureSet,function(ligature){return new table.Table('ligatureTable',[{name:'ligGlyph',type:'USHORT',value:ligature.ligGlyph}].concat(table.ushortList('component',ligature.components,ligature.components.length+1)));}));})));};function makeGsubTable(gsub){return new table.Table('GSUB',[{name:'version',type:'ULONG',value:0x10000},{name:'scripts',type:'TABLE',value:new table.ScriptList(gsub.scripts)},{name:'features',type:'TABLE',value:new table.FeatureList(gsub.features)},{name:'lookups',type:'TABLE',value:new table.LookupList(gsub.lookups,subtableMakers)}]);}
var gsub={parse:parseGsubTable,make:makeGsubTable};function parseMetaTable(data,start){var p=new parse.Parser(data,start);var tableVersion=p.parseULong();check.argument(tableVersion===1,'Unsupported META table version.');p.parseULong();p.parseULong();var numDataMaps=p.parseULong();var tags={};for(var i=0;i<numDataMaps;i++){var tag=p.parseTag();var dataOffset=p.parseULong();var dataLength=p.parseULong();var text=decode.UTF8(data,start+dataOffset,dataLength);tags[tag]=text;}
return tags;}
function makeMetaTable(tags){var numTags=Object.keys(tags).length;var stringPool='';var stringPoolOffset=16+numTags*12;var result=new table.Table('meta',[{name:'version',type:'ULONG',value:1},{name:'flags',type:'ULONG',value:0},{name:'offset',type:'ULONG',value:stringPoolOffset},{name:'numTags',type:'ULONG',value:numTags}]);for(var tag in tags){var pos=stringPool.length;stringPool+=tags[tag];result.fields.push({name:'tag '+tag,type:'TAG',value:tag});result.fields.push({name:'offset '+tag,type:'ULONG',value:stringPoolOffset+pos});result.fields.push({name:'length '+tag,type:'ULONG',value:tags[tag].length});}
result.fields.push({name:'stringPool',type:'CHARARRAY',value:stringPool});return result;}
var meta={parse:parseMetaTable,make:makeMetaTable};function log2(v){return Math.log(v)/Math.log(2)|0;}
function computeCheckSum(bytes){while(bytes.length%4!==0){bytes.push(0);}
var sum=0;for(var i=0;i<bytes.length;i+=4){sum+=(bytes[i]<<24)+
(bytes[i+1]<<16)+
(bytes[i+2]<<8)+
(bytes[i+3]);}
sum%=Math.pow(2,32);return sum;}
function makeTableRecord(tag,checkSum,offset,length){return new table.Record('Table Record',[{name:'tag',type:'TAG',value:tag!==undefined?tag:''},{name:'checkSum',type:'ULONG',value:checkSum!==undefined?checkSum:0},{name:'offset',type:'ULONG',value:offset!==undefined?offset:0},{name:'length',type:'ULONG',value:length!==undefined?length:0}]);}
function makeSfntTable(tables){var sfnt=new table.Table('sfnt',[{name:'version',type:'TAG',value:'OTTO'},{name:'numTables',type:'USHORT',value:0},{name:'searchRange',type:'USHORT',value:0},{name:'entrySelector',type:'USHORT',value:0},{name:'rangeShift',type:'USHORT',value:0}]);sfnt.tables=tables;sfnt.numTables=tables.length;var highestPowerOf2=Math.pow(2,log2(sfnt.numTables));sfnt.searchRange=16*highestPowerOf2;sfnt.entrySelector=log2(highestPowerOf2);sfnt.rangeShift=sfnt.numTables*16-sfnt.searchRange;var recordFields=[];var tableFields=[];var offset=sfnt.sizeOf()+(makeTableRecord().sizeOf()*sfnt.numTables);while(offset%4!==0){offset+=1;tableFields.push({name:'padding',type:'BYTE',value:0});}
for(var i=0;i<tables.length;i+=1){var t=tables[i];check.argument(t.tableName.length===4,'Table name'+t.tableName+' is invalid.');var tableLength=t.sizeOf();var tableRecord=makeTableRecord(t.tableName,computeCheckSum(t.encode()),offset,tableLength);recordFields.push({name:tableRecord.tag+' Table Record',type:'RECORD',value:tableRecord});tableFields.push({name:t.tableName+' table',type:'RECORD',value:t});offset+=tableLength;check.argument(!isNaN(offset),'Something went wrong calculating the offset.');while(offset%4!==0){offset+=1;tableFields.push({name:'padding',type:'BYTE',value:0});}}
recordFields.sort(function(r1,r2){if(r1.value.tag>r2.value.tag){return 1;}else{return-1;}});sfnt.fields=sfnt.fields.concat(recordFields);sfnt.fields=sfnt.fields.concat(tableFields);return sfnt;}
function metricsForChar(font,chars,notFoundMetrics){for(var i=0;i<chars.length;i+=1){var glyphIndex=font.charToGlyphIndex(chars[i]);if(glyphIndex>0){var glyph=font.glyphs.get(glyphIndex);return glyph.getMetrics();}}
return notFoundMetrics;}
function average(vs){var sum=0;for(var i=0;i<vs.length;i+=1){sum+=vs[i];}
return sum/vs.length;}
function fontToSfntTable(font){var xMins=[];var yMins=[];var xMaxs=[];var yMaxs=[];var advanceWidths=[];var leftSideBearings=[];var rightSideBearings=[];var firstCharIndex;var lastCharIndex=0;var ulUnicodeRange1=0;var ulUnicodeRange2=0;var ulUnicodeRange3=0;var ulUnicodeRange4=0;for(var i=0;i<font.glyphs.length;i+=1){var glyph=font.glyphs.get(i);var unicode=glyph.unicode|0;if(isNaN(glyph.advanceWidth)){throw new Error('Glyph '+glyph.name+' ('+i+'): advanceWidth is not a number.');}
if(firstCharIndex>unicode||firstCharIndex===undefined){if(unicode>0){firstCharIndex=unicode;}}
if(lastCharIndex<unicode){lastCharIndex=unicode;}
var position=os2.getUnicodeRange(unicode);if(position<32){ulUnicodeRange1|=1<<position;}else if(position<64){ulUnicodeRange2|=1<<position-32;}else if(position<96){ulUnicodeRange3|=1<<position-64;}else if(position<123){ulUnicodeRange4|=1<<position-96;}else{throw new Error('Unicode ranges bits > 123 are reserved for internal usage');}
if(glyph.name==='.notdef'){continue;}
var metrics=glyph.getMetrics();xMins.push(metrics.xMin);yMins.push(metrics.yMin);xMaxs.push(metrics.xMax);yMaxs.push(metrics.yMax);leftSideBearings.push(metrics.leftSideBearing);rightSideBearings.push(metrics.rightSideBearing);advanceWidths.push(glyph.advanceWidth);}
var globals={xMin:Math.min.apply(null,xMins),yMin:Math.min.apply(null,yMins),xMax:Math.max.apply(null,xMaxs),yMax:Math.max.apply(null,yMaxs),advanceWidthMax:Math.max.apply(null,advanceWidths),advanceWidthAvg:average(advanceWidths),minLeftSideBearing:Math.min.apply(null,leftSideBearings),maxLeftSideBearing:Math.max.apply(null,leftSideBearings),minRightSideBearing:Math.min.apply(null,rightSideBearings)};globals.ascender=font.ascender;globals.descender=font.descender;var headTable=head.make({flags:3,unitsPerEm:font.unitsPerEm,xMin:globals.xMin,yMin:globals.yMin,xMax:globals.xMax,yMax:globals.yMax,lowestRecPPEM:3,createdTimestamp:font.createdTimestamp});var hheaTable=hhea.make({ascender:globals.ascender,descender:globals.descender,advanceWidthMax:globals.advanceWidthMax,minLeftSideBearing:globals.minLeftSideBearing,minRightSideBearing:globals.minRightSideBearing,xMaxExtent:globals.maxLeftSideBearing+(globals.xMax-globals.xMin),numberOfHMetrics:font.glyphs.length});var maxpTable=maxp.make(font.glyphs.length);var os2Table=os2.make({xAvgCharWidth:Math.round(globals.advanceWidthAvg),usWeightClass:font.tables.os2.usWeightClass,usWidthClass:font.tables.os2.usWidthClass,usFirstCharIndex:firstCharIndex,usLastCharIndex:lastCharIndex,ulUnicodeRange1:ulUnicodeRange1,ulUnicodeRange2:ulUnicodeRange2,ulUnicodeRange3:ulUnicodeRange3,ulUnicodeRange4:ulUnicodeRange4,fsSelection:font.tables.os2.fsSelection,sTypoAscender:globals.ascender,sTypoDescender:globals.descender,sTypoLineGap:0,usWinAscent:globals.yMax,usWinDescent:Math.abs(globals.yMin),ulCodePageRange1:1,sxHeight:metricsForChar(font,'xyvw',{yMax:Math.round(globals.ascender/2)}).yMax,sCapHeight:metricsForChar(font,'HIKLEFJMNTZBDPRAGOQSUVWXY',globals).yMax,usDefaultChar:font.hasChar(' ')?32:0,usBreakChar:font.hasChar(' ')?32:0});var hmtxTable=hmtx.make(font.glyphs);var cmapTable=cmap.make(font.glyphs);var englishFamilyName=font.getEnglishName('fontFamily');var englishStyleName=font.getEnglishName('fontSubfamily');var englishFullName=englishFamilyName+' '+englishStyleName;var postScriptName=font.getEnglishName('postScriptName');if(!postScriptName){postScriptName=englishFamilyName.replace(/\s/g,'')+'-'+englishStyleName;}
var names={};for(var n in font.names){names[n]=font.names[n];}
if(!names.uniqueID){names.uniqueID={en:font.getEnglishName('manufacturer')+':'+englishFullName};}
if(!names.postScriptName){names.postScriptName={en:postScriptName};}
if(!names.preferredFamily){names.preferredFamily=font.names.fontFamily;}
if(!names.preferredSubfamily){names.preferredSubfamily=font.names.fontSubfamily;}
var languageTags=[];var nameTable=_name.make(names,languageTags);var ltagTable=(languageTags.length>0?ltag.make(languageTags):undefined);var postTable=post.make();var cffTable=cff.make(font.glyphs,{version:font.getEnglishName('version'),fullName:englishFullName,familyName:englishFamilyName,weightName:englishStyleName,postScriptName:postScriptName,unitsPerEm:font.unitsPerEm,fontBBox:[0,globals.yMin,globals.ascender,globals.advanceWidthMax]});var metaTable=(font.metas&&Object.keys(font.metas).length>0)?meta.make(font.metas):undefined;var tables=[headTable,hheaTable,maxpTable,os2Table,nameTable,cmapTable,postTable,cffTable,hmtxTable];if(ltagTable){tables.push(ltagTable);}
if(font.tables.gsub){tables.push(gsub.make(font.tables.gsub));}
if(metaTable){tables.push(metaTable);}
var sfntTable=makeSfntTable(tables);var bytes=sfntTable.encode();var checkSum=computeCheckSum(bytes);var tableFields=sfntTable.fields;var checkSumAdjusted=false;for(var i$1=0;i$1<tableFields.length;i$1+=1){if(tableFields[i$1].name==='head table'){tableFields[i$1].value.checkSumAdjustment=0xB1B0AFBA-checkSum;checkSumAdjusted=true;break;}}
if(!checkSumAdjusted){throw new Error('Could not find head table with checkSum to adjust.');}
return sfntTable;}
var sfnt={make:makeSfntTable,fontToTable:fontToSfntTable,computeCheckSum:computeCheckSum};function searchTag(arr,tag){var imin=0;var imax=arr.length-1;while(imin<=imax){var imid=(imin+imax)>>>1;var val=arr[imid].tag;if(val===tag){return imid;}else if(val<tag){imin=imid+1;}else{imax=imid-1;}}
return-imin-1;}
function binSearch(arr,value){var imin=0;var imax=arr.length-1;while(imin<=imax){var imid=(imin+imax)>>>1;var val=arr[imid];if(val===value){return imid;}else if(val<value){imin=imid+1;}else{imax=imid-1;}}
return-imin-1;}
function Layout(font,tableName){this.font=font;this.tableName=tableName;}
Layout.prototype={searchTag:searchTag,binSearch:binSearch,getTable:function(create){var layout=this.font.tables[this.tableName];if(!layout&&create){layout=this.font.tables[this.tableName]=this.createDefaultTable();}
return layout;},getScriptNames:function(){var layout=this.getTable();if(!layout){return[];}
return layout.scripts.map(function(script){return script.tag;});},getDefaultScriptName:function(){var layout=this.getTable();if(!layout){return;}
var hasLatn=false;for(var i=0;i<layout.scripts.length;i++){var name=layout.scripts[i].tag;if(name==='DFLT'){return name;}
if(name==='latn'){hasLatn=true;}}
if(hasLatn){return'latn';}},getScriptTable:function(script,create){var layout=this.getTable(create);if(layout){script=script||'DFLT';var scripts=layout.scripts;var pos=searchTag(layout.scripts,script);if(pos>=0){return scripts[pos].script;}else if(create){var scr={tag:script,script:{defaultLangSys:{reserved:0,reqFeatureIndex:0xffff,featureIndexes:[]},langSysRecords:[]}};scripts.splice(-1-pos,0,scr);return scr.script;}}},getLangSysTable:function(script,language,create){var scriptTable=this.getScriptTable(script,create);if(scriptTable){if(!language||language==='dflt'||language==='DFLT'){return scriptTable.defaultLangSys;}
var pos=searchTag(scriptTable.langSysRecords,language);if(pos>=0){return scriptTable.langSysRecords[pos].langSys;}else if(create){var langSysRecord={tag:language,langSys:{reserved:0,reqFeatureIndex:0xffff,featureIndexes:[]}};scriptTable.langSysRecords.splice(-1-pos,0,langSysRecord);return langSysRecord.langSys;}}},getFeatureTable:function(script,language,feature,create){var langSysTable=this.getLangSysTable(script,language,create);if(langSysTable){var featureRecord;var featIndexes=langSysTable.featureIndexes;var allFeatures=this.font.tables[this.tableName].features;for(var i=0;i<featIndexes.length;i++){featureRecord=allFeatures[featIndexes[i]];if(featureRecord.tag===feature){return featureRecord.feature;}}
if(create){var index=allFeatures.length;check.assert(index===0||feature>=allFeatures[index-1].tag,'Features must be added in alphabetical order.');featureRecord={tag:feature,feature:{params:0,lookupListIndexes:[]}};allFeatures.push(featureRecord);featIndexes.push(index);return featureRecord.feature;}}},getLookupTables:function(script,language,feature,lookupType,create){var featureTable=this.getFeatureTable(script,language,feature,create);var tables=[];if(featureTable){var lookupTable;var lookupListIndexes=featureTable.lookupListIndexes;var allLookups=this.font.tables[this.tableName].lookups;for(var i=0;i<lookupListIndexes.length;i++){lookupTable=allLookups[lookupListIndexes[i]];if(lookupTable.lookupType===lookupType){tables.push(lookupTable);}}
if(tables.length===0&&create){lookupTable={lookupType:lookupType,lookupFlag:0,subtables:[],markFilteringSet:undefined};var index=allLookups.length;allLookups.push(lookupTable);lookupListIndexes.push(index);return[lookupTable];}}
return tables;},expandCoverage:function(coverageTable){if(coverageTable.format===1){return coverageTable.glyphs;}else{var glyphs=[];var ranges=coverageTable.ranges;for(var i=0;i<ranges.length;i++){var range=ranges[i];var start=range.start;var end=range.end;for(var j=start;j<=end;j++){glyphs.push(j);}}
return glyphs;}}};function Substitution(font){Layout.call(this,font,'gsub');}
function arraysEqual(ar1,ar2){var n=ar1.length;if(n!==ar2.length){return false;}
for(var i=0;i<n;i++){if(ar1[i]!==ar2[i]){return false;}}
return true;}
function getSubstFormat(lookupTable,format,defaultSubtable){var subtables=lookupTable.subtables;for(var i=0;i<subtables.length;i++){var subtable=subtables[i];if(subtable.substFormat===format){return subtable;}}
if(defaultSubtable){subtables.push(defaultSubtable);return defaultSubtable;}
return undefined;}
Substitution.prototype=Layout.prototype;Substitution.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:'DFLT',script:{defaultLangSys:{reserved:0,reqFeatureIndex:0xffff,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]};};Substitution.prototype.getSingle=function(feature,script,language){var this$1=this;var substitutions=[];var lookupTables=this.getLookupTables(script,language,feature,1);for(var idx=0;idx<lookupTables.length;idx++){var subtables=lookupTables[idx].subtables;for(var i=0;i<subtables.length;i++){var subtable=subtables[i];var glyphs=this$1.expandCoverage(subtable.coverage);var j=(void 0);if(subtable.substFormat===1){var delta=subtable.deltaGlyphId;for(j=0;j<glyphs.length;j++){var glyph=glyphs[j];substitutions.push({sub:glyph,by:glyph+delta});}}else{var substitute=subtable.substitute;for(j=0;j<glyphs.length;j++){substitutions.push({sub:glyphs[j],by:substitute[j]});}}}}
return substitutions;};Substitution.prototype.getAlternates=function(feature,script,language){var this$1=this;var alternates=[];var lookupTables=this.getLookupTables(script,language,feature,3);for(var idx=0;idx<lookupTables.length;idx++){var subtables=lookupTables[idx].subtables;for(var i=0;i<subtables.length;i++){var subtable=subtables[i];var glyphs=this$1.expandCoverage(subtable.coverage);var alternateSets=subtable.alternateSets;for(var j=0;j<glyphs.length;j++){alternates.push({sub:glyphs[j],by:alternateSets[j]});}}}
return alternates;};Substitution.prototype.getLigatures=function(feature,script,language){var this$1=this;var ligatures=[];var lookupTables=this.getLookupTables(script,language,feature,4);for(var idx=0;idx<lookupTables.length;idx++){var subtables=lookupTables[idx].subtables;for(var i=0;i<subtables.length;i++){var subtable=subtables[i];var glyphs=this$1.expandCoverage(subtable.coverage);var ligatureSets=subtable.ligatureSets;for(var j=0;j<glyphs.length;j++){var startGlyph=glyphs[j];var ligSet=ligatureSets[j];for(var k=0;k<ligSet.length;k++){var lig=ligSet[k];ligatures.push({sub:[startGlyph].concat(lig.components),by:lig.ligGlyph});}}}}
return ligatures;};Substitution.prototype.addSingle=function(feature,substitution,script,language){var lookupTable=this.getLookupTables(script,language,feature,1,true)[0];var subtable=getSubstFormat(lookupTable,2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});check.assert(subtable.coverage.format===1,'Ligature: unable to modify coverage table format '+subtable.coverage.format);var coverageGlyph=substitution.sub;var pos=this.binSearch(subtable.coverage.glyphs,coverageGlyph);if(pos<0){pos=-1-pos;subtable.coverage.glyphs.splice(pos,0,coverageGlyph);subtable.substitute.splice(pos,0,0);}
subtable.substitute[pos]=substitution.by;};Substitution.prototype.addAlternate=function(feature,substitution,script,language){var lookupTable=this.getLookupTables(script,language,feature,3,true)[0];var subtable=getSubstFormat(lookupTable,1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});check.assert(subtable.coverage.format===1,'Ligature: unable to modify coverage table format '+subtable.coverage.format);var coverageGlyph=substitution.sub;var pos=this.binSearch(subtable.coverage.glyphs,coverageGlyph);if(pos<0){pos=-1-pos;subtable.coverage.glyphs.splice(pos,0,coverageGlyph);subtable.alternateSets.splice(pos,0,0);}
subtable.alternateSets[pos]=substitution.by;};Substitution.prototype.addLigature=function(feature,ligature,script,language){var lookupTable=this.getLookupTables(script,language,feature,4,true)[0];var subtable=lookupTable.subtables[0];if(!subtable){subtable={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]};lookupTable.subtables[0]=subtable;}
check.assert(subtable.coverage.format===1,'Ligature: unable to modify coverage table format '+subtable.coverage.format);var coverageGlyph=ligature.sub[0];var ligComponents=ligature.sub.slice(1);var ligatureTable={ligGlyph:ligature.by,components:ligComponents};var pos=this.binSearch(subtable.coverage.glyphs,coverageGlyph);if(pos>=0){var ligatureSet=subtable.ligatureSets[pos];for(var i=0;i<ligatureSet.length;i++){if(arraysEqual(ligatureSet[i].components,ligComponents)){return;}}
ligatureSet.push(ligatureTable);}else{pos=-1-pos;subtable.coverage.glyphs.splice(pos,0,coverageGlyph);subtable.ligatureSets.splice(pos,0,[ligatureTable]);}};Substitution.prototype.getFeature=function(feature,script,language){if(/ss\d\d/.test(feature)){return this.getSingle(feature,script,language);}
switch(feature){case'aalt':case'salt':return this.getSingle(feature,script,language).concat(this.getAlternates(feature,script,language));case'dlig':case'liga':case'rlig':return this.getLigatures(feature,script,language);}
return undefined;};Substitution.prototype.add=function(feature,sub,script,language){if(/ss\d\d/.test(feature)){return this.addSingle(feature,sub,script,language);}
switch(feature){case'aalt':case'salt':if(typeof sub.by==='number'){return this.addSingle(feature,sub,script,language);}
return this.addAlternate(feature,sub,script,language);case'dlig':case'liga':case'rlig':return this.addLigature(feature,sub,script,language);}
return undefined;};function isBrowser(){return typeof window!=='undefined';}
function nodeBufferToArrayBuffer(buffer){var ab=new ArrayBuffer(buffer.length);var view=new Uint8Array(ab);for(var i=0;i<buffer.length;++i){view[i]=buffer[i];}
return ab;}
function arrayBufferToNodeBuffer(ab){var buffer=new Buffer(ab.byteLength);var view=new Uint8Array(ab);for(var i=0;i<buffer.length;++i){buffer[i]=view[i];}
return buffer;}
function checkArgument(expression,message){if(!expression){throw message;}}
var instructionTable;var exec;var execGlyph;var execComponent;function Hinting(font){this.font=font;this._fpgmState=this._prepState=undefined;this._errorState=0;}
function roundOff(v){return v;}
function roundToGrid(v){return Math.sign(v)*Math.round(Math.abs(v));}
function roundToDoubleGrid(v){return Math.sign(v)*Math.round(Math.abs(v*2))/2;}
function roundToHalfGrid(v){return Math.sign(v)*(Math.round(Math.abs(v)+0.5)-0.5);}
function roundUpToGrid(v){return Math.sign(v)*Math.ceil(Math.abs(v));}
function roundDownToGrid(v){return Math.sign(v)*Math.floor(Math.abs(v));}
var roundSuper=function(v){var period=this.srPeriod;var phase=this.srPhase;var threshold=this.srThreshold;var sign=1;if(v<0){v=-v;sign=-1;}
v+=threshold-phase;v=Math.trunc(v/period)*period;v+=phase;if(v<0){return phase*sign;}
return v*sign;};var xUnitVector={x:1,y:0,axis:'x',distance:function(p1,p2,o1,o2){return(o1?p1.xo:p1.x)-(o2?p2.xo:p2.x);},interpolate:function(p,rp1,rp2,pv){var do1;var do2;var doa1;var doa2;var dm1;var dm2;var dt;if(!pv||pv===this){do1=p.xo-rp1.xo;do2=p.xo-rp2.xo;dm1=rp1.x-rp1.xo;dm2=rp2.x-rp2.xo;doa1=Math.abs(do1);doa2=Math.abs(do2);dt=doa1+doa2;if(dt===0){p.x=p.xo+(dm1+dm2)/2;return;}
p.x=p.xo+(dm1*doa2+dm2*doa1)/dt;return;}
do1=pv.distance(p,rp1,true,true);do2=pv.distance(p,rp2,true,true);dm1=pv.distance(rp1,rp1,false,true);dm2=pv.distance(rp2,rp2,false,true);doa1=Math.abs(do1);doa2=Math.abs(do2);dt=doa1+doa2;if(dt===0){xUnitVector.setRelative(p,p,(dm1+dm2)/2,pv,true);return;}
xUnitVector.setRelative(p,p,(dm1*doa2+dm2*doa1)/dt,pv,true);},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(p,rp,d,pv,org){if(!pv||pv===this){p.x=(org?rp.xo:rp.x)+d;return;}
var rpx=org?rp.xo:rp.x;var rpy=org?rp.yo:rp.y;var rpdx=rpx+d*pv.x;var rpdy=rpy+d*pv.y;p.x=rpdx+(p.y-rpdy)/pv.normalSlope;},slope:0,touch:function(p){p.xTouched=true;},touched:function(p){return p.xTouched;},untouch:function(p){p.xTouched=false;}};var yUnitVector={x:0,y:1,axis:'y',distance:function(p1,p2,o1,o2){return(o1?p1.yo:p1.y)-(o2?p2.yo:p2.y);},interpolate:function(p,rp1,rp2,pv){var do1;var do2;var doa1;var doa2;var dm1;var dm2;var dt;if(!pv||pv===this){do1=p.yo-rp1.yo;do2=p.yo-rp2.yo;dm1=rp1.y-rp1.yo;dm2=rp2.y-rp2.yo;doa1=Math.abs(do1);doa2=Math.abs(do2);dt=doa1+doa2;if(dt===0){p.y=p.yo+(dm1+dm2)/2;return;}
p.y=p.yo+(dm1*doa2+dm2*doa1)/dt;return;}
do1=pv.distance(p,rp1,true,true);do2=pv.distance(p,rp2,true,true);dm1=pv.distance(rp1,rp1,false,true);dm2=pv.distance(rp2,rp2,false,true);doa1=Math.abs(do1);doa2=Math.abs(do2);dt=doa1+doa2;if(dt===0){yUnitVector.setRelative(p,p,(dm1+dm2)/2,pv,true);return;}
yUnitVector.setRelative(p,p,(dm1*doa2+dm2*doa1)/dt,pv,true);},normalSlope:0,setRelative:function(p,rp,d,pv,org){if(!pv||pv===this){p.y=(org?rp.yo:rp.y)+d;return;}
var rpx=org?rp.xo:rp.x;var rpy=org?rp.yo:rp.y;var rpdx=rpx+d*pv.x;var rpdy=rpy+d*pv.y;p.y=rpdy+pv.normalSlope*(p.x-rpdx);},slope:Number.POSITIVE_INFINITY,touch:function(p){p.yTouched=true;},touched:function(p){return p.yTouched;},untouch:function(p){p.yTouched=false;}};Object.freeze(xUnitVector);Object.freeze(yUnitVector);function UnitVector(x,y){this.x=x;this.y=y;this.axis=undefined;this.slope=y/x;this.normalSlope=-x/y;Object.freeze(this);}
UnitVector.prototype.distance=function(p1,p2,o1,o2){return(this.x*xUnitVector.distance(p1,p2,o1,o2)+
this.y*yUnitVector.distance(p1,p2,o1,o2));};UnitVector.prototype.interpolate=function(p,rp1,rp2,pv){var dm1;var dm2;var do1;var do2;var doa1;var doa2;var dt;do1=pv.distance(p,rp1,true,true);do2=pv.distance(p,rp2,true,true);dm1=pv.distance(rp1,rp1,false,true);dm2=pv.distance(rp2,rp2,false,true);doa1=Math.abs(do1);doa2=Math.abs(do2);dt=doa1+doa2;if(dt===0){this.setRelative(p,p,(dm1+dm2)/2,pv,true);return;}
this.setRelative(p,p,(dm1*doa2+dm2*doa1)/dt,pv,true);};UnitVector.prototype.setRelative=function(p,rp,d,pv,org){pv=pv||this;var rpx=org?rp.xo:rp.x;var rpy=org?rp.yo:rp.y;var rpdx=rpx+d*pv.x;var rpdy=rpy+d*pv.y;var pvns=pv.normalSlope;var fvs=this.slope;var px=p.x;var py=p.y;p.x=(fvs*px-pvns*rpdx+rpdy-py)/(fvs-pvns);p.y=fvs*(p.x-px)+py;};UnitVector.prototype.touch=function(p){p.xTouched=true;p.yTouched=true;};function getUnitVector(x,y){var d=Math.sqrt(x*x+y*y);x/=d;y/=d;if(x===1&&y===0){return xUnitVector;}
else if(x===0&&y===1){return yUnitVector;}
else{return new UnitVector(x,y);}}
function HPoint(x,y,lastPointOfContour,onCurve){this.x=this.xo=Math.round(x*64)/64;this.y=this.yo=Math.round(y*64)/64;this.lastPointOfContour=lastPointOfContour;this.onCurve=onCurve;this.prevPointOnContour=undefined;this.nextPointOnContour=undefined;this.xTouched=false;this.yTouched=false;Object.preventExtensions(this);}
HPoint.prototype.nextTouched=function(v){var p=this.nextPointOnContour;while(!v.touched(p)&&p!==this){p=p.nextPointOnContour;}
return p;};HPoint.prototype.prevTouched=function(v){var p=this.prevPointOnContour;while(!v.touched(p)&&p!==this){p=p.prevPointOnContour;}
return p;};var HPZero=Object.freeze(new HPoint(0,0));var defaultState={cvCutIn:17/16,deltaBase:9,deltaShift:0.125,loop:1,minDis:1,autoFlip:true};function State(env,prog){this.env=env;this.stack=[];this.prog=prog;switch(env){case'glyf':this.zp0=this.zp1=this.zp2=1;this.rp0=this.rp1=this.rp2=0;case'prep':this.fv=this.pv=this.dpv=xUnitVector;this.round=roundToGrid;}}
Hinting.prototype.exec=function(glyph,ppem){if(typeof ppem!=='number'){throw new Error('Point size is not a number!');}
if(this._errorState>2){return;}
var font=this.font;var prepState=this._prepState;if(!prepState||prepState.ppem!==ppem){var fpgmState=this._fpgmState;if(!fpgmState){State.prototype=defaultState;fpgmState=this._fpgmState=new State('fpgm',font.tables.fpgm);fpgmState.funcs=[];fpgmState.font=font;if(exports.DEBUG){console.log('---EXEC FPGM---');fpgmState.step=-1;}
try{exec(fpgmState);}catch(e){console.log('Hinting error in FPGM:'+e);this._errorState=3;return;}}
State.prototype=fpgmState;prepState=this._prepState=new State('prep',font.tables.prep);prepState.ppem=ppem;var oCvt=font.tables.cvt;if(oCvt){var cvt=prepState.cvt=new Array(oCvt.length);var scale=ppem/font.unitsPerEm;for(var c=0;c<oCvt.length;c++){cvt[c]=oCvt[c]*scale;}}else{prepState.cvt=[];}
if(exports.DEBUG){console.log('---EXEC PREP---');prepState.step=-1;}
try{exec(prepState);}catch(e){if(this._errorState<2){console.log('Hinting error in PREP:'+e);}
this._errorState=2;}}
if(this._errorState>1){return;}
try{return execGlyph(glyph,prepState);}catch(e){if(this._errorState<1){console.log('Hinting error:'+e);console.log('Note: further hinting errors are silenced');}
this._errorState=1;return undefined;}};execGlyph=function(glyph,prepState){var xScale=prepState.ppem/prepState.font.unitsPerEm;var yScale=xScale;var components=glyph.components;var contours;var gZone;var state;State.prototype=prepState;if(!components){state=new State('glyf',glyph.instructions);if(exports.DEBUG){console.log('---EXEC GLYPH---');state.step=-1;}
execComponent(glyph,state,xScale,yScale);gZone=state.gZone;}else{var font=prepState.font;gZone=[];contours=[];for(var i=0;i<components.length;i++){var c=components[i];var cg=font.glyphs.get(c.glyphIndex);state=new State('glyf',cg.instructions);if(exports.DEBUG){console.log('---EXEC COMP '+i+'---');state.step=-1;}
execComponent(cg,state,xScale,yScale);var dx=Math.round(c.dx*xScale);var dy=Math.round(c.dy*yScale);var gz=state.gZone;var cc=state.contours;for(var pi=0;pi<gz.length;pi++){var p=gz[pi];p.xTouched=p.yTouched=false;p.xo=p.x=p.x+dx;p.yo=p.y=p.y+dy;}
var gLen=gZone.length;gZone.push.apply(gZone,gz);for(var j=0;j<cc.length;j++){contours.push(cc[j]+gLen);}}
if(glyph.instructions&&!state.inhibitGridFit){state=new State('glyf',glyph.instructions);state.gZone=state.z0=state.z1=state.z2=gZone;state.contours=contours;gZone.push(new HPoint(0,0),new HPoint(Math.round(glyph.advanceWidth*xScale),0));if(exports.DEBUG){console.log('---EXEC COMPOSITE---');state.step=-1;}
exec(state);gZone.length-=2;}}
return gZone;};execComponent=function(glyph,state,xScale,yScale)
{var points=glyph.points||[];var pLen=points.length;var gZone=state.gZone=state.z0=state.z1=state.z2=[];var contours=state.contours=[];var cp;for(var i=0;i<pLen;i++){cp=points[i];gZone[i]=new HPoint(cp.x*xScale,cp.y*yScale,cp.lastPointOfContour,cp.onCurve);}
var sp;var np;for(var i$1=0;i$1<pLen;i$1++){cp=gZone[i$1];if(!sp){sp=cp;contours.push(i$1);}
if(cp.lastPointOfContour){cp.nextPointOnContour=sp;sp.prevPointOnContour=cp;sp=undefined;}else{np=gZone[i$1+1];cp.nextPointOnContour=np;np.prevPointOnContour=cp;}}
if(state.inhibitGridFit){return;}
if(exports.DEBUG){console.log('PROCESSING GLYPH',state.stack);for(var i$2=0;i$2<pLen;i$2++){console.log(i$2,gZone[i$2].x,gZone[i$2].y);}}
gZone.push(new HPoint(0,0),new HPoint(Math.round(glyph.advanceWidth*xScale),0));exec(state);gZone.length-=2;if(exports.DEBUG){console.log('FINISHED GLYPH',state.stack);for(var i$3=0;i$3<pLen;i$3++){console.log(i$3,gZone[i$3].x,gZone[i$3].y);}}};exec=function(state){var prog=state.prog;if(!prog){return;}
var pLen=prog.length;var ins;for(state.ip=0;state.ip<pLen;state.ip++){if(exports.DEBUG){state.step++;}
ins=instructionTable[prog[state.ip]];if(!ins){throw new Error('unknown instruction: 0x'+
Number(prog[state.ip]).toString(16));}
ins(state);}};function initTZone(state)
{var tZone=state.tZone=new Array(state.gZone.length);for(var i=0;i<tZone.length;i++)
{tZone[i]=new HPoint(0,0);}}
function skip(state,handleElse)
{var prog=state.prog;var ip=state.ip;var nesting=1;var ins;do{ins=prog[++ip];if(ins===0x58)
{nesting++;}
else if(ins===0x59)
{nesting--;}
else if(ins===0x40)
{ip+=prog[ip+1]+1;}
else if(ins===0x41)
{ip+=2*prog[ip+1]+1;}
else if(ins>=0xB0&&ins<=0xB7)
{ip+=ins-0xB0+1;}
else if(ins>=0xB8&&ins<=0xBF)
{ip+=(ins-0xB8+1)*2;}
else if(handleElse&&nesting===1&&ins===0x1B)
{break;}}while(nesting>0);state.ip=ip;}
function SVTCA(v,state){if(exports.DEBUG){console.log(state.step,'SVTCA['+v.axis+']');}
state.fv=state.pv=state.dpv=v;}
function SPVTCA(v,state){if(exports.DEBUG){console.log(state.step,'SPVTCA['+v.axis+']');}
state.pv=state.dpv=v;}
function SFVTCA(v,state){if(exports.DEBUG){console.log(state.step,'SFVTCA['+v.axis+']');}
state.fv=v;}
function SPVTL(a,state){var stack=state.stack;var p2i=stack.pop();var p1i=stack.pop();var p2=state.z2[p2i];var p1=state.z1[p1i];if(exports.DEBUG){console.log('SPVTL['+a+']',p2i,p1i);}
var dx;var dy;if(!a){dx=p1.x-p2.x;dy=p1.y-p2.y;}else{dx=p2.y-p1.y;dy=p1.x-p2.x;}
state.pv=state.dpv=getUnitVector(dx,dy);}
function SFVTL(a,state){var stack=state.stack;var p2i=stack.pop();var p1i=stack.pop();var p2=state.z2[p2i];var p1=state.z1[p1i];if(exports.DEBUG){console.log('SFVTL['+a+']',p2i,p1i);}
var dx;var dy;if(!a){dx=p1.x-p2.x;dy=p1.y-p2.y;}else{dx=p2.y-p1.y;dy=p1.x-p2.x;}
state.fv=getUnitVector(dx,dy);}
function SPVFS(state){var stack=state.stack;var y=stack.pop();var x=stack.pop();if(exports.DEBUG){console.log(state.step,'SPVFS[]',y,x);}
state.pv=state.dpv=getUnitVector(x,y);}
function SFVFS(state){var stack=state.stack;var y=stack.pop();var x=stack.pop();if(exports.DEBUG){console.log(state.step,'SPVFS[]',y,x);}
state.fv=getUnitVector(x,y);}
function GPV(state){var stack=state.stack;var pv=state.pv;if(exports.DEBUG){console.log(state.step,'GPV[]');}
stack.push(pv.x*0x4000);stack.push(pv.y*0x4000);}
function GFV(state){var stack=state.stack;var fv=state.fv;if(exports.DEBUG){console.log(state.step,'GFV[]');}
stack.push(fv.x*0x4000);stack.push(fv.y*0x4000);}
function SFVTPV(state){state.fv=state.pv;if(exports.DEBUG){console.log(state.step,'SFVTPV[]');}}
function ISECT(state)
{var stack=state.stack;var pa0i=stack.pop();var pa1i=stack.pop();var pb0i=stack.pop();var pb1i=stack.pop();var pi=stack.pop();var z0=state.z0;var z1=state.z1;var pa0=z0[pa0i];var pa1=z0[pa1i];var pb0=z1[pb0i];var pb1=z1[pb1i];var p=state.z2[pi];if(exports.DEBUG){console.log('ISECT[], ',pa0i,pa1i,pb0i,pb1i,pi);}
var x1=pa0.x;var y1=pa0.y;var x2=pa1.x;var y2=pa1.y;var x3=pb0.x;var y3=pb0.y;var x4=pb1.x;var y4=pb1.y;var div=(x1-x2)*(y3-y4)-(y1-y2)*(x3-x4);var f1=x1*y2-y1*x2;var f2=x3*y4-y3*x4;p.x=(f1*(x3-x4)-f2*(x1-x2))/div;p.y=(f1*(y3-y4)-f2*(y1-y2))/div;}
function SRP0(state){state.rp0=state.stack.pop();if(exports.DEBUG){console.log(state.step,'SRP0[]',state.rp0);}}
function SRP1(state){state.rp1=state.stack.pop();if(exports.DEBUG){console.log(state.step,'SRP1[]',state.rp1);}}
function SRP2(state){state.rp2=state.stack.pop();if(exports.DEBUG){console.log(state.step,'SRP2[]',state.rp2);}}
function SZP0(state){var n=state.stack.pop();if(exports.DEBUG){console.log(state.step,'SZP0[]',n);}
state.zp0=n;switch(n){case 0:if(!state.tZone){initTZone(state);}
state.z0=state.tZone;break;case 1:state.z0=state.gZone;break;default:throw new Error('Invalid zone pointer');}}
function SZP1(state){var n=state.stack.pop();if(exports.DEBUG){console.log(state.step,'SZP1[]',n);}
state.zp1=n;switch(n){case 0:if(!state.tZone){initTZone(state);}
state.z1=state.tZone;break;case 1:state.z1=state.gZone;break;default:throw new Error('Invalid zone pointer');}}
function SZP2(state){var n=state.stack.pop();if(exports.DEBUG){console.log(state.step,'SZP2[]',n);}
state.zp2=n;switch(n){case 0:if(!state.tZone){initTZone(state);}
state.z2=state.tZone;break;case 1:state.z2=state.gZone;break;default:throw new Error('Invalid zone pointer');}}
function SZPS(state){var n=state.stack.pop();if(exports.DEBUG){console.log(state.step,'SZPS[]',n);}
state.zp0=state.zp1=state.zp2=n;switch(n){case 0:if(!state.tZone){initTZone(state);}
state.z0=state.z1=state.z2=state.tZone;break;case 1:state.z0=state.z1=state.z2=state.gZone;break;default:throw new Error('Invalid zone pointer');}}
function SLOOP(state){state.loop=state.stack.pop();if(exports.DEBUG){console.log(state.step,'SLOOP[]',state.loop);}}
function RTG(state){if(exports.DEBUG){console.log(state.step,'RTG[]');}
state.round=roundToGrid;}
function RTHG(state){if(exports.DEBUG){console.log(state.step,'RTHG[]');}
state.round=roundToHalfGrid;}
function SMD(state){var d=state.stack.pop();if(exports.DEBUG){console.log(state.step,'SMD[]',d);}
state.minDis=d/0x40;}
function ELSE(state){if(exports.DEBUG){console.log(state.step,'ELSE[]');}
skip(state,false);}
function JMPR(state){var o=state.stack.pop();if(exports.DEBUG){console.log(state.step,'JMPR[]',o);}
state.ip+=o-1;}
function SCVTCI(state){var n=state.stack.pop();if(exports.DEBUG){console.log(state.step,'SCVTCI[]',n);}
state.cvCutIn=n/0x40;}
function DUP(state){var stack=state.stack;if(exports.DEBUG){console.log(state.step,'DUP[]');}
stack.push(stack[stack.length-1]);}
function POP(state){if(exports.DEBUG){console.log(state.step,'POP[]');}
state.stack.pop();}
function CLEAR(state){if(exports.DEBUG){console.log(state.step,'CLEAR[]');}
state.stack.length=0;}
function SWAP(state){var stack=state.stack;var a=stack.pop();var b=stack.pop();if(exports.DEBUG){console.log(state.step,'SWAP[]');}
stack.push(a);stack.push(b);}
function DEPTH(state){var stack=state.stack;if(exports.DEBUG){console.log(state.step,'DEPTH[]');}
stack.push(stack.length);}
function LOOPCALL(state){var stack=state.stack;var fn=stack.pop();var c=stack.pop();if(exports.DEBUG){console.log(state.step,'LOOPCALL[]',fn,c);}
var cip=state.ip;var cprog=state.prog;state.prog=state.funcs[fn];for(var i=0;i<c;i++){exec(state);if(exports.DEBUG){console.log(++state.step,i+1<c?'next loopcall':'done loopcall',i);}}
state.ip=cip;state.prog=cprog;}
function CALL(state){var fn=state.stack.pop();if(exports.DEBUG){console.log(state.step,'CALL[]',fn);}
var cip=state.ip;var cprog=state.prog;state.prog=state.funcs[fn];exec(state);state.ip=cip;state.prog=cprog;if(exports.DEBUG){console.log(++state.step,'returning from',fn);}}
function CINDEX(state){var stack=state.stack;var k=stack.pop();if(exports.DEBUG){console.log(state.step,'CINDEX[]',k);}
stack.push(stack[stack.length-k]);}
function MINDEX(state){var stack=state.stack;var k=stack.pop();if(exports.DEBUG){console.log(state.step,'MINDEX[]',k);}
stack.push(stack.splice(stack.length-k,1)[0]);}
function FDEF(state){if(state.env!=='fpgm'){throw new Error('FDEF not allowed here');}
var stack=state.stack;var prog=state.prog;var ip=state.ip;var fn=stack.pop();var ipBegin=ip;if(exports.DEBUG){console.log(state.step,'FDEF[]',fn);}
while(prog[++ip]!==0x2D){}
state.ip=ip;state.funcs[fn]=prog.slice(ipBegin+1,ip);}
function MDAP(round,state){var pi=state.stack.pop();var p=state.z0[pi];var fv=state.fv;var pv=state.pv;if(exports.DEBUG){console.log(state.step,'MDAP['+round+']',pi);}
var d=pv.distance(p,HPZero);if(round){d=state.round(d);}
fv.setRelative(p,HPZero,d,pv);fv.touch(p);state.rp0=state.rp1=pi;}
function IUP(v,state){var z2=state.z2;var pLen=z2.length-2;var cp;var pp;var np;if(exports.DEBUG){console.log(state.step,'IUP['+v.axis+']');}
for(var i=0;i<pLen;i++){cp=z2[i];if(v.touched(cp)){continue;}
pp=cp.prevTouched(v);if(pp===cp){continue;}
np=cp.nextTouched(v);if(pp===np){v.setRelative(cp,cp,v.distance(pp,pp,false,true),v,true);}
v.interpolate(cp,pp,np,v);}}
function SHP(a,state){var stack=state.stack;var rpi=a?state.rp1:state.rp2;var rp=(a?state.z0:state.z1)[rpi];var fv=state.fv;var pv=state.pv;var loop=state.loop;var z2=state.z2;while(loop--)
{var pi=stack.pop();var p=z2[pi];var d=pv.distance(rp,rp,false,true);fv.setRelative(p,p,d,pv);fv.touch(p);if(exports.DEBUG){console.log(state.step,(state.loop>1?'loop '+(state.loop-loop)+': ':'')+'SHP['+(a?'rp1':'rp2')+']',pi);}}
state.loop=1;}
function SHC(a,state){var stack=state.stack;var rpi=a?state.rp1:state.rp2;var rp=(a?state.z0:state.z1)[rpi];var fv=state.fv;var pv=state.pv;var ci=stack.pop();var sp=state.z2[state.contours[ci]];var p=sp;if(exports.DEBUG){console.log(state.step,'SHC['+a+']',ci);}
var d=pv.distance(rp,rp,false,true);do{if(p!==rp){fv.setRelative(p,p,d,pv);}
p=p.nextPointOnContour;}while(p!==sp);}
function SHZ(a,state){var stack=state.stack;var rpi=a?state.rp1:state.rp2;var rp=(a?state.z0:state.z1)[rpi];var fv=state.fv;var pv=state.pv;var e=stack.pop();if(exports.DEBUG){console.log(state.step,'SHZ['+a+']',e);}
var z;switch(e){case 0:z=state.tZone;break;case 1:z=state.gZone;break;default:throw new Error('Invalid zone');}
var p;var d=pv.distance(rp,rp,false,true);var pLen=z.length-2;for(var i=0;i<pLen;i++)
{p=z[i];fv.setRelative(p,p,d,pv);}}
function SHPIX(state){var stack=state.stack;var loop=state.loop;var fv=state.fv;var d=stack.pop()/0x40;var z2=state.z2;while(loop--){var pi=stack.pop();var p=z2[pi];if(exports.DEBUG){console.log(state.step,(state.loop>1?'loop '+(state.loop-loop)+': ':'')+'SHPIX[]',pi,d);}
fv.setRelative(p,p,d);fv.touch(p);}
state.loop=1;}
function IP(state){var stack=state.stack;var rp1i=state.rp1;var rp2i=state.rp2;var loop=state.loop;var rp1=state.z0[rp1i];var rp2=state.z1[rp2i];var fv=state.fv;var pv=state.dpv;var z2=state.z2;while(loop--){var pi=stack.pop();var p=z2[pi];if(exports.DEBUG){console.log(state.step,(state.loop>1?'loop '+(state.loop-loop)+': ':'')+'IP[]',pi,rp1i,'<->',rp2i);}
fv.interpolate(p,rp1,rp2,pv);fv.touch(p);}
state.loop=1;}
function MSIRP(a,state){var stack=state.stack;var d=stack.pop()/64;var pi=stack.pop();var p=state.z1[pi];var rp0=state.z0[state.rp0];var fv=state.fv;var pv=state.pv;fv.setRelative(p,rp0,d,pv);fv.touch(p);if(exports.DEBUG){console.log(state.step,'MSIRP['+a+']',d,pi);}
state.rp1=state.rp0;state.rp2=pi;if(a){state.rp0=pi;}}
function ALIGNRP(state){var stack=state.stack;var rp0i=state.rp0;var rp0=state.z0[rp0i];var loop=state.loop;var fv=state.fv;var pv=state.pv;var z1=state.z1;while(loop--){var pi=stack.pop();var p=z1[pi];if(exports.DEBUG){console.log(state.step,(state.loop>1?'loop '+(state.loop-loop)+': ':'')+'ALIGNRP[]',pi);}
fv.setRelative(p,rp0,0,pv);fv.touch(p);}
state.loop=1;}
function RTDG(state){if(exports.DEBUG){console.log(state.step,'RTDG[]');}
state.round=roundToDoubleGrid;}
function MIAP(round,state){var stack=state.stack;var n=stack.pop();var pi=stack.pop();var p=state.z0[pi];var fv=state.fv;var pv=state.pv;var cv=state.cvt[n];if(exports.DEBUG){console.log(state.step,'MIAP['+round+']',n,'(',cv,')',pi);}
var d=pv.distance(p,HPZero);if(round){if(Math.abs(d-cv)<state.cvCutIn){d=cv;}
d=state.round(d);}
fv.setRelative(p,HPZero,d,pv);if(state.zp0===0){p.xo=p.x;p.yo=p.y;}
fv.touch(p);state.rp0=state.rp1=pi;}
function NPUSHB(state){var prog=state.prog;var ip=state.ip;var stack=state.stack;var n=prog[++ip];if(exports.DEBUG){console.log(state.step,'NPUSHB[]',n);}
for(var i=0;i<n;i++){stack.push(prog[++ip]);}
state.ip=ip;}
function NPUSHW(state){var ip=state.ip;var prog=state.prog;var stack=state.stack;var n=prog[++ip];if(exports.DEBUG){console.log(state.step,'NPUSHW[]',n);}
for(var i=0;i<n;i++){var w=(prog[++ip]<<8)|prog[++ip];if(w&0x8000){w=-((w^0xffff)+1);}
stack.push(w);}
state.ip=ip;}
function WS(state){var stack=state.stack;var store=state.store;if(!store){store=state.store=[];}
var v=stack.pop();var l=stack.pop();if(exports.DEBUG){console.log(state.step,'WS',v,l);}
store[l]=v;}
function RS(state){var stack=state.stack;var store=state.store;var l=stack.pop();if(exports.DEBUG){console.log(state.step,'RS',l);}
var v=(store&&store[l])||0;stack.push(v);}
function WCVTP(state){var stack=state.stack;var v=stack.pop();var l=stack.pop();if(exports.DEBUG){console.log(state.step,'WCVTP',v,l);}
state.cvt[l]=v/0x40;}
function RCVT(state){var stack=state.stack;var cvte=stack.pop();if(exports.DEBUG){console.log(state.step,'RCVT',cvte);}
stack.push(state.cvt[cvte]*0x40);}
function GC(a,state){var stack=state.stack;var pi=stack.pop();var p=state.z2[pi];if(exports.DEBUG){console.log(state.step,'GC['+a+']',pi);}
stack.push(state.dpv.distance(p,HPZero,a,false)*0x40);}
function MD(a,state){var stack=state.stack;var pi2=stack.pop();var pi1=stack.pop();var p2=state.z1[pi2];var p1=state.z0[pi1];var d=state.dpv.distance(p1,p2,a,a);if(exports.DEBUG){console.log(state.step,'MD['+a+']',pi2,pi1,'->',d);}
state.stack.push(Math.round(d*64));}
function MPPEM(state){if(exports.DEBUG){console.log(state.step,'MPPEM[]');}
state.stack.push(state.ppem);}
function FLIPON(state){if(exports.DEBUG){console.log(state.step,'FLIPON[]');}
state.autoFlip=true;}
function LT(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,'LT[]',e2,e1);}
stack.push(e1<e2?1:0);}
function LTEQ(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,'LTEQ[]',e2,e1);}
stack.push(e1<=e2?1:0);}
function GT(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,'GT[]',e2,e1);}
stack.push(e1>e2?1:0);}
function GTEQ(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,'GTEQ[]',e2,e1);}
stack.push(e1>=e2?1:0);}
function EQ(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,'EQ[]',e2,e1);}
stack.push(e2===e1?1:0);}
function NEQ(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,'NEQ[]',e2,e1);}
stack.push(e2!==e1?1:0);}
function ODD(state){var stack=state.stack;var n=stack.pop();if(exports.DEBUG){console.log(state.step,'ODD[]',n);}
stack.push(Math.trunc(n)%2?1:0);}
function EVEN(state){var stack=state.stack;var n=stack.pop();if(exports.DEBUG){console.log(state.step,'EVEN[]',n);}
stack.push(Math.trunc(n)%2?0:1);}
function IF(state){var test=state.stack.pop();var ins;if(exports.DEBUG){console.log(state.step,'IF[]',test);}
if(!test){skip(state,true);if(exports.DEBUG){console.log(state.step,ins===0x1B?'ELSE[]':'EIF[]');}}}
function EIF(state){if(exports.DEBUG){console.log(state.step,'EIF[]');}}
function AND(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,'AND[]',e2,e1);}
stack.push(e2&&e1?1:0);}
function OR(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,'OR[]',e2,e1);}
stack.push(e2||e1?1:0);}
function NOT(state){var stack=state.stack;var e=stack.pop();if(exports.DEBUG){console.log(state.step,'NOT[]',e);}
stack.push(e?0:1);}
function DELTAP123(b,state){var stack=state.stack;var n=stack.pop();var fv=state.fv;var pv=state.pv;var ppem=state.ppem;var base=state.deltaBase+(b-1)*16;var ds=state.deltaShift;var z0=state.z0;if(exports.DEBUG){console.log(state.step,'DELTAP['+b+']',n,stack);}
for(var i=0;i<n;i++){var pi=stack.pop();var arg=stack.pop();var appem=base+((arg&0xF0)>>4);if(appem!==ppem){continue;}
var mag=(arg&0x0F)-8;if(mag>=0){mag++;}
if(exports.DEBUG){console.log(state.step,'DELTAPFIX',pi,'by',mag*ds);}
var p=z0[pi];fv.setRelative(p,p,mag*ds,pv);}}
function SDB(state){var stack=state.stack;var n=stack.pop();if(exports.DEBUG){console.log(state.step,'SDB[]',n);}
state.deltaBase=n;}
function SDS(state){var stack=state.stack;var n=stack.pop();if(exports.DEBUG){console.log(state.step,'SDS[]',n);}
state.deltaShift=Math.pow(0.5,n);}
function ADD(state){var stack=state.stack;var n2=stack.pop();var n1=stack.pop();if(exports.DEBUG){console.log(state.step,'ADD[]',n2,n1);}
stack.push(n1+n2);}
function SUB(state){var stack=state.stack;var n2=stack.pop();var n1=stack.pop();if(exports.DEBUG){console.log(state.step,'SUB[]',n2,n1);}
stack.push(n1-n2);}
function DIV(state){var stack=state.stack;var n2=stack.pop();var n1=stack.pop();if(exports.DEBUG){console.log(state.step,'DIV[]',n2,n1);}
stack.push(n1*64/n2);}
function MUL(state){var stack=state.stack;var n2=stack.pop();var n1=stack.pop();if(exports.DEBUG){console.log(state.step,'MUL[]',n2,n1);}
stack.push(n1*n2/64);}
function ABS(state){var stack=state.stack;var n=stack.pop();if(exports.DEBUG){console.log(state.step,'ABS[]',n);}
stack.push(Math.abs(n));}
function NEG(state){var stack=state.stack;var n=stack.pop();if(exports.DEBUG){console.log(state.step,'NEG[]',n);}
stack.push(-n);}
function FLOOR(state){var stack=state.stack;var n=stack.pop();if(exports.DEBUG){console.log(state.step,'FLOOR[]',n);}
stack.push(Math.floor(n/0x40)*0x40);}
function CEILING(state){var stack=state.stack;var n=stack.pop();if(exports.DEBUG){console.log(state.step,'CEILING[]',n);}
stack.push(Math.ceil(n/0x40)*0x40);}
function ROUND(dt,state){var stack=state.stack;var n=stack.pop();if(exports.DEBUG){console.log(state.step,'ROUND[]');}
stack.push(state.round(n/0x40)*0x40);}
function WCVTF(state){var stack=state.stack;var v=stack.pop();var l=stack.pop();if(exports.DEBUG){console.log(state.step,'WCVTF[]',v,l);}
state.cvt[l]=v*state.ppem/state.font.unitsPerEm;}
function DELTAC123(b,state){var stack=state.stack;var n=stack.pop();var ppem=state.ppem;var base=state.deltaBase+(b-1)*16;var ds=state.deltaShift;if(exports.DEBUG){console.log(state.step,'DELTAC['+b+']',n,stack);}
for(var i=0;i<n;i++){var c=stack.pop();var arg=stack.pop();var appem=base+((arg&0xF0)>>4);if(appem!==ppem){continue;}
var mag=(arg&0x0F)-8;if(mag>=0){mag++;}
var delta=mag*ds;if(exports.DEBUG){console.log(state.step,'DELTACFIX',c,'by',delta);}
state.cvt[c]+=delta;}}
function SROUND(state){var n=state.stack.pop();if(exports.DEBUG){console.log(state.step,'SROUND[]',n);}
state.round=roundSuper;var period;switch(n&0xC0){case 0x00:period=0.5;break;case 0x40:period=1;break;case 0x80:period=2;break;default:throw new Error('invalid SROUND value');}
state.srPeriod=period;switch(n&0x30){case 0x00:state.srPhase=0;break;case 0x10:state.srPhase=0.25*period;break;case 0x20:state.srPhase=0.5*period;break;case 0x30:state.srPhase=0.75*period;break;default:throw new Error('invalid SROUND value');}
n&=0x0F;if(n===0){state.srThreshold=0;}
else{state.srThreshold=(n/8-0.5)*period;}}
function S45ROUND(state){var n=state.stack.pop();if(exports.DEBUG){console.log(state.step,'S45ROUND[]',n);}
state.round=roundSuper;var period;switch(n&0xC0){case 0x00:period=Math.sqrt(2)/2;break;case 0x40:period=Math.sqrt(2);break;case 0x80:period=2*Math.sqrt(2);break;default:throw new Error('invalid S45ROUND value');}
state.srPeriod=period;switch(n&0x30){case 0x00:state.srPhase=0;break;case 0x10:state.srPhase=0.25*period;break;case 0x20:state.srPhase=0.5*period;break;case 0x30:state.srPhase=0.75*period;break;default:throw new Error('invalid S45ROUND value');}
n&=0x0F;if(n===0){state.srThreshold=0;}
else{state.srThreshold=(n/8-0.5)*period;}}
function ROFF(state){if(exports.DEBUG){console.log(state.step,'ROFF[]');}
state.round=roundOff;}
function RUTG(state){if(exports.DEBUG){console.log(state.step,'RUTG[]');}
state.round=roundUpToGrid;}
function RDTG(state){if(exports.DEBUG){console.log(state.step,'RDTG[]');}
state.round=roundDownToGrid;}
function SCANCTRL(state){var n=state.stack.pop();if(exports.DEBUG){console.log(state.step,'SCANCTRL[]',n);}}
function SDPVTL(a,state){var stack=state.stack;var p2i=stack.pop();var p1i=stack.pop();var p2=state.z2[p2i];var p1=state.z1[p1i];if(exports.DEBUG){console.log(state.step,'SDPVTL['+a+']',p2i,p1i);}
var dx;var dy;if(!a){dx=p1.x-p2.x;dy=p1.y-p2.y;}else{dx=p2.y-p1.y;dy=p1.x-p2.x;}
state.dpv=getUnitVector(dx,dy);}
function GETINFO(state){var stack=state.stack;var sel=stack.pop();var r=0;if(exports.DEBUG){console.log(state.step,'GETINFO[]',sel);}
if(sel&0x01){r=35;}
if(sel&0x20){r|=0x1000;}
stack.push(r);}
function ROLL(state){var stack=state.stack;var a=stack.pop();var b=stack.pop();var c=stack.pop();if(exports.DEBUG){console.log(state.step,'ROLL[]');}
stack.push(b);stack.push(a);stack.push(c);}
function MAX(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,'MAX[]',e2,e1);}
stack.push(Math.max(e1,e2));}
function MIN(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,'MIN[]',e2,e1);}
stack.push(Math.min(e1,e2));}
function SCANTYPE(state){var n=state.stack.pop();if(exports.DEBUG){console.log(state.step,'SCANTYPE[]',n);}}
function INSTCTRL(state){var s=state.stack.pop();var v=state.stack.pop();if(exports.DEBUG){console.log(state.step,'INSTCTRL[]',s,v);}
switch(s){case 1:state.inhibitGridFit=!!v;return;case 2:state.ignoreCvt=!!v;return;default:throw new Error('invalid INSTCTRL[] selector');}}
function PUSHB(n,state){var stack=state.stack;var prog=state.prog;var ip=state.ip;if(exports.DEBUG){console.log(state.step,'PUSHB['+n+']');}
for(var i=0;i<n;i++){stack.push(prog[++ip]);}
state.ip=ip;}
function PUSHW(n,state){var ip=state.ip;var prog=state.prog;var stack=state.stack;if(exports.DEBUG){console.log(state.ip,'PUSHW['+n+']');}
for(var i=0;i<n;i++){var w=(prog[++ip]<<8)|prog[++ip];if(w&0x8000){w=-((w^0xffff)+1);}
stack.push(w);}
state.ip=ip;}
function MDRP_MIRP(indirect,setRp0,keepD,ro,dt,state){var stack=state.stack;var cvte=indirect&&stack.pop();var pi=stack.pop();var rp0i=state.rp0;var rp=state.z0[rp0i];var p=state.z1[pi];var md=state.minDis;var fv=state.fv;var pv=state.dpv;var od;var d;var sign;var cv;d=od=pv.distance(p,rp,true,true);sign=d>=0?1:-1;d=Math.abs(d);if(indirect){cv=state.cvt[cvte];if(ro&&Math.abs(d-cv)<state.cvCutIn){d=cv;}}
if(keepD&&d<md){d=md;}
if(ro){d=state.round(d);}
fv.setRelative(p,rp,sign*d,pv);fv.touch(p);if(exports.DEBUG){console.log(state.step,(indirect?'MIRP[':'MDRP[')+
(setRp0?'M':'m')+
(keepD?'>':'_')+
(ro?'R':'_')+
(dt===0?'Gr':(dt===1?'Bl':(dt===2?'Wh':'')))+']',indirect?cvte+'('+state.cvt[cvte]+','+cv+')':'',pi,'(d =',od,'->',sign*d,')');}
state.rp1=state.rp0;state.rp2=pi;if(setRp0){state.rp0=pi;}}
instructionTable=[SVTCA.bind(undefined,yUnitVector),SVTCA.bind(undefined,xUnitVector),SPVTCA.bind(undefined,yUnitVector),SPVTCA.bind(undefined,xUnitVector),SFVTCA.bind(undefined,yUnitVector),SFVTCA.bind(undefined,xUnitVector),SPVTL.bind(undefined,0),SPVTL.bind(undefined,1),SFVTL.bind(undefined,0),SFVTL.bind(undefined,1),SPVFS,SFVFS,GPV,GFV,SFVTPV,ISECT,SRP0,SRP1,SRP2,SZP0,SZP1,SZP2,SZPS,SLOOP,RTG,RTHG,SMD,ELSE,JMPR,SCVTCI,undefined,undefined,DUP,POP,CLEAR,SWAP,DEPTH,CINDEX,MINDEX,undefined,undefined,undefined,LOOPCALL,CALL,FDEF,undefined,MDAP.bind(undefined,0),MDAP.bind(undefined,1),IUP.bind(undefined,yUnitVector),IUP.bind(undefined,xUnitVector),SHP.bind(undefined,0),SHP.bind(undefined,1),SHC.bind(undefined,0),SHC.bind(undefined,1),SHZ.bind(undefined,0),SHZ.bind(undefined,1),SHPIX,IP,MSIRP.bind(undefined,0),MSIRP.bind(undefined,1),ALIGNRP,RTDG,MIAP.bind(undefined,0),MIAP.bind(undefined,1),NPUSHB,NPUSHW,WS,RS,WCVTP,RCVT,GC.bind(undefined,0),GC.bind(undefined,1),undefined,MD.bind(undefined,0),MD.bind(undefined,1),MPPEM,undefined,FLIPON,undefined,undefined,LT,LTEQ,GT,GTEQ,EQ,NEQ,ODD,EVEN,IF,EIF,AND,OR,NOT,DELTAP123.bind(undefined,1),SDB,SDS,ADD,SUB,DIV,MUL,ABS,NEG,FLOOR,CEILING,ROUND.bind(undefined,0),ROUND.bind(undefined,1),ROUND.bind(undefined,2),ROUND.bind(undefined,3),undefined,undefined,undefined,undefined,WCVTF,DELTAP123.bind(undefined,2),DELTAP123.bind(undefined,3),DELTAC123.bind(undefined,1),DELTAC123.bind(undefined,2),DELTAC123.bind(undefined,3),SROUND,S45ROUND,undefined,undefined,ROFF,undefined,RUTG,RDTG,POP,POP,undefined,undefined,undefined,undefined,undefined,SCANCTRL,SDPVTL.bind(undefined,0),SDPVTL.bind(undefined,1),GETINFO,undefined,ROLL,MAX,MIN,SCANTYPE,INSTCTRL,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,PUSHB.bind(undefined,1),PUSHB.bind(undefined,2),PUSHB.bind(undefined,3),PUSHB.bind(undefined,4),PUSHB.bind(undefined,5),PUSHB.bind(undefined,6),PUSHB.bind(undefined,7),PUSHB.bind(undefined,8),PUSHW.bind(undefined,1),PUSHW.bind(undefined,2),PUSHW.bind(undefined,3),PUSHW.bind(undefined,4),PUSHW.bind(undefined,5),PUSHW.bind(undefined,6),PUSHW.bind(undefined,7),PUSHW.bind(undefined,8),MDRP_MIRP.bind(undefined,0,0,0,0,0),MDRP_MIRP.bind(undefined,0,0,0,0,1),MDRP_MIRP.bind(undefined,0,0,0,0,2),MDRP_MIRP.bind(undefined,0,0,0,0,3),MDRP_MIRP.bind(undefined,0,0,0,1,0),MDRP_MIRP.bind(undefined,0,0,0,1,1),MDRP_MIRP.bind(undefined,0,0,0,1,2),MDRP_MIRP.bind(undefined,0,0,0,1,3),MDRP_MIRP.bind(undefined,0,0,1,0,0),MDRP_MIRP.bind(undefined,0,0,1,0,1),MDRP_MIRP.bind(undefined,0,0,1,0,2),MDRP_MIRP.bind(undefined,0,0,1,0,3),MDRP_MIRP.bind(undefined,0,0,1,1,0),MDRP_MIRP.bind(undefined,0,0,1,1,1),MDRP_MIRP.bind(undefined,0,0,1,1,2),MDRP_MIRP.bind(undefined,0,0,1,1,3),MDRP_MIRP.bind(undefined,0,1,0,0,0),MDRP_MIRP.bind(undefined,0,1,0,0,1),MDRP_MIRP.bind(undefined,0,1,0,0,2),MDRP_MIRP.bind(undefined,0,1,0,0,3),MDRP_MIRP.bind(undefined,0,1,0,1,0),MDRP_MIRP.bind(undefined,0,1,0,1,1),MDRP_MIRP.bind(undefined,0,1,0,1,2),MDRP_MIRP.bind(undefined,0,1,0,1,3),MDRP_MIRP.bind(undefined,0,1,1,0,0),MDRP_MIRP.bind(undefined,0,1,1,0,1),MDRP_MIRP.bind(undefined,0,1,1,0,2),MDRP_MIRP.bind(undefined,0,1,1,0,3),MDRP_MIRP.bind(undefined,0,1,1,1,0),MDRP_MIRP.bind(undefined,0,1,1,1,1),MDRP_MIRP.bind(undefined,0,1,1,1,2),MDRP_MIRP.bind(undefined,0,1,1,1,3),MDRP_MIRP.bind(undefined,1,0,0,0,0),MDRP_MIRP.bind(undefined,1,0,0,0,1),MDRP_MIRP.bind(undefined,1,0,0,0,2),MDRP_MIRP.bind(undefined,1,0,0,0,3),MDRP_MIRP.bind(undefined,1,0,0,1,0),MDRP_MIRP.bind(undefined,1,0,0,1,1),MDRP_MIRP.bind(undefined,1,0,0,1,2),MDRP_MIRP.bind(undefined,1,0,0,1,3),MDRP_MIRP.bind(undefined,1,0,1,0,0),MDRP_MIRP.bind(undefined,1,0,1,0,1),MDRP_MIRP.bind(undefined,1,0,1,0,2),MDRP_MIRP.bind(undefined,1,0,1,0,3),MDRP_MIRP.bind(undefined,1,0,1,1,0),MDRP_MIRP.bind(undefined,1,0,1,1,1),MDRP_MIRP.bind(undefined,1,0,1,1,2),MDRP_MIRP.bind(undefined,1,0,1,1,3),MDRP_MIRP.bind(undefined,1,1,0,0,0),MDRP_MIRP.bind(undefined,1,1,0,0,1),MDRP_MIRP.bind(undefined,1,1,0,0,2),MDRP_MIRP.bind(undefined,1,1,0,0,3),MDRP_MIRP.bind(undefined,1,1,0,1,0),MDRP_MIRP.bind(undefined,1,1,0,1,1),MDRP_MIRP.bind(undefined,1,1,0,1,2),MDRP_MIRP.bind(undefined,1,1,0,1,3),MDRP_MIRP.bind(undefined,1,1,1,0,0),MDRP_MIRP.bind(undefined,1,1,1,0,1),MDRP_MIRP.bind(undefined,1,1,1,0,2),MDRP_MIRP.bind(undefined,1,1,1,0,3),MDRP_MIRP.bind(undefined,1,1,1,1,0),MDRP_MIRP.bind(undefined,1,1,1,1,1),MDRP_MIRP.bind(undefined,1,1,1,1,2),MDRP_MIRP.bind(undefined,1,1,1,1,3)];function Font(options){options=options||{};if(!options.empty){checkArgument(options.familyName,'When creating a new Font object, familyName is required.');checkArgument(options.styleName,'When creating a new Font object, styleName is required.');checkArgument(options.unitsPerEm,'When creating a new Font object, unitsPerEm is required.');checkArgument(options.ascender,'When creating a new Font object, ascender is required.');checkArgument(options.descender,'When creating a new Font object, descender is required.');checkArgument(options.descender<0,'Descender should be negative (e.g. -512).');this.names={fontFamily:{en:options.familyName||' '},fontSubfamily:{en:options.styleName||' '},fullName:{en:options.fullName||options.familyName+' '+options.styleName},postScriptName:{en:options.postScriptName||options.familyName+options.styleName},designer:{en:options.designer||' '},designerURL:{en:options.designerURL||' '},manufacturer:{en:options.manufacturer||' '},manufacturerURL:{en:options.manufacturerURL||' '},license:{en:options.license||' '},licenseURL:{en:options.licenseURL||' '},version:{en:options.version||'Version 0.1'},description:{en:options.description||' '},copyright:{en:options.copyright||' '},trademark:{en:options.trademark||' '}};this.unitsPerEm=options.unitsPerEm||1000;this.ascender=options.ascender;this.descender=options.descender;this.createdTimestamp=options.createdTimestamp;this.tables={os2:{usWeightClass:options.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:options.widthClass||this.usWidthClasses.MEDIUM,fsSelection:options.fsSelection||this.fsSelectionValues.REGULAR}};}
this.supported=true;this.glyphs=new glyphset.GlyphSet(this,options.glyphs||[]);this.encoding=new DefaultEncoding(this);this.substitution=new Substitution(this);this.tables=this.tables||{};Object.defineProperty(this,'hinting',{get:function(){if(this._hinting){return this._hinting;}
if(this.outlinesFormat==='truetype'){return(this._hinting=new Hinting(this));}}});}
Font.prototype.hasChar=function(c){return this.encoding.charToGlyphIndex(c)!==null;};Font.prototype.charToGlyphIndex=function(s){return this.encoding.charToGlyphIndex(s);};Font.prototype.charToGlyph=function(c){var glyphIndex=this.charToGlyphIndex(c);var glyph=this.glyphs.get(glyphIndex);if(!glyph){glyph=this.glyphs.get(0);}
return glyph;};Font.prototype.stringToGlyphs=function(s,options){var this$1=this;options=options||this.defaultRenderOptions;var indexes=[];for(var i=0;i<s.length;i+=1){var c=s[i];indexes.push(this$1.charToGlyphIndex(c));}
var length=indexes.length;if(options.features){var script=options.script||this.substitution.getDefaultScriptName();var manyToOne=[];if(options.features.liga){manyToOne=manyToOne.concat(this.substitution.getFeature('liga',script,options.language));}
if(options.features.rlig){manyToOne=manyToOne.concat(this.substitution.getFeature('rlig',script,options.language));}
for(var i$1=0;i$1<length;i$1+=1){for(var j=0;j<manyToOne.length;j++){var ligature=manyToOne[j];var components=ligature.sub;var compCount=components.length;var k=0;while(k<compCount&&components[k]===indexes[i$1+k]){k++;}
if(k===compCount){indexes.splice(i$1,compCount,ligature.by);length=length-compCount+1;}}}}
var glyphs=new Array(length);var notdef=this.glyphs.get(0);for(var i$2=0;i$2<length;i$2+=1){glyphs[i$2]=this$1.glyphs.get(indexes[i$2])||notdef;}
return glyphs;};Font.prototype.nameToGlyphIndex=function(name){return this.glyphNames.nameToGlyphIndex(name);};Font.prototype.nameToGlyph=function(name){var glyphIndex=this.nameToGlyphIndex(name);var glyph=this.glyphs.get(glyphIndex);if(!glyph){glyph=this.glyphs.get(0);}
return glyph;};Font.prototype.glyphIndexToName=function(gid){if(!this.glyphNames.glyphIndexToName){return'';}
return this.glyphNames.glyphIndexToName(gid);};Font.prototype.getKerningValue=function(leftGlyph,rightGlyph){leftGlyph=leftGlyph.index||leftGlyph;rightGlyph=rightGlyph.index||rightGlyph;var gposKerning=this.getGposKerningValue;return gposKerning?gposKerning(leftGlyph,rightGlyph):(this.kerningPairs[leftGlyph+','+rightGlyph]||0);};Font.prototype.defaultRenderOptions={kerning:true,features:{liga:true,rlig:true}};Font.prototype.forEachGlyph=function(text,x,y,fontSize,options,callback){var this$1=this;x=x!==undefined?x:0;y=y!==undefined?y:0;fontSize=fontSize!==undefined?fontSize:72;options=options||this.defaultRenderOptions;var fontScale=1/this.unitsPerEm*fontSize;var glyphs=this.stringToGlyphs(text,options);for(var i=0;i<glyphs.length;i+=1){var glyph=glyphs[i];callback.call(this$1,glyph,x,y,fontSize,options);if(glyph.advanceWidth){x+=glyph.advanceWidth*fontScale;}
if(options.kerning&&i<glyphs.length-1){var kerningValue=this$1.getKerningValue(glyph,glyphs[i+1]);x+=kerningValue*fontScale;}
if(options.letterSpacing){x+=options.letterSpacing*fontSize;}else if(options.tracking){x+=(options.tracking/1000)*fontSize;}}
return x;};Font.prototype.getPath=function(text,x,y,fontSize,options){var fullPath=new Path();this.forEachGlyph(text,x,y,fontSize,options,function(glyph,gX,gY,gFontSize){var glyphPath=glyph.getPath(gX,gY,gFontSize,options,this);fullPath.extend(glyphPath);});return fullPath;};Font.prototype.getPaths=function(text,x,y,fontSize,options){var glyphPaths=[];this.forEachGlyph(text,x,y,fontSize,options,function(glyph,gX,gY,gFontSize){var glyphPath=glyph.getPath(gX,gY,gFontSize,options,this);glyphPaths.push(glyphPath);});return glyphPaths;};Font.prototype.getAdvanceWidth=function(text,fontSize,options){return this.forEachGlyph(text,0,0,fontSize,options,function(){});};Font.prototype.draw=function(ctx,text,x,y,fontSize,options){this.getPath(text,x,y,fontSize,options).draw(ctx);};Font.prototype.drawPoints=function(ctx,text,x,y,fontSize,options){this.forEachGlyph(text,x,y,fontSize,options,function(glyph,gX,gY,gFontSize){glyph.drawPoints(ctx,gX,gY,gFontSize);});};Font.prototype.drawMetrics=function(ctx,text,x,y,fontSize,options){this.forEachGlyph(text,x,y,fontSize,options,function(glyph,gX,gY,gFontSize){glyph.drawMetrics(ctx,gX,gY,gFontSize);});};Font.prototype.getEnglishName=function(name){var translations=this.names[name];if(translations){return translations.en;}};Font.prototype.validate=function(){var warnings=[];var _this=this;function assert(predicate,message){if(!predicate){warnings.push(message);}}
function assertNamePresent(name){var englishName=_this.getEnglishName(name);assert(englishName&&englishName.trim().length>0,'No English '+name+' specified.');}
assertNamePresent('fontFamily');assertNamePresent('weightName');assertNamePresent('manufacturer');assertNamePresent('copyright');assertNamePresent('version');assert(this.unitsPerEm>0,'No unitsPerEm specified.');};Font.prototype.toTables=function(){return sfnt.fontToTable(this);};Font.prototype.toBuffer=function(){console.warn('Font.toBuffer is deprecated. Use Font.toArrayBuffer instead.');return this.toArrayBuffer();};Font.prototype.toArrayBuffer=function(){var sfntTable=this.toTables();var bytes=sfntTable.encode();var buffer=new ArrayBuffer(bytes.length);var intArray=new Uint8Array(buffer);for(var i=0;i<bytes.length;i++){intArray[i]=bytes[i];}
return buffer;};Font.prototype.download=function(fileName){var familyName=this.getEnglishName('fontFamily');var styleName=this.getEnglishName('fontSubfamily');fileName=fileName||familyName.replace(/\s/g,'')+'-'+styleName+'.otf';var arrayBuffer=this.toArrayBuffer();if(isBrowser()){window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem;window.requestFileSystem(window.TEMPORARY,arrayBuffer.byteLength,function(fs){fs.root.getFile(fileName,{create:true},function(fileEntry){fileEntry.createWriter(function(writer){var dataView=new DataView(arrayBuffer);var blob=new Blob([dataView],{type:'font/opentype'});writer.write(blob);writer.addEventListener('writeend',function(){location.href=fileEntry.toURL();},false);});});},function(err){throw new Error(err.name+': '+err.message);});}else{var fs=require('fs');var buffer=arrayBufferToNodeBuffer(arrayBuffer);fs.writeFileSync(fileName,buffer);}};Font.prototype.fsSelectionValues={ITALIC:0x001,UNDERSCORE:0x002,NEGATIVE:0x004,OUTLINED:0x008,STRIKEOUT:0x010,BOLD:0x020,REGULAR:0x040,USER_TYPO_METRICS:0x080,WWS:0x100,OBLIQUE:0x200};Font.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9};Font.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};function addName(name,names){var nameString=JSON.stringify(name);var nameID=256;for(var nameKey in names){var n=parseInt(nameKey);if(!n||n<256){continue;}
if(JSON.stringify(names[nameKey])===nameString){return n;}
if(nameID<=n){nameID=n+1;}}
names[nameID]=name;return nameID;}
function makeFvarAxis(n,axis,names){var nameID=addName(axis.name,names);return[{name:'tag_'+n,type:'TAG',value:axis.tag},{name:'minValue_'+n,type:'FIXED',value:axis.minValue<<16},{name:'defaultValue_'+n,type:'FIXED',value:axis.defaultValue<<16},{name:'maxValue_'+n,type:'FIXED',value:axis.maxValue<<16},{name:'flags_'+n,type:'USHORT',value:0},{name:'nameID_'+n,type:'USHORT',value:nameID}];}
function parseFvarAxis(data,start,names){var axis={};var p=new parse.Parser(data,start);axis.tag=p.parseTag();axis.minValue=p.parseFixed();axis.defaultValue=p.parseFixed();axis.maxValue=p.parseFixed();p.skip('uShort',1);axis.name=names[p.parseUShort()]||{};return axis;}
function makeFvarInstance(n,inst,axes,names){var nameID=addName(inst.name,names);var fields=[{name:'nameID_'+n,type:'USHORT',value:nameID},{name:'flags_'+n,type:'USHORT',value:0}];for(var i=0;i<axes.length;++i){var axisTag=axes[i].tag;fields.push({name:'axis_'+n+' '+axisTag,type:'FIXED',value:inst.coordinates[axisTag]<<16});}
return fields;}
function parseFvarInstance(data,start,axes,names){var inst={};var p=new parse.Parser(data,start);inst.name=names[p.parseUShort()]||{};p.skip('uShort',1);inst.coordinates={};for(var i=0;i<axes.length;++i){inst.coordinates[axes[i].tag]=p.parseFixed();}
return inst;}
function makeFvarTable(fvar,names){var result=new table.Table('fvar',[{name:'version',type:'ULONG',value:0x10000},{name:'offsetToData',type:'USHORT',value:0},{name:'countSizePairs',type:'USHORT',value:2},{name:'axisCount',type:'USHORT',value:fvar.axes.length},{name:'axisSize',type:'USHORT',value:20},{name:'instanceCount',type:'USHORT',value:fvar.instances.length},{name:'instanceSize',type:'USHORT',value:4+fvar.axes.length*4}]);result.offsetToData=result.sizeOf();for(var i=0;i<fvar.axes.length;i++){result.fields=result.fields.concat(makeFvarAxis(i,fvar.axes[i],names));}
for(var j=0;j<fvar.instances.length;j++){result.fields=result.fields.concat(makeFvarInstance(j,fvar.instances[j],fvar.axes,names));}
return result;}
function parseFvarTable(data,start,names){var p=new parse.Parser(data,start);var tableVersion=p.parseULong();check.argument(tableVersion===0x00010000,'Unsupported fvar table version.');var offsetToData=p.parseOffset16();p.skip('uShort',1);var axisCount=p.parseUShort();var axisSize=p.parseUShort();var instanceCount=p.parseUShort();var instanceSize=p.parseUShort();var axes=[];for(var i=0;i<axisCount;i++){axes.push(parseFvarAxis(data,start+offsetToData+i*axisSize,names));}
var instances=[];var instanceStart=start+offsetToData+axisCount*axisSize;for(var j=0;j<instanceCount;j++){instances.push(parseFvarInstance(data,instanceStart+j*instanceSize,axes,names));}
return{axes:axes,instances:instances};}
var fvar={make:makeFvarTable,parse:parseFvarTable};function parseTaggedListTable(data,start){var p=new parse.Parser(data,start);var n=p.parseUShort();var list=[];for(var i=0;i<n;i++){list[p.parseTag()]={offset:p.parseUShort()};}
return list;}
function parseCoverageTable(data,start){var p=new parse.Parser(data,start);var format=p.parseUShort();var count=p.parseUShort();if(format===1){return p.parseUShortList(count);}else if(format===2){var coverage=[];for(;count--;){var begin=p.parseUShort();var end=p.parseUShort();var index=p.parseUShort();for(var i=begin;i<=end;i++){coverage[index++]=i;}}
return coverage;}}
function parseClassDefTable(data,start){var p=new parse.Parser(data,start);var format=p.parseUShort();if(format===1){var startGlyph=p.parseUShort();var glyphCount=p.parseUShort();var classes=p.parseUShortList(glyphCount);return function(glyphID){return classes[glyphID-startGlyph]||0;};}else if(format===2){var rangeCount=p.parseUShort();var startGlyphs=[];var endGlyphs=[];var classValues=[];for(var i=0;i<rangeCount;i++){startGlyphs[i]=p.parseUShort();endGlyphs[i]=p.parseUShort();classValues[i]=p.parseUShort();}
return function(glyphID){var l=0;var r=startGlyphs.length-1;while(l<r){var c=(l+r+1)>>1;if(glyphID<startGlyphs[c]){r=c-1;}else{l=c;}}
if(startGlyphs[l]<=glyphID&&glyphID<=endGlyphs[l]){return classValues[l]||0;}
return 0;};}}
function parsePairPosSubTable(data,start){var p=new parse.Parser(data,start);var format=p.parseUShort();var coverageOffset=p.parseUShort();var coverage=parseCoverageTable(data,start+coverageOffset);var valueFormat1=p.parseUShort();var valueFormat2=p.parseUShort();var value1;var value2;if(valueFormat1!==4||valueFormat2!==0){return;}
var sharedPairSets={};if(format===1){var pairSetCount=p.parseUShort();var pairSet=[];var pairSetOffsets=p.parseOffset16List(pairSetCount);for(var firstGlyph=0;firstGlyph<pairSetCount;firstGlyph++){var pairSetOffset=pairSetOffsets[firstGlyph];var sharedPairSet=sharedPairSets[pairSetOffset];if(!sharedPairSet){sharedPairSet={};p.relativeOffset=pairSetOffset;var pairValueCount=p.parseUShort();for(;pairValueCount--;){var secondGlyph=p.parseUShort();if(valueFormat1){value1=p.parseShort();}
if(valueFormat2){value2=p.parseShort();}
sharedPairSet[secondGlyph]=value1;}}
pairSet[coverage[firstGlyph]]=sharedPairSet;}
return function(leftGlyph,rightGlyph){var pairs=pairSet[leftGlyph];if(pairs){return pairs[rightGlyph];}};}else if(format===2){var classDef1Offset=p.parseUShort();var classDef2Offset=p.parseUShort();var class1Count=p.parseUShort();var class2Count=p.parseUShort();var getClass1=parseClassDefTable(data,start+classDef1Offset);var getClass2=parseClassDefTable(data,start+classDef2Offset);var kerningMatrix=[];for(var i=0;i<class1Count;i++){var kerningRow=kerningMatrix[i]=[];for(var j=0;j<class2Count;j++){if(valueFormat1){value1=p.parseShort();}
if(valueFormat2){value2=p.parseShort();}
kerningRow[j]=value1;}}
var covered={};for(var i$1=0;i$1<coverage.length;i$1++){covered[coverage[i$1]]=1;}
return function(leftGlyph,rightGlyph){if(!covered[leftGlyph]){return;}
var class1=getClass1(leftGlyph);var class2=getClass2(rightGlyph);var kerningRow=kerningMatrix[class1];if(kerningRow){return kerningRow[class2];}};}}
function parseLookupTable(data,start){var p=new parse.Parser(data,start);var lookupType=p.parseUShort();var lookupFlag=p.parseUShort();var useMarkFilteringSet=lookupFlag&0x10;var subTableCount=p.parseUShort();var subTableOffsets=p.parseOffset16List(subTableCount);var table={lookupType:lookupType,lookupFlag:lookupFlag,markFilteringSet:useMarkFilteringSet?p.parseUShort():-1};if(lookupType===2){var subtables=[];for(var i=0;i<subTableCount;i++){var pairPosSubTable=parsePairPosSubTable(data,start+subTableOffsets[i]);if(pairPosSubTable){subtables.push(pairPosSubTable);}}
table.getKerningValue=function(leftGlyph,rightGlyph){for(var i=subtables.length;i--;){var value=subtables[i](leftGlyph,rightGlyph);if(value!==undefined){return value;}}
return 0;};}
return table;}
function parseGposTable(data,start,font){var p=new parse.Parser(data,start);var tableVersion=p.parseVersion(1);check.argument(tableVersion===1||tableVersion===1.1,'Unsupported GPOS table version.');parseTaggedListTable(data,start+p.parseUShort());parseTaggedListTable(data,start+p.parseUShort());var lookupListOffset=p.parseUShort();p.relativeOffset=lookupListOffset;var lookupCount=p.parseUShort();var lookupTableOffsets=p.parseOffset16List(lookupCount);var lookupListAbsoluteOffset=start+lookupListOffset;for(var i=0;i<lookupCount;i++){var table=parseLookupTable(data,lookupListAbsoluteOffset+lookupTableOffsets[i]);if(table.lookupType===2&&!font.getGposKerningValue){font.getGposKerningValue=table.getKerningValue;}}}
var gpos={parse:parseGposTable};function parseWindowsKernTable(p){var pairs={};p.skip('uShort');var subtableVersion=p.parseUShort();check.argument(subtableVersion===0,'Unsupported kern sub-table version.');p.skip('uShort',2);var nPairs=p.parseUShort();p.skip('uShort',3);for(var i=0;i<nPairs;i+=1){var leftIndex=p.parseUShort();var rightIndex=p.parseUShort();var value=p.parseShort();pairs[leftIndex+','+rightIndex]=value;}
return pairs;}
function parseMacKernTable(p){var pairs={};p.skip('uShort');var nTables=p.parseULong();if(nTables>1){console.warn('Only the first kern subtable is supported.');}
p.skip('uLong');var coverage=p.parseUShort();var subtableVersion=coverage&0xFF;p.skip('uShort');if(subtableVersion===0){var nPairs=p.parseUShort();p.skip('uShort',3);for(var i=0;i<nPairs;i+=1){var leftIndex=p.parseUShort();var rightIndex=p.parseUShort();var value=p.parseShort();pairs[leftIndex+','+rightIndex]=value;}}
return pairs;}
function parseKernTable(data,start){var p=new parse.Parser(data,start);var tableVersion=p.parseUShort();if(tableVersion===0){return parseWindowsKernTable(p);}else if(tableVersion===1){return parseMacKernTable(p);}else{throw new Error('Unsupported kern table version ('+tableVersion+').');}}
var kern={parse:parseKernTable};function parseLocaTable(data,start,numGlyphs,shortVersion){var p=new parse.Parser(data,start);var parseFn=shortVersion?p.parseUShort:p.parseULong;var glyphOffsets=[];for(var i=0;i<numGlyphs+1;i+=1){var glyphOffset=parseFn.call(p);if(shortVersion){glyphOffset*=2;}
glyphOffsets.push(glyphOffset);}
return glyphOffsets;}
var loca={parse:parseLocaTable};function loadFromFile(path,callback){var fs=require('fs');fs.readFile(path,function(err,buffer){if(err){return callback(err.message);}
callback(null,nodeBufferToArrayBuffer(buffer));});}
function loadFromUrl(url,callback){var request=new XMLHttpRequest();request.open('get',url,true);request.responseType='arraybuffer';request.onload=function(){if(request.response){return callback(null,request.response);}else{return callback('Font could not be loaded: '+request.statusText);}};request.onerror=function(){callback('Font could not be loaded');};request.send();}
function parseOpenTypeTableEntries(data,numTables){var tableEntries=[];var p=12;for(var i=0;i<numTables;i+=1){var tag=parse.getTag(data,p);var checksum=parse.getULong(data,p+4);var offset=parse.getULong(data,p+8);var length=parse.getULong(data,p+12);tableEntries.push({tag:tag,checksum:checksum,offset:offset,length:length,compression:false});p+=16;}
return tableEntries;}
function parseWOFFTableEntries(data,numTables){var tableEntries=[];var p=44;for(var i=0;i<numTables;i+=1){var tag=parse.getTag(data,p);var offset=parse.getULong(data,p+4);var compLength=parse.getULong(data,p+8);var origLength=parse.getULong(data,p+12);var compression=(void 0);if(compLength<origLength){compression='WOFF';}else{compression=false;}
tableEntries.push({tag:tag,offset:offset,compression:compression,compressedLength:compLength,length:origLength});p+=20;}
return tableEntries;}
function uncompressTable(data,tableEntry){if(tableEntry.compression==='WOFF'){var inBuffer=new Uint8Array(data.buffer,tableEntry.offset+2,tableEntry.compressedLength-2);var outBuffer=new Uint8Array(tableEntry.length);tinyInflate(inBuffer,outBuffer);if(outBuffer.byteLength!==tableEntry.length){throw new Error('Decompression error: '+tableEntry.tag+' decompressed length doesn\'t match recorded length');}
var view=new DataView(outBuffer.buffer,0);return{data:view,offset:0};}else{return{data:data,offset:tableEntry.offset};}}
function parseBuffer(buffer){var indexToLocFormat;var ltagTable;var font=new Font({empty:true});var data=new DataView(buffer,0);var numTables;var tableEntries=[];var signature=parse.getTag(data,0);if(signature===String.fromCharCode(0,1,0,0)||signature==='true'||signature==='typ1'){font.outlinesFormat='truetype';numTables=parse.getUShort(data,4);tableEntries=parseOpenTypeTableEntries(data,numTables);}else if(signature==='OTTO'){font.outlinesFormat='cff';numTables=parse.getUShort(data,4);tableEntries=parseOpenTypeTableEntries(data,numTables);}else if(signature==='wOFF'){var flavor=parse.getTag(data,4);if(flavor===String.fromCharCode(0,1,0,0)){font.outlinesFormat='truetype';}else if(flavor==='OTTO'){font.outlinesFormat='cff';}else{throw new Error('Unsupported OpenType flavor '+signature);}
numTables=parse.getUShort(data,12);tableEntries=parseWOFFTableEntries(data,numTables);}else{throw new Error('Unsupported OpenType signature '+signature);}
var cffTableEntry;var fvarTableEntry;var glyfTableEntry;var gposTableEntry;var gsubTableEntry;var hmtxTableEntry;var kernTableEntry;var locaTableEntry;var nameTableEntry;var metaTableEntry;var p;for(var i=0;i<numTables;i+=1){var tableEntry=tableEntries[i];var table=(void 0);switch(tableEntry.tag){case'cmap':table=uncompressTable(data,tableEntry);font.tables.cmap=cmap.parse(table.data,table.offset);font.encoding=new CmapEncoding(font.tables.cmap);break;case'cvt ':table=uncompressTable(data,tableEntry);p=new parse.Parser(table.data,table.offset);font.tables.cvt=p.parseShortList(tableEntry.length/2);break;case'fvar':fvarTableEntry=tableEntry;break;case'fpgm':table=uncompressTable(data,tableEntry);p=new parse.Parser(table.data,table.offset);font.tables.fpgm=p.parseByteList(tableEntry.length);break;case'head':table=uncompressTable(data,tableEntry);font.tables.head=head.parse(table.data,table.offset);font.unitsPerEm=font.tables.head.unitsPerEm;indexToLocFormat=font.tables.head.indexToLocFormat;break;case'hhea':table=uncompressTable(data,tableEntry);font.tables.hhea=hhea.parse(table.data,table.offset);font.ascender=font.tables.hhea.ascender;font.descender=font.tables.hhea.descender;font.numberOfHMetrics=font.tables.hhea.numberOfHMetrics;break;case'hmtx':hmtxTableEntry=tableEntry;break;case'ltag':table=uncompressTable(data,tableEntry);ltagTable=ltag.parse(table.data,table.offset);break;case'maxp':table=uncompressTable(data,tableEntry);font.tables.maxp=maxp.parse(table.data,table.offset);font.numGlyphs=font.tables.maxp.numGlyphs;break;case'name':nameTableEntry=tableEntry;break;case'OS/2':table=uncompressTable(data,tableEntry);font.tables.os2=os2.parse(table.data,table.offset);break;case'post':table=uncompressTable(data,tableEntry);font.tables.post=post.parse(table.data,table.offset);font.glyphNames=new GlyphNames(font.tables.post);break;case'prep':table=uncompressTable(data,tableEntry);p=new parse.Parser(table.data,table.offset);font.tables.prep=p.parseByteList(tableEntry.length);break;case'glyf':glyfTableEntry=tableEntry;break;case'loca':locaTableEntry=tableEntry;break;case'CFF ':cffTableEntry=tableEntry;break;case'kern':kernTableEntry=tableEntry;break;case'GPOS':gposTableEntry=tableEntry;break;case'GSUB':gsubTableEntry=tableEntry;break;case'meta':metaTableEntry=tableEntry;break;}}
var nameTable=uncompressTable(data,nameTableEntry);font.tables.name=_name.parse(nameTable.data,nameTable.offset,ltagTable);font.names=font.tables.name;if(glyfTableEntry&&locaTableEntry){var shortVersion=indexToLocFormat===0;var locaTable=uncompressTable(data,locaTableEntry);var locaOffsets=loca.parse(locaTable.data,locaTable.offset,font.numGlyphs,shortVersion);var glyfTable=uncompressTable(data,glyfTableEntry);font.glyphs=glyf.parse(glyfTable.data,glyfTable.offset,locaOffsets,font);}else if(cffTableEntry){var cffTable=uncompressTable(data,cffTableEntry);cff.parse(cffTable.data,cffTable.offset,font);}else{throw new Error('Font doesn\'t contain TrueType or CFF outlines.');}
var hmtxTable=uncompressTable(data,hmtxTableEntry);hmtx.parse(hmtxTable.data,hmtxTable.offset,font.numberOfHMetrics,font.numGlyphs,font.glyphs);addGlyphNames(font);if(kernTableEntry){var kernTable=uncompressTable(data,kernTableEntry);font.kerningPairs=kern.parse(kernTable.data,kernTable.offset);}else{font.kerningPairs={};}
if(gposTableEntry){var gposTable=uncompressTable(data,gposTableEntry);gpos.parse(gposTable.data,gposTable.offset,font);}
if(gsubTableEntry){var gsubTable=uncompressTable(data,gsubTableEntry);font.tables.gsub=gsub.parse(gsubTable.data,gsubTable.offset);}
if(fvarTableEntry){var fvarTable=uncompressTable(data,fvarTableEntry);font.tables.fvar=fvar.parse(fvarTable.data,fvarTable.offset,font.names);}
if(metaTableEntry){var metaTable=uncompressTable(data,metaTableEntry);font.tables.meta=meta.parse(metaTable.data,metaTable.offset);font.metas=font.tables.meta;}
return font;}
function load(url,callback){var isNode$$1=typeof window==='undefined';var loadFn=isNode$$1?loadFromFile:loadFromUrl;loadFn(url,function(err,arrayBuffer){if(err){return callback(err);}
var font;try{font=parseBuffer(arrayBuffer);}catch(e){return callback(e,null);}
return callback(null,font);});}
function loadSync(url){var fs=require('fs');var buffer=fs.readFileSync(url);return parseBuffer(nodeBufferToArrayBuffer(buffer));}
exports.Font=Font;exports.Glyph=Glyph;exports.Path=Path;exports.BoundingBox=BoundingBox;exports._parse=parse;exports.parse=parseBuffer;exports.load=load;exports.loadSync=loadSync;Object.defineProperty(exports,'__esModule',{value:true});})));;$(document).ready(function(){Drupal.settings.logo_step3_timer_obj={};Drupal.settings.logo_step3_timer_obj['on_logo_step3_page_start']=Date.now();if(Drupal.settings.weebly_preview_v2_split_set&&$("body[class*='page-body-step3-parent']").length&&!$("body").hasClass('.page-body-business-cards-step3)'))
config_bc_suggestion_lightbox();$('.flash_plugin a').click(function(){var logo_id=Drupal.settings.logo_id;var type=Drupal.settings.logo_type;var urln=$(this).attr('href');$.ajax({url:Drupal.settings.baseUrl+'/save-logo/'+type+'/'+logo_id,success:function(Response){window.onbeforeunload=null;window.location.href=urln;}});return false;});window.onbeforeunload=function(){return Drupal.settings.leave_page_message};$("a").click(function(){window.onbeforeunload=null;});$('#flashContent .SafesaveBtn').click(function(){if(Drupal.settings.logo_type=="parent")
step3_safesave_logo();else{window.onbeforeunload=null;window.location=Drupal.settings.baseUrl+'/mylogos';return false;}
flash_show_overlay2();$('#TB_overlay').css('z-index',102);return false;});$('.scrollerConteiner #next').click(function(){var img=$('.scrollerConteiner .scroller ul').find("img[src='#']:first");img_ids=img.attr('id');img_ids=img_ids.split('_');img.attr('src',Drupal.settings.step3_image_src[img_ids[1]]);});if(Drupal.settings.ismobile){$('body').on('mousedown touchstart','#FreelogoEditorCanvas-EditorUI-BackDesignDlg .selector-dlg-wrapper .inner-wrapper .selector-slider .design-item',function(){console.log("ACTION: accepted_bc_upsell");fls_events_add('accepted_bc_upsell');});}
$('body').on('mousedown touchstart','#FreelogoEditorCanvas-EditorUI-BackDesignDlg .selector-dlg-wrapper .selector-action',function(){if($(this).attr("data-action")=='remove-cancel'){console.log("ACTION: lightbox_step3bc_close");fls_events_add('lightbox_step3bc_close');fls_events_add('close_bc_upsell');}});$('body').on('mouseover mousedown touchstart','#FreelogoEditorCanvas-EditorUI-BackDesignDlg ',function(){if(typeof Drupal.settings.bc_suggestions_cards_viewed=='undefined'){Drupal.settings.bc_suggestions_cards_viewed=true;fls_events_add('lightbox_step3bc_views');}});$('body').on('mousedown touchstart','#FreelogoEditorCanvas-EditorUI-BackDesignDlg .selector-dlg-wrapper.no-navigation .close-suggest-dlg',function(){fls_events_add('lightbox_step3bc_close');fls_events_add('close_bc_upsell');});$('body').on('mousedown touchstart','#FreelogoEditorCanvas-EditorUI-BackDesignDlg .selector-dlg-wrapper.no-navigation .selector-action.fls-button.fls-orangebutton',function(){fls_events_add('lightbox_step3bc_negativecta');});$('body').on('mousedown','#FreelogoEditorCanvas-EditorUI-BackDesignDlg .selector-dlg-wrapper.no-navigation',function(){if($('#FreelogoEditorCanvas-EditorUI-BackDesignDlg .selector-dlg-wrapper.no-navigation .design-item').length==6){if(!Drupal.settings.events_logoweb_bc_init){Drupal.settings.events_logoweb_bc_init=true;}}});$('body').on('mouseover','#FreelogoEditorCanvas-EditorUI-BackDesignDlg .selector-dlg-wrapper.no-navigation',function(){if(Drupal.settings.lang=='tr'){$("#FreelogoEditorCanvas-EditorUI-BackDesignDlg .selector-dlg-wrapper .selector-slider .design-item span").html(Drupal.settings.buttonText);}
$("#FreelogoEditorCanvas-EditorUI-BackDesignDlg .selector-dlg-wrapper .selector-slider .design-item span").addClass("orangeButton");});$('body').on('mousedown','#FreelogoEditorCanvas-EditorUI-BackDesignDlg .selector-dlg-wrapper.no-navigation .design-item',function(){if(!Drupal.settings.events_bc_upsell_direct_save){Drupal.settings.events_bc_upsell_direct_save=true;fls_events_add('bc_upsell_direct_save');fls_events_add('accepted_bc_upsell');}});});function flash_redirect_step4(skip_popup)
{if(Drupal.settings.notice_url!='undefined'){var url=Drupal.settings.notice_url;}else{var url=Drupal.settings.baseUrl+'/step4';}
window.onbeforeunload=null;if(Drupal.settings.force_bc==1){Drupal.settings.logo_step3_timer_obj['on_logo_step3_page_end']=Date.now();fls_events_add('on_logo_step3_page_timer',Math.round((Drupal.settings.logo_step3_timer_obj['on_logo_step3_page_end']-Drupal.settings.logo_step3_timer_obj['on_logo_step3_page_start'])/1000));window.location.href=url;return;}
var editor_response=false;if(typeof skip_popup=='object'){editor_response=skip_popup;Drupal.settings.step3_save_result=editor_response;if(editor_response.bc_logoweb_show_lightbox==0){if(Drupal.settings.logoweb_split_set||Drupal.settings.bc_logoweb_split_set||Drupal.settings.tlds_split_set){if(!editor_response.suggest_card_id)
ga('send','event','Domain LB Logo Flow','Not_Fired','Domain_LB_not_fired_logo');}
Drupal.settings.bc_logoweb_split_set=0;Drupal.settings.tlds_split_set=0;Drupal.settings.suggest_pp=1;}
else{if(typeof editor_response.website_response!='undefined'){Drupal.settings.websites_populate_data=editor_response.website_response;}}
skip_popup=false;}
Drupal.settings.skip_domain_result_population=0;skip_popup=skip_popup||false;if(!skip_popup&&Drupal.settings.pp_suggestion_split&&(Drupal.settings.logo_type!="logo"||Drupal.settings.favorites!=='0')){if(flash_promo_products_popup())
return;else if(fls_show_logowebv2_lightbox())
return;}
if(!skip_popup&&(Drupal.settings.bc_logoweb_split_set||Drupal.settings.tlds_split_set)&&(Drupal.settings.logo_type!="logo"||Drupal.settings.favorites!=='0')){if(flash_promo_products_popup())
return;else if(fls_show_logowebv2_lightbox())
return;}
Drupal.settings.logo_step3_timer_obj['on_logo_step3_page_end']=Date.now();fls_events_add('on_logo_step3_page_timer',Math.round((Drupal.settings.logo_step3_timer_obj['on_logo_step3_page_end']-Drupal.settings.logo_step3_timer_obj['on_logo_step3_page_start'])/1000));window.location.href=url;}
function flash_show_overlay()
{$('body').append('<div id="TB_overlay" class="TB_overlayBG"></div>');$('body').append('<div id="TB_window" style="display:block"></div>');$('#flash_container').css('z-index',101);$('#TB_window').show();}
function flash_show_overlay2()
{$('body').append('<div id="TB_overlay" class="TB_overlayBG"></div>');$('body').append('<div id="TB_window" style="display:block"></div>');$('#flash_container').css('z-index',101);$('#TB_window').html('<div id="TB_load" class="custom_tb_overlay"><p align="center"><img src="https://freelogo-assets.s3.amazonaws.com/sites/all/themes/freelogoservices/images/loading_animation.gif" /><br />'+Drupal.settings.step2_texttojs.text2+'</p></div>');$('#TB_overlay').fadeIn(1000);$('#TB_window').show();}
function flash_hide_overlay()
{$('#TB_overlay').remove();$('#TB_window').remove();$('#flash_container').css('z-index',1);}
function flash_show_tips(){tb_show("",Drupal.settings.baseUrl+'/logo_step3_modal?TB_iframe=true&width=540&height=310','');return false;}
function step3_safesave_logo(noRedirect){if(noRedirect===undefined){noRedirect=0;}
var url='/step2-save/'+Drupal.settings.logo_id;url_suffix='?';if(typeof logodata.post_back_data!='undefined'){if(typeof logodata.post_back_data['force_font']!='undefined'){url_suffix+='force_font='+logodata.post_back_data['force_font']+'&';}
if(typeof logodata.post_back_data['layout']!='undefined'){url_suffix+='layout='+logodata.post_back_data['layout']+'&';}
if(typeof logodata.post_back_data['new_logo']!='undefined'&&logodata.post_back_data['new_logo']){url_suffix+='new_logo='+logodata.post_back_data['new_logo']+'&';}}
if(url_suffix.length>0){url+=url_suffix;}
url+='edited=1';$.ajax({url:url,type:'post',data:'json=1&action=save&noRedirect='+noRedirect,dataType:'json',success:function(result){Drupal.settings.step3_directsave_lid=result.step3_direct_save;FLSLogoEditor.onCheckDirectSaveCallback(result.step3_direct_save);if(noRedirect){var lid=result.step3_direct_save||0;}
else{window.onbeforeunload=null;window.location=Drupal.settings.baseUrl+'/step4?destination=mylogos';}}});}
function check_logo_direct_save(){return'';}
editorLoaded=false;function editor_ready(){editorLoaded=true;};(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory);}else{factory(jQuery);}}(function($){$.ui=$.ui||{};var version=$.ui.version="1.12.1";var widgetUuid=0;var widgetSlice=Array.prototype.slice;$.cleanData=(function(orig){return function(elems){var events,elem,i;for(i=0;(elem=elems[i])!=null;i++){try{events=$._data(elem,"events");if(events&&events.remove){$(elem).triggerHandler("remove");}}catch(e){}}
orig(elems);};})($.cleanData);$.widget=function(name,base,prototype){var existingConstructor,constructor,basePrototype;var proxiedPrototype={};var namespace=name.split(".")[0];name=name.split(".")[1];var fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget;}
if($.isArray(prototype)){prototype=$.extend.apply(null,[{}].concat(prototype));}
$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName);};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget){return new constructor(options,element);}
if(arguments.length){this._createWidget(options,element);}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base();basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return;}
proxiedPrototype[prop]=(function(){function _super(){return base.prototype[prop].apply(this,arguments);}
function _superApply(args){return base.prototype[prop].apply(this,args);}
return function(){var __super=this._super;var __superApply=this._superApply;var returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue;};})();});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?(basePrototype.widgetEventPrefix||name):name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto);});delete existingConstructor._childConstructors;}else{base._childConstructors.push(constructor);}
$.widget.bridge(name,constructor);return constructor;};$.widget.extend=function(target){var input=widgetSlice.call(arguments,1);var inputIndex=0;var inputLength=input.length;var key;var value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value);}else{target[key]=value;}}}}
return target;};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options==="string";var args=widgetSlice.call(arguments,1);var returnValue=this;if(isMethodCall){if(!this.length&&options==="instance"){returnValue=undefined;}else{this.each(function(){var methodValue;var instance=$.data(this,fullName);if(options==="instance"){returnValue=instance;return false;}
if(!instance){return $.error("cannot call methods on "+name+" prior to initialization; "+"attempted to call method '"+options+"'");}
if(!$.isFunction(instance[options])||options.charAt(0)==="_"){return $.error("no such method '"+options+"' for "+name+" widget instance");}
methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false;}});}}else{if(args.length){options=$.widget.extend.apply(null,[options].concat(args));}
this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{});if(instance._init){instance._init();}}else{$.data(this,fullName,new object(options,this));}});}
return returnValue;};};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=widgetUuid++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=$();this.hoverable=$();this.focusable=$();this.classesElementLookup={};if(element!==this){$.data(element,this.widgetFullName,this);this._on(true,this.element,{remove:function(event){if(event.target===element){this.destroy();}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow);}
this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this._create();if(this.options.disabled){this._setOptionDisabled(this.options.disabled);}
this._trigger("create",null,this._getCreateEventData());this._init();},_getCreateOptions:function(){return{};},_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){var that=this;this._destroy();$.each(this.classesElementLookup,function(key,value){that._removeClass(value,key);});this.element.off(this.eventNamespace).removeData(this.widgetFullName);this.widget().off(this.eventNamespace).removeAttr("aria-disabled");this.bindings.off(this.eventNamespace);},_destroy:$.noop,widget:function(){return this.element;},option:function(key,value){var options=key;var parts;var curOption;var i;if(arguments.length===0){return $.widget.extend({},this.options);}
if(typeof key==="string"){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]];}
key=parts.pop();if(arguments.length===1){return curOption[key]===undefined?null:curOption[key];}
curOption[key]=value;}else{if(arguments.length===1){return this.options[key]===undefined?null:this.options[key];}
options[key]=value;}}
this._setOptions(options);return this;},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key]);}
return this;},_setOption:function(key,value){if(key==="classes"){this._setOptionClasses(value);}
this.options[key]=value;if(key==="disabled"){this._setOptionDisabled(value);}
return this;},_setOptionClasses:function(value){var classKey,elements,currentElements;for(classKey in value){currentElements=this.classesElementLookup[classKey];if(value[classKey]===this.options.classes[classKey]||!currentElements||!currentElements.length){continue;}
elements=$(currentElements.get());this._removeClass(currentElements,classKey);elements.addClass(this._classes({element:elements,keys:classKey,classes:value,add:true}));}},_setOptionDisabled:function(value){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!value);if(value){this._removeClass(this.hoverable,null,"ui-state-hover");this._removeClass(this.focusable,null,"ui-state-focus");}},enable:function(){return this._setOptions({disabled:false});},disable:function(){return this._setOptions({disabled:true});},_classes:function(options){var full=[];var that=this;options=$.extend({element:this.element,classes:this.options.classes||{}},options);function processClassString(classes,checkOption){var current,i;for(i=0;i<classes.length;i++){current=that.classesElementLookup[classes[i]]||$();if(options.add){current=$($.unique(current.get().concat(options.element.get())));}else{current=$(current.not(options.element).get());}
that.classesElementLookup[classes[i]]=current;full.push(classes[i]);if(checkOption&&options.classes[classes[i]]){full.push(options.classes[classes[i]]);}}}
this._on(options.element,{"remove":"_untrackClassesElement"});if(options.keys){processClassString(options.keys.match(/\S+/g)||[],true);}
if(options.extra){processClassString(options.extra.match(/\S+/g)||[]);}
return full.join(" ");},_untrackClassesElement:function(event){var that=this;$.each(that.classesElementLookup,function(key,value){if($.inArray(event.target,value)!==-1){that.classesElementLookup[key]=$(value.not(event.target).get());}});},_removeClass:function(element,keys,extra){return this._toggleClass(element,keys,extra,false);},_addClass:function(element,keys,extra){return this._toggleClass(element,keys,extra,true);},_toggleClass:function(element,keys,extra,add){add=(typeof add==="boolean")?add:extra;var shift=(typeof element==="string"||element===null),options={extra:shift?keys:extra,keys:shift?element:keys,element:shift?this.element:element,add:add};options.element.toggleClass(this._classes(options),add);return this;},_on:function(suppressDisabledCheck,element,handlers){var delegateElement;var instance=this;if(typeof suppressDisabledCheck!=="boolean"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=false;}
if(!handlers){handlers=element;element=this.element;delegateElement=this.widget();}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element);}
$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===true||$(this).hasClass("ui-state-disabled"))){return;}
return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
if(typeof handler!=="string"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++;}
var match=event.match(/^([\w:-]*)\s*(.*)$/);var eventName=match[1]+instance.eventNamespace;var selector=match[2];if(selector){delegateElement.on(eventName,selector,handlerProxy);}else{element.on(eventName,handlerProxy);}});},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+
this.eventNamespace;element.off(eventName).off(eventName);this.bindings=$(this.bindings.not(element).get());this.focusable=$(this.focusable.not(element).get());this.hoverable=$(this.hoverable.not(element).get());},_delay:function(handler,delay){function handlerProxy(){return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
var instance=this;return setTimeout(handlerProxy,delay||0);},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){this._addClass($(event.currentTarget),null,"ui-state-hover");},mouseleave:function(event){this._removeClass($(event.currentTarget),null,"ui-state-hover");}});},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){this._addClass($(event.currentTarget),null,"ui-state-focus");},focusout:function(event){this._removeClass($(event.currentTarget),null,"ui-state-focus");}});},_trigger:function(type,event,data){var prop,orig;var callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop];}}}
this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===false||event.isDefaultPrevented());}};$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){if(typeof options==="string"){options={effect:options};}
var hasOptions;var effectName=!options?method:options===true||typeof options==="number"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options==="number"){options={duration:options};}
hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay);}
if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options);}else if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback);}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0]);}
next();});}};});var widget=$.widget;(function(){var cachedScrollbarWidth,max=Math.max,abs=Math.abs,rhorizontal=/left|center|right/,rvertical=/top|center|bottom/,roffset=/[\+\-]\d+(\.[\d]+)?%?/,rposition=/^\w+/,rpercent=/%$/,_position=$.fn.position;function getOffsets(offsets,width,height){return[parseFloat(offsets[0])*(rpercent.test(offsets[0])?width/100:1),parseFloat(offsets[1])*(rpercent.test(offsets[1])?height/100:1)];}
function parseCss(element,property){return parseInt($.css(element,property),10)||0;}
function getDimensions(elem){var raw=elem[0];if(raw.nodeType===9){return{width:elem.width(),height:elem.height(),offset:{top:0,left:0}};}
if($.isWindow(raw)){return{width:elem.width(),height:elem.height(),offset:{top:elem.scrollTop(),left:elem.scrollLeft()}};}
if(raw.preventDefault){return{width:0,height:0,offset:{top:raw.pageY,left:raw.pageX}};}
return{width:elem.outerWidth(),height:elem.outerHeight(),offset:elem.offset()};}
$.position={scrollbarWidth:function(){if(cachedScrollbarWidth!==undefined){return cachedScrollbarWidth;}
var w1,w2,div=$("<div "+"style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'>"+"<div style='height:100px;width:auto;'></div></div>"),innerDiv=div.children()[0];$("body").append(div);w1=innerDiv.offsetWidth;div.css("overflow","scroll");w2=innerDiv.offsetWidth;if(w1===w2){w2=div[0].clientWidth;}
div.remove();return(cachedScrollbarWidth=w1-w2);},getScrollInfo:function(within){var overflowX=within.isWindow||within.isDocument?"":within.element.css("overflow-x"),overflowY=within.isWindow||within.isDocument?"":within.element.css("overflow-y"),hasOverflowX=overflowX==="scroll"||(overflowX==="auto"&&within.width<within.element[0].scrollWidth),hasOverflowY=overflowY==="scroll"||(overflowY==="auto"&&within.height<within.element[0].scrollHeight);return{width:hasOverflowY?$.position.scrollbarWidth():0,height:hasOverflowX?$.position.scrollbarWidth():0};},getWithinInfo:function(element){var withinElement=$(element||window),isWindow=$.isWindow(withinElement[0]),isDocument=!!withinElement[0]&&withinElement[0].nodeType===9,hasOffset=!isWindow&&!isDocument;return{element:withinElement,isWindow:isWindow,isDocument:isDocument,offset:hasOffset?$(element).offset():{left:0,top:0},scrollLeft:withinElement.scrollLeft(),scrollTop:withinElement.scrollTop(),width:withinElement.outerWidth(),height:withinElement.outerHeight()};}};$.fn.position=function(options){if(!options||!options.of){return _position.apply(this,arguments);}
options=$.extend({},options);var atOffset,targetWidth,targetHeight,targetOffset,basePosition,dimensions,target=$(options.of),within=$.position.getWithinInfo(options.within),scrollInfo=$.position.getScrollInfo(within),collision=(options.collision||"flip").split(" "),offsets={};dimensions=getDimensions(target);if(target[0].preventDefault){options.at="left top";}
targetWidth=dimensions.width;targetHeight=dimensions.height;targetOffset=dimensions.offset;basePosition=$.extend({},targetOffset);$.each(["my","at"],function(){var pos=(options[this]||"").split(" "),horizontalOffset,verticalOffset;if(pos.length===1){pos=rhorizontal.test(pos[0])?pos.concat(["center"]):rvertical.test(pos[0])?["center"].concat(pos):["center","center"];}
pos[0]=rhorizontal.test(pos[0])?pos[0]:"center";pos[1]=rvertical.test(pos[1])?pos[1]:"center";horizontalOffset=roffset.exec(pos[0]);verticalOffset=roffset.exec(pos[1]);offsets[this]=[horizontalOffset?horizontalOffset[0]:0,verticalOffset?verticalOffset[0]:0];options[this]=[rposition.exec(pos[0])[0],rposition.exec(pos[1])[0]];});if(collision.length===1){collision[1]=collision[0];}
if(options.at[0]==="right"){basePosition.left+=targetWidth;}else if(options.at[0]==="center"){basePosition.left+=targetWidth/2;}
if(options.at[1]==="bottom"){basePosition.top+=targetHeight;}else if(options.at[1]==="center"){basePosition.top+=targetHeight/2;}
atOffset=getOffsets(offsets.at,targetWidth,targetHeight);basePosition.left+=atOffset[0];basePosition.top+=atOffset[1];return this.each(function(){var collisionPosition,using,elem=$(this),elemWidth=elem.outerWidth(),elemHeight=elem.outerHeight(),marginLeft=parseCss(this,"marginLeft"),marginTop=parseCss(this,"marginTop"),collisionWidth=elemWidth+marginLeft+parseCss(this,"marginRight")+
scrollInfo.width,collisionHeight=elemHeight+marginTop+parseCss(this,"marginBottom")+
scrollInfo.height,position=$.extend({},basePosition),myOffset=getOffsets(offsets.my,elem.outerWidth(),elem.outerHeight());if(options.my[0]==="right"){position.left-=elemWidth;}else if(options.my[0]==="center"){position.left-=elemWidth/2;}
if(options.my[1]==="bottom"){position.top-=elemHeight;}else if(options.my[1]==="center"){position.top-=elemHeight/2;}
position.left+=myOffset[0];position.top+=myOffset[1];collisionPosition={marginLeft:marginLeft,marginTop:marginTop};$.each(["left","top"],function(i,dir){if($.ui.position[collision[i]]){$.ui.position[collision[i]][dir](position,{targetWidth:targetWidth,targetHeight:targetHeight,elemWidth:elemWidth,elemHeight:elemHeight,collisionPosition:collisionPosition,collisionWidth:collisionWidth,collisionHeight:collisionHeight,offset:[atOffset[0]+myOffset[0],atOffset[1]+myOffset[1]],my:options.my,at:options.at,within:within,elem:elem});}});if(options.using){using=function(props){var left=targetOffset.left-position.left,right=left+targetWidth-elemWidth,top=targetOffset.top-position.top,bottom=top+targetHeight-elemHeight,feedback={target:{element:target,left:targetOffset.left,top:targetOffset.top,width:targetWidth,height:targetHeight},element:{element:elem,left:position.left,top:position.top,width:elemWidth,height:elemHeight},horizontal:right<0?"left":left>0?"right":"center",vertical:bottom<0?"top":top>0?"bottom":"middle"};if(targetWidth<elemWidth&&abs(left+right)<targetWidth){feedback.horizontal="center";}
if(targetHeight<elemHeight&&abs(top+bottom)<targetHeight){feedback.vertical="middle";}
if(max(abs(left),abs(right))>max(abs(top),abs(bottom))){feedback.important="horizontal";}else{feedback.important="vertical";}
options.using.call(this,props,feedback);};}
elem.offset($.extend(position,{using:using}));});};$.ui.position={fit:{left:function(position,data){var within=data.within,withinOffset=within.isWindow?within.scrollLeft:within.offset.left,outerWidth=within.width,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=withinOffset-collisionPosLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-withinOffset,newOverRight;if(data.collisionWidth>outerWidth){if(overLeft>0&&overRight<=0){newOverRight=position.left+overLeft+data.collisionWidth-outerWidth-
withinOffset;position.left+=overLeft-newOverRight;}else if(overRight>0&&overLeft<=0){position.left=withinOffset;}else{if(overLeft>overRight){position.left=withinOffset+outerWidth-data.collisionWidth;}else{position.left=withinOffset;}}}else if(overLeft>0){position.left+=overLeft;}else if(overRight>0){position.left-=overRight;}else{position.left=max(position.left-collisionPosLeft,position.left);}},top:function(position,data){var within=data.within,withinOffset=within.isWindow?within.scrollTop:within.offset.top,outerHeight=data.within.height,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=withinOffset-collisionPosTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-withinOffset,newOverBottom;if(data.collisionHeight>outerHeight){if(overTop>0&&overBottom<=0){newOverBottom=position.top+overTop+data.collisionHeight-outerHeight-
withinOffset;position.top+=overTop-newOverBottom;}else if(overBottom>0&&overTop<=0){position.top=withinOffset;}else{if(overTop>overBottom){position.top=withinOffset+outerHeight-data.collisionHeight;}else{position.top=withinOffset;}}}else if(overTop>0){position.top+=overTop;}else if(overBottom>0){position.top-=overBottom;}else{position.top=max(position.top-collisionPosTop,position.top);}}},flip:{left:function(position,data){var within=data.within,withinOffset=within.offset.left+within.scrollLeft,outerWidth=within.width,offsetLeft=within.isWindow?within.scrollLeft:within.offset.left,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=collisionPosLeft-offsetLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-offsetLeft,myOffset=data.my[0]==="left"?-data.elemWidth:data.my[0]==="right"?data.elemWidth:0,atOffset=data.at[0]==="left"?data.targetWidth:data.at[0]==="right"?-data.targetWidth:0,offset=-2*data.offset[0],newOverRight,newOverLeft;if(overLeft<0){newOverRight=position.left+myOffset+atOffset+offset+data.collisionWidth-
outerWidth-withinOffset;if(newOverRight<0||newOverRight<abs(overLeft)){position.left+=myOffset+atOffset+offset;}}else if(overRight>0){newOverLeft=position.left-data.collisionPosition.marginLeft+myOffset+
atOffset+offset-offsetLeft;if(newOverLeft>0||abs(newOverLeft)<overRight){position.left+=myOffset+atOffset+offset;}}},top:function(position,data){var within=data.within,withinOffset=within.offset.top+within.scrollTop,outerHeight=within.height,offsetTop=within.isWindow?within.scrollTop:within.offset.top,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=collisionPosTop-offsetTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-offsetTop,top=data.my[1]==="top",myOffset=top?-data.elemHeight:data.my[1]==="bottom"?data.elemHeight:0,atOffset=data.at[1]==="top"?data.targetHeight:data.at[1]==="bottom"?-data.targetHeight:0,offset=-2*data.offset[1],newOverTop,newOverBottom;if(overTop<0){newOverBottom=position.top+myOffset+atOffset+offset+data.collisionHeight-
outerHeight-withinOffset;if(newOverBottom<0||newOverBottom<abs(overTop)){position.top+=myOffset+atOffset+offset;}}else if(overBottom>0){newOverTop=position.top-data.collisionPosition.marginTop+myOffset+atOffset+
offset-offsetTop;if(newOverTop>0||abs(newOverTop)<overBottom){position.top+=myOffset+atOffset+offset;}}}},flipfit:{left:function(){$.ui.position.flip.left.apply(this,arguments);$.ui.position.fit.left.apply(this,arguments);},top:function(){$.ui.position.flip.top.apply(this,arguments);$.ui.position.fit.top.apply(this,arguments);}}};})();var position=$.ui.position;var data=$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName);};}):function(elem,i,match){return!!$.data(elem,match[3]);}});var disableSelection=$.fn.extend({disableSelection:(function(){var eventType="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(eventType+".ui-disableSelection",function(event){event.preventDefault();});};})(),enableSelection:function(){return this.off(".ui-disableSelection");}});var dataSpace="ui-effects-",dataSpaceStyle="ui-effects-style",dataSpaceAnimated="ui-effects-animated",jQuery=$;$.effects={effect:{}};(function(jQuery,undefined){var stepHooks="backgroundColor borderBottomColor borderLeftColor borderRightColor "+"borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",rplusequals=/^([\-+])=\s*(\d+\.?\d*)/,stringParsers=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1],execResult[2],execResult[3],execResult[4]];}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1]*2.55,execResult[2]*2.55,execResult[3]*2.55,execResult[4]];}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(execResult){return[parseInt(execResult[1],16),parseInt(execResult[2],16),parseInt(execResult[3],16)];}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(execResult){return[parseInt(execResult[1]+execResult[1],16),parseInt(execResult[2]+execResult[2],16),parseInt(execResult[3]+execResult[3],16)];}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(execResult){return[execResult[1],execResult[2]/100,execResult[3]/100,execResult[4]];}}],color=jQuery.Color=function(color,green,blue,alpha){return new jQuery.Color.fn.parse(color,green,blue,alpha);},spaces={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},propTypes={"byte":{floor:true,max:255},"percent":{max:1},"degrees":{mod:360,floor:true}},support=color.support={},supportElem=jQuery("<p>")[0],colors,each=jQuery.each;supportElem.style.cssText="background-color:rgba(1,1,1,.5)";support.rgba=supportElem.style.backgroundColor.indexOf("rgba")>-1;each(spaces,function(spaceName,space){space.cache="_"+spaceName;space.props.alpha={idx:3,type:"percent",def:1};});function clamp(value,prop,allowEmpty){var type=propTypes[prop.type]||{};if(value==null){return(allowEmpty||!prop.def)?null:prop.def;}
value=type.floor?~~value:parseFloat(value);if(isNaN(value)){return prop.def;}
if(type.mod){return(value+type.mod)%type.mod;}
return 0>value?0:type.max<value?type.max:value;}
function stringParse(string){var inst=color(),rgba=inst._rgba=[];string=string.toLowerCase();each(stringParsers,function(i,parser){var parsed,match=parser.re.exec(string),values=match&&parser.parse(match),spaceName=parser.space||"rgba";if(values){parsed=inst[spaceName](values);inst[spaces[spaceName].cache]=parsed[spaces[spaceName].cache];rgba=inst._rgba=parsed._rgba;return false;}});if(rgba.length){if(rgba.join()==="0,0,0,0"){jQuery.extend(rgba,colors.transparent);}
return inst;}
return colors[string];}
color.fn=jQuery.extend(color.prototype,{parse:function(red,green,blue,alpha){if(red===undefined){this._rgba=[null,null,null,null];return this;}
if(red.jquery||red.nodeType){red=jQuery(red).css(green);green=undefined;}
var inst=this,type=jQuery.type(red),rgba=this._rgba=[];if(green!==undefined){red=[red,green,blue,alpha];type="array";}
if(type==="string"){return this.parse(stringParse(red)||colors._default);}
if(type==="array"){each(spaces.rgba.props,function(key,prop){rgba[prop.idx]=clamp(red[prop.idx],prop);});return this;}
if(type==="object"){if(red instanceof color){each(spaces,function(spaceName,space){if(red[space.cache]){inst[space.cache]=red[space.cache].slice();}});}else{each(spaces,function(spaceName,space){var cache=space.cache;each(space.props,function(key,prop){if(!inst[cache]&&space.to){if(key==="alpha"||red[key]==null){return;}
inst[cache]=space.to(inst._rgba);}
inst[cache][prop.idx]=clamp(red[key],prop,true);});if(inst[cache]&&jQuery.inArray(null,inst[cache].slice(0,3))<0){inst[cache][3]=1;if(space.from){inst._rgba=space.from(inst[cache]);}}});}
return this;}},is:function(compare){var is=color(compare),same=true,inst=this;each(spaces,function(_,space){var localCache,isCache=is[space.cache];if(isCache){localCache=inst[space.cache]||space.to&&space.to(inst._rgba)||[];each(space.props,function(_,prop){if(isCache[prop.idx]!=null){same=(isCache[prop.idx]===localCache[prop.idx]);return same;}});}
return same;});return same;},_space:function(){var used=[],inst=this;each(spaces,function(spaceName,space){if(inst[space.cache]){used.push(spaceName);}});return used.pop();},transition:function(other,distance){var end=color(other),spaceName=end._space(),space=spaces[spaceName],startColor=this.alpha()===0?color("transparent"):this,start=startColor[space.cache]||space.to(startColor._rgba),result=start.slice();end=end[space.cache];each(space.props,function(key,prop){var index=prop.idx,startValue=start[index],endValue=end[index],type=propTypes[prop.type]||{};if(endValue===null){return;}
if(startValue===null){result[index]=endValue;}else{if(type.mod){if(endValue-startValue>type.mod/2){startValue+=type.mod;}else if(startValue-endValue>type.mod/2){startValue-=type.mod;}}
result[index]=clamp((endValue-startValue)*distance+startValue,prop);}});return this[spaceName](result);},blend:function(opaque){if(this._rgba[3]===1){return this;}
var rgb=this._rgba.slice(),a=rgb.pop(),blend=color(opaque)._rgba;return color(jQuery.map(rgb,function(v,i){return(1-a)*blend[i]+a*v;}));},toRgbaString:function(){var prefix="rgba(",rgba=jQuery.map(this._rgba,function(v,i){return v==null?(i>2?1:0):v;});if(rgba[3]===1){rgba.pop();prefix="rgb(";}
return prefix+rgba.join()+")";},toHslaString:function(){var prefix="hsla(",hsla=jQuery.map(this.hsla(),function(v,i){if(v==null){v=i>2?1:0;}
if(i&&i<3){v=Math.round(v*100)+"%";}
return v;});if(hsla[3]===1){hsla.pop();prefix="hsl(";}
return prefix+hsla.join()+")";},toHexString:function(includeAlpha){var rgba=this._rgba.slice(),alpha=rgba.pop();if(includeAlpha){rgba.push(~~(alpha*255));}
return"#"+jQuery.map(rgba,function(v){v=(v||0).toString(16);return v.length===1?"0"+v:v;}).join("");},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString();}});color.fn.parse.prototype=color.fn;function hue2rgb(p,q,h){h=(h+1)%1;if(h*6<1){return p+(q-p)*h*6;}
if(h*2<1){return q;}
if(h*3<2){return p+(q-p)*((2/3)-h)*6;}
return p;}
spaces.hsla.to=function(rgba){if(rgba[0]==null||rgba[1]==null||rgba[2]==null){return[null,null,null,rgba[3]];}
var r=rgba[0]/255,g=rgba[1]/255,b=rgba[2]/255,a=rgba[3],max=Math.max(r,g,b),min=Math.min(r,g,b),diff=max-min,add=max+min,l=add*0.5,h,s;if(min===max){h=0;}else if(r===max){h=(60*(g-b)/diff)+360;}else if(g===max){h=(60*(b-r)/diff)+120;}else{h=(60*(r-g)/diff)+240;}
if(diff===0){s=0;}else if(l<=0.5){s=diff/add;}else{s=diff/(2-add);}
return[Math.round(h)%360,s,l,a==null?1:a];};spaces.hsla.from=function(hsla){if(hsla[0]==null||hsla[1]==null||hsla[2]==null){return[null,null,null,hsla[3]];}
var h=hsla[0]/360,s=hsla[1],l=hsla[2],a=hsla[3],q=l<=0.5?l*(1+s):l+s-l*s,p=2*l-q;return[Math.round(hue2rgb(p,q,h+(1/3))*255),Math.round(hue2rgb(p,q,h)*255),Math.round(hue2rgb(p,q,h-(1/3))*255),a];};each(spaces,function(spaceName,space){var props=space.props,cache=space.cache,to=space.to,from=space.from;color.fn[spaceName]=function(value){if(to&&!this[cache]){this[cache]=to(this._rgba);}
if(value===undefined){return this[cache].slice();}
var ret,type=jQuery.type(value),arr=(type==="array"||type==="object")?value:arguments,local=this[cache].slice();each(props,function(key,prop){var val=arr[type==="object"?key:prop.idx];if(val==null){val=local[prop.idx];}
local[prop.idx]=clamp(val,prop);});if(from){ret=color(from(local));ret[cache]=local;return ret;}else{return color(local);}};each(props,function(key,prop){if(color.fn[key]){return;}
color.fn[key]=function(value){var vtype=jQuery.type(value),fn=(key==="alpha"?(this._hsla?"hsla":"rgba"):spaceName),local=this[fn](),cur=local[prop.idx],match;if(vtype==="undefined"){return cur;}
if(vtype==="function"){value=value.call(this,cur);vtype=jQuery.type(value);}
if(value==null&&prop.empty){return this;}
if(vtype==="string"){match=rplusequals.exec(value);if(match){value=cur+parseFloat(match[2])*(match[1]==="+"?1:-1);}}
local[prop.idx]=value;return this[fn](local);};});});color.hook=function(hook){var hooks=hook.split(" ");each(hooks,function(i,hook){jQuery.cssHooks[hook]={set:function(elem,value){var parsed,curElem,backgroundColor="";if(value!=="transparent"&&(jQuery.type(value)!=="string"||(parsed=stringParse(value)))){value=color(parsed||value);if(!support.rgba&&value._rgba[3]!==1){curElem=hook==="backgroundColor"?elem.parentNode:elem;while((backgroundColor===""||backgroundColor==="transparent")&&curElem&&curElem.style){try{backgroundColor=jQuery.css(curElem,"backgroundColor");curElem=curElem.parentNode;}catch(e){}}
value=value.blend(backgroundColor&&backgroundColor!=="transparent"?backgroundColor:"_default");}
value=value.toRgbaString();}
try{elem.style[hook]=value;}catch(e){}}};jQuery.fx.step[hook]=function(fx){if(!fx.colorInit){fx.start=color(fx.elem,hook);fx.end=color(fx.end);fx.colorInit=true;}
jQuery.cssHooks[hook].set(fx.elem,fx.start.transition(fx.end,fx.pos));};});};color.hook(stepHooks);jQuery.cssHooks.borderColor={expand:function(value){var expanded={};each(["Top","Right","Bottom","Left"],function(i,part){expanded["border"+part+"Color"]=value;});return expanded;}};colors=jQuery.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"};})(jQuery);(function(){var classAnimationActions=["add","remove","toggle"],shorthandStyles={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};$.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(_,prop){$.fx.step[prop]=function(fx){if(fx.end!=="none"&&!fx.setAttr||fx.pos===1&&!fx.setAttr){jQuery.style(fx.elem,prop,fx.end);fx.setAttr=true;}};});function getElementStyles(elem){var key,len,style=elem.ownerDocument.defaultView?elem.ownerDocument.defaultView.getComputedStyle(elem,null):elem.currentStyle,styles={};if(style&&style.length&&style[0]&&style[style[0]]){len=style.length;while(len--){key=style[len];if(typeof style[key]==="string"){styles[$.camelCase(key)]=style[key];}}}else{for(key in style){if(typeof style[key]==="string"){styles[key]=style[key];}}}
return styles;}
function styleDifference(oldStyle,newStyle){var diff={},name,value;for(name in newStyle){value=newStyle[name];if(oldStyle[name]!==value){if(!shorthandStyles[name]){if($.fx.step[name]||!isNaN(parseFloat(value))){diff[name]=value;}}}}
return diff;}
if(!$.fn.addBack){$.fn.addBack=function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector));};}
$.effects.animateClass=function(value,duration,easing,callback){var o=$.speed(duration,easing,callback);return this.queue(function(){var animated=$(this),baseClass=animated.attr("class")||"",applyClassChange,allAnimations=o.children?animated.find("*").addBack():animated;allAnimations=allAnimations.map(function(){var el=$(this);return{el:el,start:getElementStyles(this)};});applyClassChange=function(){$.each(classAnimationActions,function(i,action){if(value[action]){animated[action+"Class"](value[action]);}});};applyClassChange();allAnimations=allAnimations.map(function(){this.end=getElementStyles(this.el[0]);this.diff=styleDifference(this.start,this.end);return this;});animated.attr("class",baseClass);allAnimations=allAnimations.map(function(){var styleInfo=this,dfd=$.Deferred(),opts=$.extend({},o,{queue:false,complete:function(){dfd.resolve(styleInfo);}});this.el.animate(this.diff,opts);return dfd.promise();});$.when.apply($,allAnimations.get()).done(function(){applyClassChange();$.each(arguments,function(){var el=this.el;$.each(this.diff,function(key){el.css(key,"");});});o.complete.call(animated[0]);});});};$.fn.extend({addClass:(function(orig){return function(classNames,speed,easing,callback){return speed?$.effects.animateClass.call(this,{add:classNames},speed,easing,callback):orig.apply(this,arguments);};})($.fn.addClass),removeClass:(function(orig){return function(classNames,speed,easing,callback){return arguments.length>1?$.effects.animateClass.call(this,{remove:classNames},speed,easing,callback):orig.apply(this,arguments);};})($.fn.removeClass),toggleClass:(function(orig){return function(classNames,force,speed,easing,callback){if(typeof force==="boolean"||force===undefined){if(!speed){return orig.apply(this,arguments);}else{return $.effects.animateClass.call(this,(force?{add:classNames}:{remove:classNames}),speed,easing,callback);}}else{return $.effects.animateClass.call(this,{toggle:classNames},force,speed,easing);}};})($.fn.toggleClass),switchClass:function(remove,add,speed,easing,callback){return $.effects.animateClass.call(this,{add:add,remove:remove},speed,easing,callback);}});})();(function(){if($.expr&&$.expr.filters&&$.expr.filters.animated){$.expr.filters.animated=(function(orig){return function(elem){return!!$(elem).data(dataSpaceAnimated)||orig(elem);};})($.expr.filters.animated);}
if($.uiBackCompat!==false){$.extend($.effects,{save:function(element,set){var i=0,length=set.length;for(;i<length;i++){if(set[i]!==null){element.data(dataSpace+set[i],element[0].style[set[i]]);}}},restore:function(element,set){var val,i=0,length=set.length;for(;i<length;i++){if(set[i]!==null){val=element.data(dataSpace+set[i]);element.css(set[i],val);}}},setMode:function(el,mode){if(mode==="toggle"){mode=el.is(":hidden")?"show":"hide";}
return mode;},createWrapper:function(element){if(element.parent().is(".ui-effects-wrapper")){return element.parent();}
var props={width:element.outerWidth(true),height:element.outerHeight(true),"float":element.css("float")},wrapper=$("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),size={width:element.width(),height:element.height()},active=document.activeElement;try{active.id;}catch(e){active=document.body;}
element.wrap(wrapper);if(element[0]===active||$.contains(element[0],active)){$(active).trigger("focus");}
wrapper=element.parent();if(element.css("position")==="static"){wrapper.css({position:"relative"});element.css({position:"relative"});}else{$.extend(props,{position:element.css("position"),zIndex:element.css("z-index")});$.each(["top","left","bottom","right"],function(i,pos){props[pos]=element.css(pos);if(isNaN(parseInt(props[pos],10))){props[pos]="auto";}});element.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"});}
element.css(size);return wrapper.css(props).show();},removeWrapper:function(element){var active=document.activeElement;if(element.parent().is(".ui-effects-wrapper")){element.parent().replaceWith(element);if(element[0]===active||$.contains(element[0],active)){$(active).trigger("focus");}}
return element;}});}
$.extend($.effects,{version:"1.12.1",define:function(name,mode,effect){if(!effect){effect=mode;mode="effect";}
$.effects.effect[name]=effect;$.effects.effect[name].mode=mode;return effect;},scaledDimensions:function(element,percent,direction){if(percent===0){return{height:0,width:0,outerHeight:0,outerWidth:0};}
var x=direction!=="horizontal"?((percent||100)/100):1,y=direction!=="vertical"?((percent||100)/100):1;return{height:element.height()*y,width:element.width()*x,outerHeight:element.outerHeight()*y,outerWidth:element.outerWidth()*x};},clipToBox:function(animation){return{width:animation.clip.right-animation.clip.left,height:animation.clip.bottom-animation.clip.top,left:animation.clip.left,top:animation.clip.top};},unshift:function(element,queueLength,count){var queue=element.queue();if(queueLength>1){queue.splice.apply(queue,[1,0].concat(queue.splice(queueLength,count)));}
element.dequeue();},saveStyle:function(element){element.data(dataSpaceStyle,element[0].style.cssText);},restoreStyle:function(element){element[0].style.cssText=element.data(dataSpaceStyle)||"";element.removeData(dataSpaceStyle);},mode:function(element,mode){var hidden=element.is(":hidden");if(mode==="toggle"){mode=hidden?"show":"hide";}
if(hidden?mode==="hide":mode==="show"){mode="none";}
return mode;},getBaseline:function(origin,original){var y,x;switch(origin[0]){case"top":y=0;break;case"middle":y=0.5;break;case"bottom":y=1;break;default:y=origin[0]/original.height;}
switch(origin[1]){case"left":x=0;break;case"center":x=0.5;break;case"right":x=1;break;default:x=origin[1]/original.width;}
return{x:x,y:y};},createPlaceholder:function(element){var placeholder,cssPosition=element.css("position"),position=element.position();element.css({marginTop:element.css("marginTop"),marginBottom:element.css("marginBottom"),marginLeft:element.css("marginLeft"),marginRight:element.css("marginRight")}).outerWidth(element.outerWidth()).outerHeight(element.outerHeight());if(/^(static|relative)/.test(cssPosition)){cssPosition="absolute";placeholder=$("<"+element[0].nodeName+">").insertAfter(element).css({display:/^(inline|ruby)/.test(element.css("display"))?"inline-block":"block",visibility:"hidden",marginTop:element.css("marginTop"),marginBottom:element.css("marginBottom"),marginLeft:element.css("marginLeft"),marginRight:element.css("marginRight"),"float":element.css("float")}).outerWidth(element.outerWidth()).outerHeight(element.outerHeight()).addClass("ui-effects-placeholder");element.data(dataSpace+"placeholder",placeholder);}
element.css({position:cssPosition,left:position.left,top:position.top});return placeholder;},removePlaceholder:function(element){var dataKey=dataSpace+"placeholder",placeholder=element.data(dataKey);if(placeholder){placeholder.remove();element.removeData(dataKey);}},cleanUp:function(element){$.effects.restoreStyle(element);$.effects.removePlaceholder(element);},setTransition:function(element,list,factor,value){value=value||{};$.each(list,function(i,x){var unit=element.cssUnit(x);if(unit[0]>0){value[x]=unit[0]*factor+unit[1];}});return value;}});function _normalizeArguments(effect,options,speed,callback){if($.isPlainObject(effect)){options=effect;effect=effect.effect;}
effect={effect:effect};if(options==null){options={};}
if($.isFunction(options)){callback=options;speed=null;options={};}
if(typeof options==="number"||$.fx.speeds[options]){callback=speed;speed=options;options={};}
if($.isFunction(speed)){callback=speed;speed=null;}
if(options){$.extend(effect,options);}
speed=speed||options.duration;effect.duration=$.fx.off?0:typeof speed==="number"?speed:speed in $.fx.speeds?$.fx.speeds[speed]:$.fx.speeds._default;effect.complete=callback||options.complete;return effect;}
function standardAnimationOption(option){if(!option||typeof option==="number"||$.fx.speeds[option]){return true;}
if(typeof option==="string"&&!$.effects.effect[option]){return true;}
if($.isFunction(option)){return true;}
if(typeof option==="object"&&!option.effect){return true;}
return false;}
$.fn.extend({effect:function(){var args=_normalizeArguments.apply(this,arguments),effectMethod=$.effects.effect[args.effect],defaultMode=effectMethod.mode,queue=args.queue,queueName=queue||"fx",complete=args.complete,mode=args.mode,modes=[],prefilter=function(next){var el=$(this),normalizedMode=$.effects.mode(el,mode)||defaultMode;el.data(dataSpaceAnimated,true);modes.push(normalizedMode);if(defaultMode&&(normalizedMode==="show"||(normalizedMode===defaultMode&&normalizedMode==="hide"))){el.show();}
if(!defaultMode||normalizedMode!=="none"){$.effects.saveStyle(el);}
if($.isFunction(next)){next();}};if($.fx.off||!effectMethod){if(mode){return this[mode](args.duration,complete);}else{return this.each(function(){if(complete){complete.call(this);}});}}
function run(next){var elem=$(this);function cleanup(){elem.removeData(dataSpaceAnimated);$.effects.cleanUp(elem);if(args.mode==="hide"){elem.hide();}
done();}
function done(){if($.isFunction(complete)){complete.call(elem[0]);}
if($.isFunction(next)){next();}}
args.mode=modes.shift();if($.uiBackCompat!==false&&!defaultMode){if(elem.is(":hidden")?mode==="hide":mode==="show"){elem[mode]();done();}else{effectMethod.call(elem[0],args,done);}}else{if(args.mode==="none"){elem[mode]();done();}else{effectMethod.call(elem[0],args,cleanup);}}}
return queue===false?this.each(prefilter).each(run):this.queue(queueName,prefilter).queue(queueName,run);},show:(function(orig){return function(option){if(standardAnimationOption(option)){return orig.apply(this,arguments);}else{var args=_normalizeArguments.apply(this,arguments);args.mode="show";return this.effect.call(this,args);}};})($.fn.show),hide:(function(orig){return function(option){if(standardAnimationOption(option)){return orig.apply(this,arguments);}else{var args=_normalizeArguments.apply(this,arguments);args.mode="hide";return this.effect.call(this,args);}};})($.fn.hide),toggle:(function(orig){return function(option){if(standardAnimationOption(option)||typeof option==="boolean"){return orig.apply(this,arguments);}else{var args=_normalizeArguments.apply(this,arguments);args.mode="toggle";return this.effect.call(this,args);}};})($.fn.toggle),cssUnit:function(key){var style=this.css(key),val=[];$.each(["em","px","%","pt"],function(i,unit){if(style.indexOf(unit)>0){val=[parseFloat(style),unit];}});return val;},cssClip:function(clipObj){if(clipObj){return this.css("clip","rect("+clipObj.top+"px "+clipObj.right+"px "+
clipObj.bottom+"px "+clipObj.left+"px)");}
return parseClip(this.css("clip"),this);},transfer:function(options,done){var element=$(this),target=$(options.to),targetFixed=target.css("position")==="fixed",body=$("body"),fixTop=targetFixed?body.scrollTop():0,fixLeft=targetFixed?body.scrollLeft():0,endPosition=target.offset(),animation={top:endPosition.top-fixTop,left:endPosition.left-fixLeft,height:target.innerHeight(),width:target.innerWidth()},startPosition=element.offset(),transfer=$("<div class='ui-effects-transfer'></div>").appendTo("body").addClass(options.className).css({top:startPosition.top-fixTop,left:startPosition.left-fixLeft,height:element.innerHeight(),width:element.innerWidth(),position:targetFixed?"fixed":"absolute"}).animate(animation,options.duration,options.easing,function(){transfer.remove();if($.isFunction(done)){done();}});}});function parseClip(str,element){var outerWidth=element.outerWidth(),outerHeight=element.outerHeight(),clipRegex=/^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/,values=clipRegex.exec(str)||["",0,outerWidth,outerHeight,0];return{top:parseFloat(values[1])||0,right:values[2]==="auto"?outerWidth:parseFloat(values[2]),bottom:values[3]==="auto"?outerHeight:parseFloat(values[3]),left:parseFloat(values[4])||0};}
$.fx.step.clip=function(fx){if(!fx.clipInit){fx.start=$(fx.elem).cssClip();if(typeof fx.end==="string"){fx.end=parseClip(fx.end,fx.elem);}
fx.clipInit=true;}
$(fx.elem).cssClip({top:fx.pos*(fx.end.top-fx.start.top)+fx.start.top,right:fx.pos*(fx.end.right-fx.start.right)+fx.start.right,bottom:fx.pos*(fx.end.bottom-fx.start.bottom)+fx.start.bottom,left:fx.pos*(fx.end.left-fx.start.left)+fx.start.left});};})();(function(){var baseEasings={};$.each(["Quad","Cubic","Quart","Quint","Expo"],function(i,name){baseEasings[name]=function(p){return Math.pow(p,i+2);};});$.extend(baseEasings,{Sine:function(p){return 1-Math.cos(p*Math.PI/2);},Circ:function(p){return 1-Math.sqrt(1-p*p);},Elastic:function(p){return p===0||p===1?p:-Math.pow(2,8*(p-1))*Math.sin(((p-1)*80-7.5)*Math.PI/15);},Back:function(p){return p*p*(3*p-2);},Bounce:function(p){var pow2,bounce=4;while(p<((pow2=Math.pow(2,--bounce))-1)/11){}
return 1/Math.pow(4,3-bounce)-7.5625*Math.pow((pow2*3-2)/22-p,2);}});$.each(baseEasings,function(name,easeIn){$.easing["easeIn"+name]=easeIn;$.easing["easeOut"+name]=function(p){return 1-easeIn(1-p);};$.easing["easeInOut"+name]=function(p){return p<0.5?easeIn(p*2)/2:1-easeIn(p*-2+2)/2;};});})();var effect=$.effects;var effectsEffectBlind=$.effects.define("blind","hide",function(options,done){var map={up:["bottom","top"],vertical:["bottom","top"],down:["top","bottom"],left:["right","left"],horizontal:["right","left"],right:["left","right"]},element=$(this),direction=options.direction||"up",start=element.cssClip(),animate={clip:$.extend({},start)},placeholder=$.effects.createPlaceholder(element);animate.clip[map[direction][0]]=animate.clip[map[direction][1]];if(options.mode==="show"){element.cssClip(animate.clip);if(placeholder){placeholder.css($.effects.clipToBox(animate));}
animate.clip=start;}
if(placeholder){placeholder.animate($.effects.clipToBox(animate),options.duration,options.easing);}
element.animate(animate,{queue:false,duration:options.duration,easing:options.easing,complete:done});});var effectsEffectBounce=$.effects.define("bounce",function(options,done){var upAnim,downAnim,refValue,element=$(this),mode=options.mode,hide=mode==="hide",show=mode==="show",direction=options.direction||"up",distance=options.distance,times=options.times||5,anims=times*2+(show||hide?1:0),speed=options.duration/anims,easing=options.easing,ref=(direction==="up"||direction==="down")?"top":"left",motion=(direction==="up"||direction==="left"),i=0,queuelen=element.queue().length;$.effects.createPlaceholder(element);refValue=element.css(ref);if(!distance){distance=element[ref==="top"?"outerHeight":"outerWidth"]()/3;}
if(show){downAnim={opacity:1};downAnim[ref]=refValue;element.css("opacity",0).css(ref,motion?-distance*2:distance*2).animate(downAnim,speed,easing);}
if(hide){distance=distance/Math.pow(2,times-1);}
downAnim={};downAnim[ref]=refValue;for(;i<times;i++){upAnim={};upAnim[ref]=(motion?"-=":"+=")+distance;element.animate(upAnim,speed,easing).animate(downAnim,speed,easing);distance=hide?distance*2:distance/2;}
if(hide){upAnim={opacity:0};upAnim[ref]=(motion?"-=":"+=")+distance;element.animate(upAnim,speed,easing);}
element.queue(done);$.effects.unshift(element,queuelen,anims+1);});var effectsEffectClip=$.effects.define("clip","hide",function(options,done){var start,animate={},element=$(this),direction=options.direction||"vertical",both=direction==="both",horizontal=both||direction==="horizontal",vertical=both||direction==="vertical";start=element.cssClip();animate.clip={top:vertical?(start.bottom-start.top)/2:start.top,right:horizontal?(start.right-start.left)/2:start.right,bottom:vertical?(start.bottom-start.top)/2:start.bottom,left:horizontal?(start.right-start.left)/2:start.left};$.effects.createPlaceholder(element);if(options.mode==="show"){element.cssClip(animate.clip);animate.clip=start;}
element.animate(animate,{queue:false,duration:options.duration,easing:options.easing,complete:done});});var effectsEffectDrop=$.effects.define("drop","hide",function(options,done){var distance,element=$(this),mode=options.mode,show=mode==="show",direction=options.direction||"left",ref=(direction==="up"||direction==="down")?"top":"left",motion=(direction==="up"||direction==="left")?"-=":"+=",oppositeMotion=(motion==="+=")?"-=":"+=",animation={opacity:0};$.effects.createPlaceholder(element);distance=options.distance||element[ref==="top"?"outerHeight":"outerWidth"](true)/2;animation[ref]=motion+distance;if(show){element.css(animation);animation[ref]=oppositeMotion+distance;animation.opacity=1;}
element.animate(animation,{queue:false,duration:options.duration,easing:options.easing,complete:done});});var effectsEffectExplode=$.effects.define("explode","hide",function(options,done){var i,j,left,top,mx,my,rows=options.pieces?Math.round(Math.sqrt(options.pieces)):3,cells=rows,element=$(this),mode=options.mode,show=mode==="show",offset=element.show().css("visibility","hidden").offset(),width=Math.ceil(element.outerWidth()/cells),height=Math.ceil(element.outerHeight()/rows),pieces=[];function childComplete(){pieces.push(this);if(pieces.length===rows*cells){animComplete();}}
for(i=0;i<rows;i++){top=offset.top+i*height;my=i-(rows-1)/2;for(j=0;j<cells;j++){left=offset.left+j*width;mx=j-(cells-1)/2;element.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-j*width,top:-i*height}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:width,height:height,left:left+(show?mx*width:0),top:top+(show?my*height:0),opacity:show?0:1}).animate({left:left+(show?0:mx*width),top:top+(show?0:my*height),opacity:show?1:0},options.duration||500,options.easing,childComplete);}}
function animComplete(){element.css({visibility:"visible"});$(pieces).remove();done();}});var effectsEffectFade=$.effects.define("fade","toggle",function(options,done){var show=options.mode==="show";$(this).css("opacity",show?0:1).animate({opacity:show?1:0},{queue:false,duration:options.duration,easing:options.easing,complete:done});});var effectsEffectFold=$.effects.define("fold","hide",function(options,done){var element=$(this),mode=options.mode,show=mode==="show",hide=mode==="hide",size=options.size||15,percent=/([0-9]+)%/.exec(size),horizFirst=!!options.horizFirst,ref=horizFirst?["right","bottom"]:["bottom","right"],duration=options.duration/2,placeholder=$.effects.createPlaceholder(element),start=element.cssClip(),animation1={clip:$.extend({},start)},animation2={clip:$.extend({},start)},distance=[start[ref[0]],start[ref[1]]],queuelen=element.queue().length;if(percent){size=parseInt(percent[1],10)/100*distance[hide?0:1];}
animation1.clip[ref[0]]=size;animation2.clip[ref[0]]=size;animation2.clip[ref[1]]=0;if(show){element.cssClip(animation2.clip);if(placeholder){placeholder.css($.effects.clipToBox(animation2));}
animation2.clip=start;}
element.queue(function(next){if(placeholder){placeholder.animate($.effects.clipToBox(animation1),duration,options.easing).animate($.effects.clipToBox(animation2),duration,options.easing);}
next();}).animate(animation1,duration,options.easing).animate(animation2,duration,options.easing).queue(done);$.effects.unshift(element,queuelen,4);});var effectsEffectHighlight=$.effects.define("highlight","show",function(options,done){var element=$(this),animation={backgroundColor:element.css("backgroundColor")};if(options.mode==="hide"){animation.opacity=0;}
$.effects.saveStyle(element);element.css({backgroundImage:"none",backgroundColor:options.color||"#ffff99"}).animate(animation,{queue:false,duration:options.duration,easing:options.easing,complete:done});});var effectsEffectSize=$.effects.define("size",function(options,done){var baseline,factor,temp,element=$(this),cProps=["fontSize"],vProps=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],hProps=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],mode=options.mode,restore=mode!=="effect",scale=options.scale||"both",origin=options.origin||["middle","center"],position=element.css("position"),pos=element.position(),original=$.effects.scaledDimensions(element),from=options.from||original,to=options.to||$.effects.scaledDimensions(element,0);$.effects.createPlaceholder(element);if(mode==="show"){temp=from;from=to;to=temp;}
factor={from:{y:from.height/original.height,x:from.width/original.width},to:{y:to.height/original.height,x:to.width/original.width}};if(scale==="box"||scale==="both"){if(factor.from.y!==factor.to.y){from=$.effects.setTransition(element,vProps,factor.from.y,from);to=$.effects.setTransition(element,vProps,factor.to.y,to);}
if(factor.from.x!==factor.to.x){from=$.effects.setTransition(element,hProps,factor.from.x,from);to=$.effects.setTransition(element,hProps,factor.to.x,to);}}
if(scale==="content"||scale==="both"){if(factor.from.y!==factor.to.y){from=$.effects.setTransition(element,cProps,factor.from.y,from);to=$.effects.setTransition(element,cProps,factor.to.y,to);}}
if(origin){baseline=$.effects.getBaseline(origin,original);from.top=(original.outerHeight-from.outerHeight)*baseline.y+pos.top;from.left=(original.outerWidth-from.outerWidth)*baseline.x+pos.left;to.top=(original.outerHeight-to.outerHeight)*baseline.y+pos.top;to.left=(original.outerWidth-to.outerWidth)*baseline.x+pos.left;}
element.css(from);if(scale==="content"||scale==="both"){vProps=vProps.concat(["marginTop","marginBottom"]).concat(cProps);hProps=hProps.concat(["marginLeft","marginRight"]);element.find("*[width]").each(function(){var child=$(this),childOriginal=$.effects.scaledDimensions(child),childFrom={height:childOriginal.height*factor.from.y,width:childOriginal.width*factor.from.x,outerHeight:childOriginal.outerHeight*factor.from.y,outerWidth:childOriginal.outerWidth*factor.from.x},childTo={height:childOriginal.height*factor.to.y,width:childOriginal.width*factor.to.x,outerHeight:childOriginal.height*factor.to.y,outerWidth:childOriginal.width*factor.to.x};if(factor.from.y!==factor.to.y){childFrom=$.effects.setTransition(child,vProps,factor.from.y,childFrom);childTo=$.effects.setTransition(child,vProps,factor.to.y,childTo);}
if(factor.from.x!==factor.to.x){childFrom=$.effects.setTransition(child,hProps,factor.from.x,childFrom);childTo=$.effects.setTransition(child,hProps,factor.to.x,childTo);}
if(restore){$.effects.saveStyle(child);}
child.css(childFrom);child.animate(childTo,options.duration,options.easing,function(){if(restore){$.effects.restoreStyle(child);}});});}
element.animate(to,{queue:false,duration:options.duration,easing:options.easing,complete:function(){var offset=element.offset();if(to.opacity===0){element.css("opacity",from.opacity);}
if(!restore){element.css("position",position==="static"?"relative":position).offset(offset);$.effects.saveStyle(element);}
done();}});});var effectsEffectScale=$.effects.define("scale",function(options,done){var el=$(this),mode=options.mode,percent=parseInt(options.percent,10)||(parseInt(options.percent,10)===0?0:(mode!=="effect"?0:100)),newOptions=$.extend(true,{from:$.effects.scaledDimensions(el),to:$.effects.scaledDimensions(el,percent,options.direction||"both"),origin:options.origin||["middle","center"]},options);if(options.fade){newOptions.from.opacity=1;newOptions.to.opacity=0;}
$.effects.effect.size.call(this,newOptions,done);});var effectsEffectPuff=$.effects.define("puff","hide",function(options,done){var newOptions=$.extend(true,{},options,{fade:true,percent:parseInt(options.percent,10)||150});$.effects.effect.scale.call(this,newOptions,done);});var effectsEffectPulsate=$.effects.define("pulsate","show",function(options,done){var element=$(this),mode=options.mode,show=mode==="show",hide=mode==="hide",showhide=show||hide,anims=((options.times||5)*2)+(showhide?1:0),duration=options.duration/anims,animateTo=0,i=1,queuelen=element.queue().length;if(show||!element.is(":visible")){element.css("opacity",0).show();animateTo=1;}
for(;i<anims;i++){element.animate({opacity:animateTo},duration,options.easing);animateTo=1-animateTo;}
element.animate({opacity:animateTo},duration,options.easing);element.queue(done);$.effects.unshift(element,queuelen,anims+1);});var effectsEffectShake=$.effects.define("shake",function(options,done){var i=1,element=$(this),direction=options.direction||"left",distance=options.distance||20,times=options.times||3,anims=times*2+1,speed=Math.round(options.duration/anims),ref=(direction==="up"||direction==="down")?"top":"left",positiveMotion=(direction==="up"||direction==="left"),animation={},animation1={},animation2={},queuelen=element.queue().length;$.effects.createPlaceholder(element);animation[ref]=(positiveMotion?"-=":"+=")+distance;animation1[ref]=(positiveMotion?"+=":"-=")+distance*2;animation2[ref]=(positiveMotion?"-=":"+=")+distance*2;element.animate(animation,speed,options.easing);for(;i<times;i++){element.animate(animation1,speed,options.easing).animate(animation2,speed,options.easing);}
element.animate(animation1,speed,options.easing).animate(animation,speed/2,options.easing).queue(done);$.effects.unshift(element,queuelen,anims+1);});var effectsEffectSlide=$.effects.define("slide","show",function(options,done){var startClip,startRef,element=$(this),map={up:["bottom","top"],down:["top","bottom"],left:["right","left"],right:["left","right"]},mode=options.mode,direction=options.direction||"left",ref=(direction==="up"||direction==="down")?"top":"left",positiveMotion=(direction==="up"||direction==="left"),distance=options.distance||element[ref==="top"?"outerHeight":"outerWidth"](true),animation={};$.effects.createPlaceholder(element);startClip=element.cssClip();startRef=element.position()[ref];animation[ref]=(positiveMotion?-1:1)*distance+startRef;animation.clip=element.cssClip();animation.clip[map[direction][1]]=animation.clip[map[direction][0]];if(mode==="show"){element.cssClip(animation.clip);element.css(ref,animation[ref]);animation.clip=startClip;animation[ref]=startRef;}
element.animate(animation,{queue:false,duration:options.duration,easing:options.easing,complete:done});});var effect;if($.uiBackCompat!==false){effect=$.effects.define("transfer",function(options,done){$(this).transfer(options,done);});}
var effectsEffectTransfer=effect;$.ui.focusable=function(element,hasTabindex){var map,mapName,img,focusableIfVisible,fieldset,nodeName=element.nodeName.toLowerCase();if("area"===nodeName){map=element.parentNode;mapName=map.name;if(!element.href||!mapName||map.nodeName.toLowerCase()!=="map"){return false;}
img=$("img[usemap='#"+mapName+"']");return img.length>0&&img.is(":visible");}
if(/^(input|select|textarea|button|object)$/.test(nodeName)){focusableIfVisible=!element.disabled;if(focusableIfVisible){fieldset=$(element).closest("fieldset")[0];if(fieldset){focusableIfVisible=!fieldset.disabled;}}}else if("a"===nodeName){focusableIfVisible=element.href||hasTabindex;}else{focusableIfVisible=hasTabindex;}
return focusableIfVisible&&$(element).is(":visible")&&visible($(element));};function visible(element){var visibility=element.css("visibility");while(visibility==="inherit"){element=element.parent();visibility=element.css("visibility");}
return visibility!=="hidden";}
$.extend($.expr[":"],{focusable:function(element){return $.ui.focusable(element,$.attr(element,"tabindex")!=null);}});var focusable=$.ui.focusable;var form=$.fn.form=function(){return typeof this[0].form==="string"?this.closest("form"):$(this[0].form);};var formResetMixin=$.ui.formResetMixin={_formResetHandler:function(){var form=$(this);setTimeout(function(){var instances=form.data("ui-form-reset-instances");$.each(instances,function(){this.refresh();});});},_bindFormResetHandler:function(){this.form=this.element.form();if(!this.form.length){return;}
var instances=this.form.data("ui-form-reset-instances")||[];if(!instances.length){this.form.on("reset.ui-form-reset",this._formResetHandler);}
instances.push(this);this.form.data("ui-form-reset-instances",instances);},_unbindFormResetHandler:function(){if(!this.form.length){return;}
var instances=this.form.data("ui-form-reset-instances");instances.splice($.inArray(this,instances),1);if(instances.length){this.form.data("ui-form-reset-instances",instances);}else{this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset");}}};if($.fn.jquery.substring(0,3)==="1.7"){$.each(["Width","Height"],function(i,name){var side=name==="Width"?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};function reduce(elem,size,border,margin){$.each(side,function(){size-=parseFloat($.css(elem,"padding"+this))||0;if(border){size-=parseFloat($.css(elem,"border"+this+"Width"))||0;}
if(margin){size-=parseFloat($.css(elem,"margin"+this))||0;}});return size;}
$.fn["inner"+name]=function(size){if(size===undefined){return orig["inner"+name].call(this);}
return this.each(function(){$(this).css(type,reduce(this,size)+"px");});};$.fn["outer"+name]=function(size,margin){if(typeof size!=="number"){return orig["outer"+name].call(this,size);}
return this.each(function(){$(this).css(type,reduce(this,size,true,margin)+"px");});};});$.fn.addBack=function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector));};};var keycode=$.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38};var escapeSelector=$.ui.escapeSelector=(function(){var selectorEscape=/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g;return function(selector){return selector.replace(selectorEscape,"\\$1");};})();var labels=$.fn.labels=function(){var ancestor,selector,id,labels,ancestors;if(this[0].labels&&this[0].labels.length){return this.pushStack(this[0].labels);}
labels=this.eq(0).parents("label");id=this.attr("id");if(id){ancestor=this.eq(0).parents().last();ancestors=ancestor.add(ancestor.length?ancestor.siblings():this.siblings());selector="label[for='"+$.ui.escapeSelector(id)+"']";labels=labels.add(ancestors.find(selector).addBack(selector));}
return this.pushStack(labels);};var scrollParent=$.fn.scrollParent=function(includeHidden){var position=this.css("position"),excludeStaticParent=position==="absolute",overflowRegex=includeHidden?/(auto|scroll|hidden)/:/(auto|scroll)/,scrollParent=this.parents().filter(function(){var parent=$(this);if(excludeStaticParent&&parent.css("position")==="static"){return false;}
return overflowRegex.test(parent.css("overflow")+parent.css("overflow-y")+
parent.css("overflow-x"));}).eq(0);return position==="fixed"||!scrollParent.length?$(this[0].ownerDocument||document):scrollParent;};var tabbable=$.extend($.expr[":"],{tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),hasTabindex=tabIndex!=null;return(!hasTabindex||tabIndex>=0)&&$.ui.focusable(element,hasTabindex);}});var uniqueId=$.fn.extend({uniqueId:(function(){var uuid=0;return function(){return this.each(function(){if(!this.id){this.id="ui-id-"+(++uuid);}});};})(),removeUniqueId:function(){return this.each(function(){if(/^ui-id-\d+$/.test(this.id)){$(this).removeAttr("id");}});}});var widgetsAccordion=$.widget("ui.accordion",{version:"1.12.1",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:false,event:"click",header:"> li > :first-child, > :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var options=this.options;this.prevShow=this.prevHide=$();this._addClass("ui-accordion","ui-widget ui-helper-reset");this.element.attr("role","tablist");if(!options.collapsible&&(options.active===false||options.active==null)){options.active=0;}
this._processPanels();if(options.active<0){options.active+=this.headers.length;}
this._refresh();},_getCreateEventData:function(){return{header:this.active,panel:!this.active.length?$():this.active.next()};},_createIcons:function(){var icon,children,icons=this.options.icons;if(icons){icon=$("<span>");this._addClass(icon,"ui-accordion-header-icon","ui-icon "+icons.header);icon.prependTo(this.headers);children=this.active.children(".ui-accordion-header-icon");this._removeClass(children,icons.header)._addClass(children,null,icons.activeHeader)._addClass(this.headers,"ui-accordion-icons");}},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons");this.headers.children(".ui-accordion-header-icon").remove();},_destroy:function(){var contents;this.element.removeAttr("role");this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId();this._destroyIcons();contents=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId();if(this.options.heightStyle!=="content"){contents.css("height","");}},_setOption:function(key,value){if(key==="active"){this._activate(value);return;}
if(key==="event"){if(this.options.event){this._off(this.headers,this.options.event);}
this._setupEvents(value);}
this._super(key,value);if(key==="collapsible"&&!value&&this.options.active===false){this._activate(0);}
if(key==="icons"){this._destroyIcons();if(value){this._createIcons();}}},_setOptionDisabled:function(value){this._super(value);this.element.attr("aria-disabled",value);this._toggleClass(null,"ui-state-disabled",!!value);this._toggleClass(this.headers.add(this.headers.next()),null,"ui-state-disabled",!!value);},_keydown:function(event){if(event.altKey||event.ctrlKey){return;}
var keyCode=$.ui.keyCode,length=this.headers.length,currentIndex=this.headers.index(event.target),toFocus=false;switch(event.keyCode){case keyCode.RIGHT:case keyCode.DOWN:toFocus=this.headers[(currentIndex+1)%length];break;case keyCode.LEFT:case keyCode.UP:toFocus=this.headers[(currentIndex-1+length)%length];break;case keyCode.SPACE:case keyCode.ENTER:this._eventHandler(event);break;case keyCode.HOME:toFocus=this.headers[0];break;case keyCode.END:toFocus=this.headers[length-1];break;}
if(toFocus){$(event.target).attr("tabIndex",-1);$(toFocus).attr("tabIndex",0);$(toFocus).trigger("focus");event.preventDefault();}},_panelKeyDown:function(event){if(event.keyCode===$.ui.keyCode.UP&&event.ctrlKey){$(event.currentTarget).prev().trigger("focus");}},refresh:function(){var options=this.options;this._processPanels();if((options.active===false&&options.collapsible===true)||!this.headers.length){options.active=false;this.active=$();}else if(options.active===false){this._activate(0);}else if(this.active.length&&!$.contains(this.element[0],this.active[0])){if(this.headers.length===this.headers.find(".ui-state-disabled").length){options.active=false;this.active=$();}else{this._activate(Math.max(0,options.active-1));}}else{options.active=this.headers.index(this.active);}
this._destroyIcons();this._refresh();},_processPanels:function(){var prevHeaders=this.headers,prevPanels=this.panels;this.headers=this.element.find(this.options.header);this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default");this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide();this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content");if(prevPanels){this._off(prevHeaders.not(this.headers));this._off(prevPanels.not(this.panels));}},_refresh:function(){var maxHeight,options=this.options,heightStyle=options.heightStyle,parent=this.element.parent();this.active=this._findActive(options.active);this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed");this._addClass(this.active.next(),"ui-accordion-content-active");this.active.next().show();this.headers.attr("role","tab").each(function(){var header=$(this),headerId=header.uniqueId().attr("id"),panel=header.next(),panelId=panel.uniqueId().attr("id");header.attr("aria-controls",panelId);panel.attr("aria-labelledby",headerId);}).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide();if(!this.active.length){this.headers.eq(0).attr("tabIndex",0);}else{this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"});}
this._createIcons();this._setupEvents(options.event);if(heightStyle==="fill"){maxHeight=parent.height();this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");if(position==="absolute"||position==="fixed"){return;}
maxHeight-=elem.outerHeight(true);});this.headers.each(function(){maxHeight-=$(this).outerHeight(true);});this.headers.next().each(function(){$(this).height(Math.max(0,maxHeight-
$(this).innerHeight()+$(this).height()));}).css("overflow","auto");}else if(heightStyle==="auto"){maxHeight=0;this.headers.next().each(function(){var isVisible=$(this).is(":visible");if(!isVisible){$(this).show();}
maxHeight=Math.max(maxHeight,$(this).css("height","").height());if(!isVisible){$(this).hide();}}).height(maxHeight);}},_activate:function(index){var active=this._findActive(index)[0];if(active===this.active[0]){return;}
active=active||this.active[0];this._eventHandler({target:active,currentTarget:active,preventDefault:$.noop});},_findActive:function(selector){return typeof selector==="number"?this.headers.eq(selector):$();},_setupEvents:function(event){var events={keydown:"_keydown"};if(event){$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler";});}
this._off(this.headers.add(this.headers.next()));this._on(this.headers,events);this._on(this.headers.next(),{keydown:"_panelKeyDown"});this._hoverable(this.headers);this._focusable(this.headers);},_eventHandler:function(event){var activeChildren,clickedChildren,options=this.options,active=this.active,clicked=$(event.currentTarget),clickedIsActive=clicked[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():clicked.next(),toHide=active.next(),eventData={oldHeader:active,oldPanel:toHide,newHeader:collapsing?$():clicked,newPanel:toShow};event.preventDefault();if((clickedIsActive&&!options.collapsible)||(this._trigger("beforeActivate",event,eventData)===false)){return;}
options.active=collapsing?false:this.headers.index(clicked);this.active=clickedIsActive?$():clicked;this._toggle(eventData);this._removeClass(active,"ui-accordion-header-active","ui-state-active");if(options.icons){activeChildren=active.children(".ui-accordion-header-icon");this._removeClass(activeChildren,null,options.icons.activeHeader)._addClass(activeChildren,null,options.icons.header);}
if(!clickedIsActive){this._removeClass(clicked,"ui-accordion-header-collapsed")._addClass(clicked,"ui-accordion-header-active","ui-state-active");if(options.icons){clickedChildren=clicked.children(".ui-accordion-header-icon");this._removeClass(clickedChildren,null,options.icons.header)._addClass(clickedChildren,null,options.icons.activeHeader);}
this._addClass(clicked.next(),"ui-accordion-content-active");}},_toggle:function(data){var toShow=data.newPanel,toHide=this.prevShow.length?this.prevShow:data.oldPanel;this.prevShow.add(this.prevHide).stop(true,true);this.prevShow=toShow;this.prevHide=toHide;if(this.options.animate){this._animate(toShow,toHide,data);}else{toHide.hide();toShow.show();this._toggleComplete(data);}
toHide.attr({"aria-hidden":"true"});toHide.prev().attr({"aria-selected":"false","aria-expanded":"false"});if(toShow.length&&toHide.length){toHide.prev().attr({"tabIndex":-1,"aria-expanded":"false"});}else if(toShow.length){this.headers.filter(function(){return parseInt($(this).attr("tabIndex"),10)===0;}).attr("tabIndex",-1);}
toShow.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0});},_animate:function(toShow,toHide,data){var total,easing,duration,that=this,adjust=0,boxSizing=toShow.css("box-sizing"),down=toShow.length&&(!toHide.length||(toShow.index()<toHide.index())),animate=this.options.animate||{},options=down&&animate.down||animate,complete=function(){that._toggleComplete(data);};if(typeof options==="number"){duration=options;}
if(typeof options==="string"){easing=options;}
easing=easing||options.easing||animate.easing;duration=duration||options.duration||animate.duration;if(!toHide.length){return toShow.animate(this.showProps,duration,easing,complete);}
if(!toShow.length){return toHide.animate(this.hideProps,duration,easing,complete);}
total=toShow.show().outerHeight();toHide.animate(this.hideProps,{duration:duration,easing:easing,step:function(now,fx){fx.now=Math.round(now);}});toShow.hide().animate(this.showProps,{duration:duration,easing:easing,complete:complete,step:function(now,fx){fx.now=Math.round(now);if(fx.prop!=="height"){if(boxSizing==="content-box"){adjust+=fx.now;}}else if(that.options.heightStyle!=="content"){fx.now=Math.round(total-toHide.outerHeight()-adjust);adjust=0;}}});},_toggleComplete:function(data){var toHide=data.oldPanel,prev=toHide.prev();this._removeClass(toHide,"ui-accordion-content-active");this._removeClass(prev,"ui-accordion-header-active")._addClass(prev,"ui-accordion-header-collapsed");if(toHide.length){toHide.parent()[0].className=toHide.parent()[0].className;}
this._trigger("activate",null,data);}});var safeActiveElement=$.ui.safeActiveElement=function(document){var activeElement;try{activeElement=document.activeElement;}catch(error){activeElement=document.body;}
if(!activeElement){activeElement=document.body;}
if(!activeElement.nodeName){activeElement=document.body;}
return activeElement;};var widgetsMenu=$.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.mouseHandled=false;this.element.uniqueId().attr({role:this.options.role,tabIndex:0});this._addClass("ui-menu","ui-widget ui-widget-content");this._on({"mousedown .ui-menu-item":function(event){event.preventDefault();},"click .ui-menu-item":function(event){var target=$(event.target);var active=$($.ui.safeActiveElement(this.document[0]));if(!this.mouseHandled&&target.not(".ui-state-disabled").length){this.select(event);if(!event.isPropagationStopped()){this.mouseHandled=true;}
if(target.has(".ui-menu").length){this.expand(event);}else if(!this.element.is(":focus")&&active.closest(".ui-menu").length){this.element.trigger("focus",[true]);if(this.active&&this.active.parents(".ui-menu").length===1){clearTimeout(this.timer);}}}},"mouseenter .ui-menu-item":function(event){if(this.previousFilter){return;}
var actualTarget=$(event.target).closest(".ui-menu-item"),target=$(event.currentTarget);if(actualTarget[0]!==target[0]){return;}
this._removeClass(target.siblings().children(".ui-state-active"),null,"ui-state-active");this.focus(event,target);},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(event,keepActiveItem){var item=this.active||this.element.find(this.options.items).eq(0);if(!keepActiveItem){this.focus(event,item);}},blur:function(event){this._delay(function(){var notContained=!$.contains(this.element[0],$.ui.safeActiveElement(this.document[0]));if(notContained){this.collapseAll(event);}});},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(event){if(this._closeOnDocumentClick(event)){this.collapseAll(event);}
this.mouseHandled=false;}});},_destroy:function(){var items=this.element.find(".ui-menu-item").removeAttr("role aria-disabled"),submenus=items.children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled "+"tabIndex").removeUniqueId().show();submenus.children().each(function(){var elem=$(this);if(elem.data("ui-menu-submenu-caret")){elem.remove();}});},_keydown:function(event){var match,prev,character,skip,preventDefault=true;switch(event.keyCode){case $.ui.keyCode.PAGE_UP:this.previousPage(event);break;case $.ui.keyCode.PAGE_DOWN:this.nextPage(event);break;case $.ui.keyCode.HOME:this._move("first","first",event);break;case $.ui.keyCode.END:this._move("last","last",event);break;case $.ui.keyCode.UP:this.previous(event);break;case $.ui.keyCode.DOWN:this.next(event);break;case $.ui.keyCode.LEFT:this.collapse(event);break;case $.ui.keyCode.RIGHT:if(this.active&&!this.active.is(".ui-state-disabled")){this.expand(event);}
break;case $.ui.keyCode.ENTER:case $.ui.keyCode.SPACE:this._activate(event);break;case $.ui.keyCode.ESCAPE:this.collapse(event);break;default:preventDefault=false;prev=this.previousFilter||"";skip=false;character=event.keyCode>=96&&event.keyCode<=105?(event.keyCode-96).toString():String.fromCharCode(event.keyCode);clearTimeout(this.filterTimer);if(character===prev){skip=true;}else{character=prev+character;}
match=this._filterMenuItems(character);match=skip&&match.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):match;if(!match.length){character=String.fromCharCode(event.keyCode);match=this._filterMenuItems(character);}
if(match.length){this.focus(event,match);this.previousFilter=character;this.filterTimer=this._delay(function(){delete this.previousFilter;},1000);}else{delete this.previousFilter;}}
if(preventDefault){event.preventDefault();}},_activate:function(event){if(this.active&&!this.active.is(".ui-state-disabled")){if(this.active.children("[aria-haspopup='true']").length){this.expand(event);}else{this.select(event);}}},refresh:function(){var menus,items,newSubmenus,newItems,newWrappers,that=this,icon=this.options.icons.submenu,submenus=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length);newSubmenus=submenus.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var menu=$(this),item=menu.prev(),submenuCaret=$("<span>").data("ui-menu-submenu-caret",true);that._addClass(submenuCaret,"ui-menu-icon","ui-icon "+icon);item.attr("aria-haspopup","true").prepend(submenuCaret);menu.attr("aria-labelledby",item.attr("id"));});this._addClass(newSubmenus,"ui-menu","ui-widget ui-widget-content ui-front");menus=submenus.add(this.element);items=menus.find(this.options.items);items.not(".ui-menu-item").each(function(){var item=$(this);if(that._isDivider(item)){that._addClass(item,"ui-menu-divider","ui-widget-content");}});newItems=items.not(".ui-menu-item, .ui-menu-divider");newWrappers=newItems.children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()});this._addClass(newItems,"ui-menu-item")._addClass(newWrappers,"ui-menu-item-wrapper");items.filter(".ui-state-disabled").attr("aria-disabled","true");if(this.active&&!$.contains(this.element[0],this.active[0])){this.blur();}},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role];},_setOption:function(key,value){if(key==="icons"){var icons=this.element.find(".ui-menu-icon");this._removeClass(icons,null,this.options.icons.submenu)._addClass(icons,null,value.submenu);}
this._super(key,value);},_setOptionDisabled:function(value){this._super(value);this.element.attr("aria-disabled",String(value));this._toggleClass(null,"ui-state-disabled",!!value);},focus:function(event,item){var nested,focused,activeParent;this.blur(event,event&&event.type==="focus");this._scrollIntoView(item);this.active=item.first();focused=this.active.children(".ui-menu-item-wrapper");this._addClass(focused,null,"ui-state-active");if(this.options.role){this.element.attr("aria-activedescendant",focused.attr("id"));}
activeParent=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper");this._addClass(activeParent,null,"ui-state-active");if(event&&event.type==="keydown"){this._close();}else{this.timer=this._delay(function(){this._close();},this.delay);}
nested=item.children(".ui-menu");if(nested.length&&event&&(/^mouse/.test(event.type))){this._startOpening(nested);}
this.activeMenu=item.parent();this._trigger("focus",event,{item:item});},_scrollIntoView:function(item){var borderTop,paddingTop,offset,scroll,elementHeight,itemHeight;if(this._hasScroll()){borderTop=parseFloat($.css(this.activeMenu[0],"borderTopWidth"))||0;paddingTop=parseFloat($.css(this.activeMenu[0],"paddingTop"))||0;offset=item.offset().top-this.activeMenu.offset().top-borderTop-paddingTop;scroll=this.activeMenu.scrollTop();elementHeight=this.activeMenu.height();itemHeight=item.outerHeight();if(offset<0){this.activeMenu.scrollTop(scroll+offset);}else if(offset+itemHeight>elementHeight){this.activeMenu.scrollTop(scroll+offset-elementHeight+itemHeight);}}},blur:function(event,fromFocus){if(!fromFocus){clearTimeout(this.timer);}
if(!this.active){return;}
this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active");this._trigger("blur",event,{item:this.active});this.active=null;},_startOpening:function(submenu){clearTimeout(this.timer);if(submenu.attr("aria-hidden")!=="true"){return;}
this.timer=this._delay(function(){this._close();this._open(submenu);},this.delay);},_open:function(submenu){var position=$.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".ui-menu").not(submenu.parents(".ui-menu")).hide().attr("aria-hidden","true");submenu.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(position);},collapseAll:function(event,all){clearTimeout(this.timer);this.timer=this._delay(function(){var currentMenu=all?this.element:$(event&&event.target).closest(this.element.find(".ui-menu"));if(!currentMenu.length){currentMenu=this.element;}
this._close(currentMenu);this.blur(event);this._removeClass(currentMenu.find(".ui-state-active"),null,"ui-state-active");this.activeMenu=currentMenu;},this.delay);},_close:function(startMenu){if(!startMenu){startMenu=this.active?this.active.parent():this.element;}
startMenu.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false");},_closeOnDocumentClick:function(event){return!$(event.target).closest(".ui-menu").length;},_isDivider:function(item){return!/[^\-\u2014\u2013\s]/.test(item.text());},collapse:function(event){var newItem=this.active&&this.active.parent().closest(".ui-menu-item",this.element);if(newItem&&newItem.length){this._close();this.focus(event,newItem);}},expand:function(event){var newItem=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();if(newItem&&newItem.length){this._open(newItem.parent());this._delay(function(){this.focus(event,newItem);});}},next:function(event){this._move("next","first",event);},previous:function(event){this._move("prev","last",event);},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length;},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length;},_move:function(direction,filter,event){var next;if(this.active){if(direction==="first"||direction==="last"){next=this.active
[direction==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1);}else{next=this.active
[direction+"All"](".ui-menu-item").eq(0);}}
if(!next||!next.length||!this.active){next=this.activeMenu.find(this.options.items)[filter]();}
this.focus(event,next);},nextPage:function(event){var item,base,height;if(!this.active){this.next(event);return;}
if(this.isLastItem()){return;}
if(this._hasScroll()){base=this.active.offset().top;height=this.element.height();this.active.nextAll(".ui-menu-item").each(function(){item=$(this);return item.offset().top-base-height<0;});this.focus(event,item);}else{this.focus(event,this.activeMenu.find(this.options.items)
[!this.active?"first":"last"]());}},previousPage:function(event){var item,base,height;if(!this.active){this.next(event);return;}
if(this.isFirstItem()){return;}
if(this._hasScroll()){base=this.active.offset().top;height=this.element.height();this.active.prevAll(".ui-menu-item").each(function(){item=$(this);return item.offset().top-base+height>0;});this.focus(event,item);}else{this.focus(event,this.activeMenu.find(this.options.items).first());}},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight");},select:function(event){this.active=this.active||$(event.target).closest(".ui-menu-item");var ui={item:this.active};if(!this.active.has(".ui-menu").length){this.collapseAll(event,true);}
this._trigger("select",event,ui);},_filterMenuItems:function(character){var escapedCharacter=character.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),regex=new RegExp("^"+escapedCharacter,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return regex.test($.trim($(this).children(".ui-menu-item-wrapper").text()));});}});$.widget("ui.autocomplete",{version:"1.12.1",defaultElement:"<input>",options:{appendTo:null,autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var suppressKeyPress,suppressKeyPressRepeat,suppressInput,nodeName=this.element[0].nodeName.toLowerCase(),isTextarea=nodeName==="textarea",isInput=nodeName==="input";this.isMultiLine=isTextarea||!isInput&&this._isContentEditable(this.element);this.valueMethod=this.element[isTextarea||isInput?"val":"text"];this.isNewMenu=true;this._addClass("ui-autocomplete-input");this.element.attr("autocomplete","off");this._on(this.element,{keydown:function(event){if(this.element.prop("readOnly")){suppressKeyPress=true;suppressInput=true;suppressKeyPressRepeat=true;return;}
suppressKeyPress=false;suppressInput=false;suppressKeyPressRepeat=false;var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:suppressKeyPress=true;this._move("previousPage",event);break;case keyCode.PAGE_DOWN:suppressKeyPress=true;this._move("nextPage",event);break;case keyCode.UP:suppressKeyPress=true;this._keyEvent("previous",event);break;case keyCode.DOWN:suppressKeyPress=true;this._keyEvent("next",event);break;case keyCode.ENTER:if(this.menu.active){suppressKeyPress=true;event.preventDefault();this.menu.select(event);}
break;case keyCode.TAB:if(this.menu.active){this.menu.select(event);}
break;case keyCode.ESCAPE:if(this.menu.element.is(":visible")){if(!this.isMultiLine){this._value(this.term);}
this.close(event);event.preventDefault();}
break;default:suppressKeyPressRepeat=true;this._searchTimeout(event);break;}},keypress:function(event){if(suppressKeyPress){suppressKeyPress=false;if(!this.isMultiLine||this.menu.element.is(":visible")){event.preventDefault();}
return;}
if(suppressKeyPressRepeat){return;}
var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:this._move("previousPage",event);break;case keyCode.PAGE_DOWN:this._move("nextPage",event);break;case keyCode.UP:this._keyEvent("previous",event);break;case keyCode.DOWN:this._keyEvent("next",event);break;}},input:function(event){if(suppressInput){suppressInput=false;event.preventDefault();return;}
this._searchTimeout(event);},focus:function(){this.selectedItem=null;this.previous=this._value();},blur:function(event){if(this.cancelBlur){delete this.cancelBlur;return;}
clearTimeout(this.searching);this.close(event);this._change(event);}});this._initSource();this.menu=$("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance");this._addClass(this.menu.element,"ui-autocomplete","ui-front");this._on(this.menu.element,{mousedown:function(event){event.preventDefault();this.cancelBlur=true;this._delay(function(){delete this.cancelBlur;if(this.element[0]!==$.ui.safeActiveElement(this.document[0])){this.element.trigger("focus");}});},menufocus:function(event,ui){var label,item;if(this.isNewMenu){this.isNewMenu=false;if(event.originalEvent&&/^mouse/.test(event.originalEvent.type)){this.menu.blur();this.document.one("mousemove",function(){$(event.target).trigger(event.originalEvent);});return;}}
item=ui.item.data("ui-autocomplete-item");if(false!==this._trigger("focus",event,{item:item})){if(event.originalEvent&&/^key/.test(event.originalEvent.type)){this._value(item.value);}}
label=ui.item.attr("aria-label")||item.value;if(label&&$.trim(label).length){this.liveRegion.children().hide();$("<div>").text(label).appendTo(this.liveRegion);}},menuselect:function(event,ui){var item=ui.item.data("ui-autocomplete-item"),previous=this.previous;if(this.element[0]!==$.ui.safeActiveElement(this.document[0])){this.element.trigger("focus");this.previous=previous;this._delay(function(){this.previous=previous;this.selectedItem=item;});}
if(false!==this._trigger("select",event,{item:item})){this._value(item.value);}
this.term=this._value();this.close(event);this.selectedItem=item;}});this.liveRegion=$("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body);this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible");this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete");}});},_destroy:function(){clearTimeout(this.searching);this.element.removeAttr("autocomplete");this.menu.element.remove();this.liveRegion.remove();},_setOption:function(key,value){this._super(key,value);if(key==="source"){this._initSource();}
if(key==="appendTo"){this.menu.element.appendTo(this._appendTo());}
if(key==="disabled"&&value&&this.xhr){this.xhr.abort();}},_isEventTargetInWidget:function(event){var menuElement=this.menu.element[0];return event.target===this.element[0]||event.target===menuElement||$.contains(menuElement,event.target);},_closeOnClickOutside:function(event){if(!this._isEventTargetInWidget(event)){this.close();}},_appendTo:function(){var element=this.options.appendTo;if(element){element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0);}
if(!element||!element[0]){element=this.element.closest(".ui-front, dialog");}
if(!element.length){element=this.document[0].body;}
return element;},_initSource:function(){var array,url,that=this;if($.isArray(this.options.source)){array=this.options.source;this.source=function(request,response){response($.ui.autocomplete.filter(array,request.term));};}else if(typeof this.options.source==="string"){url=this.options.source;this.source=function(request,response){if(that.xhr){that.xhr.abort();}
that.xhr=$.ajax({url:url,data:request,dataType:"json",success:function(data){response(data);},error:function(){response([]);}});};}else{this.source=this.options.source;}},_searchTimeout:function(event){clearTimeout(this.searching);this.searching=this._delay(function(){var equalValues=this.term===this._value(),menuVisible=this.menu.element.is(":visible"),modifierKey=event.altKey||event.ctrlKey||event.metaKey||event.shiftKey;if(!equalValues||(equalValues&&!menuVisible&&!modifierKey)){this.selectedItem=null;this.search(null,event);}},this.options.delay);},search:function(value,event){value=value!=null?value:this._value();this.term=this._value();if(value.length<this.options.minLength){return this.close(event);}
if(this._trigger("search",event)===false){return;}
return this._search(value);},_search:function(value){this.pending++;this._addClass("ui-autocomplete-loading");this.cancelSearch=false;this.source({term:value},this._response());},_response:function(){var index=++this.requestIndex;return $.proxy(function(content){if(index===this.requestIndex){this.__response(content);}
this.pending--;if(!this.pending){this._removeClass("ui-autocomplete-loading");}},this);},__response:function(content){if(content){content=this._normalize(content);}
this._trigger("response",null,{content:content});if(!this.options.disabled&&content&&content.length&&!this.cancelSearch){this._suggest(content);this._trigger("open");}else{this._close();}},close:function(event){this.cancelSearch=true;this._close(event);},_close:function(event){this._off(this.document,"mousedown");if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.blur();this.isNewMenu=true;this._trigger("close",event);}},_change:function(event){if(this.previous!==this._value()){this._trigger("change",event,{item:this.selectedItem});}},_normalize:function(items){if(items.length&&items[0].label&&items[0].value){return items;}
return $.map(items,function(item){if(typeof item==="string"){return{label:item,value:item};}
return $.extend({},item,{label:item.label||item.value,value:item.value||item.label});});},_suggest:function(items){var ul=this.menu.element.empty();this._renderMenu(ul,items);this.isNewMenu=true;this.menu.refresh();ul.show();this._resizeMenu();ul.position($.extend({of:this.element},this.options.position));if(this.options.autoFocus){this.menu.next();}
this._on(this.document,{mousedown:"_closeOnClickOutside"});},_resizeMenu:function(){var ul=this.menu.element;ul.outerWidth(Math.max(ul.width("").outerWidth()+1,this.element.outerWidth()));},_renderMenu:function(ul,items){var that=this;$.each(items,function(index,item){that._renderItemData(ul,item);});},_renderItemData:function(ul,item){return this._renderItem(ul,item).data("ui-autocomplete-item",item);},_renderItem:function(ul,item){return $("<li>").append($("<div>").text(item.label)).appendTo(ul);},_move:function(direction,event){if(!this.menu.element.is(":visible")){this.search(null,event);return;}
if(this.menu.isFirstItem()&&/^previous/.test(direction)||this.menu.isLastItem()&&/^next/.test(direction)){if(!this.isMultiLine){this._value(this.term);}
this.menu.blur();return;}
this.menu[direction](event);},widget:function(){return this.menu.element;},_value:function(){return this.valueMethod.apply(this.element,arguments);},_keyEvent:function(keyEvent,event){if(!this.isMultiLine||this.menu.element.is(":visible")){this._move(keyEvent,event);event.preventDefault();}},_isContentEditable:function(element){if(!element.length){return false;}
var editable=element.prop("contentEditable");if(editable==="inherit"){return this._isContentEditable(element.parent());}
return editable==="true";}});$.extend($.ui.autocomplete,{escapeRegex:function(value){return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");},filter:function(array,term){var matcher=new RegExp($.ui.autocomplete.escapeRegex(term),"i");return $.grep(array,function(value){return matcher.test(value.label||value.value||value);});}});$.widget("ui.autocomplete",$.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(amount){return amount+(amount>1?" results are":" result is")+" available, use up and down arrow keys to navigate.";}}},__response:function(content){var message;this._superApply(arguments);if(this.options.disabled||this.cancelSearch){return;}
if(content&&content.length){message=this.options.messages.results(content.length);}else{message=this.options.messages.noResults;}
this.liveRegion.children().hide();$("<div>").text(message).appendTo(this.liveRegion);}});var widgetsAutocomplete=$.ui.autocomplete;var controlgroupCornerRegex=/ui-corner-([a-z]){2,6}/g;var widgetsControlgroup=$.widget("ui.controlgroup",{version:"1.12.1",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:true,items:{"button":"input[type=button], input[type=submit], input[type=reset], button, a","controlgroupLabel":".ui-controlgroup-label","checkboxradio":"input[type='checkbox'], input[type='radio']","selectmenu":"select","spinner":".ui-spinner-input"}},_create:function(){this._enhance();},_enhance:function(){this.element.attr("role","toolbar");this.refresh();},_destroy:function(){this._callChildMethod("destroy");this.childWidgets.removeData("ui-controlgroup-data");this.element.removeAttr("role");if(this.options.items.controlgroupLabel){this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap();}},_initWidgets:function(){var that=this,childWidgets=[];$.each(this.options.items,function(widget,selector){var labels;var options={};if(!selector){return;}
if(widget==="controlgroupLabel"){labels=that.element.find(selector);labels.each(function(){var element=$(this);if(element.children(".ui-controlgroup-label-contents").length){return;}
element.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>");});that._addClass(labels,null,"ui-widget ui-widget-content ui-state-default");childWidgets=childWidgets.concat(labels.get());return;}
if(!$.fn[widget]){return;}
if(that["_"+widget+"Options"]){options=that["_"+widget+"Options"]("middle");}else{options={classes:{}};}
that.element.find(selector).each(function(){var element=$(this);var instance=element[widget]("instance");var instanceOptions=$.widget.extend({},options);if(widget==="button"&&element.parent(".ui-spinner").length){return;}
if(!instance){instance=element[widget]()[widget]("instance");}
if(instance){instanceOptions.classes=that._resolveClassesValues(instanceOptions.classes,instance);}
element[widget](instanceOptions);var widgetElement=element[widget]("widget");$.data(widgetElement[0],"ui-controlgroup-data",instance?instance:element[widget]("instance"));childWidgets.push(widgetElement[0]);});});this.childWidgets=$($.unique(childWidgets));this._addClass(this.childWidgets,"ui-controlgroup-item");},_callChildMethod:function(method){this.childWidgets.each(function(){var element=$(this),data=element.data("ui-controlgroup-data");if(data&&data[method]){data[method]();}});},_updateCornerClass:function(element,position){var remove="ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all";var add=this._buildSimpleOptions(position,"label").classes.label;this._removeClass(element,null,remove);this._addClass(element,null,add);},_buildSimpleOptions:function(position,key){var direction=this.options.direction==="vertical";var result={classes:{}};result.classes[key]={"middle":"","first":"ui-corner-"+(direction?"top":"left"),"last":"ui-corner-"+(direction?"bottom":"right"),"only":"ui-corner-all"}[position];return result;},_spinnerOptions:function(position){var options=this._buildSimpleOptions(position,"ui-spinner");options.classes["ui-spinner-up"]="";options.classes["ui-spinner-down"]="";return options;},_buttonOptions:function(position){return this._buildSimpleOptions(position,"ui-button");},_checkboxradioOptions:function(position){return this._buildSimpleOptions(position,"ui-checkboxradio-label");},_selectmenuOptions:function(position){var direction=this.options.direction==="vertical";return{width:direction?"auto":false,classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(direction?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(direction?"top":"left")},last:{"ui-selectmenu-button-open":direction?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(direction?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[position]};},_resolveClassesValues:function(classes,instance){var result={};$.each(classes,function(key){var current=instance.options.classes[key]||"";current=$.trim(current.replace(controlgroupCornerRegex,""));result[key]=(current+" "+classes[key]).replace(/\s+/g," ");});return result;},_setOption:function(key,value){if(key==="direction"){this._removeClass("ui-controlgroup-"+this.options.direction);}
this._super(key,value);if(key==="disabled"){this._callChildMethod(value?"disable":"enable");return;}
this.refresh();},refresh:function(){var children,that=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction);if(this.options.direction==="horizontal"){this._addClass(null,"ui-helper-clearfix");}
this._initWidgets();children=this.childWidgets;if(this.options.onlyVisible){children=children.filter(":visible");}
if(children.length){$.each(["first","last"],function(index,value){var instance=children[value]().data("ui-controlgroup-data");if(instance&&that["_"+instance.widgetName+"Options"]){var options=that["_"+instance.widgetName+"Options"](children.length===1?"only":value);options.classes=that._resolveClassesValues(options.classes,instance);instance.element[instance.widgetName](options);}else{that._updateCornerClass(children[value](),value);}});this._callChildMethod("refresh");}}});$.widget("ui.checkboxradio",[$.ui.formResetMixin,{version:"1.12.1",options:{disabled:null,label:null,icon:true,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var disabled,labels;var that=this;var options=this._super()||{};this._readType();labels=this.element.labels();this.label=$(labels[labels.length-1]);if(!this.label.length){$.error("No label found for checkboxradio widget");}
this.originalLabel="";this.label.contents().not(this.element[0]).each(function(){that.originalLabel+=this.nodeType===3?$(this).text():this.outerHTML;});if(this.originalLabel){options.label=this.originalLabel;}
disabled=this.element[0].disabled;if(disabled!=null){options.disabled=disabled;}
return options;},_create:function(){var checked=this.element[0].checked;this._bindFormResetHandler();if(this.options.disabled==null){this.options.disabled=this.element[0].disabled;}
this._setOption("disabled",this.options.disabled);this._addClass("ui-checkboxradio","ui-helper-hidden-accessible");this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget");if(this.type==="radio"){this._addClass(this.label,"ui-checkboxradio-radio-label");}
if(this.options.label&&this.options.label!==this.originalLabel){this._updateLabel();}else if(this.originalLabel){this.options.label=this.originalLabel;}
this._enhance();if(checked){this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active");if(this.icon){this._addClass(this.icon,null,"ui-state-hover");}}
this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus");},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus");}});},_readType:function(){var nodeName=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type;if(nodeName!=="input"||!/radio|checkbox/.test(this.type)){$.error("Can't create checkboxradio on element.nodeName="+nodeName+" and element.type="+this.type);}},_enhance:function(){this._updateIcon(this.element[0].checked);},widget:function(){return this.label;},_getRadioGroup:function(){var group;var name=this.element[0].name;var nameSelector="input[name='"+$.ui.escapeSelector(name)+"']";if(!name){return $([]);}
if(this.form.length){group=$(this.form[0].elements).filter(nameSelector);}else{group=$(nameSelector).filter(function(){return $(this).form().length===0;});}
return group.not(this.element);},_toggleClasses:function(){var checked=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",checked);if(this.options.icon&&this.type==="checkbox"){this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",checked)._toggleClass(this.icon,null,"ui-icon-blank",!checked);}
if(this.type==="radio"){this._getRadioGroup().each(function(){var instance=$(this).checkboxradio("instance");if(instance){instance._removeClass(instance.label,"ui-checkboxradio-checked","ui-state-active");}});}},_destroy:function(){this._unbindFormResetHandler();if(this.icon){this.icon.remove();this.iconSpace.remove();}},_setOption:function(key,value){if(key==="label"&&!value){return;}
this._super(key,value);if(key==="disabled"){this._toggleClass(this.label,null,"ui-state-disabled",value);this.element[0].disabled=value;return;}
this.refresh();},_updateIcon:function(checked){var toAdd="ui-icon ui-icon-background ";if(this.options.icon){if(!this.icon){this.icon=$("<span>");this.iconSpace=$("<span> </span>");this._addClass(this.iconSpace,"ui-checkboxradio-icon-space");}
if(this.type==="checkbox"){toAdd+=checked?"ui-icon-check ui-state-checked":"ui-icon-blank";this._removeClass(this.icon,null,checked?"ui-icon-blank":"ui-icon-check");}else{toAdd+="ui-icon-blank";}
this._addClass(this.icon,"ui-checkboxradio-icon",toAdd);if(!checked){this._removeClass(this.icon,null,"ui-icon-check ui-state-checked");}
this.icon.prependTo(this.label).after(this.iconSpace);}else if(this.icon!==undefined){this.icon.remove();this.iconSpace.remove();delete this.icon;}},_updateLabel:function(){var contents=this.label.contents().not(this.element[0]);if(this.icon){contents=contents.not(this.icon[0]);}
if(this.iconSpace){contents=contents.not(this.iconSpace[0]);}
contents.remove();this.label.append(this.options.label);},refresh:function(){var checked=this.element[0].checked,isDisabled=this.element[0].disabled;this._updateIcon(checked);this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",checked);if(this.options.label!==null){this._updateLabel();}
if(isDisabled!==this.options.disabled){this._setOptions({"disabled":isDisabled});}}}]);var widgetsCheckboxradio=$.ui.checkboxradio;$.widget("ui.button",{version:"1.12.1",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:true},_getCreateOptions:function(){var disabled,options=this._super()||{};this.isInput=this.element.is("input");disabled=this.element[0].disabled;if(disabled!=null){options.disabled=disabled;}
this.originalLabel=this.isInput?this.element.val():this.element.html();if(this.originalLabel){options.label=this.originalLabel;}
return options;},_create:function(){if(!this.option.showLabel&!this.options.icon){this.options.showLabel=true;}
if(this.options.disabled==null){this.options.disabled=this.element[0].disabled||false;}
this.hasTitle=!!this.element.attr("title");if(this.options.label&&this.options.label!==this.originalLabel){if(this.isInput){this.element.val(this.options.label);}else{this.element.html(this.options.label);}}
this._addClass("ui-button","ui-widget");this._setOption("disabled",this.options.disabled);this._enhance();if(this.element.is("a")){this._on({"keyup":function(event){if(event.keyCode===$.ui.keyCode.SPACE){event.preventDefault();if(this.element[0].click){this.element[0].click();}else{this.element.trigger("click");}}}});}},_enhance:function(){if(!this.element.is("button")){this.element.attr("role","button");}
if(this.options.icon){this._updateIcon("icon",this.options.icon);this._updateTooltip();}},_updateTooltip:function(){this.title=this.element.attr("title");if(!this.options.showLabel&&!this.title){this.element.attr("title",this.options.label);}},_updateIcon:function(option,value){var icon=option!=="iconPosition",position=icon?this.options.iconPosition:value,displayBlock=position==="top"||position==="bottom";if(!this.icon){this.icon=$("<span>");this._addClass(this.icon,"ui-button-icon","ui-icon");if(!this.options.showLabel){this._addClass("ui-button-icon-only");}}else if(icon){this._removeClass(this.icon,null,this.options.icon);}
if(icon){this._addClass(this.icon,null,value);}
this._attachIcon(position);if(displayBlock){this._addClass(this.icon,null,"ui-widget-icon-block");if(this.iconSpace){this.iconSpace.remove();}}else{if(!this.iconSpace){this.iconSpace=$("<span> </span>");this._addClass(this.iconSpace,"ui-button-icon-space");}
this._removeClass(this.icon,null,"ui-wiget-icon-block");this._attachIconSpace(position);}},_destroy:function(){this.element.removeAttr("role");if(this.icon){this.icon.remove();}
if(this.iconSpace){this.iconSpace.remove();}
if(!this.hasTitle){this.element.removeAttr("title");}},_attachIconSpace:function(iconPosition){this.icon[/^(?:end|bottom)/.test(iconPosition)?"before":"after"](this.iconSpace);},_attachIcon:function(iconPosition){this.element[/^(?:end|bottom)/.test(iconPosition)?"append":"prepend"](this.icon);},_setOptions:function(options){var newShowLabel=options.showLabel===undefined?this.options.showLabel:options.showLabel,newIcon=options.icon===undefined?this.options.icon:options.icon;if(!newShowLabel&&!newIcon){options.showLabel=true;}
this._super(options);},_setOption:function(key,value){if(key==="icon"){if(value){this._updateIcon(key,value);}else if(this.icon){this.icon.remove();if(this.iconSpace){this.iconSpace.remove();}}}
if(key==="iconPosition"){this._updateIcon(key,value);}
if(key==="showLabel"){this._toggleClass("ui-button-icon-only",null,!value);this._updateTooltip();}
if(key==="label"){if(this.isInput){this.element.val(value);}else{this.element.html(value);if(this.icon){this._attachIcon(this.options.iconPosition);this._attachIconSpace(this.options.iconPosition);}}}
this._super(key,value);if(key==="disabled"){this._toggleClass(null,"ui-state-disabled",value);this.element[0].disabled=value;if(value){this.element.blur();}}},refresh:function(){var isDisabled=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");if(isDisabled!==this.options.disabled){this._setOptions({disabled:isDisabled});}
this._updateTooltip();}});if($.uiBackCompat!==false){$.widget("ui.button",$.ui.button,{options:{text:true,icons:{primary:null,secondary:null}},_create:function(){if(this.options.showLabel&&!this.options.text){this.options.showLabel=this.options.text;}
if(!this.options.showLabel&&this.options.text){this.options.text=this.options.showLabel;}
if(!this.options.icon&&(this.options.icons.primary||this.options.icons.secondary)){if(this.options.icons.primary){this.options.icon=this.options.icons.primary;}else{this.options.icon=this.options.icons.secondary;this.options.iconPosition="end";}}else if(this.options.icon){this.options.icons.primary=this.options.icon;}
this._super();},_setOption:function(key,value){if(key==="text"){this._super("showLabel",value);return;}
if(key==="showLabel"){this.options.text=value;}
if(key==="icon"){this.options.icons.primary=value;}
if(key==="icons"){if(value.primary){this._super("icon",value.primary);this._super("iconPosition","beginning");}else if(value.secondary){this._super("icon",value.secondary);this._super("iconPosition","end");}}
this._superApply(arguments);}});$.fn.button=(function(orig){return function(){if(!this.length||(this.length&&this[0].tagName!=="INPUT")||(this.length&&this[0].tagName==="INPUT"&&(this.attr("type")!=="checkbox"&&this.attr("type")!=="radio"))){return orig.apply(this,arguments);}
if(!$.ui.checkboxradio){$.error("Checkboxradio widget missing");}
if(arguments.length===0){return this.checkboxradio({"icon":false});}
return this.checkboxradio.apply(this,arguments);};})($.fn.button);$.fn.buttonset=function(){if(!$.ui.controlgroup){$.error("Controlgroup widget missing");}
if(arguments[0]==="option"&&arguments[1]==="items"&&arguments[2]){return this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]);}
if(arguments[0]==="option"&&arguments[1]==="items"){return this.controlgroup.apply(this,[arguments[0],"items.button"]);}
if(typeof arguments[0]==="object"&&arguments[0].items){arguments[0].items={button:arguments[0].items};}
return this.controlgroup.apply(this,arguments);};}
var widgetsButton=$.ui.button;$.extend($.ui,{datepicker:{version:"1.12.1"}});var datepicker_instActive;function datepicker_getZindex(elem){var position,value;while(elem.length&&elem[0]!==document){position=elem.css("position");if(position==="absolute"||position==="relative"||position==="fixed"){value=parseInt(elem.css("zIndex"),10);if(!isNaN(value)&&value!==0){return value;}}
elem=elem.parent();}
return 0;}
function Datepicker(){this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};$.extend(this._defaults,this.regional[""]);this.regional.en=$.extend(true,{},this.regional[""]);this.regional["en-US"]=$.extend(true,{},this.regional.en);this.dpDiv=datepicker_bindHover($("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"));}
$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv;},setDefaults:function(settings){datepicker_extendRemove(this._defaults,settings||{});return this;},_attachDatepicker:function(target,settings){var nodeName,inline,inst;nodeName=target.nodeName.toLowerCase();inline=(nodeName==="div"||nodeName==="span");if(!target.id){this.uuid+=1;target.id="dp"+this.uuid;}
inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{});if(nodeName==="input"){this._connectDatepicker(target,inst);}else if(inline){this._inlineDatepicker(target,inst);}},_newInst:function(target,inline){var id=target[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:id,input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:(!inline?this.dpDiv:datepicker_bindHover($("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")))};},_connectDatepicker:function(target,inst){var input=$(target);inst.append=$([]);inst.trigger=$([]);if(input.hasClass(this.markerClassName)){return;}
this._attachments(input,inst);input.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp);this._autoSize(inst);$.data(target,"datepicker",inst);if(inst.settings.disabled){this._disableDatepicker(target);}},_attachments:function(input,inst){var showOn,buttonText,buttonImage,appendText=this._get(inst,"appendText"),isRTL=this._get(inst,"isRTL");if(inst.append){inst.append.remove();}
if(appendText){inst.append=$("<span class='"+this._appendClass+"'>"+appendText+"</span>");input[isRTL?"before":"after"](inst.append);}
input.off("focus",this._showDatepicker);if(inst.trigger){inst.trigger.remove();}
showOn=this._get(inst,"showOn");if(showOn==="focus"||showOn==="both"){input.on("focus",this._showDatepicker);}
if(showOn==="button"||showOn==="both"){buttonText=this._get(inst,"buttonText");buttonImage=this._get(inst,"buttonImage");inst.trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:buttonImage,alt:buttonText,title:buttonText}):$("<button type='button'></button>").addClass(this._triggerClass).html(!buttonImage?buttonText:$("<img/>").attr({src:buttonImage,alt:buttonText,title:buttonText})));input[isRTL?"before":"after"](inst.trigger);inst.trigger.on("click",function(){if($.datepicker._datepickerShowing&&$.datepicker._lastInput===input[0]){$.datepicker._hideDatepicker();}else if($.datepicker._datepickerShowing&&$.datepicker._lastInput!==input[0]){$.datepicker._hideDatepicker();$.datepicker._showDatepicker(input[0]);}else{$.datepicker._showDatepicker(input[0]);}
return false;});}},_autoSize:function(inst){if(this._get(inst,"autoSize")&&!inst.inline){var findMax,max,maxI,i,date=new Date(2009,12-1,20),dateFormat=this._get(inst,"dateFormat");if(dateFormat.match(/[DM]/)){findMax=function(names){max=0;maxI=0;for(i=0;i<names.length;i++){if(names[i].length>max){max=names[i].length;maxI=i;}}
return maxI;};date.setMonth(findMax(this._get(inst,(dateFormat.match(/MM/)?"monthNames":"monthNamesShort"))));date.setDate(findMax(this._get(inst,(dateFormat.match(/DD/)?"dayNames":"dayNamesShort")))+20-date.getDay());}
inst.input.attr("size",this._formatDate(inst,date).length);}},_inlineDatepicker:function(target,inst){var divSpan=$(target);if(divSpan.hasClass(this.markerClassName)){return;}
divSpan.addClass(this.markerClassName).append(inst.dpDiv);$.data(target,"datepicker",inst);this._setDate(inst,this._getDefaultDate(inst),true);this._updateDatepicker(inst);this._updateAlternate(inst);if(inst.settings.disabled){this._disableDatepicker(target);}
inst.dpDiv.css("display","block");},_dialogDatepicker:function(input,date,onSelect,settings,pos){var id,browserWidth,browserHeight,scrollX,scrollY,inst=this._dialogInst;if(!inst){this.uuid+=1;id="dp"+this.uuid;this._dialogInput=$("<input type='text' id='"+id+"' style='position: absolute; top: -100px; width: 0px;'/>");this._dialogInput.on("keydown",this._doKeyDown);$("body").append(this._dialogInput);inst=this._dialogInst=this._newInst(this._dialogInput,false);inst.settings={};$.data(this._dialogInput[0],"datepicker",inst);}
datepicker_extendRemove(inst.settings,settings||{});date=(date&&date.constructor===Date?this._formatDate(inst,date):date);this._dialogInput.val(date);this._pos=(pos?(pos.length?pos:[pos.pageX,pos.pageY]):null);if(!this._pos){browserWidth=document.documentElement.clientWidth;browserHeight=document.documentElement.clientHeight;scrollX=document.documentElement.scrollLeft||document.body.scrollLeft;scrollY=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[(browserWidth/2)-100+scrollX,(browserHeight/2)-150+scrollY];}
this._dialogInput.css("left",(this._pos[0]+20)+"px").css("top",this._pos[1]+"px");inst.settings.onSelect=onSelect;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if($.blockUI){$.blockUI(this.dpDiv);}
$.data(this._dialogInput[0],"datepicker",inst);return this;},_destroyDatepicker:function(target){var nodeName,$target=$(target),inst=$.data(target,"datepicker");if(!$target.hasClass(this.markerClassName)){return;}
nodeName=target.nodeName.toLowerCase();$.removeData(target,"datepicker");if(nodeName==="input"){inst.append.remove();inst.trigger.remove();$target.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp);}else if(nodeName==="div"||nodeName==="span"){$target.removeClass(this.markerClassName).empty();}
if(datepicker_instActive===inst){datepicker_instActive=null;}},_enableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,"datepicker");if(!$target.hasClass(this.markerClassName)){return;}
nodeName=target.nodeName.toLowerCase();if(nodeName==="input"){target.disabled=false;inst.trigger.filter("button").each(function(){this.disabled=false;}).end().filter("img").css({opacity:"1.0",cursor:""});}else if(nodeName==="div"||nodeName==="span"){inline=$target.children("."+this._inlineClass);inline.children().removeClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",false);}
this._disabledInputs=$.map(this._disabledInputs,function(value){return(value===target?null:value);});},_disableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,"datepicker");if(!$target.hasClass(this.markerClassName)){return;}
nodeName=target.nodeName.toLowerCase();if(nodeName==="input"){target.disabled=true;inst.trigger.filter("button").each(function(){this.disabled=true;}).end().filter("img").css({opacity:"0.5",cursor:"default"});}else if(nodeName==="div"||nodeName==="span"){inline=$target.children("."+this._inlineClass);inline.children().addClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",true);}
this._disabledInputs=$.map(this._disabledInputs,function(value){return(value===target?null:value);});this._disabledInputs[this._disabledInputs.length]=target;},_isDisabledDatepicker:function(target){if(!target){return false;}
for(var i=0;i<this._disabledInputs.length;i++){if(this._disabledInputs[i]===target){return true;}}
return false;},_getInst:function(target){try{return $.data(target,"datepicker");}
catch(err){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(target,name,value){var settings,date,minDate,maxDate,inst=this._getInst(target);if(arguments.length===2&&typeof name==="string"){return(name==="defaults"?$.extend({},$.datepicker._defaults):(inst?(name==="all"?$.extend({},inst.settings):this._get(inst,name)):null));}
settings=name||{};if(typeof name==="string"){settings={};settings[name]=value;}
if(inst){if(this._curInst===inst){this._hideDatepicker();}
date=this._getDateDatepicker(target,true);minDate=this._getMinMaxDate(inst,"min");maxDate=this._getMinMaxDate(inst,"max");datepicker_extendRemove(inst.settings,settings);if(minDate!==null&&settings.dateFormat!==undefined&&settings.minDate===undefined){inst.settings.minDate=this._formatDate(inst,minDate);}
if(maxDate!==null&&settings.dateFormat!==undefined&&settings.maxDate===undefined){inst.settings.maxDate=this._formatDate(inst,maxDate);}
if("disabled"in settings){if(settings.disabled){this._disableDatepicker(target);}else{this._enableDatepicker(target);}}
this._attachments($(target),inst);this._autoSize(inst);this._setDate(inst,date);this._updateAlternate(inst);this._updateDatepicker(inst);}},_changeDatepicker:function(target,name,value){this._optionDatepicker(target,name,value);},_refreshDatepicker:function(target){var inst=this._getInst(target);if(inst){this._updateDatepicker(inst);}},_setDateDatepicker:function(target,date){var inst=this._getInst(target);if(inst){this._setDate(inst,date);this._updateDatepicker(inst);this._updateAlternate(inst);}},_getDateDatepicker:function(target,noDefault){var inst=this._getInst(target);if(inst&&!inst.inline){this._setDateFromField(inst,noDefault);}
return(inst?this._getDate(inst):null);},_doKeyDown:function(event){var onSelect,dateStr,sel,inst=$.datepicker._getInst(event.target),handled=true,isRTL=inst.dpDiv.is(".ui-datepicker-rtl");inst._keyEvent=true;if($.datepicker._datepickerShowing){switch(event.keyCode){case 9:$.datepicker._hideDatepicker();handled=false;break;case 13:sel=$("td."+$.datepicker._dayOverClass+":not(."+
$.datepicker._currentClass+")",inst.dpDiv);if(sel[0]){$.datepicker._selectDay(event.target,inst.selectedMonth,inst.selectedYear,sel[0]);}
onSelect=$.datepicker._get(inst,"onSelect");if(onSelect){dateStr=$.datepicker._formatDate(inst);onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst]);}else{$.datepicker._hideDatepicker();}
return false;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M");break;case 34:$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M");break;case 35:if(event.ctrlKey||event.metaKey){$.datepicker._clearDate(event.target);}
handled=event.ctrlKey||event.metaKey;break;case 36:if(event.ctrlKey||event.metaKey){$.datepicker._gotoToday(event.target);}
handled=event.ctrlKey||event.metaKey;break;case 37:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?+1:-1),"D");}
handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M");}
break;case 38:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,-7,"D");}
handled=event.ctrlKey||event.metaKey;break;case 39:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?-1:+1),"D");}
handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M");}
break;case 40:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,+7,"D");}
handled=event.ctrlKey||event.metaKey;break;default:handled=false;}}else if(event.keyCode===36&&event.ctrlKey){$.datepicker._showDatepicker(this);}else{handled=false;}
if(handled){event.preventDefault();event.stopPropagation();}},_doKeyPress:function(event){var chars,chr,inst=$.datepicker._getInst(event.target);if($.datepicker._get(inst,"constrainInput")){chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat"));chr=String.fromCharCode(event.charCode==null?event.keyCode:event.charCode);return event.ctrlKey||event.metaKey||(chr<" "||!chars||chars.indexOf(chr)>-1);}},_doKeyUp:function(event){var date,inst=$.datepicker._getInst(event.target);if(inst.input.val()!==inst.lastVal){try{date=$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),(inst.input?inst.input.val():null),$.datepicker._getFormatConfig(inst));if(date){$.datepicker._setDateFromField(inst);$.datepicker._updateAlternate(inst);$.datepicker._updateDatepicker(inst);}}
catch(err){}}
return true;},_showDatepicker:function(input){input=input.target||input;if(input.nodeName.toLowerCase()!=="input"){input=$("input",input.parentNode)[0];}
if($.datepicker._isDisabledDatepicker(input)||$.datepicker._lastInput===input){return;}
var inst,beforeShow,beforeShowSettings,isFixed,offset,showAnim,duration;inst=$.datepicker._getInst(input);if($.datepicker._curInst&&$.datepicker._curInst!==inst){$.datepicker._curInst.dpDiv.stop(true,true);if(inst&&$.datepicker._datepickerShowing){$.datepicker._hideDatepicker($.datepicker._curInst.input[0]);}}
beforeShow=$.datepicker._get(inst,"beforeShow");beforeShowSettings=beforeShow?beforeShow.apply(input,[input,inst]):{};if(beforeShowSettings===false){return;}
datepicker_extendRemove(inst.settings,beforeShowSettings);inst.lastVal=null;$.datepicker._lastInput=input;$.datepicker._setDateFromField(inst);if($.datepicker._inDialog){input.value="";}
if(!$.datepicker._pos){$.datepicker._pos=$.datepicker._findPos(input);$.datepicker._pos[1]+=input.offsetHeight;}
isFixed=false;$(input).parents().each(function(){isFixed|=$(this).css("position")==="fixed";return!isFixed;});offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null;inst.dpDiv.empty();inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});$.datepicker._updateDatepicker(inst);offset=$.datepicker._checkOffset(inst,offset,isFixed);inst.dpDiv.css({position:($.datepicker._inDialog&&$.blockUI?"static":(isFixed?"fixed":"absolute")),display:"none",left:offset.left+"px",top:offset.top+"px"});if(!inst.inline){showAnim=$.datepicker._get(inst,"showAnim");duration=$.datepicker._get(inst,"duration");inst.dpDiv.css("z-index",datepicker_getZindex($(input))+1);$.datepicker._datepickerShowing=true;if($.effects&&$.effects.effect[showAnim]){inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration);}else{inst.dpDiv[showAnim||"show"](showAnim?duration:null);}
if($.datepicker._shouldFocusInput(inst)){inst.input.trigger("focus");}
$.datepicker._curInst=inst;}},_updateDatepicker:function(inst){this.maxRows=4;datepicker_instActive=inst;inst.dpDiv.empty().append(this._generateHTML(inst));this._attachHandlers(inst);var origyearshtml,numMonths=this._getNumberOfMonths(inst),cols=numMonths[1],width=17,activeCell=inst.dpDiv.find("."+this._dayOverClass+" a");if(activeCell.length>0){datepicker_handleMouseover.apply(activeCell.get(0));}
inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(cols>1){inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",(width*cols)+"em");}
inst.dpDiv[(numMonths[0]!==1||numMonths[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi");inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(inst===$.datepicker._curInst&&$.datepicker._datepickerShowing&&$.datepicker._shouldFocusInput(inst)){inst.input.trigger("focus");}
if(inst.yearshtml){origyearshtml=inst.yearshtml;setTimeout(function(){if(origyearshtml===inst.yearshtml&&inst.yearshtml){inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml);}
origyearshtml=inst.yearshtml=null;},0);}},_shouldFocusInput:function(inst){return inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&!inst.input.is(":focus");},_checkOffset:function(inst,offset,isFixed){var dpWidth=inst.dpDiv.outerWidth(),dpHeight=inst.dpDiv.outerHeight(),inputWidth=inst.input?inst.input.outerWidth():0,inputHeight=inst.input?inst.input.outerHeight():0,viewWidth=document.documentElement.clientWidth+(isFixed?0:$(document).scrollLeft()),viewHeight=document.documentElement.clientHeight+(isFixed?0:$(document).scrollTop());offset.left-=(this._get(inst,"isRTL")?(dpWidth-inputWidth):0);offset.left-=(isFixed&&offset.left===inst.input.offset().left)?$(document).scrollLeft():0;offset.top-=(isFixed&&offset.top===(inst.input.offset().top+inputHeight))?$(document).scrollTop():0;offset.left-=Math.min(offset.left,(offset.left+dpWidth>viewWidth&&viewWidth>dpWidth)?Math.abs(offset.left+dpWidth-viewWidth):0);offset.top-=Math.min(offset.top,(offset.top+dpHeight>viewHeight&&viewHeight>dpHeight)?Math.abs(dpHeight+inputHeight):0);return offset;},_findPos:function(obj){var position,inst=this._getInst(obj),isRTL=this._get(inst,"isRTL");while(obj&&(obj.type==="hidden"||obj.nodeType!==1||$.expr.filters.hidden(obj))){obj=obj[isRTL?"previousSibling":"nextSibling"];}
position=$(obj).offset();return[position.left,position.top];},_hideDatepicker:function(input){var showAnim,duration,postProcess,onClose,inst=this._curInst;if(!inst||(input&&inst!==$.data(input,"datepicker"))){return;}
if(this._datepickerShowing){showAnim=this._get(inst,"showAnim");duration=this._get(inst,"duration");postProcess=function(){$.datepicker._tidyDialog(inst);};if($.effects&&($.effects.effect[showAnim]||$.effects[showAnim])){inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess);}else{inst.dpDiv[(showAnim==="slideDown"?"slideUp":(showAnim==="fadeIn"?"fadeOut":"hide"))]((showAnim?duration:null),postProcess);}
if(!showAnim){postProcess();}
this._datepickerShowing=false;onClose=this._get(inst,"onClose");if(onClose){onClose.apply((inst.input?inst.input[0]:null),[(inst.input?inst.input.val():""),inst]);}
this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if($.blockUI){$.unblockUI();$("body").append(this.dpDiv);}}
this._inDialog=false;}},_tidyDialog:function(inst){inst.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar");},_checkExternalClick:function(event){if(!$.datepicker._curInst){return;}
var $target=$(event.target),inst=$.datepicker._getInst($target[0]);if((($target[0].id!==$.datepicker._mainDivId&&$target.parents("#"+$.datepicker._mainDivId).length===0&&!$target.hasClass($.datepicker.markerClassName)&&!$target.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&!($.datepicker._inDialog&&$.blockUI)))||($target.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!==inst)){$.datepicker._hideDatepicker();}},_adjustDate:function(id,offset,period){var target=$(id),inst=this._getInst(target[0]);if(this._isDisabledDatepicker(target[0])){return;}
this._adjustInstDate(inst,offset+
(period==="M"?this._get(inst,"showCurrentAtPos"):0),period);this._updateDatepicker(inst);},_gotoToday:function(id){var date,target=$(id),inst=this._getInst(target[0]);if(this._get(inst,"gotoCurrent")&&inst.currentDay){inst.selectedDay=inst.currentDay;inst.drawMonth=inst.selectedMonth=inst.currentMonth;inst.drawYear=inst.selectedYear=inst.currentYear;}else{date=new Date();inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();}
this._notifyChange(inst);this._adjustDate(target);},_selectMonthYear:function(id,select,period){var target=$(id),inst=this._getInst(target[0]);inst["selected"+(period==="M"?"Month":"Year")]=inst["draw"+(period==="M"?"Month":"Year")]=parseInt(select.options[select.selectedIndex].value,10);this._notifyChange(inst);this._adjustDate(target);},_selectDay:function(id,month,year,td){var inst,target=$(id);if($(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(target[0])){return;}
inst=this._getInst(target[0]);inst.selectedDay=inst.currentDay=$("a",td).html();inst.selectedMonth=inst.currentMonth=month;inst.selectedYear=inst.currentYear=year;this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear));},_clearDate:function(id){var target=$(id);this._selectDate(target,"");},_selectDate:function(id,dateStr){var onSelect,target=$(id),inst=this._getInst(target[0]);dateStr=(dateStr!=null?dateStr:this._formatDate(inst));if(inst.input){inst.input.val(dateStr);}
this._updateAlternate(inst);onSelect=this._get(inst,"onSelect");if(onSelect){onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst]);}else if(inst.input){inst.input.trigger("change");}
if(inst.inline){this._updateDatepicker(inst);}else{this._hideDatepicker();this._lastInput=inst.input[0];if(typeof(inst.input[0])!=="object"){inst.input.trigger("focus");}
this._lastInput=null;}},_updateAlternate:function(inst){var altFormat,date,dateStr,altField=this._get(inst,"altField");if(altField){altFormat=this._get(inst,"altFormat")||this._get(inst,"dateFormat");date=this._getDate(inst);dateStr=this.formatDate(altFormat,date,this._getFormatConfig(inst));$(altField).val(dateStr);}},noWeekends:function(date){var day=date.getDay();return[(day>0&&day<6),""];},iso8601Week:function(date){var time,checkDate=new Date(date.getTime());checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));time=checkDate.getTime();checkDate.setMonth(0);checkDate.setDate(1);return Math.floor(Math.round((time-checkDate)/86400000)/7)+1;},parseDate:function(format,value,settings){if(format==null||value==null){throw"Invalid arguments";}
value=(typeof value==="object"?value.toString():value+"");if(value===""){return null;}
var iFormat,dim,extra,iValue=0,shortYearCutoffTemp=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff,shortYearCutoff=(typeof shortYearCutoffTemp!=="string"?shortYearCutoffTemp:new Date().getFullYear()%100+parseInt(shortYearCutoffTemp,10)),dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,year=-1,month=-1,day=-1,doy=-1,literal=false,date,lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)===match);if(matches){iFormat++;}
return matches;},getNumber=function(match){var isDoubled=lookAhead(match),size=(match==="@"?14:(match==="!"?20:(match==="y"&&isDoubled?4:(match==="o"?3:2)))),minSize=(match==="y"?size:1),digits=new RegExp("^\\d{"+minSize+","+size+"}"),num=value.substring(iValue).match(digits);if(!num){throw"Missing number at position "+iValue;}
iValue+=num[0].length;return parseInt(num[0],10);},getName=function(match,shortNames,longNames){var index=-1,names=$.map(lookAhead(match)?longNames:shortNames,function(v,k){return[[k,v]];}).sort(function(a,b){return-(a[1].length-b[1].length);});$.each(names,function(i,pair){var name=pair[1];if(value.substr(iValue,name.length).toLowerCase()===name.toLowerCase()){index=pair[0];iValue+=name.length;return false;}});if(index!==-1){return index+1;}else{throw"Unknown name at position "+iValue;}},checkLiteral=function(){if(value.charAt(iValue)!==format.charAt(iFormat)){throw"Unexpected literal at position "+iValue;}
iValue++;};for(iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)==="'"&&!lookAhead("'")){literal=false;}else{checkLiteral();}}else{switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":year=getNumber("y");break;case"@":date=new Date(getNumber("@"));year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"!":date=new Date((getNumber("!")-this._ticksTo1970)/10000);year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"'":if(lookAhead("'")){checkLiteral();}else{literal=true;}
break;default:checkLiteral();}}}
if(iValue<value.length){extra=value.substr(iValue);if(!/^\s+/.test(extra)){throw"Extra/unparsed characters found in date: "+extra;}}
if(year===-1){year=new Date().getFullYear();}else if(year<100){year+=new Date().getFullYear()-new Date().getFullYear()%100+
(year<=shortYearCutoff?0:-100);}
if(doy>-1){month=1;day=doy;do{dim=this._getDaysInMonth(year,month-1);if(day<=dim){break;}
month++;day-=dim;}while(true);}
date=this._daylightSavingAdjust(new Date(year,month-1,day));if(date.getFullYear()!==year||date.getMonth()+1!==month||date.getDate()!==day){throw"Invalid date";}
return date;},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+
Math.floor(1970/400))*24*60*60*10000000),formatDate:function(format,date,settings){if(!date){return"";}
var iFormat,dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)===match);if(matches){iFormat++;}
return matches;},formatNumber=function(match,value,len){var num=""+value;if(lookAhead(match)){while(num.length<len){num="0"+num;}}
return num;},formatName=function(match,value,shortNames,longNames){return(lookAhead(match)?longNames[value]:shortNames[value]);},output="",literal=false;if(date){for(iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)==="'"&&!lookAhead("'")){literal=false;}else{output+=format.charAt(iFormat);}}else{switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":output+=formatNumber("o",Math.round((new Date(date.getFullYear(),date.getMonth(),date.getDate()).getTime()-new Date(date.getFullYear(),0,0).getTime())/86400000),3);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=(lookAhead("y")?date.getFullYear():(date.getFullYear()%100<10?"0":"")+date.getFullYear()%100);break;case"@":output+=date.getTime();break;case"!":output+=date.getTime()*10000+this._ticksTo1970;break;case"'":if(lookAhead("'")){output+="'";}else{literal=true;}
break;default:output+=format.charAt(iFormat);}}}}
return output;},_possibleChars:function(format){var iFormat,chars="",literal=false,lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)===match);if(matches){iFormat++;}
return matches;};for(iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)==="'"&&!lookAhead("'")){literal=false;}else{chars+=format.charAt(iFormat);}}else{switch(format.charAt(iFormat)){case"d":case"m":case"y":case"@":chars+="0123456789";break;case"D":case"M":return null;case"'":if(lookAhead("'")){chars+="'";}else{literal=true;}
break;default:chars+=format.charAt(iFormat);}}}
return chars;},_get:function(inst,name){return inst.settings[name]!==undefined?inst.settings[name]:this._defaults[name];},_setDateFromField:function(inst,noDefault){if(inst.input.val()===inst.lastVal){return;}
var dateFormat=this._get(inst,"dateFormat"),dates=inst.lastVal=inst.input?inst.input.val():null,defaultDate=this._getDefaultDate(inst),date=defaultDate,settings=this._getFormatConfig(inst);try{date=this.parseDate(dateFormat,dates,settings)||defaultDate;}catch(event){dates=(noDefault?"":dates);}
inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();inst.currentDay=(dates?date.getDate():0);inst.currentMonth=(dates?date.getMonth():0);inst.currentYear=(dates?date.getFullYear():0);this._adjustInstDate(inst);},_getDefaultDate:function(inst){return this._restrictMinMax(inst,this._determineDate(inst,this._get(inst,"defaultDate"),new Date()));},_determineDate:function(inst,date,defaultDate){var offsetNumeric=function(offset){var date=new Date();date.setDate(date.getDate()+offset);return date;},offsetString=function(offset){try{return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),offset,$.datepicker._getFormatConfig(inst));}
catch(e){}
var date=(offset.toLowerCase().match(/^c/)?$.datepicker._getDate(inst):null)||new Date(),year=date.getFullYear(),month=date.getMonth(),day=date.getDate(),pattern=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,matches=pattern.exec(offset);while(matches){switch(matches[2]||"d"){case"d":case"D":day+=parseInt(matches[1],10);break;case"w":case"W":day+=parseInt(matches[1],10)*7;break;case"m":case"M":month+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;case"y":case"Y":year+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;}
matches=pattern.exec(offset);}
return new Date(year,month,day);},newDate=(date==null||date===""?defaultDate:(typeof date==="string"?offsetString(date):(typeof date==="number"?(isNaN(date)?defaultDate:offsetNumeric(date)):new Date(date.getTime()))));newDate=(newDate&&newDate.toString()==="Invalid Date"?defaultDate:newDate);if(newDate){newDate.setHours(0);newDate.setMinutes(0);newDate.setSeconds(0);newDate.setMilliseconds(0);}
return this._daylightSavingAdjust(newDate);},_daylightSavingAdjust:function(date){if(!date){return null;}
date.setHours(date.getHours()>12?date.getHours()+2:0);return date;},_setDate:function(inst,date,noChange){var clear=!date,origMonth=inst.selectedMonth,origYear=inst.selectedYear,newDate=this._restrictMinMax(inst,this._determineDate(inst,date,new Date()));inst.selectedDay=inst.currentDay=newDate.getDate();inst.drawMonth=inst.selectedMonth=inst.currentMonth=newDate.getMonth();inst.drawYear=inst.selectedYear=inst.currentYear=newDate.getFullYear();if((origMonth!==inst.selectedMonth||origYear!==inst.selectedYear)&&!noChange){this._notifyChange(inst);}
this._adjustInstDate(inst);if(inst.input){inst.input.val(clear?"":this._formatDate(inst));}},_getDate:function(inst){var startDate=(!inst.currentYear||(inst.input&&inst.input.val()==="")?null:this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return startDate;},_attachHandlers:function(inst){var stepMonths=this._get(inst,"stepMonths"),id="#"+inst.id.replace(/\\\\/g,"\\");inst.dpDiv.find("[data-handler]").map(function(){var handler={prev:function(){$.datepicker._adjustDate(id,-stepMonths,"M");},next:function(){$.datepicker._adjustDate(id,+stepMonths,"M");},hide:function(){$.datepicker._hideDatepicker();},today:function(){$.datepicker._gotoToday(id);},selectDay:function(){$.datepicker._selectDay(id,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return false;},selectMonth:function(){$.datepicker._selectMonthYear(id,this,"M");return false;},selectYear:function(){$.datepicker._selectMonthYear(id,this,"Y");return false;}};$(this).on(this.getAttribute("data-event"),handler[this.getAttribute("data-handler")]);});},_generateHTML:function(inst){var maxDraw,prevText,prev,nextText,next,currentText,gotoDate,controls,buttonPanel,firstDay,showWeek,dayNames,dayNamesMin,monthNames,monthNamesShort,beforeShowDay,showOtherMonths,selectOtherMonths,defaultDate,html,dow,row,group,col,selectedDate,cornerClass,calender,thead,day,daysInMonth,leadDays,curRows,numRows,printDate,dRow,tbody,daySettings,otherMonth,unselectable,tempDate=new Date(),today=this._daylightSavingAdjust(new Date(tempDate.getFullYear(),tempDate.getMonth(),tempDate.getDate())),isRTL=this._get(inst,"isRTL"),showButtonPanel=this._get(inst,"showButtonPanel"),hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext"),navigationAsDateFormat=this._get(inst,"navigationAsDateFormat"),numMonths=this._getNumberOfMonths(inst),showCurrentAtPos=this._get(inst,"showCurrentAtPos"),stepMonths=this._get(inst,"stepMonths"),isMultiMonth=(numMonths[0]!==1||numMonths[1]!==1),currentDate=this._daylightSavingAdjust((!inst.currentDay?new Date(9999,9,9):new Date(inst.currentYear,inst.currentMonth,inst.currentDay))),minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),drawMonth=inst.drawMonth-showCurrentAtPos,drawYear=inst.drawYear;if(drawMonth<0){drawMonth+=12;drawYear--;}
if(maxDate){maxDraw=this._daylightSavingAdjust(new Date(maxDate.getFullYear(),maxDate.getMonth()-(numMonths[0]*numMonths[1])+1,maxDate.getDate()));maxDraw=(minDate&&maxDraw<minDate?minDate:maxDraw);while(this._daylightSavingAdjust(new Date(drawYear,drawMonth,1))>maxDraw){drawMonth--;if(drawMonth<0){drawMonth=11;drawYear--;}}}
inst.drawMonth=drawMonth;inst.drawYear=drawYear;prevText=this._get(inst,"prevText");prevText=(!navigationAsDateFormat?prevText:this.formatDate(prevText,this._daylightSavingAdjust(new Date(drawYear,drawMonth-stepMonths,1)),this._getFormatConfig(inst)));prev=(this._canAdjustMonth(inst,-1,drawYear,drawMonth)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click'"+" title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>":(hideIfNoPrevNext?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>"));nextText=this._get(inst,"nextText");nextText=(!navigationAsDateFormat?nextText:this.formatDate(nextText,this._daylightSavingAdjust(new Date(drawYear,drawMonth+stepMonths,1)),this._getFormatConfig(inst)));next=(this._canAdjustMonth(inst,+1,drawYear,drawMonth)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click'"+" title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>":(hideIfNoPrevNext?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>"));currentText=this._get(inst,"currentText");gotoDate=(this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today);currentText=(!navigationAsDateFormat?currentText:this.formatDate(currentText,gotoDate,this._getFormatConfig(inst)));controls=(!inst.inline?"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+
this._get(inst,"closeText")+"</button>":"");buttonPanel=(showButtonPanel)?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(isRTL?controls:"")+
(this._isInRange(inst,gotoDate)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'"+">"+currentText+"</button>":"")+(isRTL?"":controls)+"</div>":"";firstDay=parseInt(this._get(inst,"firstDay"),10);firstDay=(isNaN(firstDay)?0:firstDay);showWeek=this._get(inst,"showWeek");dayNames=this._get(inst,"dayNames");dayNamesMin=this._get(inst,"dayNamesMin");monthNames=this._get(inst,"monthNames");monthNamesShort=this._get(inst,"monthNamesShort");beforeShowDay=this._get(inst,"beforeShowDay");showOtherMonths=this._get(inst,"showOtherMonths");selectOtherMonths=this._get(inst,"selectOtherMonths");defaultDate=this._getDefaultDate(inst);html="";for(row=0;row<numMonths[0];row++){group="";this.maxRows=4;for(col=0;col<numMonths[1];col++){selectedDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,inst.selectedDay));cornerClass=" ui-corner-all";calender="";if(isMultiMonth){calender+="<div class='ui-datepicker-group";if(numMonths[1]>1){switch(col){case 0:calender+=" ui-datepicker-group-first";cornerClass=" ui-corner-"+(isRTL?"right":"left");break;case numMonths[1]-1:calender+=" ui-datepicker-group-last";cornerClass=" ui-corner-"+(isRTL?"left":"right");break;default:calender+=" ui-datepicker-group-middle";cornerClass="";break;}}
calender+="'>";}
calender+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+cornerClass+"'>"+
(/all|left/.test(cornerClass)&&row===0?(isRTL?next:prev):"")+
(/all|right/.test(cornerClass)&&row===0?(isRTL?prev:next):"")+
this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,row>0||col>0,monthNames,monthNamesShort)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>";thead=(showWeek?"<th class='ui-datepicker-week-col'>"+this._get(inst,"weekHeader")+"</th>":"");for(dow=0;dow<7;dow++){day=(dow+firstDay)%7;thead+="<th scope='col'"+((dow+firstDay+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+dayNames[day]+"'>"+dayNamesMin[day]+"</span></th>";}
calender+=thead+"</tr></thead><tbody>";daysInMonth=this._getDaysInMonth(drawYear,drawMonth);if(drawYear===inst.selectedYear&&drawMonth===inst.selectedMonth){inst.selectedDay=Math.min(inst.selectedDay,daysInMonth);}
leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7;curRows=Math.ceil((leadDays+daysInMonth)/7);numRows=(isMultiMonth?this.maxRows>curRows?this.maxRows:curRows:curRows);this.maxRows=numRows;printDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,1-leadDays));for(dRow=0;dRow<numRows;dRow++){calender+="<tr>";tbody=(!showWeek?"":"<td class='ui-datepicker-week-col'>"+
this._get(inst,"calculateWeek")(printDate)+"</td>");for(dow=0;dow<7;dow++){daySettings=(beforeShowDay?beforeShowDay.apply((inst.input?inst.input[0]:null),[printDate]):[true,""]);otherMonth=(printDate.getMonth()!==drawMonth);unselectable=(otherMonth&&!selectOtherMonths)||!daySettings[0]||(minDate&&printDate<minDate)||(maxDate&&printDate>maxDate);tbody+="<td class='"+
((dow+firstDay+6)%7>=5?" ui-datepicker-week-end":"")+
(otherMonth?" ui-datepicker-other-month":"")+
((printDate.getTime()===selectedDate.getTime()&&drawMonth===inst.selectedMonth&&inst._keyEvent)||(defaultDate.getTime()===printDate.getTime()&&defaultDate.getTime()===selectedDate.getTime())?" "+this._dayOverClass:"")+
(unselectable?" "+this._unselectableClass+" ui-state-disabled":"")+
(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+
(printDate.getTime()===currentDate.getTime()?" "+this._currentClass:"")+
(printDate.getTime()===today.getTime()?" ui-datepicker-today":""))+"'"+
((!otherMonth||showOtherMonths)&&daySettings[2]?" title='"+daySettings[2].replace(/'/g,"&#39;")+"'":"")+
(unselectable?"":" data-handler='selectDay' data-event='click' data-month='"+printDate.getMonth()+"' data-year='"+printDate.getFullYear()+"'")+">"+
(otherMonth&&!showOtherMonths?"&#xa0;":(unselectable?"<span class='ui-state-default'>"+printDate.getDate()+"</span>":"<a class='ui-state-default"+
(printDate.getTime()===today.getTime()?" ui-state-highlight":"")+
(printDate.getTime()===currentDate.getTime()?" ui-state-active":"")+
(otherMonth?" ui-priority-secondary":"")+"' href='#'>"+printDate.getDate()+"</a>"))+"</td>";printDate.setDate(printDate.getDate()+1);printDate=this._daylightSavingAdjust(printDate);}
calender+=tbody+"</tr>";}
drawMonth++;if(drawMonth>11){drawMonth=0;drawYear++;}
calender+="</tbody></table>"+(isMultiMonth?"</div>"+
((numMonths[0]>0&&col===numMonths[1]-1)?"<div class='ui-datepicker-row-break'></div>":""):"");group+=calender;}
html+=group;}
html+=buttonPanel;inst._keyEvent=false;return html;},_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,secondary,monthNames,monthNamesShort){var inMinYear,inMaxYear,month,years,thisYear,determineYear,year,endYear,changeMonth=this._get(inst,"changeMonth"),changeYear=this._get(inst,"changeYear"),showMonthAfterYear=this._get(inst,"showMonthAfterYear"),html="<div class='ui-datepicker-title'>",monthHtml="";if(secondary||!changeMonth){monthHtml+="<span class='ui-datepicker-month'>"+monthNames[drawMonth]+"</span>";}else{inMinYear=(minDate&&minDate.getFullYear()===drawYear);inMaxYear=(maxDate&&maxDate.getFullYear()===drawYear);monthHtml+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(month=0;month<12;month++){if((!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth())){monthHtml+="<option value='"+month+"'"+
(month===drawMonth?" selected='selected'":"")+">"+monthNamesShort[month]+"</option>";}}
monthHtml+="</select>";}
if(!showMonthAfterYear){html+=monthHtml+(secondary||!(changeMonth&&changeYear)?"&#xa0;":"");}
if(!inst.yearshtml){inst.yearshtml="";if(secondary||!changeYear){html+="<span class='ui-datepicker-year'>"+drawYear+"</span>";}else{years=this._get(inst,"yearRange").split(":");thisYear=new Date().getFullYear();determineYear=function(value){var year=(value.match(/c[+\-].*/)?drawYear+parseInt(value.substring(1),10):(value.match(/[+\-].*/)?thisYear+parseInt(value,10):parseInt(value,10)));return(isNaN(year)?thisYear:year);};year=determineYear(years[0]);endYear=Math.max(year,determineYear(years[1]||""));year=(minDate?Math.max(year,minDate.getFullYear()):year);endYear=(maxDate?Math.min(endYear,maxDate.getFullYear()):endYear);inst.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";for(;year<=endYear;year++){inst.yearshtml+="<option value='"+year+"'"+
(year===drawYear?" selected='selected'":"")+">"+year+"</option>";}
inst.yearshtml+="</select>";html+=inst.yearshtml;inst.yearshtml=null;}}
html+=this._get(inst,"yearSuffix");if(showMonthAfterYear){html+=(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")+monthHtml;}
html+="</div>";return html;},_adjustInstDate:function(inst,offset,period){var year=inst.selectedYear+(period==="Y"?offset:0),month=inst.selectedMonth+(period==="M"?offset:0),day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+(period==="D"?offset:0),date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,month,day)));inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();if(period==="M"||period==="Y"){this._notifyChange(inst);}},_restrictMinMax:function(inst,date){var minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),newDate=(minDate&&date<minDate?minDate:date);return(maxDate&&newDate>maxDate?maxDate:newDate);},_notifyChange:function(inst){var onChange=this._get(inst,"onChangeMonthYear");if(onChange){onChange.apply((inst.input?inst.input[0]:null),[inst.selectedYear,inst.selectedMonth+1,inst]);}},_getNumberOfMonths:function(inst){var numMonths=this._get(inst,"numberOfMonths");return(numMonths==null?[1,1]:(typeof numMonths==="number"?[1,numMonths]:numMonths));},_getMinMaxDate:function(inst,minMax){return this._determineDate(inst,this._get(inst,minMax+"Date"),null);},_getDaysInMonth:function(year,month){return 32-this._daylightSavingAdjust(new Date(year,month,32)).getDate();},_getFirstDayOfMonth:function(year,month){return new Date(year,month,1).getDay();},_canAdjustMonth:function(inst,offset,curYear,curMonth){var numMonths=this._getNumberOfMonths(inst),date=this._daylightSavingAdjust(new Date(curYear,curMonth+(offset<0?offset:numMonths[0]*numMonths[1]),1));if(offset<0){date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth()));}
return this._isInRange(inst,date);},_isInRange:function(inst,date){var yearSplit,currentYear,minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),minYear=null,maxYear=null,years=this._get(inst,"yearRange");if(years){yearSplit=years.split(":");currentYear=new Date().getFullYear();minYear=parseInt(yearSplit[0],10);maxYear=parseInt(yearSplit[1],10);if(yearSplit[0].match(/[+\-].*/)){minYear+=currentYear;}
if(yearSplit[1].match(/[+\-].*/)){maxYear+=currentYear;}}
return((!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime())&&(!minYear||date.getFullYear()>=minYear)&&(!maxYear||date.getFullYear()<=maxYear));},_getFormatConfig:function(inst){var shortYearCutoff=this._get(inst,"shortYearCutoff");shortYearCutoff=(typeof shortYearCutoff!=="string"?shortYearCutoff:new Date().getFullYear()%100+parseInt(shortYearCutoff,10));return{shortYearCutoff:shortYearCutoff,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")};},_formatDate:function(inst,day,month,year){if(!day){inst.currentDay=inst.selectedDay;inst.currentMonth=inst.selectedMonth;inst.currentYear=inst.selectedYear;}
var date=(day?(typeof day==="object"?day:this._daylightSavingAdjust(new Date(year,month,day))):this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst));}});function datepicker_bindHover(dpDiv){var selector="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return dpDiv.on("mouseout",selector,function(){$(this).removeClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){$(this).removeClass("ui-datepicker-prev-hover");}
if(this.className.indexOf("ui-datepicker-next")!==-1){$(this).removeClass("ui-datepicker-next-hover");}}).on("mouseover",selector,datepicker_handleMouseover);}
function datepicker_handleMouseover(){if(!$.datepicker._isDisabledDatepicker(datepicker_instActive.inline?datepicker_instActive.dpDiv.parent()[0]:datepicker_instActive.input[0])){$(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");$(this).addClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){$(this).addClass("ui-datepicker-prev-hover");}
if(this.className.indexOf("ui-datepicker-next")!==-1){$(this).addClass("ui-datepicker-next-hover");}}}
function datepicker_extendRemove(target,props){$.extend(target,props);for(var name in props){if(props[name]==null){target[name]=props[name];}}
return target;}
$.fn.datepicker=function(options){if(!this.length){return this;}
if(!$.datepicker.initialized){$(document).on("mousedown",$.datepicker._checkExternalClick);$.datepicker.initialized=true;}
if($("#"+$.datepicker._mainDivId).length===0){$("body").append($.datepicker.dpDiv);}
var otherArgs=Array.prototype.slice.call(arguments,1);if(typeof options==="string"&&(options==="isDisabled"||options==="getDate"||options==="widget")){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs));}
if(options==="option"&&arguments.length===2&&typeof arguments[1]==="string"){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs));}
return this.each(function(){typeof options==="string"?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this].concat(otherArgs)):$.datepicker._attachDatepicker(this,options);});};$.datepicker=new Datepicker();$.datepicker.initialized=false;$.datepicker.uuid=new Date().getTime();$.datepicker.version="1.12.1";var widgetsDatepicker=$.datepicker;var ie=$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var mouseHandled=false;$(document).on("mouseup",function(){mouseHandled=false;});var widgetsMouse=$.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.on("mousedown."+this.widgetName,function(event){return that._mouseDown(event);}).on("click."+this.widgetName,function(event){if(true===$.data(event.target,that.widgetName+".preventClickEvent")){$.removeData(event.target,that.widgetName+".preventClickEvent");event.stopImmediatePropagation();return false;}});this.started=false;},_mouseDestroy:function(){this.element.off("."+this.widgetName);if(this._mouseMoveDelegate){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate);}},_mouseDown:function(event){if(mouseHandled){return;}
this._mouseMoved=false;(this._mouseStarted&&this._mouseUp(event));this._mouseDownEvent=event;var that=this,btnIsLeft=(event.which===1),elIsCancel=(typeof this.options.cancel==="string"&&event.target.nodeName?$(event.target).closest(this.options.cancel).length:false);if(!btnIsLeft||elIsCancel||!this._mouseCapture(event)){return true;}
this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=true;},this.options.delay);}
if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=(this._mouseStart(event)!==false);if(!this._mouseStarted){event.preventDefault();return true;}}
if(true===$.data(event.target,this.widgetName+".preventClickEvent")){$.removeData(event.target,this.widgetName+".preventClickEvent");}
this._mouseMoveDelegate=function(event){return that._mouseMove(event);};this._mouseUpDelegate=function(event){return that._mouseUp(event);};this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate);event.preventDefault();mouseHandled=true;return true;},_mouseMove:function(event){if(this._mouseMoved){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button){return this._mouseUp(event);}else if(!event.which){if(event.originalEvent.altKey||event.originalEvent.ctrlKey||event.originalEvent.metaKey||event.originalEvent.shiftKey){this.ignoreMissingWhich=true;}else if(!this.ignoreMissingWhich){return this._mouseUp(event);}}}
if(event.which||event.button){this._mouseMoved=true;}
if(this._mouseStarted){this._mouseDrag(event);return event.preventDefault();}
if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,event)!==false);(this._mouseStarted?this._mouseDrag(event):this._mouseUp(event));}
return!this._mouseStarted;},_mouseUp:function(event){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(event.target===this._mouseDownEvent.target){$.data(event.target,this.widgetName+".preventClickEvent",true);}
this._mouseStop(event);}
if(this._mouseDelayTimer){clearTimeout(this._mouseDelayTimer);delete this._mouseDelayTimer;}
this.ignoreMissingWhich=false;mouseHandled=false;event.preventDefault();},_mouseDistanceMet:function(event){return(Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance);},_mouseDelayMet:function(){return this.mouseDelayMet;},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true;}});var plugin=$.ui.plugin={add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set){proto.plugins[i]=proto.plugins[i]||[];proto.plugins[i].push([option,set[i]]);}},call:function(instance,name,args,allowDisconnected){var i,set=instance.plugins[name];if(!set){return;}
if(!allowDisconnected&&(!instance.element[0].parentNode||instance.element[0].parentNode.nodeType===11)){return;}
for(i=0;i<set.length;i++){if(instance.options[set[i][0]]){set[i][1].apply(instance.element,args);}}}};var safeBlur=$.ui.safeBlur=function(element){if(element&&element.nodeName.toLowerCase()!=="body"){$(element).trigger("blur");}};$.widget("ui.draggable",$.ui.mouse,{version:"1.12.1",widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false,drag:null,start:null,stop:null},_create:function(){if(this.options.helper==="original"){this._setPositionRelative();}
if(this.options.addClasses){this._addClass("ui-draggable");}
this._setHandleClassName();this._mouseInit();},_setOption:function(key,value){this._super(key,value);if(key==="handle"){this._removeHandleClassName();this._setHandleClassName();}},_destroy:function(){if((this.helper||this.element).is(".ui-draggable-dragging")){this.destroyOnClear=true;return;}
this._removeHandleClassName();this._mouseDestroy();},_mouseCapture:function(event){var o=this.options;if(this.helper||o.disabled||$(event.target).closest(".ui-resizable-handle").length>0){return false;}
this.handle=this._getHandle(event);if(!this.handle){return false;}
this._blurActiveElement(event);this._blockFrames(o.iframeFix===true?"iframe":o.iframeFix);return true;},_blockFrames:function(selector){this.iframeBlocks=this.document.find(selector).map(function(){var iframe=$(this);return $("<div>").css("position","absolute").appendTo(iframe.parent()).outerWidth(iframe.outerWidth()).outerHeight(iframe.outerHeight()).offset(iframe.offset())[0];});},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks;}},_blurActiveElement:function(event){var activeElement=$.ui.safeActiveElement(this.document[0]),target=$(event.target);if(target.closest(activeElement).length){return;}
$.ui.safeBlur(activeElement);},_mouseStart:function(event){var o=this.options;this.helper=this._createHelper(event);this._addClass(this.helper,"ui-draggable-dragging");this._cacheHelperProportions();if($.ui.ddmanager){$.ui.ddmanager.current=this;}
this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent(true);this.offsetParent=this.helper.offsetParent();this.hasFixedAncestor=this.helper.parents().filter(function(){return $(this).css("position")==="fixed";}).length>0;this.positionAbs=this.element.offset();this._refreshOffsets(event);this.originalPosition=this.position=this._generatePosition(event,false);this.originalPageX=event.pageX;this.originalPageY=event.pageY;(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));this._setContainment();if(this._trigger("start",event)===false){this._clear();return false;}
this._cacheHelperProportions();if($.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event);}
this._mouseDrag(event,true);if($.ui.ddmanager){$.ui.ddmanager.dragStart(this,event);}
return true;},_refreshOffsets:function(event){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:false,parent:this._getParentOffset(),relative:this._getRelativeOffset()};this.offset.click={left:event.pageX-this.offset.left,top:event.pageY-this.offset.top};},_mouseDrag:function(event,noPropagation){if(this.hasFixedAncestor){this.offset.parent=this._getParentOffset();}
this.position=this._generatePosition(event,true);this.positionAbs=this._convertPositionTo("absolute");if(!noPropagation){var ui=this._uiHash();if(this._trigger("drag",event,ui)===false){this._mouseUp(new $.Event("mouseup",event));return false;}
this.position=ui.position;}
this.helper[0].style.left=this.position.left+"px";this.helper[0].style.top=this.position.top+"px";if($.ui.ddmanager){$.ui.ddmanager.drag(this,event);}
return false;},_mouseStop:function(event){var that=this,dropped=false;if($.ui.ddmanager&&!this.options.dropBehaviour){dropped=$.ui.ddmanager.drop(this,event);}
if(this.dropped){dropped=this.dropped;this.dropped=false;}
if((this.options.revert==="invalid"&&!dropped)||(this.options.revert==="valid"&&dropped)||this.options.revert===true||($.isFunction(this.options.revert)&&this.options.revert.call(this.element,dropped))){$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(that._trigger("stop",event)!==false){that._clear();}});}else{if(this._trigger("stop",event)!==false){this._clear();}}
return false;},_mouseUp:function(event){this._unblockFrames();if($.ui.ddmanager){$.ui.ddmanager.dragStop(this,event);}
if(this.handleElement.is(event.target)){this.element.trigger("focus");}
return $.ui.mouse.prototype._mouseUp.call(this,event);},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp(new $.Event("mouseup",{target:this.element[0]}));}else{this._clear();}
return this;},_getHandle:function(event){return this.options.handle?!!$(event.target).closest(this.element.find(this.options.handle)).length:true;},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element;this._addClass(this.handleElement,"ui-draggable-handle");},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle");},_createHelper:function(event){var o=this.options,helperIsFunction=$.isFunction(o.helper),helper=helperIsFunction?$(o.helper.apply(this.element[0],[event])):(o.helper==="clone"?this.element.clone().removeAttr("id"):this.element);if(!helper.parents("body").length){helper.appendTo((o.appendTo==="parent"?this.element[0].parentNode:o.appendTo));}
if(helperIsFunction&&helper[0]===this.element[0]){this._setPositionRelative();}
if(helper[0]!==this.element[0]&&!(/(fixed|absolute)/).test(helper.css("position"))){helper.css("position","absolute");}
return helper;},_setPositionRelative:function(){if(!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative";}},_adjustOffsetFromHelper:function(obj){if(typeof obj==="string"){obj=obj.split(" ");}
if($.isArray(obj)){obj={left:+obj[0],top:+obj[1]||0};}
if("left"in obj){this.offset.click.left=obj.left+this.margins.left;}
if("right"in obj){this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left;}
if("top"in obj){this.offset.click.top=obj.top+this.margins.top;}
if("bottom"in obj){this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top;}},_isRootNode:function(element){return(/(html|body)/i).test(element.tagName)||element===this.document[0];},_getParentOffset:function(){var po=this.offsetParent.offset(),document=this.document[0];if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])){po.left+=this.scrollParent.scrollLeft();po.top+=this.scrollParent.scrollTop();}
if(this._isRootNode(this.offsetParent[0])){po={top:0,left:0};}
return{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)};},_getRelativeOffset:function(){if(this.cssPosition!=="relative"){return{top:0,left:0};}
var p=this.element.position(),scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+
(!scrollIsRootNode?this.scrollParent.scrollTop():0),left:p.left-(parseInt(this.helper.css("left"),10)||0)+
(!scrollIsRootNode?this.scrollParent.scrollLeft():0)};},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)};},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};},_setContainment:function(){var isUserScrollable,c,ce,o=this.options,document=this.document[0];this.relativeContainer=null;if(!o.containment){this.containment=null;return;}
if(o.containment==="window"){this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-
this.helperProportions.width-this.margins.left,$(window).scrollTop()+
($(window).height()||document.body.parentNode.scrollHeight)-
this.helperProportions.height-this.margins.top];return;}
if(o.containment==="document"){this.containment=[0,0,$(document).width()-this.helperProportions.width-this.margins.left,($(document).height()||document.body.parentNode.scrollHeight)-
this.helperProportions.height-this.margins.top];return;}
if(o.containment.constructor===Array){this.containment=o.containment;return;}
if(o.containment==="parent"){o.containment=this.helper[0].parentNode;}
c=$(o.containment);ce=c[0];if(!ce){return;}
isUserScrollable=/(scroll|auto)/.test(c.css("overflow"));this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+
(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+
(parseInt(c.css("paddingTop"),10)||0),(isUserScrollable?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-
(parseInt(c.css("borderRightWidth"),10)||0)-
(parseInt(c.css("paddingRight"),10)||0)-
this.helperProportions.width-
this.margins.left-
this.margins.right,(isUserScrollable?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-
(parseInt(c.css("borderBottomWidth"),10)||0)-
(parseInt(c.css("paddingBottom"),10)||0)-
this.helperProportions.height-
this.margins.top-
this.margins.bottom];this.relativeContainer=c;},_convertPositionTo:function(d,pos){if(!pos){pos=this.position;}
var mod=d==="absolute"?1:-1,scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:(pos.top+
this.offset.relative.top*mod+
this.offset.parent.top*mod-
((this.cssPosition==="fixed"?-this.offset.scroll.top:(scrollIsRootNode?0:this.offset.scroll.top))*mod)),left:(pos.left+
this.offset.relative.left*mod+
this.offset.parent.left*mod-
((this.cssPosition==="fixed"?-this.offset.scroll.left:(scrollIsRootNode?0:this.offset.scroll.left))*mod))};},_generatePosition:function(event,constrainPosition){var containment,co,top,left,o=this.options,scrollIsRootNode=this._isRootNode(this.scrollParent[0]),pageX=event.pageX,pageY=event.pageY;if(!scrollIsRootNode||!this.offset.scroll){this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()};}
if(constrainPosition){if(this.containment){if(this.relativeContainer){co=this.relativeContainer.offset();containment=[this.containment[0]+co.left,this.containment[1]+co.top,this.containment[2]+co.left,this.containment[3]+co.top];}else{containment=this.containment;}
if(event.pageX-this.offset.click.left<containment[0]){pageX=containment[0]+this.offset.click.left;}
if(event.pageY-this.offset.click.top<containment[1]){pageY=containment[1]+this.offset.click.top;}
if(event.pageX-this.offset.click.left>containment[2]){pageX=containment[2]+this.offset.click.left;}
if(event.pageY-this.offset.click.top>containment[3]){pageY=containment[3]+this.offset.click.top;}}
if(o.grid){top=o.grid[1]?this.originalPageY+Math.round((pageY-
this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY;pageY=containment?((top-this.offset.click.top>=containment[1]||top-this.offset.click.top>containment[3])?top:((top-this.offset.click.top>=containment[1])?top-o.grid[1]:top+o.grid[1])):top;left=o.grid[0]?this.originalPageX+
Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX;pageX=containment?((left-this.offset.click.left>=containment[0]||left-this.offset.click.left>containment[2])?left:((left-this.offset.click.left>=containment[0])?left-o.grid[0]:left+o.grid[0])):left;}
if(o.axis==="y"){pageX=this.originalPageX;}
if(o.axis==="x"){pageY=this.originalPageY;}}
return{top:(pageY-
this.offset.click.top-
this.offset.relative.top-
this.offset.parent.top+
(this.cssPosition==="fixed"?-this.offset.scroll.top:(scrollIsRootNode?0:this.offset.scroll.top))),left:(pageX-
this.offset.click.left-
this.offset.relative.left-
this.offset.parent.left+
(this.cssPosition==="fixed"?-this.offset.scroll.left:(scrollIsRootNode?0:this.offset.scroll.left)))};},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging");if(this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval){this.helper.remove();}
this.helper=null;this.cancelHelperRemoval=false;if(this.destroyOnClear){this.destroy();}},_trigger:function(type,event,ui){ui=ui||this._uiHash();$.ui.plugin.call(this,type,[event,ui,this],true);if(/^(drag|start|stop)/.test(type)){this.positionAbs=this._convertPositionTo("absolute");ui.offset=this.positionAbs;}
return $.Widget.prototype._trigger.call(this,type,event,ui);},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs};}});$.ui.plugin.add("draggable","connectToSortable",{start:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.sortables=[];$(draggable.options.connectToSortable).each(function(){var sortable=$(this).sortable("instance");if(sortable&&!sortable.options.disabled){draggable.sortables.push(sortable);sortable.refreshPositions();sortable._trigger("activate",event,uiSortable);}});},stop:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.cancelHelperRemoval=false;$.each(draggable.sortables,function(){var sortable=this;if(sortable.isOver){sortable.isOver=0;draggable.cancelHelperRemoval=true;sortable.cancelHelperRemoval=false;sortable._storedCSS={position:sortable.placeholder.css("position"),top:sortable.placeholder.css("top"),left:sortable.placeholder.css("left")};sortable._mouseStop(event);sortable.options.helper=sortable.options._helper;}else{sortable.cancelHelperRemoval=true;sortable._trigger("deactivate",event,uiSortable);}});},drag:function(event,ui,draggable){$.each(draggable.sortables,function(){var innermostIntersecting=false,sortable=this;sortable.positionAbs=draggable.positionAbs;sortable.helperProportions=draggable.helperProportions;sortable.offset.click=draggable.offset.click;if(sortable._intersectsWith(sortable.containerCache)){innermostIntersecting=true;$.each(draggable.sortables,function(){this.positionAbs=draggable.positionAbs;this.helperProportions=draggable.helperProportions;this.offset.click=draggable.offset.click;if(this!==sortable&&this._intersectsWith(this.containerCache)&&$.contains(sortable.element[0],this.element[0])){innermostIntersecting=false;}
return innermostIntersecting;});}
if(innermostIntersecting){if(!sortable.isOver){sortable.isOver=1;draggable._parent=ui.helper.parent();sortable.currentItem=ui.helper.appendTo(sortable.element).data("ui-sortable-item",true);sortable.options._helper=sortable.options.helper;sortable.options.helper=function(){return ui.helper[0];};event.target=sortable.currentItem[0];sortable._mouseCapture(event,true);sortable._mouseStart(event,true,true);sortable.offset.click.top=draggable.offset.click.top;sortable.offset.click.left=draggable.offset.click.left;sortable.offset.parent.left-=draggable.offset.parent.left-
sortable.offset.parent.left;sortable.offset.parent.top-=draggable.offset.parent.top-
sortable.offset.parent.top;draggable._trigger("toSortable",event);draggable.dropped=sortable.element;$.each(draggable.sortables,function(){this.refreshPositions();});draggable.currentItem=draggable.element;sortable.fromOutside=draggable;}
if(sortable.currentItem){sortable._mouseDrag(event);ui.position=sortable.position;}}else{if(sortable.isOver){sortable.isOver=0;sortable.cancelHelperRemoval=true;sortable.options._revert=sortable.options.revert;sortable.options.revert=false;sortable._trigger("out",event,sortable._uiHash(sortable));sortable._mouseStop(event,true);sortable.options.revert=sortable.options._revert;sortable.options.helper=sortable.options._helper;if(sortable.placeholder){sortable.placeholder.remove();}
ui.helper.appendTo(draggable._parent);draggable._refreshOffsets(event);ui.position=draggable._generatePosition(event,true);draggable._trigger("fromSortable",event);draggable.dropped=false;$.each(draggable.sortables,function(){this.refreshPositions();});}}});}});$.ui.plugin.add("draggable","cursor",{start:function(event,ui,instance){var t=$("body"),o=instance.options;if(t.css("cursor")){o._cursor=t.css("cursor");}
t.css("cursor",o.cursor);},stop:function(event,ui,instance){var o=instance.options;if(o._cursor){$("body").css("cursor",o._cursor);}}});$.ui.plugin.add("draggable","opacity",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;if(t.css("opacity")){o._opacity=t.css("opacity");}
t.css("opacity",o.opacity);},stop:function(event,ui,instance){var o=instance.options;if(o._opacity){$(ui.helper).css("opacity",o._opacity);}}});$.ui.plugin.add("draggable","scroll",{start:function(event,ui,i){if(!i.scrollParentNotHidden){i.scrollParentNotHidden=i.helper.scrollParent(false);}
if(i.scrollParentNotHidden[0]!==i.document[0]&&i.scrollParentNotHidden[0].tagName!=="HTML"){i.overflowOffset=i.scrollParentNotHidden.offset();}},drag:function(event,ui,i){var o=i.options,scrolled=false,scrollParent=i.scrollParentNotHidden[0],document=i.document[0];if(scrollParent!==document&&scrollParent.tagName!=="HTML"){if(!o.axis||o.axis!=="x"){if((i.overflowOffset.top+scrollParent.offsetHeight)-event.pageY<o.scrollSensitivity){scrollParent.scrollTop=scrolled=scrollParent.scrollTop+o.scrollSpeed;}else if(event.pageY-i.overflowOffset.top<o.scrollSensitivity){scrollParent.scrollTop=scrolled=scrollParent.scrollTop-o.scrollSpeed;}}
if(!o.axis||o.axis!=="y"){if((i.overflowOffset.left+scrollParent.offsetWidth)-event.pageX<o.scrollSensitivity){scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft+o.scrollSpeed;}else if(event.pageX-i.overflowOffset.left<o.scrollSensitivity){scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft-o.scrollSpeed;}}}else{if(!o.axis||o.axis!=="x"){if(event.pageY-$(document).scrollTop()<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed);}else if($(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed);}}
if(!o.axis||o.axis!=="y"){if(event.pageX-$(document).scrollLeft()<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed);}else if($(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed);}}}
if(scrolled!==false&&$.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(i,event);}}});$.ui.plugin.add("draggable","snap",{start:function(event,ui,i){var o=i.options;i.snapElements=[];$(o.snap.constructor!==String?(o.snap.items||":data(ui-draggable)"):o.snap).each(function(){var $t=$(this),$o=$t.offset();if(this!==i.element[0]){i.snapElements.push({item:this,width:$t.outerWidth(),height:$t.outerHeight(),top:$o.top,left:$o.left});}});},drag:function(event,ui,inst){var ts,bs,ls,rs,l,r,t,b,i,first,o=inst.options,d=o.snapTolerance,x1=ui.offset.left,x2=x1+inst.helperProportions.width,y1=ui.offset.top,y2=y1+inst.helperProportions.height;for(i=inst.snapElements.length-1;i>=0;i--){l=inst.snapElements[i].left-inst.margins.left;r=l+inst.snapElements[i].width;t=inst.snapElements[i].top-inst.margins.top;b=t+inst.snapElements[i].height;if(x2<l-d||x1>r+d||y2<t-d||y1>b+d||!$.contains(inst.snapElements[i].item.ownerDocument,inst.snapElements[i].item)){if(inst.snapElements[i].snapping){(inst.options.snap.release&&inst.options.snap.release.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})));}
inst.snapElements[i].snapping=false;continue;}
if(o.snapMode!=="inner"){ts=Math.abs(t-y2)<=d;bs=Math.abs(b-y1)<=d;ls=Math.abs(l-x2)<=d;rs=Math.abs(r-x1)<=d;if(ts){ui.position.top=inst._convertPositionTo("relative",{top:t-inst.helperProportions.height,left:0}).top;}
if(bs){ui.position.top=inst._convertPositionTo("relative",{top:b,left:0}).top;}
if(ls){ui.position.left=inst._convertPositionTo("relative",{top:0,left:l-inst.helperProportions.width}).left;}
if(rs){ui.position.left=inst._convertPositionTo("relative",{top:0,left:r}).left;}}
first=(ts||bs||ls||rs);if(o.snapMode!=="outer"){ts=Math.abs(t-y1)<=d;bs=Math.abs(b-y2)<=d;ls=Math.abs(l-x1)<=d;rs=Math.abs(r-x2)<=d;if(ts){ui.position.top=inst._convertPositionTo("relative",{top:t,left:0}).top;}
if(bs){ui.position.top=inst._convertPositionTo("relative",{top:b-inst.helperProportions.height,left:0}).top;}
if(ls){ui.position.left=inst._convertPositionTo("relative",{top:0,left:l}).left;}
if(rs){ui.position.left=inst._convertPositionTo("relative",{top:0,left:r-inst.helperProportions.width}).left;}}
if(!inst.snapElements[i].snapping&&(ts||bs||ls||rs||first)){(inst.options.snap.snap&&inst.options.snap.snap.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})));}
inst.snapElements[i].snapping=(ts||bs||ls||rs||first);}}});$.ui.plugin.add("draggable","stack",{start:function(event,ui,instance){var min,o=instance.options,group=$.makeArray($(o.stack)).sort(function(a,b){return(parseInt($(a).css("zIndex"),10)||0)-
(parseInt($(b).css("zIndex"),10)||0);});if(!group.length){return;}
min=parseInt($(group[0]).css("zIndex"),10)||0;$(group).each(function(i){$(this).css("zIndex",min+i);});this.css("zIndex",(min+group.length));}});$.ui.plugin.add("draggable","zIndex",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;if(t.css("zIndex")){o._zIndex=t.css("zIndex");}
t.css("zIndex",o.zIndex);},stop:function(event,ui,instance){var o=instance.options;if(o._zIndex){$(ui.helper).css("zIndex",o._zIndex);}}});var widgetsDraggable=$.ui.draggable;$.widget("ui.resizable",$.ui.mouse,{version:"1.12.1",widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(value){return parseFloat(value)||0;},_isNumber:function(value){return!isNaN(parseFloat(value));},_hasScroll:function(el,a){if($(el).css("overflow")==="hidden"){return false;}
var scroll=(a&&a==="left")?"scrollLeft":"scrollTop",has=false;if(el[scroll]>0){return true;}
el[scroll]=1;has=(el[scroll]>0);el[scroll]=0;return has;},_create:function(){var margins,o=this.options,that=this;this._addClass("ui-resizable");$.extend(this,{_aspectRatio:!!(o.aspectRatio),aspectRatio:o.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:o.helper||o.ghost||o.animate?o.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)){this.element.wrap($("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance"));this.elementIsWrapper=true;margins={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")};this.element.css(margins);this.originalElement.css("margin",0);this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css(margins);this._proportionallyResize();}
this._setupHandles();if(o.autoHide){$(this.element).on("mouseenter",function(){if(o.disabled){return;}
that._removeClass("ui-resizable-autohide");that._handles.show();}).on("mouseleave",function(){if(o.disabled){return;}
if(!that.resizing){that._addClass("ui-resizable-autohide");that._handles.hide();}});}
this._mouseInit();},_destroy:function(){this._mouseDestroy();var wrapper,_destroy=function(exp){$(exp).removeData("resizable").removeData("ui-resizable").off(".resizable").find(".ui-resizable-handle").remove();};if(this.elementIsWrapper){_destroy(this.element);wrapper=this.element;this.originalElement.css({position:wrapper.css("position"),width:wrapper.outerWidth(),height:wrapper.outerHeight(),top:wrapper.css("top"),left:wrapper.css("left")}).insertAfter(wrapper);wrapper.remove();}
this.originalElement.css("resize",this.originalResizeStyle);_destroy(this.originalElement);return this;},_setOption:function(key,value){this._super(key,value);switch(key){case"handles":this._removeHandles();this._setupHandles();break;default:break;}},_setupHandles:function(){var o=this.options,handle,i,n,hname,axis,that=this;this.handles=o.handles||(!$(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});this._handles=$();if(this.handles.constructor===String){if(this.handles==="all"){this.handles="n,e,s,w,se,sw,ne,nw";}
n=this.handles.split(",");this.handles={};for(i=0;i<n.length;i++){handle=$.trim(n[i]);hname="ui-resizable-"+handle;axis=$("<div>");this._addClass(axis,"ui-resizable-handle "+hname);axis.css({zIndex:o.zIndex});this.handles[handle]=".ui-resizable-"+handle;this.element.append(axis);}}
this._renderAxis=function(target){var i,axis,padPos,padWrapper;target=target||this.element;for(i in this.handles){if(this.handles[i].constructor===String){this.handles[i]=this.element.children(this.handles[i]).first().show();}else if(this.handles[i].jquery||this.handles[i].nodeType){this.handles[i]=$(this.handles[i]);this._on(this.handles[i],{"mousedown":that._mouseDown});}
if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)){axis=$(this.handles[i],this.element);padWrapper=/sw|ne|nw|se|n|s/.test(i)?axis.outerHeight():axis.outerWidth();padPos=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join("");target.css(padPos,padWrapper);this._proportionallyResize();}
this._handles=this._handles.add(this.handles[i]);}};this._renderAxis(this.element);this._handles=this._handles.add(this.element.find(".ui-resizable-handle"));this._handles.disableSelection();this._handles.on("mouseover",function(){if(!that.resizing){if(this.className){axis=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);}
that.axis=axis&&axis[1]?axis[1]:"se";}});if(o.autoHide){this._handles.hide();this._addClass("ui-resizable-autohide");}},_removeHandles:function(){this._handles.remove();},_mouseCapture:function(event){var i,handle,capture=false;for(i in this.handles){handle=$(this.handles[i])[0];if(handle===event.target||$.contains(handle,event.target)){capture=true;}}
return!this.options.disabled&&capture;},_mouseStart:function(event){var curleft,curtop,cursor,o=this.options,el=this.element;this.resizing=true;this._renderProxy();curleft=this._num(this.helper.css("left"));curtop=this._num(this.helper.css("top"));if(o.containment){curleft+=$(o.containment).scrollLeft()||0;curtop+=$(o.containment).scrollTop()||0;}
this.offset=this.helper.offset();this.position={left:curleft,top:curtop};this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:el.width(),height:el.height()};this.originalSize=this._helper?{width:el.outerWidth(),height:el.outerHeight()}:{width:el.width(),height:el.height()};this.sizeDiff={width:el.outerWidth()-el.width(),height:el.outerHeight()-el.height()};this.originalPosition={left:curleft,top:curtop};this.originalMousePosition={left:event.pageX,top:event.pageY};this.aspectRatio=(typeof o.aspectRatio==="number")?o.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);cursor=$(".ui-resizable-"+this.axis).css("cursor");$("body").css("cursor",cursor==="auto"?this.axis+"-resize":cursor);this._addClass("ui-resizable-resizing");this._propagate("start",event);return true;},_mouseDrag:function(event){var data,props,smp=this.originalMousePosition,a=this.axis,dx=(event.pageX-smp.left)||0,dy=(event.pageY-smp.top)||0,trigger=this._change[a];this._updatePrevProperties();if(!trigger){return false;}
data=trigger.apply(this,[event,dx,dy]);this._updateVirtualBoundaries(event.shiftKey);if(this._aspectRatio||event.shiftKey){data=this._updateRatio(data,event);}
data=this._respectSize(data,event);this._updateCache(data);this._propagate("resize",event);props=this._applyChanges();if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize();}
if(!$.isEmptyObject(props)){this._updatePrevProperties();this._trigger("resize",event,this.ui());this._applyChanges();}
return false;},_mouseStop:function(event){this.resizing=false;var pr,ista,soffseth,soffsetw,s,left,top,o=this.options,that=this;if(this._helper){pr=this._proportionallyResizeElements;ista=pr.length&&(/textarea/i).test(pr[0].nodeName);soffseth=ista&&this._hasScroll(pr[0],"left")?0:that.sizeDiff.height;soffsetw=ista?0:that.sizeDiff.width;s={width:(that.helper.width()-soffsetw),height:(that.helper.height()-soffseth)};left=(parseFloat(that.element.css("left"))+
(that.position.left-that.originalPosition.left))||null;top=(parseFloat(that.element.css("top"))+
(that.position.top-that.originalPosition.top))||null;if(!o.animate){this.element.css($.extend(s,{top:top,left:left}));}
that.helper.height(that.size.height);that.helper.width(that.size.width);if(this._helper&&!o.animate){this._proportionallyResize();}}
$("body").css("cursor","auto");this._removeClass("ui-resizable-resizing");this._propagate("stop",event);if(this._helper){this.helper.remove();}
return false;},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left};this.prevSize={width:this.size.width,height:this.size.height};},_applyChanges:function(){var props={};if(this.position.top!==this.prevPosition.top){props.top=this.position.top+"px";}
if(this.position.left!==this.prevPosition.left){props.left=this.position.left+"px";}
if(this.size.width!==this.prevSize.width){props.width=this.size.width+"px";}
if(this.size.height!==this.prevSize.height){props.height=this.size.height+"px";}
this.helper.css(props);return props;},_updateVirtualBoundaries:function(forceAspectRatio){var pMinWidth,pMaxWidth,pMinHeight,pMaxHeight,b,o=this.options;b={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:Infinity,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:Infinity};if(this._aspectRatio||forceAspectRatio){pMinWidth=b.minHeight*this.aspectRatio;pMinHeight=b.minWidth/this.aspectRatio;pMaxWidth=b.maxHeight*this.aspectRatio;pMaxHeight=b.maxWidth/this.aspectRatio;if(pMinWidth>b.minWidth){b.minWidth=pMinWidth;}
if(pMinHeight>b.minHeight){b.minHeight=pMinHeight;}
if(pMaxWidth<b.maxWidth){b.maxWidth=pMaxWidth;}
if(pMaxHeight<b.maxHeight){b.maxHeight=pMaxHeight;}}
this._vBoundaries=b;},_updateCache:function(data){this.offset=this.helper.offset();if(this._isNumber(data.left)){this.position.left=data.left;}
if(this._isNumber(data.top)){this.position.top=data.top;}
if(this._isNumber(data.height)){this.size.height=data.height;}
if(this._isNumber(data.width)){this.size.width=data.width;}},_updateRatio:function(data){var cpos=this.position,csize=this.size,a=this.axis;if(this._isNumber(data.height)){data.width=(data.height*this.aspectRatio);}else if(this._isNumber(data.width)){data.height=(data.width/this.aspectRatio);}
if(a==="sw"){data.left=cpos.left+(csize.width-data.width);data.top=null;}
if(a==="nw"){data.top=cpos.top+(csize.height-data.height);data.left=cpos.left+(csize.width-data.width);}
return data;},_respectSize:function(data){var o=this._vBoundaries,a=this.axis,ismaxw=this._isNumber(data.width)&&o.maxWidth&&(o.maxWidth<data.width),ismaxh=this._isNumber(data.height)&&o.maxHeight&&(o.maxHeight<data.height),isminw=this._isNumber(data.width)&&o.minWidth&&(o.minWidth>data.width),isminh=this._isNumber(data.height)&&o.minHeight&&(o.minHeight>data.height),dw=this.originalPosition.left+this.originalSize.width,dh=this.originalPosition.top+this.originalSize.height,cw=/sw|nw|w/.test(a),ch=/nw|ne|n/.test(a);if(isminw){data.width=o.minWidth;}
if(isminh){data.height=o.minHeight;}
if(ismaxw){data.width=o.maxWidth;}
if(ismaxh){data.height=o.maxHeight;}
if(isminw&&cw){data.left=dw-o.minWidth;}
if(ismaxw&&cw){data.left=dw-o.maxWidth;}
if(isminh&&ch){data.top=dh-o.minHeight;}
if(ismaxh&&ch){data.top=dh-o.maxHeight;}
if(!data.width&&!data.height&&!data.left&&data.top){data.top=null;}else if(!data.width&&!data.height&&!data.top&&data.left){data.left=null;}
return data;},_getPaddingPlusBorderDimensions:function(element){var i=0,widths=[],borders=[element.css("borderTopWidth"),element.css("borderRightWidth"),element.css("borderBottomWidth"),element.css("borderLeftWidth")],paddings=[element.css("paddingTop"),element.css("paddingRight"),element.css("paddingBottom"),element.css("paddingLeft")];for(;i<4;i++){widths[i]=(parseFloat(borders[i])||0);widths[i]+=(parseFloat(paddings[i])||0);}
return{height:widths[0]+widths[2],width:widths[1]+widths[3]};},_proportionallyResize:function(){if(!this._proportionallyResizeElements.length){return;}
var prel,i=0,element=this.helper||this.element;for(;i<this._proportionallyResizeElements.length;i++){prel=this._proportionallyResizeElements[i];if(!this.outerDimensions){this.outerDimensions=this._getPaddingPlusBorderDimensions(prel);}
prel.css({height:(element.height()-this.outerDimensions.height)||0,width:(element.width()-this.outerDimensions.width)||0});}},_renderProxy:function(){var el=this.element,o=this.options;this.elementOffset=el.offset();if(this._helper){this.helper=this.helper||$("<div style='overflow:hidden;'></div>");this._addClass(this.helper,this._helper);this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++o.zIndex});this.helper.appendTo("body").disableSelection();}else{this.helper=this.element;}},_change:{e:function(event,dx){return{width:this.originalSize.width+dx};},w:function(event,dx){var cs=this.originalSize,sp=this.originalPosition;return{left:sp.left+dx,width:cs.width-dx};},n:function(event,dx,dy){var cs=this.originalSize,sp=this.originalPosition;return{top:sp.top+dy,height:cs.height-dy};},s:function(event,dx,dy){return{height:this.originalSize.height+dy};},se:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]));},sw:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]));},ne:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]));},nw:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]));}},_propagate:function(n,event){$.ui.plugin.call(this,n,[event,this.ui()]);(n!=="resize"&&this._trigger(n,event,this.ui()));},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition};}});$.ui.plugin.add("resizable","animate",{stop:function(event){var that=$(this).resizable("instance"),o=that.options,pr=that._proportionallyResizeElements,ista=pr.length&&(/textarea/i).test(pr[0].nodeName),soffseth=ista&&that._hasScroll(pr[0],"left")?0:that.sizeDiff.height,soffsetw=ista?0:that.sizeDiff.width,style={width:(that.size.width-soffsetw),height:(that.size.height-soffseth)},left=(parseFloat(that.element.css("left"))+
(that.position.left-that.originalPosition.left))||null,top=(parseFloat(that.element.css("top"))+
(that.position.top-that.originalPosition.top))||null;that.element.animate($.extend(style,top&&left?{top:top,left:left}:{}),{duration:o.animateDuration,easing:o.animateEasing,step:function(){var data={width:parseFloat(that.element.css("width")),height:parseFloat(that.element.css("height")),top:parseFloat(that.element.css("top")),left:parseFloat(that.element.css("left"))};if(pr&&pr.length){$(pr[0]).css({width:data.width,height:data.height});}
that._updateCache(data);that._propagate("resize",event);}});}});$.ui.plugin.add("resizable","containment",{start:function(){var element,p,co,ch,cw,width,height,that=$(this).resizable("instance"),o=that.options,el=that.element,oc=o.containment,ce=(oc instanceof $)?oc.get(0):(/parent/.test(oc))?el.parent().get(0):oc;if(!ce){return;}
that.containerElement=$(ce);if(/document/.test(oc)||oc===document){that.containerOffset={left:0,top:0};that.containerPosition={left:0,top:0};that.parentData={element:$(document),left:0,top:0,width:$(document).width(),height:$(document).height()||document.body.parentNode.scrollHeight};}else{element=$(ce);p=[];$(["Top","Right","Left","Bottom"]).each(function(i,name){p[i]=that._num(element.css("padding"+name));});that.containerOffset=element.offset();that.containerPosition=element.position();that.containerSize={height:(element.innerHeight()-p[3]),width:(element.innerWidth()-p[1])};co=that.containerOffset;ch=that.containerSize.height;cw=that.containerSize.width;width=(that._hasScroll(ce,"left")?ce.scrollWidth:cw);height=(that._hasScroll(ce)?ce.scrollHeight:ch);that.parentData={element:ce,left:co.left,top:co.top,width:width,height:height};}},resize:function(event){var woset,hoset,isParent,isOffsetRelative,that=$(this).resizable("instance"),o=that.options,co=that.containerOffset,cp=that.position,pRatio=that._aspectRatio||event.shiftKey,cop={top:0,left:0},ce=that.containerElement,continueResize=true;if(ce[0]!==document&&(/static/).test(ce.css("position"))){cop=co;}
if(cp.left<(that._helper?co.left:0)){that.size.width=that.size.width+
(that._helper?(that.position.left-co.left):(that.position.left-cop.left));if(pRatio){that.size.height=that.size.width/that.aspectRatio;continueResize=false;}
that.position.left=o.helper?co.left:0;}
if(cp.top<(that._helper?co.top:0)){that.size.height=that.size.height+
(that._helper?(that.position.top-co.top):that.position.top);if(pRatio){that.size.width=that.size.height*that.aspectRatio;continueResize=false;}
that.position.top=that._helper?co.top:0;}
isParent=that.containerElement.get(0)===that.element.parent().get(0);isOffsetRelative=/relative|absolute/.test(that.containerElement.css("position"));if(isParent&&isOffsetRelative){that.offset.left=that.parentData.left+that.position.left;that.offset.top=that.parentData.top+that.position.top;}else{that.offset.left=that.element.offset().left;that.offset.top=that.element.offset().top;}
woset=Math.abs(that.sizeDiff.width+
(that._helper?that.offset.left-cop.left:(that.offset.left-co.left)));hoset=Math.abs(that.sizeDiff.height+
(that._helper?that.offset.top-cop.top:(that.offset.top-co.top)));if(woset+that.size.width>=that.parentData.width){that.size.width=that.parentData.width-woset;if(pRatio){that.size.height=that.size.width/that.aspectRatio;continueResize=false;}}
if(hoset+that.size.height>=that.parentData.height){that.size.height=that.parentData.height-hoset;if(pRatio){that.size.width=that.size.height*that.aspectRatio;continueResize=false;}}
if(!continueResize){that.position.left=that.prevPosition.left;that.position.top=that.prevPosition.top;that.size.width=that.prevSize.width;that.size.height=that.prevSize.height;}},stop:function(){var that=$(this).resizable("instance"),o=that.options,co=that.containerOffset,cop=that.containerPosition,ce=that.containerElement,helper=$(that.helper),ho=helper.offset(),w=helper.outerWidth()-that.sizeDiff.width,h=helper.outerHeight()-that.sizeDiff.height;if(that._helper&&!o.animate&&(/relative/).test(ce.css("position"))){$(this).css({left:ho.left-cop.left-co.left,width:w,height:h});}
if(that._helper&&!o.animate&&(/static/).test(ce.css("position"))){$(this).css({left:ho.left-cop.left-co.left,width:w,height:h});}}});$.ui.plugin.add("resizable","alsoResize",{start:function(){var that=$(this).resizable("instance"),o=that.options;$(o.alsoResize).each(function(){var el=$(this);el.data("ui-resizable-alsoresize",{width:parseFloat(el.width()),height:parseFloat(el.height()),left:parseFloat(el.css("left")),top:parseFloat(el.css("top"))});});},resize:function(event,ui){var that=$(this).resizable("instance"),o=that.options,os=that.originalSize,op=that.originalPosition,delta={height:(that.size.height-os.height)||0,width:(that.size.width-os.width)||0,top:(that.position.top-op.top)||0,left:(that.position.left-op.left)||0};$(o.alsoResize).each(function(){var el=$(this),start=$(this).data("ui-resizable-alsoresize"),style={},css=el.parents(ui.originalElement[0]).length?["width","height"]:["width","height","top","left"];$.each(css,function(i,prop){var sum=(start[prop]||0)+(delta[prop]||0);if(sum&&sum>=0){style[prop]=sum||null;}});el.css(style);});},stop:function(){$(this).removeData("ui-resizable-alsoresize");}});$.ui.plugin.add("resizable","ghost",{start:function(){var that=$(this).resizable("instance"),cs=that.size;that.ghost=that.originalElement.clone();that.ghost.css({opacity:0.25,display:"block",position:"relative",height:cs.height,width:cs.width,margin:0,left:0,top:0});that._addClass(that.ghost,"ui-resizable-ghost");if($.uiBackCompat!==false&&typeof that.options.ghost==="string"){that.ghost.addClass(this.options.ghost);}
that.ghost.appendTo(that.helper);},resize:function(){var that=$(this).resizable("instance");if(that.ghost){that.ghost.css({position:"relative",height:that.size.height,width:that.size.width});}},stop:function(){var that=$(this).resizable("instance");if(that.ghost&&that.helper){that.helper.get(0).removeChild(that.ghost.get(0));}}});$.ui.plugin.add("resizable","grid",{resize:function(){var outerDimensions,that=$(this).resizable("instance"),o=that.options,cs=that.size,os=that.originalSize,op=that.originalPosition,a=that.axis,grid=typeof o.grid==="number"?[o.grid,o.grid]:o.grid,gridX=(grid[0]||1),gridY=(grid[1]||1),ox=Math.round((cs.width-os.width)/gridX)*gridX,oy=Math.round((cs.height-os.height)/gridY)*gridY,newWidth=os.width+ox,newHeight=os.height+oy,isMaxWidth=o.maxWidth&&(o.maxWidth<newWidth),isMaxHeight=o.maxHeight&&(o.maxHeight<newHeight),isMinWidth=o.minWidth&&(o.minWidth>newWidth),isMinHeight=o.minHeight&&(o.minHeight>newHeight);o.grid=grid;if(isMinWidth){newWidth+=gridX;}
if(isMinHeight){newHeight+=gridY;}
if(isMaxWidth){newWidth-=gridX;}
if(isMaxHeight){newHeight-=gridY;}
if(/^(se|s|e)$/.test(a)){that.size.width=newWidth;that.size.height=newHeight;}else if(/^(ne)$/.test(a)){that.size.width=newWidth;that.size.height=newHeight;that.position.top=op.top-oy;}else if(/^(sw)$/.test(a)){that.size.width=newWidth;that.size.height=newHeight;that.position.left=op.left-ox;}else{if(newHeight-gridY<=0||newWidth-gridX<=0){outerDimensions=that._getPaddingPlusBorderDimensions(this);}
if(newHeight-gridY>0){that.size.height=newHeight;that.position.top=op.top-oy;}else{newHeight=gridY-outerDimensions.height;that.size.height=newHeight;that.position.top=op.top+os.height-newHeight;}
if(newWidth-gridX>0){that.size.width=newWidth;that.position.left=op.left-ox;}else{newWidth=gridX-outerDimensions.width;that.size.width=newWidth;that.position.left=op.left+os.width-newWidth;}}}});var widgetsResizable=$.ui.resizable;$.widget("ui.dialog",{version:"1.12.1",options:{appendTo:"body",autoOpen:true,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:true,closeText:"Close",draggable:true,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",of:window,collision:"fit",using:function(pos){var topOffset=$(this).css(pos).offset().top;if(topOffset<0){$(this).css("top",pos.top-topOffset);}}},resizable:true,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},resizableRelatedOptions:{maxHeight:true,maxWidth:true,minHeight:true,minWidth:true},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height};this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};this.originalTitle=this.element.attr("title");if(this.options.title==null&&this.originalTitle!=null){this.options.title=this.originalTitle;}
if(this.options.disabled){this.options.disabled=false;}
this._createWrapper();this.element.show().removeAttr("title").appendTo(this.uiDialog);this._addClass("ui-dialog-content","ui-widget-content");this._createTitlebar();this._createButtonPane();if(this.options.draggable&&$.fn.draggable){this._makeDraggable();}
if(this.options.resizable&&$.fn.resizable){this._makeResizable();}
this._isOpen=false;this._trackFocus();},_init:function(){if(this.options.autoOpen){this.open();}},_appendTo:function(){var element=this.options.appendTo;if(element&&(element.jquery||element.nodeType)){return $(element);}
return this.document.find(element||"body").eq(0);},_destroy:function(){var next,originalPosition=this.originalPosition;this._untrackInstance();this._destroyOverlay();this.element.removeUniqueId().css(this.originalCss).detach();this.uiDialog.remove();if(this.originalTitle){this.element.attr("title",this.originalTitle);}
next=originalPosition.parent.children().eq(originalPosition.index);if(next.length&&next[0]!==this.element[0]){next.before(this.element);}else{originalPosition.parent.append(this.element);}},widget:function(){return this.uiDialog;},disable:$.noop,enable:$.noop,close:function(event){var that=this;if(!this._isOpen||this._trigger("beforeClose",event)===false){return;}
this._isOpen=false;this._focusedElement=null;this._destroyOverlay();this._untrackInstance();if(!this.opener.filter(":focusable").trigger("focus").length){$.ui.safeBlur($.ui.safeActiveElement(this.document[0]));}
this._hide(this.uiDialog,this.options.hide,function(){that._trigger("close",event);});},isOpen:function(){return this._isOpen;},moveToTop:function(){this._moveToTop();},_moveToTop:function(event,silent){var moved=false,zIndices=this.uiDialog.siblings(".ui-front:visible").map(function(){return+$(this).css("z-index");}).get(),zIndexMax=Math.max.apply(null,zIndices);if(zIndexMax>=+this.uiDialog.css("z-index")){this.uiDialog.css("z-index",zIndexMax+1);moved=true;}
if(moved&&!silent){this._trigger("focus",event);}
return moved;},open:function(){var that=this;if(this._isOpen){if(this._moveToTop()){this._focusTabbable();}
return;}
this._isOpen=true;this.opener=$($.ui.safeActiveElement(this.document[0]));this._size();this._position();this._createOverlay();this._moveToTop(null,true);if(this.overlay){this.overlay.css("z-index",this.uiDialog.css("z-index")-1);}
this._show(this.uiDialog,this.options.show,function(){that._focusTabbable();that._trigger("focus");});this._makeFocusTarget();this._trigger("open");},_focusTabbable:function(){var hasFocus=this._focusedElement;if(!hasFocus){hasFocus=this.element.find("[autofocus]");}
if(!hasFocus.length){hasFocus=this.element.find(":tabbable");}
if(!hasFocus.length){hasFocus=this.uiDialogButtonPane.find(":tabbable");}
if(!hasFocus.length){hasFocus=this.uiDialogTitlebarClose.filter(":tabbable");}
if(!hasFocus.length){hasFocus=this.uiDialog;}
hasFocus.eq(0).trigger("focus");},_keepFocus:function(event){function checkFocus(){var activeElement=$.ui.safeActiveElement(this.document[0]),isActive=this.uiDialog[0]===activeElement||$.contains(this.uiDialog[0],activeElement);if(!isActive){this._focusTabbable();}}
event.preventDefault();checkFocus.call(this);this._delay(checkFocus);},_createWrapper:function(){this.uiDialog=$("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo());this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front");this._on(this.uiDialog,{keydown:function(event){if(this.options.closeOnEscape&&!event.isDefaultPrevented()&&event.keyCode&&event.keyCode===$.ui.keyCode.ESCAPE){event.preventDefault();this.close(event);return;}
if(event.keyCode!==$.ui.keyCode.TAB||event.isDefaultPrevented()){return;}
var tabbables=this.uiDialog.find(":tabbable"),first=tabbables.filter(":first"),last=tabbables.filter(":last");if((event.target===last[0]||event.target===this.uiDialog[0])&&!event.shiftKey){this._delay(function(){first.trigger("focus");});event.preventDefault();}else if((event.target===first[0]||event.target===this.uiDialog[0])&&event.shiftKey){this._delay(function(){last.trigger("focus");});event.preventDefault();}},mousedown:function(event){if(this._moveToTop(event)){this._focusTabbable();}}});if(!this.element.find("[aria-describedby]").length){this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")});}},_createTitlebar:function(){var uiDialogTitle;this.uiDialogTitlebar=$("<div>");this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix");this._on(this.uiDialogTitlebar,{mousedown:function(event){if(!$(event.target).closest(".ui-dialog-titlebar-close")){this.uiDialog.trigger("focus");}}});this.uiDialogTitlebarClose=$("<button type='button'></button>").button({label:$("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:false}).appendTo(this.uiDialogTitlebar);this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close");this._on(this.uiDialogTitlebarClose,{click:function(event){event.preventDefault();this.close(event);}});uiDialogTitle=$("<span>").uniqueId().prependTo(this.uiDialogTitlebar);this._addClass(uiDialogTitle,"ui-dialog-title");this._title(uiDialogTitle);this.uiDialogTitlebar.prependTo(this.uiDialog);this.uiDialog.attr({"aria-labelledby":uiDialogTitle.attr("id")});},_title:function(title){if(this.options.title){title.text(this.options.title);}else{title.html("&#160;");}},_createButtonPane:function(){this.uiDialogButtonPane=$("<div>");this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix");this.uiButtonSet=$("<div>").appendTo(this.uiDialogButtonPane);this._addClass(this.uiButtonSet,"ui-dialog-buttonset");this._createButtons();},_createButtons:function(){var that=this,buttons=this.options.buttons;this.uiDialogButtonPane.remove();this.uiButtonSet.empty();if($.isEmptyObject(buttons)||($.isArray(buttons)&&!buttons.length)){this._removeClass(this.uiDialog,"ui-dialog-buttons");return;}
$.each(buttons,function(name,props){var click,buttonOptions;props=$.isFunction(props)?{click:props,text:name}:props;props=$.extend({type:"button"},props);click=props.click;buttonOptions={icon:props.icon,iconPosition:props.iconPosition,showLabel:props.showLabel,icons:props.icons,text:props.text};delete props.click;delete props.icon;delete props.iconPosition;delete props.showLabel;delete props.icons;if(typeof props.text==="boolean"){delete props.text;}
$("<button></button>",props).button(buttonOptions).appendTo(that.uiButtonSet).on("click",function(){click.apply(that.element[0],arguments);});});this._addClass(this.uiDialog,"ui-dialog-buttons");this.uiDialogButtonPane.appendTo(this.uiDialog);},_makeDraggable:function(){var that=this,options=this.options;function filteredUi(ui){return{position:ui.position,offset:ui.offset};}
this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(event,ui){that._addClass($(this),"ui-dialog-dragging");that._blockFrames();that._trigger("dragStart",event,filteredUi(ui));},drag:function(event,ui){that._trigger("drag",event,filteredUi(ui));},stop:function(event,ui){var left=ui.offset.left-that.document.scrollLeft(),top=ui.offset.top-that.document.scrollTop();options.position={my:"left top",at:"left"+(left>=0?"+":"")+left+" "+"top"+(top>=0?"+":"")+top,of:that.window};that._removeClass($(this),"ui-dialog-dragging");that._unblockFrames();that._trigger("dragStop",event,filteredUi(ui));}});},_makeResizable:function(){var that=this,options=this.options,handles=options.resizable,position=this.uiDialog.css("position"),resizeHandles=typeof handles==="string"?handles:"n,e,s,w,se,sw,ne,nw";function filteredUi(ui){return{originalPosition:ui.originalPosition,originalSize:ui.originalSize,position:ui.position,size:ui.size};}
this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:options.maxWidth,maxHeight:options.maxHeight,minWidth:options.minWidth,minHeight:this._minHeight(),handles:resizeHandles,start:function(event,ui){that._addClass($(this),"ui-dialog-resizing");that._blockFrames();that._trigger("resizeStart",event,filteredUi(ui));},resize:function(event,ui){that._trigger("resize",event,filteredUi(ui));},stop:function(event,ui){var offset=that.uiDialog.offset(),left=offset.left-that.document.scrollLeft(),top=offset.top-that.document.scrollTop();options.height=that.uiDialog.height();options.width=that.uiDialog.width();options.position={my:"left top",at:"left"+(left>=0?"+":"")+left+" "+"top"+(top>=0?"+":"")+top,of:that.window};that._removeClass($(this),"ui-dialog-resizing");that._unblockFrames();that._trigger("resizeStop",event,filteredUi(ui));}}).css("position",position);},_trackFocus:function(){this._on(this.widget(),{focusin:function(event){this._makeFocusTarget();this._focusedElement=$(event.target);}});},_makeFocusTarget:function(){this._untrackInstance();this._trackingInstances().unshift(this);},_untrackInstance:function(){var instances=this._trackingInstances(),exists=$.inArray(this,instances);if(exists!==-1){instances.splice(exists,1);}},_trackingInstances:function(){var instances=this.document.data("ui-dialog-instances");if(!instances){instances=[];this.document.data("ui-dialog-instances",instances);}
return instances;},_minHeight:function(){var options=this.options;return options.height==="auto"?options.minHeight:Math.min(options.minHeight,options.height);},_position:function(){var isVisible=this.uiDialog.is(":visible");if(!isVisible){this.uiDialog.show();}
this.uiDialog.position(this.options.position);if(!isVisible){this.uiDialog.hide();}},_setOptions:function(options){var that=this,resize=false,resizableOptions={};$.each(options,function(key,value){that._setOption(key,value);if(key in that.sizeRelatedOptions){resize=true;}
if(key in that.resizableRelatedOptions){resizableOptions[key]=value;}});if(resize){this._size();this._position();}
if(this.uiDialog.is(":data(ui-resizable)")){this.uiDialog.resizable("option",resizableOptions);}},_setOption:function(key,value){var isDraggable,isResizable,uiDialog=this.uiDialog;if(key==="disabled"){return;}
this._super(key,value);if(key==="appendTo"){this.uiDialog.appendTo(this._appendTo());}
if(key==="buttons"){this._createButtons();}
if(key==="closeText"){this.uiDialogTitlebarClose.button({label:$("<a>").text(""+this.options.closeText).html()});}
if(key==="draggable"){isDraggable=uiDialog.is(":data(ui-draggable)");if(isDraggable&&!value){uiDialog.draggable("destroy");}
if(!isDraggable&&value){this._makeDraggable();}}
if(key==="position"){this._position();}
if(key==="resizable"){isResizable=uiDialog.is(":data(ui-resizable)");if(isResizable&&!value){uiDialog.resizable("destroy");}
if(isResizable&&typeof value==="string"){uiDialog.resizable("option","handles",value);}
if(!isResizable&&value!==false){this._makeResizable();}}
if(key==="title"){this._title(this.uiDialogTitlebar.find(".ui-dialog-title"));}},_size:function(){var nonContentHeight,minContentHeight,maxContentHeight,options=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0});if(options.minWidth>options.width){options.width=options.minWidth;}
nonContentHeight=this.uiDialog.css({height:"auto",width:options.width}).outerHeight();minContentHeight=Math.max(0,options.minHeight-nonContentHeight);maxContentHeight=typeof options.maxHeight==="number"?Math.max(0,options.maxHeight-nonContentHeight):"none";if(options.height==="auto"){this.element.css({minHeight:minContentHeight,maxHeight:maxContentHeight,height:"auto"});}else{this.element.height(Math.max(0,options.height-nonContentHeight));}
if(this.uiDialog.is(":data(ui-resizable)")){this.uiDialog.resizable("option","minHeight",this._minHeight());}},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var iframe=$(this);return $("<div>").css({position:"absolute",width:iframe.outerWidth(),height:iframe.outerHeight()}).appendTo(iframe.parent()).offset(iframe.offset())[0];});},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks;}},_allowInteraction:function(event){if($(event.target).closest(".ui-dialog").length){return true;}
return!!$(event.target).closest(".ui-datepicker").length;},_createOverlay:function(){if(!this.options.modal){return;}
var isOpening=true;this._delay(function(){isOpening=false;});if(!this.document.data("ui-dialog-overlays")){this._on(this.document,{focusin:function(event){if(isOpening){return;}
if(!this._allowInteraction(event)){event.preventDefault();this._trackingInstances()[0]._focusTabbable();}}});}
this.overlay=$("<div>").appendTo(this._appendTo());this._addClass(this.overlay,null,"ui-widget-overlay ui-front");this._on(this.overlay,{mousedown:"_keepFocus"});this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1);},_destroyOverlay:function(){if(!this.options.modal){return;}
if(this.overlay){var overlays=this.document.data("ui-dialog-overlays")-1;if(!overlays){this._off(this.document,"focusin");this.document.removeData("ui-dialog-overlays");}else{this.document.data("ui-dialog-overlays",overlays);}
this.overlay.remove();this.overlay=null;}}});if($.uiBackCompat!==false){$.widget("ui.dialog",$.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super();this.uiDialog.addClass(this.options.dialogClass);},_setOption:function(key,value){if(key==="dialogClass"){this.uiDialog.removeClass(this.options.dialogClass).addClass(value);}
this._superApply(arguments);}});}
var widgetsDialog=$.ui.dialog;$.widget("ui.droppable",{version:"1.12.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:true,greedy:false,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var proportions,o=this.options,accept=o.accept;this.isover=false;this.isout=true;this.accept=$.isFunction(accept)?accept:function(d){return d.is(accept);};this.proportions=function(){if(arguments.length){proportions=arguments[0];}else{return proportions?proportions:proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};}};this._addToManager(o.scope);o.addClasses&&this._addClass("ui-droppable");},_addToManager:function(scope){$.ui.ddmanager.droppables[scope]=$.ui.ddmanager.droppables[scope]||[];$.ui.ddmanager.droppables[scope].push(this);},_splice:function(drop){var i=0;for(;i<drop.length;i++){if(drop[i]===this){drop.splice(i,1);}}},_destroy:function(){var drop=$.ui.ddmanager.droppables[this.options.scope];this._splice(drop);},_setOption:function(key,value){if(key==="accept"){this.accept=$.isFunction(value)?value:function(d){return d.is(value);};}else if(key==="scope"){var drop=$.ui.ddmanager.droppables[this.options.scope];this._splice(drop);this._addToManager(value);}
this._super(key,value);},_activate:function(event){var draggable=$.ui.ddmanager.current;this._addActiveClass();if(draggable){this._trigger("activate",event,this.ui(draggable));}},_deactivate:function(event){var draggable=$.ui.ddmanager.current;this._removeActiveClass();if(draggable){this._trigger("deactivate",event,this.ui(draggable));}},_over:function(event){var draggable=$.ui.ddmanager.current;if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){return;}
if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){this._addHoverClass();this._trigger("over",event,this.ui(draggable));}},_out:function(event){var draggable=$.ui.ddmanager.current;if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){return;}
if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){this._removeHoverClass();this._trigger("out",event,this.ui(draggable));}},_drop:function(event,custom){var draggable=custom||$.ui.ddmanager.current,childrenIntersection=false;if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){return false;}
this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var inst=$(this).droppable("instance");if(inst.options.greedy&&!inst.options.disabled&&inst.options.scope===draggable.options.scope&&inst.accept.call(inst.element[0],(draggable.currentItem||draggable.element))&&intersect(draggable,$.extend(inst,{offset:inst.element.offset()}),inst.options.tolerance,event)){childrenIntersection=true;return false;}});if(childrenIntersection){return false;}
if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){this._removeActiveClass();this._removeHoverClass();this._trigger("drop",event,this.ui(draggable));return this.element;}
return false;},ui:function(c){return{draggable:(c.currentItem||c.element),helper:c.helper,position:c.position,offset:c.positionAbs};},_addHoverClass:function(){this._addClass("ui-droppable-hover");},_removeHoverClass:function(){this._removeClass("ui-droppable-hover");},_addActiveClass:function(){this._addClass("ui-droppable-active");},_removeActiveClass:function(){this._removeClass("ui-droppable-active");}});var intersect=$.ui.intersect=(function(){function isOverAxis(x,reference,size){return(x>=reference)&&(x<(reference+size));}
return function(draggable,droppable,toleranceMode,event){if(!droppable.offset){return false;}
var x1=(draggable.positionAbs||draggable.position.absolute).left+draggable.margins.left,y1=(draggable.positionAbs||draggable.position.absolute).top+draggable.margins.top,x2=x1+draggable.helperProportions.width,y2=y1+draggable.helperProportions.height,l=droppable.offset.left,t=droppable.offset.top,r=l+droppable.proportions().width,b=t+droppable.proportions().height;switch(toleranceMode){case"fit":return(l<=x1&&x2<=r&&t<=y1&&y2<=b);case"intersect":return(l<x1+(draggable.helperProportions.width/2)&&x2-(draggable.helperProportions.width/2)<r&&t<y1+(draggable.helperProportions.height/2)&&y2-(draggable.helperProportions.height/2)<b);case"pointer":return isOverAxis(event.pageY,t,droppable.proportions().height)&&isOverAxis(event.pageX,l,droppable.proportions().width);case"touch":return((y1>=t&&y1<=b)||(y2>=t&&y2<=b)||(y1<t&&y2>b))&&((x1>=l&&x1<=r)||(x2>=l&&x2<=r)||(x1<l&&x2>r));default:return false;}};})();$.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,event){var i,j,m=$.ui.ddmanager.droppables[t.options.scope]||[],type=event?event.type:null,list=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();droppablesLoop:for(i=0;i<m.length;i++){if(m[i].options.disabled||(t&&!m[i].accept.call(m[i].element[0],(t.currentItem||t.element)))){continue;}
for(j=0;j<list.length;j++){if(list[j]===m[i].element[0]){m[i].proportions().height=0;continue droppablesLoop;}}
m[i].visible=m[i].element.css("display")!=="none";if(!m[i].visible){continue;}
if(type==="mousedown"){m[i]._activate.call(m[i],event);}
m[i].offset=m[i].element.offset();m[i].proportions({width:m[i].element[0].offsetWidth,height:m[i].element[0].offsetHeight});}},drop:function(draggable,event){var dropped=false;$.each(($.ui.ddmanager.droppables[draggable.options.scope]||[]).slice(),function(){if(!this.options){return;}
if(!this.options.disabled&&this.visible&&intersect(draggable,this,this.options.tolerance,event)){dropped=this._drop.call(this,event)||dropped;}
if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){this.isout=true;this.isover=false;this._deactivate.call(this,event);}});return dropped;},dragStart:function(draggable,event){draggable.element.parentsUntil("body").on("scroll.droppable",function(){if(!draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event);}});},drag:function(draggable,event){if(draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event);}
$.each($.ui.ddmanager.droppables[draggable.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return;}
var parentInstance,scope,parent,intersects=intersect(draggable,this,this.options.tolerance,event),c=!intersects&&this.isover?"isout":(intersects&&!this.isover?"isover":null);if(!c){return;}
if(this.options.greedy){scope=this.options.scope;parent=this.element.parents(":data(ui-droppable)").filter(function(){return $(this).droppable("instance").options.scope===scope;});if(parent.length){parentInstance=$(parent[0]).droppable("instance");parentInstance.greedyChild=(c==="isover");}}
if(parentInstance&&c==="isover"){parentInstance.isover=false;parentInstance.isout=true;parentInstance._out.call(parentInstance,event);}
this[c]=true;this[c==="isout"?"isover":"isout"]=false;this[c==="isover"?"_over":"_out"].call(this,event);if(parentInstance&&c==="isout"){parentInstance.isout=false;parentInstance.isover=true;parentInstance._over.call(parentInstance,event);}});},dragStop:function(draggable,event){draggable.element.parentsUntil("body").off("scroll.droppable");if(!draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event);}}};if($.uiBackCompat!==false){$.widget("ui.droppable",$.ui.droppable,{options:{hoverClass:false,activeClass:false},_addActiveClass:function(){this._super();if(this.options.activeClass){this.element.addClass(this.options.activeClass);}},_removeActiveClass:function(){this._super();if(this.options.activeClass){this.element.removeClass(this.options.activeClass);}},_addHoverClass:function(){this._super();if(this.options.hoverClass){this.element.addClass(this.options.hoverClass);}},_removeHoverClass:function(){this._super();if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass);}}});}
var widgetsDroppable=$.ui.droppable;var widgetsProgressbar=$.widget("ui.progressbar",{version:"1.12.1",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue();this.element.attr({role:"progressbar","aria-valuemin":this.min});this._addClass("ui-progressbar","ui-widget ui-widget-content");this.valueDiv=$("<div>").appendTo(this.element);this._addClass(this.valueDiv,"ui-progressbar-value","ui-widget-header");this._refreshValue();},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow");this.valueDiv.remove();},value:function(newValue){if(newValue===undefined){return this.options.value;}
this.options.value=this._constrainedValue(newValue);this._refreshValue();},_constrainedValue:function(newValue){if(newValue===undefined){newValue=this.options.value;}
this.indeterminate=newValue===false;if(typeof newValue!=="number"){newValue=0;}
return this.indeterminate?false:Math.min(this.options.max,Math.max(this.min,newValue));},_setOptions:function(options){var value=options.value;delete options.value;this._super(options);this.options.value=this._constrainedValue(value);this._refreshValue();},_setOption:function(key,value){if(key==="max"){value=Math.max(this.min,value);}
this._super(key,value);},_setOptionDisabled:function(value){this._super(value);this.element.attr("aria-disabled",value);this._toggleClass(null,"ui-state-disabled",!!value);},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min);},_refreshValue:function(){var value=this.options.value,percentage=this._percentage();this.valueDiv.toggle(this.indeterminate||value>this.min).width(percentage.toFixed(0)+"%");this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,value===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate);if(this.indeterminate){this.element.removeAttr("aria-valuenow");if(!this.overlayDiv){this.overlayDiv=$("<div>").appendTo(this.valueDiv);this._addClass(this.overlayDiv,"ui-progressbar-overlay");}}else{this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":value});if(this.overlayDiv){this.overlayDiv.remove();this.overlayDiv=null;}}
if(this.oldValue!==value){this.oldValue=value;this._trigger("change");}
if(value===this.options.max){this._trigger("complete");}}});var widgetsSelectable=$.widget("ui.selectable",$.ui.mouse,{version:"1.12.1",options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var that=this;this._addClass("ui-selectable");this.dragged=false;this.refresh=function(){that.elementPos=$(that.element[0]).offset();that.selectees=$(that.options.filter,that.element[0]);that._addClass(that.selectees,"ui-selectee");that.selectees.each(function(){var $this=$(this),selecteeOffset=$this.offset(),pos={left:selecteeOffset.left-that.elementPos.left,top:selecteeOffset.top-that.elementPos.top};$.data(this,"selectable-item",{element:this,$element:$this,left:pos.left,top:pos.top,right:pos.left+$this.outerWidth(),bottom:pos.top+$this.outerHeight(),startselected:false,selected:$this.hasClass("ui-selected"),selecting:$this.hasClass("ui-selecting"),unselecting:$this.hasClass("ui-unselecting")});});};this.refresh();this._mouseInit();this.helper=$("<div>");this._addClass(this.helper,"ui-selectable-helper");},_destroy:function(){this.selectees.removeData("selectable-item");this._mouseDestroy();},_mouseStart:function(event){var that=this,options=this.options;this.opos=[event.pageX,event.pageY];this.elementPos=$(this.element[0]).offset();if(this.options.disabled){return;}
this.selectees=$(options.filter,this.element[0]);this._trigger("start",event);$(options.appendTo).append(this.helper);this.helper.css({"left":event.pageX,"top":event.pageY,"width":0,"height":0});if(options.autoRefresh){this.refresh();}
this.selectees.filter(".ui-selected").each(function(){var selectee=$.data(this,"selectable-item");selectee.startselected=true;if(!event.metaKey&&!event.ctrlKey){that._removeClass(selectee.$element,"ui-selected");selectee.selected=false;that._addClass(selectee.$element,"ui-unselecting");selectee.unselecting=true;that._trigger("unselecting",event,{unselecting:selectee.element});}});$(event.target).parents().addBack().each(function(){var doSelect,selectee=$.data(this,"selectable-item");if(selectee){doSelect=(!event.metaKey&&!event.ctrlKey)||!selectee.$element.hasClass("ui-selected");that._removeClass(selectee.$element,doSelect?"ui-unselecting":"ui-selected")._addClass(selectee.$element,doSelect?"ui-selecting":"ui-unselecting");selectee.unselecting=!doSelect;selectee.selecting=doSelect;selectee.selected=doSelect;if(doSelect){that._trigger("selecting",event,{selecting:selectee.element});}else{that._trigger("unselecting",event,{unselecting:selectee.element});}
return false;}});},_mouseDrag:function(event){this.dragged=true;if(this.options.disabled){return;}
var tmp,that=this,options=this.options,x1=this.opos[0],y1=this.opos[1],x2=event.pageX,y2=event.pageY;if(x1>x2){tmp=x2;x2=x1;x1=tmp;}
if(y1>y2){tmp=y2;y2=y1;y1=tmp;}
this.helper.css({left:x1,top:y1,width:x2-x1,height:y2-y1});this.selectees.each(function(){var selectee=$.data(this,"selectable-item"),hit=false,offset={};if(!selectee||selectee.element===that.element[0]){return;}
offset.left=selectee.left+that.elementPos.left;offset.right=selectee.right+that.elementPos.left;offset.top=selectee.top+that.elementPos.top;offset.bottom=selectee.bottom+that.elementPos.top;if(options.tolerance==="touch"){hit=(!(offset.left>x2||offset.right<x1||offset.top>y2||offset.bottom<y1));}else if(options.tolerance==="fit"){hit=(offset.left>x1&&offset.right<x2&&offset.top>y1&&offset.bottom<y2);}
if(hit){if(selectee.selected){that._removeClass(selectee.$element,"ui-selected");selectee.selected=false;}
if(selectee.unselecting){that._removeClass(selectee.$element,"ui-unselecting");selectee.unselecting=false;}
if(!selectee.selecting){that._addClass(selectee.$element,"ui-selecting");selectee.selecting=true;that._trigger("selecting",event,{selecting:selectee.element});}}else{if(selectee.selecting){if((event.metaKey||event.ctrlKey)&&selectee.startselected){that._removeClass(selectee.$element,"ui-selecting");selectee.selecting=false;that._addClass(selectee.$element,"ui-selected");selectee.selected=true;}else{that._removeClass(selectee.$element,"ui-selecting");selectee.selecting=false;if(selectee.startselected){that._addClass(selectee.$element,"ui-unselecting");selectee.unselecting=true;}
that._trigger("unselecting",event,{unselecting:selectee.element});}}
if(selectee.selected){if(!event.metaKey&&!event.ctrlKey&&!selectee.startselected){that._removeClass(selectee.$element,"ui-selected");selectee.selected=false;that._addClass(selectee.$element,"ui-unselecting");selectee.unselecting=true;that._trigger("unselecting",event,{unselecting:selectee.element});}}}});return false;},_mouseStop:function(event){var that=this;this.dragged=false;$(".ui-unselecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");that._removeClass(selectee.$element,"ui-unselecting");selectee.unselecting=false;selectee.startselected=false;that._trigger("unselected",event,{unselected:selectee.element});});$(".ui-selecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");that._removeClass(selectee.$element,"ui-selecting")._addClass(selectee.$element,"ui-selected");selectee.selecting=false;selectee.selected=true;selectee.startselected=true;that._trigger("selected",event,{selected:selectee.element});});this._trigger("stop",event);this.helper.remove();return false;}});var widgetsSelectmenu=$.widget("ui.selectmenu",[$.ui.formResetMixin,{version:"1.12.1",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:false,change:null,close:null,focus:null,open:null,select:null},_create:function(){var selectmenuId=this.element.uniqueId().attr("id");this.ids={element:selectmenuId,button:selectmenuId+"-button",menu:selectmenuId+"-menu"};this._drawButton();this._drawMenu();this._bindFormResetHandler();this._rendered=false;this.menuItems=$();},_drawButton:function(){var icon,that=this,item=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button);this._on(this.labels,{click:function(event){this.button.focus();event.preventDefault();}});this.element.hide();this.button=$("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element);this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget");icon=$("<span>").appendTo(this.button);this._addClass(icon,"ui-selectmenu-icon","ui-icon "+this.options.icons.button);this.buttonItem=this._renderButtonItem(item).appendTo(this.button);if(this.options.width!==false){this._resizeButton();}
this._on(this.button,this._buttonEvents);this.button.one("focusin",function(){if(!that._rendered){that._refreshMenu();}});},_drawMenu:function(){var that=this;this.menu=$("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu});this.menuWrap=$("<div>").append(this.menu);this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front");this.menuWrap.appendTo(this._appendTo());this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(event,ui){event.preventDefault();that._setSelection();that._select(ui.item.data("ui-selectmenu-item"),event);},focus:function(event,ui){var item=ui.item.data("ui-selectmenu-item");if(that.focusIndex!=null&&item.index!==that.focusIndex){that._trigger("focus",event,{item:item});if(!that.isOpen){that._select(item,event);}}
that.focusIndex=item.index;that.button.attr("aria-activedescendant",that.menuItems.eq(item.index).attr("id"));}}).menu("instance");this.menuInstance._off(this.menu,"mouseleave");this.menuInstance._closeOnDocumentClick=function(){return false;};this.menuInstance._isDivider=function(){return false;};},refresh:function(){this._refreshMenu();this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{}));if(this.options.width===null){this._resizeButton();}},_refreshMenu:function(){var item,options=this.element.find("option");this.menu.empty();this._parseOptions(options);this._renderMenu(this.menu,this.items);this.menuInstance.refresh();this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper");this._rendered=true;if(!options.length){return;}
item=this._getSelectedItem();this.menuInstance.focus(null,item);this._setAria(item.data("ui-selectmenu-item"));this._setOption("disabled",this.element.prop("disabled"));},open:function(event){if(this.options.disabled){return;}
if(!this._rendered){this._refreshMenu();}else{this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active");this.menuInstance.focus(null,this._getSelectedItem());}
if(!this.menuItems.length){return;}
this.isOpen=true;this._toggleAttr();this._resizeMenu();this._position();this._on(this.document,this._documentClick);this._trigger("open",event);},_position:function(){this.menuWrap.position($.extend({of:this.button},this.options.position));},close:function(event){if(!this.isOpen){return;}
this.isOpen=false;this._toggleAttr();this.range=null;this._off(this.document);this._trigger("close",event);},widget:function(){return this.button;},menuWidget:function(){return this.menu;},_renderButtonItem:function(item){var buttonItem=$("<span>");this._setText(buttonItem,item.label);this._addClass(buttonItem,"ui-selectmenu-text");return buttonItem;},_renderMenu:function(ul,items){var that=this,currentOptgroup="";$.each(items,function(index,item){var li;if(item.optgroup!==currentOptgroup){li=$("<li>",{text:item.optgroup});that._addClass(li,"ui-selectmenu-optgroup","ui-menu-divider"+
(item.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""));li.appendTo(ul);currentOptgroup=item.optgroup;}
that._renderItemData(ul,item);});},_renderItemData:function(ul,item){return this._renderItem(ul,item).data("ui-selectmenu-item",item);},_renderItem:function(ul,item){var li=$("<li>"),wrapper=$("<div>",{title:item.element.attr("title")});if(item.disabled){this._addClass(li,null,"ui-state-disabled");}
this._setText(wrapper,item.label);return li.append(wrapper).appendTo(ul);},_setText:function(element,value){if(value){element.text(value);}else{element.html("&#160;");}},_move:function(direction,event){var item,next,filter=".ui-menu-item";if(this.isOpen){item=this.menuItems.eq(this.focusIndex).parent("li");}else{item=this.menuItems.eq(this.element[0].selectedIndex).parent("li");filter+=":not(.ui-state-disabled)";}
if(direction==="first"||direction==="last"){next=item[direction==="first"?"prevAll":"nextAll"](filter).eq(-1);}else{next=item[direction+"All"](filter).eq(0);}
if(next.length){this.menuInstance.focus(event,next);}},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li");},_toggle:function(event){this[this.isOpen?"close":"open"](event);},_setSelection:function(){var selection;if(!this.range){return;}
if(window.getSelection){selection=window.getSelection();selection.removeAllRanges();selection.addRange(this.range);}else{this.range.select();}
this.button.focus();},_documentClick:{mousedown:function(event){if(!this.isOpen){return;}
if(!$(event.target).closest(".ui-selectmenu-menu, #"+
$.ui.escapeSelector(this.ids.button)).length){this.close(event);}}},_buttonEvents:{mousedown:function(){var selection;if(window.getSelection){selection=window.getSelection();if(selection.rangeCount){this.range=selection.getRangeAt(0);}}else{this.range=document.selection.createRange();}},click:function(event){this._setSelection();this._toggle(event);},keydown:function(event){var preventDefault=true;switch(event.keyCode){case $.ui.keyCode.TAB:case $.ui.keyCode.ESCAPE:this.close(event);preventDefault=false;break;case $.ui.keyCode.ENTER:if(this.isOpen){this._selectFocusedItem(event);}
break;case $.ui.keyCode.UP:if(event.altKey){this._toggle(event);}else{this._move("prev",event);}
break;case $.ui.keyCode.DOWN:if(event.altKey){this._toggle(event);}else{this._move("next",event);}
break;case $.ui.keyCode.SPACE:if(this.isOpen){this._selectFocusedItem(event);}else{this._toggle(event);}
break;case $.ui.keyCode.LEFT:this._move("prev",event);break;case $.ui.keyCode.RIGHT:this._move("next",event);break;case $.ui.keyCode.HOME:case $.ui.keyCode.PAGE_UP:this._move("first",event);break;case $.ui.keyCode.END:case $.ui.keyCode.PAGE_DOWN:this._move("last",event);break;default:this.menu.trigger(event);preventDefault=false;}
if(preventDefault){event.preventDefault();}}},_selectFocusedItem:function(event){var item=this.menuItems.eq(this.focusIndex).parent("li");if(!item.hasClass("ui-state-disabled")){this._select(item.data("ui-selectmenu-item"),event);}},_select:function(item,event){var oldIndex=this.element[0].selectedIndex;this.element[0].selectedIndex=item.index;this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(item));this._setAria(item);this._trigger("select",event,{item:item});if(item.index!==oldIndex){this._trigger("change",event,{item:item});}
this.close(event);},_setAria:function(item){var id=this.menuItems.eq(item.index).attr("id");this.button.attr({"aria-labelledby":id,"aria-activedescendant":id});this.menu.attr("aria-activedescendant",id);},_setOption:function(key,value){if(key==="icons"){var icon=this.button.find("span.ui-icon");this._removeClass(icon,null,this.options.icons.button)._addClass(icon,null,value.button);}
this._super(key,value);if(key==="appendTo"){this.menuWrap.appendTo(this._appendTo());}
if(key==="width"){this._resizeButton();}},_setOptionDisabled:function(value){this._super(value);this.menuInstance.option("disabled",value);this.button.attr("aria-disabled",value);this._toggleClass(this.button,null,"ui-state-disabled",value);this.element.prop("disabled",value);if(value){this.button.attr("tabindex",-1);this.close();}else{this.button.attr("tabindex",0);}},_appendTo:function(){var element=this.options.appendTo;if(element){element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0);}
if(!element||!element[0]){element=this.element.closest(".ui-front, dialog");}
if(!element.length){element=this.document[0].body;}
return element;},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen);this._removeClass(this.button,"ui-selectmenu-button-"+
(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+
(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen);this.menu.attr("aria-hidden",!this.isOpen);},_resizeButton:function(){var width=this.options.width;if(width===false){this.button.css("width","");return;}
if(width===null){width=this.element.show().outerWidth();this.element.hide();}
this.button.outerWidth(width);},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1));},_getCreateOptions:function(){var options=this._super();options.disabled=this.element.prop("disabled");return options;},_parseOptions:function(options){var that=this,data=[];options.each(function(index,item){data.push(that._parseOption($(item),index));});this.items=data;},_parseOption:function(option,index){var optgroup=option.parent("optgroup");return{element:option,index:index,value:option.val(),label:option.text(),optgroup:optgroup.attr("label")||"",disabled:optgroup.prop("disabled")||option.prop("disabled")};},_destroy:function(){this._unbindFormResetHandler();this.menuWrap.remove();this.button.remove();this.element.show();this.element.removeUniqueId();this.labels.attr("for",this.ids.element);}}]);var widgetsSlider=$.widget("ui.slider",$.ui.mouse,{version:"1.12.1",widgetEventPrefix:"slide",options:{animate:false,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this._calculateNewMax();this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content");this._refresh();this._animateOff=false;},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue();},_createHandles:function(){var i,handleCount,options=this.options,existingHandles=this.element.find(".ui-slider-handle"),handle="<span tabindex='0'></span>",handles=[];handleCount=(options.values&&options.values.length)||1;if(existingHandles.length>handleCount){existingHandles.slice(handleCount).remove();existingHandles=existingHandles.slice(0,handleCount);}
for(i=existingHandles.length;i<handleCount;i++){handles.push(handle);}
this.handles=existingHandles.add($(handles.join("")).appendTo(this.element));this._addClass(this.handles,"ui-slider-handle","ui-state-default");this.handle=this.handles.eq(0);this.handles.each(function(i){$(this).data("ui-slider-handle-index",i).attr("tabIndex",0);});},_createRange:function(){var options=this.options;if(options.range){if(options.range===true){if(!options.values){options.values=[this._valueMin(),this._valueMin()];}else if(options.values.length&&options.values.length!==2){options.values=[options.values[0],options.values[0]];}else if($.isArray(options.values)){options.values=options.values.slice(0);}}
if(!this.range||!this.range.length){this.range=$("<div>").appendTo(this.element);this._addClass(this.range,"ui-slider-range");}else{this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max");this.range.css({"left":"","bottom":""});}
if(options.range==="min"||options.range==="max"){this._addClass(this.range,"ui-slider-range-"+options.range);}}else{if(this.range){this.range.remove();}
this.range=null;}},_setupEvents:function(){this._off(this.handles);this._on(this.handles,this._handleEvents);this._hoverable(this.handles);this._focusable(this.handles);},_destroy:function(){this.handles.remove();if(this.range){this.range.remove();}
this._mouseDestroy();},_mouseCapture:function(event){var position,normValue,distance,closestHandle,index,allowed,offset,mouseOverHandle,that=this,o=this.options;if(o.disabled){return false;}
this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();position={x:event.pageX,y:event.pageY};normValue=this._normValueFromMouse(position);distance=this._valueMax()-this._valueMin()+1;this.handles.each(function(i){var thisDistance=Math.abs(normValue-that.values(i));if((distance>thisDistance)||(distance===thisDistance&&(i===that._lastChangedValue||that.values(i)===o.min))){distance=thisDistance;closestHandle=$(this);index=i;}});allowed=this._start(event,index);if(allowed===false){return false;}
this._mouseSliding=true;this._handleIndex=index;this._addClass(closestHandle,null,"ui-state-active");closestHandle.trigger("focus");offset=closestHandle.offset();mouseOverHandle=!$(event.target).parents().addBack().is(".ui-slider-handle");this._clickOffset=mouseOverHandle?{left:0,top:0}:{left:event.pageX-offset.left-(closestHandle.width()/2),top:event.pageY-offset.top-
(closestHandle.height()/2)-
(parseInt(closestHandle.css("borderTopWidth"),10)||0)-
(parseInt(closestHandle.css("borderBottomWidth"),10)||0)+
(parseInt(closestHandle.css("marginTop"),10)||0)};if(!this.handles.hasClass("ui-state-hover")){this._slide(event,index,normValue);}
this._animateOff=true;return true;},_mouseStart:function(){return true;},_mouseDrag:function(event){var position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position);this._slide(event,this._handleIndex,normValue);return false;},_mouseStop:function(event){this._removeClass(this.handles,null,"ui-state-active");this._mouseSliding=false;this._stop(event,this._handleIndex);this._change(event,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false;},_detectOrientation:function(){this.orientation=(this.options.orientation==="vertical")?"vertical":"horizontal";},_normValueFromMouse:function(position){var pixelTotal,pixelMouse,percentMouse,valueTotal,valueMouse;if(this.orientation==="horizontal"){pixelTotal=this.elementSize.width;pixelMouse=position.x-this.elementOffset.left-
(this._clickOffset?this._clickOffset.left:0);}else{pixelTotal=this.elementSize.height;pixelMouse=position.y-this.elementOffset.top-
(this._clickOffset?this._clickOffset.top:0);}
percentMouse=(pixelMouse/pixelTotal);if(percentMouse>1){percentMouse=1;}
if(percentMouse<0){percentMouse=0;}
if(this.orientation==="vertical"){percentMouse=1-percentMouse;}
valueTotal=this._valueMax()-this._valueMin();valueMouse=this._valueMin()+percentMouse*valueTotal;return this._trimAlignValue(valueMouse);},_uiHash:function(index,value,values){var uiHash={handle:this.handles[index],handleIndex:index,value:value!==undefined?value:this.value()};if(this._hasMultipleValues()){uiHash.value=value!==undefined?value:this.values(index);uiHash.values=values||this.values();}
return uiHash;},_hasMultipleValues:function(){return this.options.values&&this.options.values.length;},_start:function(event,index){return this._trigger("start",event,this._uiHash(index));},_slide:function(event,index,newVal){var allowed,otherVal,currentValue=this.value(),newValues=this.values();if(this._hasMultipleValues()){otherVal=this.values(index?0:1);currentValue=this.values(index);if(this.options.values.length===2&&this.options.range===true){newVal=index===0?Math.min(otherVal,newVal):Math.max(otherVal,newVal);}
newValues[index]=newVal;}
if(newVal===currentValue){return;}
allowed=this._trigger("slide",event,this._uiHash(index,newVal,newValues));if(allowed===false){return;}
if(this._hasMultipleValues()){this.values(index,newVal);}else{this.value(newVal);}},_stop:function(event,index){this._trigger("stop",event,this._uiHash(index));},_change:function(event,index){if(!this._keySliding&&!this._mouseSliding){this._lastChangedValue=index;this._trigger("change",event,this._uiHash(index));}},value:function(newValue){if(arguments.length){this.options.value=this._trimAlignValue(newValue);this._refreshValue();this._change(null,0);return;}
return this._value();},values:function(index,newValue){var vals,newValues,i;if(arguments.length>1){this.options.values[index]=this._trimAlignValue(newValue);this._refreshValue();this._change(null,index);return;}
if(arguments.length){if($.isArray(arguments[0])){vals=this.options.values;newValues=arguments[0];for(i=0;i<vals.length;i+=1){vals[i]=this._trimAlignValue(newValues[i]);this._change(null,i);}
this._refreshValue();}else{if(this._hasMultipleValues()){return this._values(index);}else{return this.value();}}}else{return this._values();}},_setOption:function(key,value){var i,valsLength=0;if(key==="range"&&this.options.range===true){if(value==="min"){this.options.value=this._values(0);this.options.values=null;}else if(value==="max"){this.options.value=this._values(this.options.values.length-1);this.options.values=null;}}
if($.isArray(this.options.values)){valsLength=this.options.values.length;}
this._super(key,value);switch(key){case"orientation":this._detectOrientation();this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation);this._refreshValue();if(this.options.range){this._refreshRange(value);}
this.handles.css(value==="horizontal"?"bottom":"left","");break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(i=valsLength-1;i>=0;i--){this._change(null,i);}
this._animateOff=false;break;case"step":case"min":case"max":this._animateOff=true;this._calculateNewMax();this._refreshValue();this._animateOff=false;break;case"range":this._animateOff=true;this._refresh();this._animateOff=false;break;}},_setOptionDisabled:function(value){this._super(value);this._toggleClass(null,"ui-state-disabled",!!value);},_value:function(){var val=this.options.value;val=this._trimAlignValue(val);return val;},_values:function(index){var val,vals,i;if(arguments.length){val=this.options.values[index];val=this._trimAlignValue(val);return val;}else if(this._hasMultipleValues()){vals=this.options.values.slice();for(i=0;i<vals.length;i+=1){vals[i]=this._trimAlignValue(vals[i]);}
return vals;}else{return[];}},_trimAlignValue:function(val){if(val<=this._valueMin()){return this._valueMin();}
if(val>=this._valueMax()){return this._valueMax();}
var step=(this.options.step>0)?this.options.step:1,valModStep=(val-this._valueMin())%step,alignValue=val-valModStep;if(Math.abs(valModStep)*2>=step){alignValue+=(valModStep>0)?step:(-step);}
return parseFloat(alignValue.toFixed(5));},_calculateNewMax:function(){var max=this.options.max,min=this._valueMin(),step=this.options.step,aboveMin=Math.round((max-min)/step)*step;max=aboveMin+min;if(max>this.options.max){max-=step;}
this.max=parseFloat(max.toFixed(this._precision()));},_precision:function(){var precision=this._precisionOf(this.options.step);if(this.options.min!==null){precision=Math.max(precision,this._precisionOf(this.options.min));}
return precision;},_precisionOf:function(num){var str=num.toString(),decimal=str.indexOf(".");return decimal===-1?0:str.length-decimal-1;},_valueMin:function(){return this.options.min;},_valueMax:function(){return this.max;},_refreshRange:function(orientation){if(orientation==="vertical"){this.range.css({"width":"","left":""});}
if(orientation==="horizontal"){this.range.css({"height":"","bottom":""});}},_refreshValue:function(){var lastValPercent,valPercent,value,valueMin,valueMax,oRange=this.options.range,o=this.options,that=this,animate=(!this._animateOff)?o.animate:false,_set={};if(this._hasMultipleValues()){this.handles.each(function(i){valPercent=(that.values(i)-that._valueMin())/(that._valueMax()-
that._valueMin())*100;_set[that.orientation==="horizontal"?"left":"bottom"]=valPercent+"%";$(this).stop(1,1)[animate?"animate":"css"](_set,o.animate);if(that.options.range===true){if(that.orientation==="horizontal"){if(i===0){that.range.stop(1,1)[animate?"animate":"css"]({left:valPercent+"%"},o.animate);}
if(i===1){that.range[animate?"animate":"css"]({width:(valPercent-lastValPercent)+"%"},{queue:false,duration:o.animate});}}else{if(i===0){that.range.stop(1,1)[animate?"animate":"css"]({bottom:(valPercent)+"%"},o.animate);}
if(i===1){that.range[animate?"animate":"css"]({height:(valPercent-lastValPercent)+"%"},{queue:false,duration:o.animate});}}}
lastValPercent=valPercent;});}else{value=this.value();valueMin=this._valueMin();valueMax=this._valueMax();valPercent=(valueMax!==valueMin)?(value-valueMin)/(valueMax-valueMin)*100:0;_set[this.orientation==="horizontal"?"left":"bottom"]=valPercent+"%";this.handle.stop(1,1)[animate?"animate":"css"](_set,o.animate);if(oRange==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[animate?"animate":"css"]({width:valPercent+"%"},o.animate);}
if(oRange==="max"&&this.orientation==="horizontal"){this.range.stop(1,1)[animate?"animate":"css"]({width:(100-valPercent)+"%"},o.animate);}
if(oRange==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[animate?"animate":"css"]({height:valPercent+"%"},o.animate);}
if(oRange==="max"&&this.orientation==="vertical"){this.range.stop(1,1)[animate?"animate":"css"]({height:(100-valPercent)+"%"},o.animate);}}},_handleEvents:{keydown:function(event){var allowed,curVal,newVal,step,index=$(event.target).data("ui-slider-handle-index");switch(event.keyCode){case $.ui.keyCode.HOME:case $.ui.keyCode.END:case $.ui.keyCode.PAGE_UP:case $.ui.keyCode.PAGE_DOWN:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:event.preventDefault();if(!this._keySliding){this._keySliding=true;this._addClass($(event.target),null,"ui-state-active");allowed=this._start(event,index);if(allowed===false){return;}}
break;}
step=this.options.step;if(this._hasMultipleValues()){curVal=newVal=this.values(index);}else{curVal=newVal=this.value();}
switch(event.keyCode){case $.ui.keyCode.HOME:newVal=this._valueMin();break;case $.ui.keyCode.END:newVal=this._valueMax();break;case $.ui.keyCode.PAGE_UP:newVal=this._trimAlignValue(curVal+((this._valueMax()-this._valueMin())/this.numPages));break;case $.ui.keyCode.PAGE_DOWN:newVal=this._trimAlignValue(curVal-((this._valueMax()-this._valueMin())/this.numPages));break;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:if(curVal===this._valueMax()){return;}
newVal=this._trimAlignValue(curVal+step);break;case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(curVal===this._valueMin()){return;}
newVal=this._trimAlignValue(curVal-step);break;}
this._slide(event,index,newVal);},keyup:function(event){var index=$(event.target).data("ui-slider-handle-index");if(this._keySliding){this._keySliding=false;this._stop(event,index);this._change(event,index);this._removeClass($(event.target),null,"ui-state-active");}}}});var widgetsSortable=$.widget("ui.sortable",$.ui.mouse,{version:"1.12.1",widgetEventPrefix:"sort",ready:false,options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(x,reference,size){return(x>=reference)&&(x<(reference+size));},_isFloating:function(item){return(/left|right/).test(item.css("float"))||(/inline|table-cell/).test(item.css("display"));},_create:function(){this.containerCache={};this._addClass("ui-sortable");this.refresh();this.offset=this.element.offset();this._mouseInit();this._setHandleClassName();this.ready=true;},_setOption:function(key,value){this._super(key,value);if(key==="handle"){this._setHandleClassName();}},_setHandleClassName:function(){var that=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle");$.each(this.items,function(){that._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle");});},_destroy:function(){this._mouseDestroy();for(var i=this.items.length-1;i>=0;i--){this.items[i].item.removeData(this.widgetName+"-item");}
return this;},_mouseCapture:function(event,overrideHandle){var currentItem=null,validHandle=false,that=this;if(this.reverting){return false;}
if(this.options.disabled||this.options.type==="static"){return false;}
this._refreshItems(event);$(event.target).parents().each(function(){if($.data(this,that.widgetName+"-item")===that){currentItem=$(this);return false;}});if($.data(event.target,that.widgetName+"-item")===that){currentItem=$(event.target);}
if(!currentItem){return false;}
if(this.options.handle&&!overrideHandle){$(this.options.handle,currentItem).find("*").addBack().each(function(){if(this===event.target){validHandle=true;}});if(!validHandle){return false;}}
this.currentItem=currentItem;this._removeCurrentsFromItems();return true;},_mouseStart:function(event,overrideHandle,noActivation){var i,body,o=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(event);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(event);this.originalPageX=event.pageX;this.originalPageY=event.pageY;(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!==this.currentItem[0]){this.currentItem.hide();}
this._createPlaceholder();if(o.containment){this._setContainment();}
if(o.cursor&&o.cursor!=="auto"){body=this.document.find("body");this.storedCursor=body.css("cursor");body.css("cursor",o.cursor);this.storedStylesheet=$("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(body);}
if(o.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity");}
this.helper.css("opacity",o.opacity);}
if(o.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex");}
this.helper.css("zIndex",o.zIndex);}
if(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"){this.overflowOffset=this.scrollParent.offset();}
this._trigger("start",event,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions();}
if(!noActivation){for(i=this.containers.length-1;i>=0;i--){this.containers[i]._trigger("activate",event,this._uiHash(this));}}
if($.ui.ddmanager){$.ui.ddmanager.current=this;}
if($.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event);}
this.dragging=true;this._addClass(this.helper,"ui-sortable-helper");this._mouseDrag(event);return true;},_mouseDrag:function(event){var i,item,itemElement,intersection,o=this.options,scrolled=false;this.position=this._generatePosition(event);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs;}
if(this.options.scroll){if(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"){if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-
event.pageY<o.scrollSensitivity){this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop+o.scrollSpeed;}else if(event.pageY-this.overflowOffset.top<o.scrollSensitivity){this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop-o.scrollSpeed;}
if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-
event.pageX<o.scrollSensitivity){this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft+o.scrollSpeed;}else if(event.pageX-this.overflowOffset.left<o.scrollSensitivity){this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft-o.scrollSpeed;}}else{if(event.pageY-this.document.scrollTop()<o.scrollSensitivity){scrolled=this.document.scrollTop(this.document.scrollTop()-o.scrollSpeed);}else if(this.window.height()-(event.pageY-this.document.scrollTop())<o.scrollSensitivity){scrolled=this.document.scrollTop(this.document.scrollTop()+o.scrollSpeed);}
if(event.pageX-this.document.scrollLeft()<o.scrollSensitivity){scrolled=this.document.scrollLeft(this.document.scrollLeft()-o.scrollSpeed);}else if(this.window.width()-(event.pageX-this.document.scrollLeft())<o.scrollSensitivity){scrolled=this.document.scrollLeft(this.document.scrollLeft()+o.scrollSpeed);}}
if(scrolled!==false&&$.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event);}}
this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px";}
if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px";}
for(i=this.items.length-1;i>=0;i--){item=this.items[i];itemElement=item.item[0];intersection=this._intersectsWithPointer(item);if(!intersection){continue;}
if(item.instance!==this.currentContainer){continue;}
if(itemElement!==this.currentItem[0]&&this.placeholder[intersection===1?"next":"prev"]()[0]!==itemElement&&!$.contains(this.placeholder[0],itemElement)&&(this.options.type==="semi-dynamic"?!$.contains(this.element[0],itemElement):true)){this.direction=intersection===1?"down":"up";if(this.options.tolerance==="pointer"||this._intersectsWithSides(item)){this._rearrange(event,item);}else{break;}
this._trigger("change",event,this._uiHash());break;}}
this._contactContainers(event);if($.ui.ddmanager){$.ui.ddmanager.drag(this,event);}
this._trigger("sort",event,this._uiHash());this.lastPositionAbs=this.positionAbs;return false;},_mouseStop:function(event,noPropagation){if(!event){return;}
if($.ui.ddmanager&&!this.options.dropBehaviour){$.ui.ddmanager.drop(this,event);}
if(this.options.revert){var that=this,cur=this.placeholder.offset(),axis=this.options.axis,animation={};if(!axis||axis==="x"){animation.left=cur.left-this.offset.parent.left-this.margins.left+
(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft);}
if(!axis||axis==="y"){animation.top=cur.top-this.offset.parent.top-this.margins.top+
(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop);}
this.reverting=true;$(this.helper).animate(animation,parseInt(this.options.revert,10)||500,function(){that._clear(event);});}else{this._clear(event,noPropagation);}
return false;},cancel:function(){if(this.dragging){this._mouseUp(new $.Event("mouseup",{target:null}));if(this.options.helper==="original"){this.currentItem.css(this._storedCSS);this._removeClass(this.currentItem,"ui-sortable-helper");}else{this.currentItem.show();}
for(var i=this.containers.length-1;i>=0;i--){this.containers[i]._trigger("deactivate",null,this._uiHash(this));if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",null,this._uiHash(this));this.containers[i].containerCache.over=0;}}}
if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0]);}
if(this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove();}
$.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){$(this.domPosition.prev).after(this.currentItem);}else{$(this.domPosition.parent).prepend(this.currentItem);}}
return this;},serialize:function(o){var items=this._getItemsAsjQuery(o&&o.connected),str=[];o=o||{};$(items).each(function(){var res=($(o.item||this).attr(o.attribute||"id")||"").match(o.expression||(/(.+)[\-=_](.+)/));if(res){str.push((o.key||res[1]+"[]")+"="+(o.key&&o.expression?res[1]:res[2]));}});if(!str.length&&o.key){str.push(o.key+"=");}
return str.join("&");},toArray:function(o){var items=this._getItemsAsjQuery(o&&o.connected),ret=[];o=o||{};items.each(function(){ret.push($(o.item||this).attr(o.attribute||"id")||"");});return ret;},_intersectsWith:function(item){var x1=this.positionAbs.left,x2=x1+this.helperProportions.width,y1=this.positionAbs.top,y2=y1+this.helperProportions.height,l=item.left,r=l+item.width,t=item.top,b=t+item.height,dyClick=this.offset.click.top,dxClick=this.offset.click.left,isOverElementHeight=(this.options.axis==="x")||((y1+dyClick)>t&&(y1+dyClick)<b),isOverElementWidth=(this.options.axis==="y")||((x1+dxClick)>l&&(x1+dxClick)<r),isOverElement=isOverElementHeight&&isOverElementWidth;if(this.options.tolerance==="pointer"||this.options.forcePointerForContainers||(this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>item[this.floating?"width":"height"])){return isOverElement;}else{return(l<x1+(this.helperProportions.width/2)&&x2-(this.helperProportions.width/2)<r&&t<y1+(this.helperProportions.height/2)&&y2-(this.helperProportions.height/2)<b);}},_intersectsWithPointer:function(item){var verticalDirection,horizontalDirection,isOverElementHeight=(this.options.axis==="x")||this._isOverAxis(this.positionAbs.top+this.offset.click.top,item.top,item.height),isOverElementWidth=(this.options.axis==="y")||this._isOverAxis(this.positionAbs.left+this.offset.click.left,item.left,item.width),isOverElement=isOverElementHeight&&isOverElementWidth;if(!isOverElement){return false;}
verticalDirection=this._getDragVerticalDirection();horizontalDirection=this._getDragHorizontalDirection();return this.floating?((horizontalDirection==="right"||verticalDirection==="down")?2:1):(verticalDirection&&(verticalDirection==="down"?2:1));},_intersectsWithSides:function(item){var isOverBottomHalf=this._isOverAxis(this.positionAbs.top+
this.offset.click.top,item.top+(item.height/2),item.height),isOverRightHalf=this._isOverAxis(this.positionAbs.left+
this.offset.click.left,item.left+(item.width/2),item.width),verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();if(this.floating&&horizontalDirection){return((horizontalDirection==="right"&&isOverRightHalf)||(horizontalDirection==="left"&&!isOverRightHalf));}else{return verticalDirection&&((verticalDirection==="down"&&isOverBottomHalf)||(verticalDirection==="up"&&!isOverBottomHalf));}},_getDragVerticalDirection:function(){var delta=this.positionAbs.top-this.lastPositionAbs.top;return delta!==0&&(delta>0?"down":"up");},_getDragHorizontalDirection:function(){var delta=this.positionAbs.left-this.lastPositionAbs.left;return delta!==0&&(delta>0?"right":"left");},refresh:function(event){this._refreshItems(event);this._setHandleClassName();this.refreshPositions();return this;},_connectWith:function(){var options=this.options;return options.connectWith.constructor===String?[options.connectWith]:options.connectWith;},_getItemsAsjQuery:function(connected){var i,j,cur,inst,items=[],queries=[],connectWith=this._connectWith();if(connectWith&&connected){for(i=connectWith.length-1;i>=0;i--){cur=$(connectWith[i],this.document[0]);for(j=cur.length-1;j>=0;j--){inst=$.data(cur[j],this.widgetFullName);if(inst&&inst!==this&&!inst.options.disabled){queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element):$(inst.options.items,inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),inst]);}}}}
queries.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);function addItems(){items.push(this);}
for(i=queries.length-1;i>=0;i--){queries[i][0].each(addItems);}
return $(items);},_removeCurrentsFromItems:function(){var list=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=$.grep(this.items,function(item){for(var j=0;j<list.length;j++){if(list[j]===item.item[0]){return false;}}
return true;});},_refreshItems:function(event){this.items=[];this.containers=[this];var i,j,cur,inst,targetData,_queries,item,queriesLength,items=this.items,queries=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],event,{item:this.currentItem}):$(this.options.items,this.element),this]],connectWith=this._connectWith();if(connectWith&&this.ready){for(i=connectWith.length-1;i>=0;i--){cur=$(connectWith[i],this.document[0]);for(j=cur.length-1;j>=0;j--){inst=$.data(cur[j],this.widgetFullName);if(inst&&inst!==this&&!inst.options.disabled){queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element[0],event,{item:this.currentItem}):$(inst.options.items,inst.element),inst]);this.containers.push(inst);}}}}
for(i=queries.length-1;i>=0;i--){targetData=queries[i][1];_queries=queries[i][0];for(j=0,queriesLength=_queries.length;j<queriesLength;j++){item=$(_queries[j]);item.data(this.widgetName+"-item",targetData);items.push({item:item,instance:targetData,width:0,height:0,left:0,top:0});}}},refreshPositions:function(fast){this.floating=this.items.length?this.options.axis==="x"||this._isFloating(this.items[0].item):false;if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset();}
var i,item,t,p;for(i=this.items.length-1;i>=0;i--){item=this.items[i];if(item.instance!==this.currentContainer&&this.currentContainer&&item.item[0]!==this.currentItem[0]){continue;}
t=this.options.toleranceElement?$(this.options.toleranceElement,item.item):item.item;if(!fast){item.width=t.outerWidth();item.height=t.outerHeight();}
p=t.offset();item.left=p.left;item.top=p.top;}
if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this);}else{for(i=this.containers.length-1;i>=0;i--){p=this.containers[i].element.offset();this.containers[i].containerCache.left=p.left;this.containers[i].containerCache.top=p.top;this.containers[i].containerCache.width=this.containers[i].element.outerWidth();this.containers[i].containerCache.height=this.containers[i].element.outerHeight();}}
return this;},_createPlaceholder:function(that){that=that||this;var className,o=that.options;if(!o.placeholder||o.placeholder.constructor===String){className=o.placeholder;o.placeholder={element:function(){var nodeName=that.currentItem[0].nodeName.toLowerCase(),element=$("<"+nodeName+">",that.document[0]);that._addClass(element,"ui-sortable-placeholder",className||that.currentItem[0].className)._removeClass(element,"ui-sortable-helper");if(nodeName==="tbody"){that._createTrPlaceholder(that.currentItem.find("tr").eq(0),$("<tr>",that.document[0]).appendTo(element));}else if(nodeName==="tr"){that._createTrPlaceholder(that.currentItem,element);}else if(nodeName==="img"){element.attr("src",that.currentItem.attr("src"));}
if(!className){element.css("visibility","hidden");}
return element;},update:function(container,p){if(className&&!o.forcePlaceholderSize){return;}
if(!p.height()){p.height(that.currentItem.innerHeight()-
parseInt(that.currentItem.css("paddingTop")||0,10)-
parseInt(that.currentItem.css("paddingBottom")||0,10));}
if(!p.width()){p.width(that.currentItem.innerWidth()-
parseInt(that.currentItem.css("paddingLeft")||0,10)-
parseInt(that.currentItem.css("paddingRight")||0,10));}}};}
that.placeholder=$(o.placeholder.element.call(that.element,that.currentItem));that.currentItem.after(that.placeholder);o.placeholder.update(that,that.placeholder);},_createTrPlaceholder:function(sourceTr,targetTr){var that=this;sourceTr.children().each(function(){$("<td>&#160;</td>",that.document[0]).attr("colspan",$(this).attr("colspan")||1).appendTo(targetTr);});},_contactContainers:function(event){var i,j,dist,itemWithLeastDistance,posProperty,sizeProperty,cur,nearBottom,floating,axis,innermostContainer=null,innermostIndex=null;for(i=this.containers.length-1;i>=0;i--){if($.contains(this.currentItem[0],this.containers[i].element[0])){continue;}
if(this._intersectsWith(this.containers[i].containerCache)){if(innermostContainer&&$.contains(this.containers[i].element[0],innermostContainer.element[0])){continue;}
innermostContainer=this.containers[i];innermostIndex=i;}else{if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",event,this._uiHash(this));this.containers[i].containerCache.over=0;}}}
if(!innermostContainer){return;}
if(this.containers.length===1){if(!this.containers[innermostIndex].containerCache.over){this.containers[innermostIndex]._trigger("over",event,this._uiHash(this));this.containers[innermostIndex].containerCache.over=1;}}else{dist=10000;itemWithLeastDistance=null;floating=innermostContainer.floating||this._isFloating(this.currentItem);posProperty=floating?"left":"top";sizeProperty=floating?"width":"height";axis=floating?"pageX":"pageY";for(j=this.items.length-1;j>=0;j--){if(!$.contains(this.containers[innermostIndex].element[0],this.items[j].item[0])){continue;}
if(this.items[j].item[0]===this.currentItem[0]){continue;}
cur=this.items[j].item.offset()[posProperty];nearBottom=false;if(event[axis]-cur>this.items[j][sizeProperty]/2){nearBottom=true;}
if(Math.abs(event[axis]-cur)<dist){dist=Math.abs(event[axis]-cur);itemWithLeastDistance=this.items[j];this.direction=nearBottom?"up":"down";}}
if(!itemWithLeastDistance&&!this.options.dropOnEmpty){return;}
if(this.currentContainer===this.containers[innermostIndex]){if(!this.currentContainer.containerCache.over){this.containers[innermostIndex]._trigger("over",event,this._uiHash());this.currentContainer.containerCache.over=1;}
return;}
itemWithLeastDistance?this._rearrange(event,itemWithLeastDistance,null,true):this._rearrange(event,null,this.containers[innermostIndex].element,true);this._trigger("change",event,this._uiHash());this.containers[innermostIndex]._trigger("change",event,this._uiHash(this));this.currentContainer=this.containers[innermostIndex];this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[innermostIndex]._trigger("over",event,this._uiHash(this));this.containers[innermostIndex].containerCache.over=1;}},_createHelper:function(event){var o=this.options,helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event,this.currentItem])):(o.helper==="clone"?this.currentItem.clone():this.currentItem);if(!helper.parents("body").length){$(o.appendTo!=="parent"?o.appendTo:this.currentItem[0].parentNode)[0].appendChild(helper[0]);}
if(helper[0]===this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")};}
if(!helper[0].style.width||o.forceHelperSize){helper.width(this.currentItem.width());}
if(!helper[0].style.height||o.forceHelperSize){helper.height(this.currentItem.height());}
return helper;},_adjustOffsetFromHelper:function(obj){if(typeof obj==="string"){obj=obj.split(" ");}
if($.isArray(obj)){obj={left:+obj[0],top:+obj[1]||0};}
if("left"in obj){this.offset.click.left=obj.left+this.margins.left;}
if("right"in obj){this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left;}
if("top"in obj){this.offset.click.top=obj.top+this.margins.top;}
if("bottom"in obj){this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top;}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var po=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==this.document[0]&&$.contains(this.scrollParent[0],this.offsetParent[0])){po.left+=this.scrollParent.scrollLeft();po.top+=this.scrollParent.scrollTop();}
if(this.offsetParent[0]===this.document[0].body||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&$.ui.ie)){po={top:0,left:0};}
return{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)};},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var p=this.currentItem.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+
this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+
this.scrollParent.scrollLeft()};}else{return{top:0,left:0};}},_cacheMargins:function(){this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)};},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};},_setContainment:function(){var ce,co,over,o=this.options;if(o.containment==="parent"){o.containment=this.helper[0].parentNode;}
if(o.containment==="document"||o.containment==="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,o.containment==="document"?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,(o.containment==="document"?(this.document.height()||document.body.parentNode.scrollHeight):this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];}
if(!(/^(document|window|parent)$/).test(o.containment)){ce=$(o.containment)[0];co=$(o.containment).offset();over=($(ce).css("overflow")!=="hidden");this.containment=[co.left+(parseInt($(ce).css("borderLeftWidth"),10)||0)+
(parseInt($(ce).css("paddingLeft"),10)||0)-this.margins.left,co.top+(parseInt($(ce).css("borderTopWidth"),10)||0)+
(parseInt($(ce).css("paddingTop"),10)||0)-this.margins.top,co.left+(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-
(parseInt($(ce).css("borderLeftWidth"),10)||0)-
(parseInt($(ce).css("paddingRight"),10)||0)-
this.helperProportions.width-this.margins.left,co.top+(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-
(parseInt($(ce).css("borderTopWidth"),10)||0)-
(parseInt($(ce).css("paddingBottom"),10)||0)-
this.helperProportions.height-this.margins.top];}},_convertPositionTo:function(d,pos){if(!pos){pos=this.position;}
var mod=d==="absolute"?1:-1,scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==this.document[0]&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);return{top:(pos.top+
this.offset.relative.top*mod+
this.offset.parent.top*mod-
((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop()))*mod)),left:(pos.left+
this.offset.relative.left*mod+
this.offset.parent.left*mod-
((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())*mod))};},_generatePosition:function(event){var top,left,o=this.options,pageX=event.pageX,pageY=event.pageY,scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==this.document[0]&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);if(this.cssPosition==="relative"&&!(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0])){this.offset.relative=this._getRelativeOffset();}
if(this.originalPosition){if(this.containment){if(event.pageX-this.offset.click.left<this.containment[0]){pageX=this.containment[0]+this.offset.click.left;}
if(event.pageY-this.offset.click.top<this.containment[1]){pageY=this.containment[1]+this.offset.click.top;}
if(event.pageX-this.offset.click.left>this.containment[2]){pageX=this.containment[2]+this.offset.click.left;}
if(event.pageY-this.offset.click.top>this.containment[3]){pageY=this.containment[3]+this.offset.click.top;}}
if(o.grid){top=this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1];pageY=this.containment?((top-this.offset.click.top>=this.containment[1]&&top-this.offset.click.top<=this.containment[3])?top:((top-this.offset.click.top>=this.containment[1])?top-o.grid[1]:top+o.grid[1])):top;left=this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0];pageX=this.containment?((left-this.offset.click.left>=this.containment[0]&&left-this.offset.click.left<=this.containment[2])?left:((left-this.offset.click.left>=this.containment[0])?left-o.grid[0]:left+o.grid[0])):left;}}
return{top:(pageY-
this.offset.click.top-
this.offset.relative.top-
this.offset.parent.top+
((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop())))),left:(pageX-
this.offset.click.left-
this.offset.relative.left-
this.offset.parent.left+
((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())))};},_rearrange:function(event,i,a,hardRefresh){a?a[0].appendChild(this.placeholder[0]):i.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction==="down"?i.item[0]:i.item[0].nextSibling));this.counter=this.counter?++this.counter:1;var counter=this.counter;this._delay(function(){if(counter===this.counter){this.refreshPositions(!hardRefresh);}});},_clear:function(event,noPropagation){this.reverting=false;var i,delayedTriggers=[];if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem);}
this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(i in this._storedCSS){if(this._storedCSS[i]==="auto"||this._storedCSS[i]==="static"){this._storedCSS[i]="";}}
this.currentItem.css(this._storedCSS);this._removeClass(this.currentItem,"ui-sortable-helper");}else{this.currentItem.show();}
if(this.fromOutside&&!noPropagation){delayedTriggers.push(function(event){this._trigger("receive",event,this._uiHash(this.fromOutside));});}
if((this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!noPropagation){delayedTriggers.push(function(event){this._trigger("update",event,this._uiHash());});}
if(this!==this.currentContainer){if(!noPropagation){delayedTriggers.push(function(event){this._trigger("remove",event,this._uiHash());});delayedTriggers.push((function(c){return function(event){c._trigger("receive",event,this._uiHash(this));};}).call(this,this.currentContainer));delayedTriggers.push((function(c){return function(event){c._trigger("update",event,this._uiHash(this));};}).call(this,this.currentContainer));}}
function delayEvent(type,instance,container){return function(event){container._trigger(type,event,instance._uiHash(instance));};}
for(i=this.containers.length-1;i>=0;i--){if(!noPropagation){delayedTriggers.push(delayEvent("deactivate",this,this.containers[i]));}
if(this.containers[i].containerCache.over){delayedTriggers.push(delayEvent("out",this,this.containers[i]));this.containers[i].containerCache.over=0;}}
if(this.storedCursor){this.document.find("body").css("cursor",this.storedCursor);this.storedStylesheet.remove();}
if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity);}
if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex);}
this.dragging=false;if(!noPropagation){this._trigger("beforeStop",event,this._uiHash());}
this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(!this.cancelHelperRemoval){if(this.helper[0]!==this.currentItem[0]){this.helper.remove();}
this.helper=null;}
if(!noPropagation){for(i=0;i<delayedTriggers.length;i++){delayedTriggers[i].call(this,event);}
this._trigger("stop",event,this._uiHash());}
this.fromOutside=false;return!this.cancelHelperRemoval;},_trigger:function(){if($.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel();}},_uiHash:function(_inst){var inst=_inst||this;return{helper:inst.helper,placeholder:inst.placeholder||$([]),position:inst.position,originalPosition:inst.originalPosition,offset:inst.positionAbs,item:inst.currentItem,sender:_inst?_inst.element:null};}});function spinnerModifer(fn){return function(){var previous=this.element.val();fn.apply(this,arguments);this._refresh();if(previous!==this.element.val()){this._trigger("change");}};}
$.widget("ui.spinner",{version:"1.12.1",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:true,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max);this._setOption("min",this.options.min);this._setOption("step",this.options.step);if(this.value()!==""){this._value(this.element.val(),true);}
this._draw();this._on(this._events);this._refresh();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete");}});},_getCreateOptions:function(){var options=this._super();var element=this.element;$.each(["min","max","step"],function(i,option){var value=element.attr(option);if(value!=null&&value.length){options[option]=value;}});return options;},_events:{keydown:function(event){if(this._start(event)&&this._keydown(event)){event.preventDefault();}},keyup:"_stop",focus:function(){this.previous=this.element.val();},blur:function(event){if(this.cancelBlur){delete this.cancelBlur;return;}
this._stop();this._refresh();if(this.previous!==this.element.val()){this._trigger("change",event);}},mousewheel:function(event,delta){if(!delta){return;}
if(!this.spinning&&!this._start(event)){return false;}
this._spin((delta>0?1:-1)*this.options.step,event);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=this._delay(function(){if(this.spinning){this._stop(event);}},100);event.preventDefault();},"mousedown .ui-spinner-button":function(event){var previous;previous=this.element[0]===$.ui.safeActiveElement(this.document[0])?this.previous:this.element.val();function checkFocus(){var isActive=this.element[0]===$.ui.safeActiveElement(this.document[0]);if(!isActive){this.element.trigger("focus");this.previous=previous;this._delay(function(){this.previous=previous;});}}
event.preventDefault();checkFocus.call(this);this.cancelBlur=true;this._delay(function(){delete this.cancelBlur;checkFocus.call(this);});if(this._start(event)===false){return;}
this._repeat(null,$(event.currentTarget).hasClass("ui-spinner-up")?1:-1,event);},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(event){if(!$(event.currentTarget).hasClass("ui-state-active")){return;}
if(this._start(event)===false){return false;}
this._repeat(null,$(event.currentTarget).hasClass("ui-spinner-up")?1:-1,event);},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>");},_draw:function(){this._enhance();this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content");this._addClass("ui-spinner-input");this.element.attr("role","spinbutton");this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",true).button({classes:{"ui-button":""}});this._removeClass(this.buttons,"ui-corner-all");this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up");this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down");this.buttons.first().button({"icon":this.options.icons.up,"showLabel":false});this.buttons.last().button({"icon":this.options.icons.down,"showLabel":false});if(this.buttons.height()>Math.ceil(this.uiSpinner.height()*0.5)&&this.uiSpinner.height()>0){this.uiSpinner.height(this.uiSpinner.height());}},_keydown:function(event){var options=this.options,keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.UP:this._repeat(null,1,event);return true;case keyCode.DOWN:this._repeat(null,-1,event);return true;case keyCode.PAGE_UP:this._repeat(null,options.page,event);return true;case keyCode.PAGE_DOWN:this._repeat(null,-options.page,event);return true;}
return false;},_start:function(event){if(!this.spinning&&this._trigger("start",event)===false){return false;}
if(!this.counter){this.counter=1;}
this.spinning=true;return true;},_repeat:function(i,steps,event){i=i||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,steps,event);},i);this._spin(steps*this.options.step,event);},_spin:function(step,event){var value=this.value()||0;if(!this.counter){this.counter=1;}
value=this._adjustValue(value+step*this._increment(this.counter));if(!this.spinning||this._trigger("spin",event,{value:value})!==false){this._value(value);this.counter++;}},_increment:function(i){var incremental=this.options.incremental;if(incremental){return $.isFunction(incremental)?incremental(i):Math.floor(i*i*i/50000-i*i/500+17*i/200+1);}
return 1;},_precision:function(){var precision=this._precisionOf(this.options.step);if(this.options.min!==null){precision=Math.max(precision,this._precisionOf(this.options.min));}
return precision;},_precisionOf:function(num){var str=num.toString(),decimal=str.indexOf(".");return decimal===-1?0:str.length-decimal-1;},_adjustValue:function(value){var base,aboveMin,options=this.options;base=options.min!==null?options.min:0;aboveMin=value-base;aboveMin=Math.round(aboveMin/options.step)*options.step;value=base+aboveMin;value=parseFloat(value.toFixed(this._precision()));if(options.max!==null&&value>options.max){return options.max;}
if(options.min!==null&&value<options.min){return options.min;}
return value;},_stop:function(event){if(!this.spinning){return;}
clearTimeout(this.timer);clearTimeout(this.mousewheelTimer);this.counter=0;this.spinning=false;this._trigger("stop",event);},_setOption:function(key,value){var prevValue,first,last;if(key==="culture"||key==="numberFormat"){prevValue=this._parse(this.element.val());this.options[key]=value;this.element.val(this._format(prevValue));return;}
if(key==="max"||key==="min"||key==="step"){if(typeof value==="string"){value=this._parse(value);}}
if(key==="icons"){first=this.buttons.first().find(".ui-icon");this._removeClass(first,null,this.options.icons.up);this._addClass(first,null,value.up);last=this.buttons.last().find(".ui-icon");this._removeClass(last,null,this.options.icons.down);this._addClass(last,null,value.down);}
this._super(key,value);},_setOptionDisabled:function(value){this._super(value);this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!value);this.element.prop("disabled",!!value);this.buttons.button(value?"disable":"enable");},_setOptions:spinnerModifer(function(options){this._super(options);}),_parse:function(val){if(typeof val==="string"&&val!==""){val=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(val,10,this.options.culture):+val;}
return val===""||isNaN(val)?null:val;},_format:function(value){if(value===""){return"";}
return window.Globalize&&this.options.numberFormat?Globalize.format(value,this.options.numberFormat,this.options.culture):value;},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())});},isValid:function(){var value=this.value();if(value===null){return false;}
return value===this._adjustValue(value);},_value:function(value,allowAny){var parsed;if(value!==""){parsed=this._parse(value);if(parsed!==null){if(!allowAny){parsed=this._adjustValue(parsed);}
value=this._format(parsed);}}
this.element.val(value);this._refresh();},_destroy:function(){this.element.prop("disabled",false).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow");this.uiSpinner.replaceWith(this.element);},stepUp:spinnerModifer(function(steps){this._stepUp(steps);}),_stepUp:function(steps){if(this._start()){this._spin((steps||1)*this.options.step);this._stop();}},stepDown:spinnerModifer(function(steps){this._stepDown(steps);}),_stepDown:function(steps){if(this._start()){this._spin((steps||1)*-this.options.step);this._stop();}},pageUp:spinnerModifer(function(pages){this._stepUp((pages||1)*this.options.page);}),pageDown:spinnerModifer(function(pages){this._stepDown((pages||1)*this.options.page);}),value:function(newVal){if(!arguments.length){return this._parse(this.element.val());}
spinnerModifer(this._value).call(this,newVal);},widget:function(){return this.uiSpinner;}});if($.uiBackCompat!==false){$.widget("ui.spinner",$.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());},_uiSpinnerHtml:function(){return"<span>";},_buttonHtml:function(){return"<a></a><a></a>";}});}
var widgetsSpinner=$.ui.spinner;$.widget("ui.tabs",{version:"1.12.1",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:false,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:(function(){var rhash=/#.*$/;return function(anchor){var anchorUrl,locationUrl;anchorUrl=anchor.href.replace(rhash,"");locationUrl=location.href.replace(rhash,"");try{anchorUrl=decodeURIComponent(anchorUrl);}catch(error){}
try{locationUrl=decodeURIComponent(locationUrl);}catch(error){}
return anchor.hash.length>1&&anchorUrl===locationUrl;};})(),_create:function(){var that=this,options=this.options;this.running=false;this._addClass("ui-tabs","ui-widget ui-widget-content");this._toggleClass("ui-tabs-collapsible",null,options.collapsible);this._processTabs();options.active=this._initialActive();if($.isArray(options.disabled)){options.disabled=$.unique(options.disabled.concat($.map(this.tabs.filter(".ui-state-disabled"),function(li){return that.tabs.index(li);}))).sort();}
if(this.options.active!==false&&this.anchors.length){this.active=this._findActive(options.active);}else{this.active=$();}
this._refresh();if(this.active.length){this.load(options.active);}},_initialActive:function(){var active=this.options.active,collapsible=this.options.collapsible,locationHash=location.hash.substring(1);if(active===null){if(locationHash){this.tabs.each(function(i,tab){if($(tab).attr("aria-controls")===locationHash){active=i;return false;}});}
if(active===null){active=this.tabs.index(this.tabs.filter(".ui-tabs-active"));}
if(active===null||active===-1){active=this.tabs.length?0:false;}}
if(active!==false){active=this.tabs.index(this.tabs.eq(active));if(active===-1){active=collapsible?false:0;}}
if(!collapsible&&active===false&&this.anchors.length){active=0;}
return active;},_getCreateEventData:function(){return{tab:this.active,panel:!this.active.length?$():this._getPanelForTab(this.active)};},_tabKeydown:function(event){var focusedTab=$($.ui.safeActiveElement(this.document[0])).closest("li"),selectedIndex=this.tabs.index(focusedTab),goingForward=true;if(this._handlePageNav(event)){return;}
switch(event.keyCode){case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:selectedIndex++;break;case $.ui.keyCode.UP:case $.ui.keyCode.LEFT:goingForward=false;selectedIndex--;break;case $.ui.keyCode.END:selectedIndex=this.anchors.length-1;break;case $.ui.keyCode.HOME:selectedIndex=0;break;case $.ui.keyCode.SPACE:event.preventDefault();clearTimeout(this.activating);this._activate(selectedIndex);return;case $.ui.keyCode.ENTER:event.preventDefault();clearTimeout(this.activating);this._activate(selectedIndex===this.options.active?false:selectedIndex);return;default:return;}
event.preventDefault();clearTimeout(this.activating);selectedIndex=this._focusNextTab(selectedIndex,goingForward);if(!event.ctrlKey&&!event.metaKey){focusedTab.attr("aria-selected","false");this.tabs.eq(selectedIndex).attr("aria-selected","true");this.activating=this._delay(function(){this.option("active",selectedIndex);},this.delay);}},_panelKeydown:function(event){if(this._handlePageNav(event)){return;}
if(event.ctrlKey&&event.keyCode===$.ui.keyCode.UP){event.preventDefault();this.active.trigger("focus");}},_handlePageNav:function(event){if(event.altKey&&event.keyCode===$.ui.keyCode.PAGE_UP){this._activate(this._focusNextTab(this.options.active-1,false));return true;}
if(event.altKey&&event.keyCode===$.ui.keyCode.PAGE_DOWN){this._activate(this._focusNextTab(this.options.active+1,true));return true;}},_findNextTab:function(index,goingForward){var lastTabIndex=this.tabs.length-1;function constrain(){if(index>lastTabIndex){index=0;}
if(index<0){index=lastTabIndex;}
return index;}
while($.inArray(constrain(),this.options.disabled)!==-1){index=goingForward?index+1:index-1;}
return index;},_focusNextTab:function(index,goingForward){index=this._findNextTab(index,goingForward);this.tabs.eq(index).trigger("focus");return index;},_setOption:function(key,value){if(key==="active"){this._activate(value);return;}
this._super(key,value);if(key==="collapsible"){this._toggleClass("ui-tabs-collapsible",null,value);if(!value&&this.options.active===false){this._activate(0);}}
if(key==="event"){this._setupEvents(value);}
if(key==="heightStyle"){this._setupHeightStyle(value);}},_sanitizeSelector:function(hash){return hash?hash.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):"";},refresh:function(){var options=this.options,lis=this.tablist.children(":has(a[href])");options.disabled=$.map(lis.filter(".ui-state-disabled"),function(tab){return lis.index(tab);});this._processTabs();if(options.active===false||!this.anchors.length){options.active=false;this.active=$();}else if(this.active.length&&!$.contains(this.tablist[0],this.active[0])){if(this.tabs.length===options.disabled.length){options.active=false;this.active=$();}else{this._activate(this._findNextTab(Math.max(0,options.active-1),false));}}else{options.active=this.tabs.index(this.active);}
this._refresh();},_refresh:function(){this._setOptionDisabled(this.options.disabled);this._setupEvents(this.options.event);this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"});if(!this.active.length){this.tabs.eq(0).attr("tabIndex",0);}else{this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0});this._addClass(this.active,"ui-tabs-active","ui-state-active");this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"});}},_processTabs:function(){var that=this,prevTabs=this.tabs,prevAnchors=this.anchors,prevPanels=this.panels;this.tablist=this._getList().attr("role","tablist");this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header");this.tablist.on("mousedown"+this.eventNamespace,"> li",function(event){if($(this).is(".ui-state-disabled")){event.preventDefault();}}).on("focus"+this.eventNamespace,".ui-tabs-anchor",function(){if($(this).closest("li").is(".ui-state-disabled")){this.blur();}});this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1});this._addClass(this.tabs,"ui-tabs-tab","ui-state-default");this.anchors=this.tabs.map(function(){return $("a",this)[0];}).attr({role:"presentation",tabIndex:-1});this._addClass(this.anchors,"ui-tabs-anchor");this.panels=$();this.anchors.each(function(i,anchor){var selector,panel,panelId,anchorId=$(anchor).uniqueId().attr("id"),tab=$(anchor).closest("li"),originalAriaControls=tab.attr("aria-controls");if(that._isLocal(anchor)){selector=anchor.hash;panelId=selector.substring(1);panel=that.element.find(that._sanitizeSelector(selector));}else{panelId=tab.attr("aria-controls")||$({}).uniqueId()[0].id;selector="#"+panelId;panel=that.element.find(selector);if(!panel.length){panel=that._createPanel(panelId);panel.insertAfter(that.panels[i-1]||that.tablist);}
panel.attr("aria-live","polite");}
if(panel.length){that.panels=that.panels.add(panel);}
if(originalAriaControls){tab.data("ui-tabs-aria-controls",originalAriaControls);}
tab.attr({"aria-controls":panelId,"aria-labelledby":anchorId});panel.attr("aria-labelledby",anchorId);});this.panels.attr("role","tabpanel");this._addClass(this.panels,"ui-tabs-panel","ui-widget-content");if(prevTabs){this._off(prevTabs.not(this.tabs));this._off(prevAnchors.not(this.anchors));this._off(prevPanels.not(this.panels));}},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0);},_createPanel:function(id){return $("<div>").attr("id",id).data("ui-tabs-destroy",true);},_setOptionDisabled:function(disabled){var currentItem,li,i;if($.isArray(disabled)){if(!disabled.length){disabled=false;}else if(disabled.length===this.anchors.length){disabled=true;}}
for(i=0;(li=this.tabs[i]);i++){currentItem=$(li);if(disabled===true||$.inArray(i,disabled)!==-1){currentItem.attr("aria-disabled","true");this._addClass(currentItem,null,"ui-state-disabled");}else{currentItem.removeAttr("aria-disabled");this._removeClass(currentItem,null,"ui-state-disabled");}}
this.options.disabled=disabled;this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,disabled===true);},_setupEvents:function(event){var events={};if(event){$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler";});}
this._off(this.anchors.add(this.tabs).add(this.panels));this._on(true,this.anchors,{click:function(event){event.preventDefault();}});this._on(this.anchors,events);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs);},_setupHeightStyle:function(heightStyle){var maxHeight,parent=this.element.parent();if(heightStyle==="fill"){maxHeight=parent.height();maxHeight-=this.element.outerHeight()-this.element.height();this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");if(position==="absolute"||position==="fixed"){return;}
maxHeight-=elem.outerHeight(true);});this.element.children().not(this.panels).each(function(){maxHeight-=$(this).outerHeight(true);});this.panels.each(function(){$(this).height(Math.max(0,maxHeight-
$(this).innerHeight()+$(this).height()));}).css("overflow","auto");}else if(heightStyle==="auto"){maxHeight=0;this.panels.each(function(){maxHeight=Math.max(maxHeight,$(this).height("").height());}).height(maxHeight);}},_eventHandler:function(event){var options=this.options,active=this.active,anchor=$(event.currentTarget),tab=anchor.closest("li"),clickedIsActive=tab[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():this._getPanelForTab(tab),toHide=!active.length?$():this._getPanelForTab(active),eventData={oldTab:active,oldPanel:toHide,newTab:collapsing?$():tab,newPanel:toShow};event.preventDefault();if(tab.hasClass("ui-state-disabled")||tab.hasClass("ui-tabs-loading")||this.running||(clickedIsActive&&!options.collapsible)||(this._trigger("beforeActivate",event,eventData)===false)){return;}
options.active=collapsing?false:this.tabs.index(tab);this.active=clickedIsActive?$():tab;if(this.xhr){this.xhr.abort();}
if(!toHide.length&&!toShow.length){$.error("jQuery UI Tabs: Mismatching fragment identifier.");}
if(toShow.length){this.load(this.tabs.index(tab),event);}
this._toggle(event,eventData);},_toggle:function(event,eventData){var that=this,toShow=eventData.newPanel,toHide=eventData.oldPanel;this.running=true;function complete(){that.running=false;that._trigger("activate",event,eventData);}
function show(){that._addClass(eventData.newTab.closest("li"),"ui-tabs-active","ui-state-active");if(toShow.length&&that.options.show){that._show(toShow,that.options.show,complete);}else{toShow.show();complete();}}
if(toHide.length&&this.options.hide){this._hide(toHide,this.options.hide,function(){that._removeClass(eventData.oldTab.closest("li"),"ui-tabs-active","ui-state-active");show();});}else{this._removeClass(eventData.oldTab.closest("li"),"ui-tabs-active","ui-state-active");toHide.hide();show();}
toHide.attr("aria-hidden","true");eventData.oldTab.attr({"aria-selected":"false","aria-expanded":"false"});if(toShow.length&&toHide.length){eventData.oldTab.attr("tabIndex",-1);}else if(toShow.length){this.tabs.filter(function(){return $(this).attr("tabIndex")===0;}).attr("tabIndex",-1);}
toShow.attr("aria-hidden","false");eventData.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0});},_activate:function(index){var anchor,active=this._findActive(index);if(active[0]===this.active[0]){return;}
if(!active.length){active=this.active;}
anchor=active.find(".ui-tabs-anchor")[0];this._eventHandler({target:anchor,currentTarget:anchor,preventDefault:$.noop});},_findActive:function(index){return index===false?$():this.tabs.eq(index);},_getIndex:function(index){if(typeof index==="string"){index=this.anchors.index(this.anchors.filter("[href$='"+
$.ui.escapeSelector(index)+"']"));}
return index;},_destroy:function(){if(this.xhr){this.xhr.abort();}
this.tablist.removeAttr("role").off(this.eventNamespace);this.anchors.removeAttr("role tabIndex").removeUniqueId();this.tabs.add(this.panels).each(function(){if($.data(this,"ui-tabs-destroy")){$(this).remove();}else{$(this).removeAttr("role tabIndex "+"aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded");}});this.tabs.each(function(){var li=$(this),prev=li.data("ui-tabs-aria-controls");if(prev){li.attr("aria-controls",prev).removeData("ui-tabs-aria-controls");}else{li.removeAttr("aria-controls");}});this.panels.show();if(this.options.heightStyle!=="content"){this.panels.css("height","");}},enable:function(index){var disabled=this.options.disabled;if(disabled===false){return;}
if(index===undefined){disabled=false;}else{index=this._getIndex(index);if($.isArray(disabled)){disabled=$.map(disabled,function(num){return num!==index?num:null;});}else{disabled=$.map(this.tabs,function(li,num){return num!==index?num:null;});}}
this._setOptionDisabled(disabled);},disable:function(index){var disabled=this.options.disabled;if(disabled===true){return;}
if(index===undefined){disabled=true;}else{index=this._getIndex(index);if($.inArray(index,disabled)!==-1){return;}
if($.isArray(disabled)){disabled=$.merge([index],disabled).sort();}else{disabled=[index];}}
this._setOptionDisabled(disabled);},load:function(index,event){index=this._getIndex(index);var that=this,tab=this.tabs.eq(index),anchor=tab.find(".ui-tabs-anchor"),panel=this._getPanelForTab(tab),eventData={tab:tab,panel:panel},complete=function(jqXHR,status){if(status==="abort"){that.panels.stop(false,true);}
that._removeClass(tab,"ui-tabs-loading");panel.removeAttr("aria-busy");if(jqXHR===that.xhr){delete that.xhr;}};if(this._isLocal(anchor[0])){return;}
this.xhr=$.ajax(this._ajaxSettings(anchor,event,eventData));if(this.xhr&&this.xhr.statusText!=="canceled"){this._addClass(tab,"ui-tabs-loading");panel.attr("aria-busy","true");this.xhr.done(function(response,status,jqXHR){setTimeout(function(){panel.html(response);that._trigger("load",event,eventData);complete(jqXHR,status);},1);}).fail(function(jqXHR,status){setTimeout(function(){complete(jqXHR,status);},1);});}},_ajaxSettings:function(anchor,event,eventData){var that=this;return{url:anchor.attr("href").replace(/#.*$/,""),beforeSend:function(jqXHR,settings){return that._trigger("beforeLoad",event,$.extend({jqXHR:jqXHR,ajaxSettings:settings},eventData));}};},_getPanelForTab:function(tab){var id=$(tab).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+id));}});if($.uiBackCompat!==false){$.widget("ui.tabs",$.ui.tabs,{_processTabs:function(){this._superApply(arguments);this._addClass(this.tabs,"ui-tab");}});}
var widgetsTabs=$.ui.tabs;$.widget("ui.tooltip",{version:"1.12.1",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var title=$(this).attr("title")||"";return $("<a>").text(title).html();},hide:true,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:true,track:false,close:null,open:null},_addDescribedBy:function(elem,id){var describedby=(elem.attr("aria-describedby")||"").split(/\s+/);describedby.push(id);elem.data("ui-tooltip-id",id).attr("aria-describedby",$.trim(describedby.join(" ")));},_removeDescribedBy:function(elem){var id=elem.data("ui-tooltip-id"),describedby=(elem.attr("aria-describedby")||"").split(/\s+/),index=$.inArray(id,describedby);if(index!==-1){describedby.splice(index,1);}
elem.removeData("ui-tooltip-id");describedby=$.trim(describedby.join(" "));if(describedby){elem.attr("aria-describedby",describedby);}else{elem.removeAttr("aria-describedby");}},_create:function(){this._on({mouseover:"open",focusin:"open"});this.tooltips={};this.parents={};this.liveRegion=$("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body);this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible");this.disabledTitles=$([]);},_setOption:function(key,value){var that=this;this._super(key,value);if(key==="content"){$.each(this.tooltips,function(id,tooltipData){that._updateContent(tooltipData.element);});}},_setOptionDisabled:function(value){this[value?"_disable":"_enable"]();},_disable:function(){var that=this;$.each(this.tooltips,function(id,tooltipData){var event=$.Event("blur");event.target=event.currentTarget=tooltipData.element[0];that.close(event,true);});this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter(function(){var element=$(this);if(element.is("[title]")){return element.data("ui-tooltip-title",element.attr("title")).removeAttr("title");}}));},_enable:function(){this.disabledTitles.each(function(){var element=$(this);if(element.data("ui-tooltip-title")){element.attr("title",element.data("ui-tooltip-title"));}});this.disabledTitles=$([]);},open:function(event){var that=this,target=$(event?event.target:this.element).closest(this.options.items);if(!target.length||target.data("ui-tooltip-id")){return;}
if(target.attr("title")){target.data("ui-tooltip-title",target.attr("title"));}
target.data("ui-tooltip-open",true);if(event&&event.type==="mouseover"){target.parents().each(function(){var parent=$(this),blurEvent;if(parent.data("ui-tooltip-open")){blurEvent=$.Event("blur");blurEvent.target=blurEvent.currentTarget=this;that.close(blurEvent,true);}
if(parent.attr("title")){parent.uniqueId();that.parents[this.id]={element:this,title:parent.attr("title")};parent.attr("title","");}});}
this._registerCloseHandlers(event,target);this._updateContent(target,event);},_updateContent:function(target,event){var content,contentOption=this.options.content,that=this,eventType=event?event.type:null;if(typeof contentOption==="string"||contentOption.nodeType||contentOption.jquery){return this._open(event,target,contentOption);}
content=contentOption.call(target[0],function(response){that._delay(function(){if(!target.data("ui-tooltip-open")){return;}
if(event){event.type=eventType;}
this._open(event,target,response);});});if(content){this._open(event,target,content);}},_open:function(event,target,content){var tooltipData,tooltip,delayedShow,a11yContent,positionOption=$.extend({},this.options.position);if(!content){return;}
tooltipData=this._find(target);if(tooltipData){tooltipData.tooltip.find(".ui-tooltip-content").html(content);return;}
if(target.is("[title]")){if(event&&event.type==="mouseover"){target.attr("title","");}else{target.removeAttr("title");}}
tooltipData=this._tooltip(target);tooltip=tooltipData.tooltip;this._addDescribedBy(target,tooltip.attr("id"));tooltip.find(".ui-tooltip-content").html(content);this.liveRegion.children().hide();a11yContent=$("<div>").html(tooltip.find(".ui-tooltip-content").html());a11yContent.removeAttr("name").find("[name]").removeAttr("name");a11yContent.removeAttr("id").find("[id]").removeAttr("id");a11yContent.appendTo(this.liveRegion);function position(event){positionOption.of=event;if(tooltip.is(":hidden")){return;}
tooltip.position(positionOption);}
if(this.options.track&&event&&/^mouse/.test(event.type)){this._on(this.document,{mousemove:position});position(event);}else{tooltip.position($.extend({of:target},this.options.position));}
tooltip.hide();this._show(tooltip,this.options.show);if(this.options.track&&this.options.show&&this.options.show.delay){delayedShow=this.delayedShow=setInterval(function(){if(tooltip.is(":visible")){position(positionOption.of);clearInterval(delayedShow);}},$.fx.interval);}
this._trigger("open",event,{tooltip:tooltip});},_registerCloseHandlers:function(event,target){var events={keyup:function(event){if(event.keyCode===$.ui.keyCode.ESCAPE){var fakeEvent=$.Event(event);fakeEvent.currentTarget=target[0];this.close(fakeEvent,true);}}};if(target[0]!==this.element[0]){events.remove=function(){this._removeTooltip(this._find(target).tooltip);};}
if(!event||event.type==="mouseover"){events.mouseleave="close";}
if(!event||event.type==="focusin"){events.focusout="close";}
this._on(true,target,events);},close:function(event){var tooltip,that=this,target=$(event?event.currentTarget:this.element),tooltipData=this._find(target);if(!tooltipData){target.removeData("ui-tooltip-open");return;}
tooltip=tooltipData.tooltip;if(tooltipData.closing){return;}
clearInterval(this.delayedShow);if(target.data("ui-tooltip-title")&&!target.attr("title")){target.attr("title",target.data("ui-tooltip-title"));}
this._removeDescribedBy(target);tooltipData.hiding=true;tooltip.stop(true);this._hide(tooltip,this.options.hide,function(){that._removeTooltip($(this));});target.removeData("ui-tooltip-open");this._off(target,"mouseleave focusout keyup");if(target[0]!==this.element[0]){this._off(target,"remove");}
this._off(this.document,"mousemove");if(event&&event.type==="mouseleave"){$.each(this.parents,function(id,parent){$(parent.element).attr("title",parent.title);delete that.parents[id];});}
tooltipData.closing=true;this._trigger("close",event,{tooltip:tooltip});if(!tooltipData.hiding){tooltipData.closing=false;}},_tooltip:function(element){var tooltip=$("<div>").attr("role","tooltip"),content=$("<div>").appendTo(tooltip),id=tooltip.uniqueId().attr("id");this._addClass(content,"ui-tooltip-content");this._addClass(tooltip,"ui-tooltip","ui-widget ui-widget-content");tooltip.appendTo(this._appendTo(element));return this.tooltips[id]={element:element,tooltip:tooltip};},_find:function(target){var id=target.data("ui-tooltip-id");return id?this.tooltips[id]:null;},_removeTooltip:function(tooltip){tooltip.remove();delete this.tooltips[tooltip.attr("id")];},_appendTo:function(target){var element=target.closest(".ui-front, dialog");if(!element.length){element=this.document[0].body;}
return element;},_destroy:function(){var that=this;$.each(this.tooltips,function(id,tooltipData){var event=$.Event("blur"),element=tooltipData.element;event.target=event.currentTarget=element[0];that.close(event,true);$("#"+id).remove();if(element.data("ui-tooltip-title")){if(!element.attr("title")){element.attr("title",element.data("ui-tooltip-title"));}
element.removeData("ui-tooltip-title");}});this.liveRegion.remove();}});if($.uiBackCompat!==false){$.widget("ui.tooltip",$.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var tooltipData=this._superApply(arguments);if(this.options.tooltipClass){tooltipData.tooltip.addClass(this.options.tooltipClass);}
return tooltipData;}});}
var widgetsTooltip=$.ui.tooltip;}));;